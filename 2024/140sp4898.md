FIPS 140-3 Non-Proprietary Security
Policy
SafeZone FIPS SW Cryptographic Module
Software Version v2.0
Rambus Global Inc., Finnish branch
Sokerilinnantie 11 C
FI-02600 Espoo
Phone: +358 50 3560966
Rambus Inc.
North First Street, Suite 100
San Jose, CA 95134
United States of America
https://www.rambus.com/
2024-11-8

SafeZone SW Cryptographic Module 2.0
1 General ........................................................................................................................................... 3
2 Cryptographic module specification .............................................................................................. 3
2.1 Approved Mode of Operation ................................................................................................. 10
3 Cryptographic module interfaces ................................................................................................. 10
4 Roles, services, and authentication.............................................................................................. 11
5 Software/Firmware security ........................................................................................................ 21
6 Operational environment ............................................................................................................. 21
7 Physical security ........................................................................................................................... 21
8 Non-invasive security ................................................................................................................... 21
9 Sensitive security parameters management ................................................................................ 21
9.1 Random bit generators ............................................................................................................ 24
10 Self-tests ....................................................................................................................................... 25
11 Life-cycle assurance ...................................................................................................................... 27
11.1 Version control ......................................................................................................................... 27
11.2 CVE ........................................................................................................................................... 27
11.3 User guidance for specific services .......................................................................................... 27
11.3.1 NIST SP 800-108 Rev 1: Key Derivation Functions ...................................................... 27
11.3.2 NIST SP 800-56C Rev 2: Key-Derivation Methods in Key-Establishment Schemes ..... 28
11.3.3 HMAC-based Extract-and-Expand Key Derivation Function (HKDF) ........................... 29
11.3.4 NIST SP 800-132: PBKDF Function .............................................................................. 29
11.3.5 NIST SP 800-38D: Galois/Counter Mode (GCM) and GMAC ....................................... 30
11.3.6 NIST SP 800-38E: XTS Mode ........................................................................................ 31
11.3.7 NIST SP 800-133 Rev 2: Key Generation (CKG) ........................................................... 31
11.3.8 NIST SP 800-107 Rev 1: Truncated HMAC .................................................................. 31
11.3.9 NIST SP 800-56A Rev 3: Pair-Wise Key-Establishment Schemes (KAS-ECC and KAS-
FFC) 31
11.4 Porting maintaining validation ................................................................................................. 31
12 Mitigation of other attacks .......................................................................................................... 32
Appendix A. Glossary and Abbreviations .......................................................................................... 33
Appendix B. References..................................................................................................................... 34
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
2 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- | --- |

1  General
This document is the non-proprietary FIPS 140-3 Security Policy for the SafeZone FIPS SW
Cryptographic Module version 2.0, hereafter referred to as the module. It contains a
specification of the rules under which the module must operate and describes how this
module meets the requirements as specified in FIPS PUB 140-3 [FIPS 140-3] for a Security
Level 1 module.
It has a one-to-one mapping to the NIST Special Publication 800-140B [NIST SP 800-140B]
starting with section B.2.1 named “General” that maps to section 1 in this document and
ending with section B.2.12 named “Mitigation of other attacks” that maps to section 12 in
this document.
| ISO/IEC 24759  | FIPS 140-3 Section Title                 |     |     | Security  |     |     |
| -------------- | ---------------------------------------- | --- | --- | --------- | --- | --- |
| Section 6.     |                                          |     |     | Level     |     |     |
| 1              | General                                  |     |     | Level 1   |     |     |
| 2              | Cryptographic module specification       |     |     | Level 1   |     |     |
| 3              | Cryptographic module interfaces          |     |     | Level 1   |     |     |
| 4              | Roles, services, and authentication      |     |     | Level 1   |     |     |
| 5              | Software/Firmware security               |     |     | Level 1   |     |     |
| 6              | Operational environment                  |     |     | Level 1   |     |     |
| 7              | Physical security                        |     |     | N/A       |     |     |
| 8              | Non-invasive security                    |     |     | N/A       |     |     |
| 9              | Sensitive security parameter management  |     |     | Level 1   |     |     |
| 10             | Self-tests                               |     |     | Level 1   |     |     |
| 11             | Life-cycle assurance                     |     |     | Level 1   |     |     |
| 12             | Mitigation of other attacks              |     |     | N/A       |     |     |
Table 1 - Security Levels

2
Cryptographic module specification
SafeZone FIPS SW Cryptographic Module is a FIPS 140-3 Level 1 validated software
cryptographic module from Rambus. The module provides a set of commonly used
cryptographic primitives by exposing a custom API for a wide range of applications,
typically running on a general-purpose operating system. There are 4 different binary
versions of the module to suit the target environments.
The identification string of the SafeZone FIPS SW Cryptographic Module can be acquired
with the FLS_LibDescription function. The returned identification string is:
”SafeZone FL 2.0 NOHASH”
| •   |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- |
The cryptographic module has been tested for validation on operational environments listed
in the Table 2 below.
| #  Operating System  |     | Hardware Platform  | Processor  |     | PAA /  |     |
| -------------------- | --- | ------------------ | ---------- | --- | ------ | --- |
Acceleration
1  Linux Ubuntu 20.04 LTS   AAEON UP Core   Intel® Atom™ x5-Z8350  AES-NI, Intel
| (X86 32-bit)  |     | UPC-CHT01-A20-0464-A11  |     |     | SHA extensions  |     |
| ------------- | --- | ----------------------- | --- | --- | --------------- | --- |
2  Linux Ubuntu 20.04 LTS  AAEON UP Core   Intel® Atom™ x5-Z8350  -
| (X86 32-bit)  |     | UPC-CHT01-A20-0464-A11  |     |     |     |     |
| ------------- | --- | ----------------------- | --- | --- | --- | --- |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 3 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- |

3  Linux Ubuntu 20.04 LTS  AAEON UP Core   Intel® Atom™ x5-Z8350  AES-NI, Intel
| (X86 64-bit)  | UPC-CHT01-A20-0464-A11  |     | SHA extensions  |     |
| ------------- | ----------------------- | --- | --------------- | --- |
4  Linux Ubuntu 20.04 LTS  AAEON UP Core   Intel® Atom™ x5-Z8350  -
| (X86 64-bit)  | UPC-CHT01-A20-0464-A11  |     |     |     |
| ------------- | ----------------------- | --- | --- | --- |
5  Linux Ubuntu 20.04 LTS  Raspberry Pi 4  Broadcom BCM2711  NEON,
| (ARMv8-a 64-bit)  |     |     | Cryptography  |     |
| ----------------- | --- | --- | ------------- | --- |
Extensions
6  Linux Ubuntu 20.04 LTS  Raspberry Pi 4  Broadcom BCM2711  -
(ARMv8-a 64-bit)
7  Linux Ubuntu 20.04 LTS  Raspberry Pi 2  Broadcom BCM2836  NEON
(ARMv7-a 32-bit)
Table 2 - Tested Operational Environments

In addition to the tested operational environments the module has been confirmed by the
vendor to be operational on the following platforms.
| #  Operating System  | Hardware Platform  |     |     |     |
| -------------------- | ------------------ | --- | --- | --- |
1  GNU/Linux Debian 11 (x86-64)   Gigabyte H97M-D3H with an Intel I7-4790K
2  GNU/Linux Debian 10 (aarch64)  Kirin 960, 4 Cortex A73 + 4 Cortex A53 Big.Little CPU
3  GNU/Linux Debian 9.13 (aarch64)  Rockship ROCK64 with a Rockchip RK3328
Table 3 - Vendor Affirmed Operational Environments

The Table 4 below lists the Approved Algorithms implemented by the module. The CAVP
certs may list more algorithms than are actually utilized by the module. Only those listed
below are used by the module.
CAVP  Algorithm and  Mode / Method  Description /  Use / Function
| Cert  Standard  |     | Key Size(s) / Key  |     |     |
| --------------- | --- | ------------------ | --- | --- |
Strength(s)
| A2836  AES-CBC       | AES-CBC  | 128, 192, 256 bits  | Encryption and  |     |
| -------------------- | -------- | ------------------- | --------------- | --- |
|   [NIST SP 800-38A]  |          |                     | Decryption      |     |
| A2836  AES-CCM       | AES-CCM  | 128, 192, 256 bits  | Authenticated   |     |
[NIST SP 800-38C]  Encryption and
Decryption
| A2836  AES-CMAC      | AES-CMAC  | 128, 192, 256 bits  | Message              |     |
| -------------------- | --------- | ------------------- | -------------------- | --- |
|   [NIST SP 800-38B]  |           |                     | Authentication Code  |     |
| A2836  AES-CTR       | AES-CTR   | 128, 192, 256 bits  | Encryption and       |     |
|   [NIST SP 800-38A]  |           |                     | Decryption           |     |
| A2836  AES-ECB       | AES-ECB   | 128, 192, 256 bits  | Encryption and       |     |
|   [NIST SP 800-38A]  |           |                     | Decryption           |     |
| A2836  AES-GCM       | AES-GCM   | 128, 192, 256 bits  | Authenticated        |     |
|   [NIST SP 800-38D]  |           |                     | Encryption and       |     |
Decryption
| A2836  AES-GMAC      | AES-GMAC  | 128, 192, 256 bits  | Message              |     |
| -------------------- | --------- | ------------------- | -------------------- | --- |
|   [NIST SP 800-38D]  |           |                     | Authentication Code  |     |
| A2836  AES-KW        | AES-KW    | 128, 192, 256 bits  | Key Wrapping and     |     |
|   [NIST SP 800-38F]  |           |                     | Unwrapping           |     |
A2836  AES-KWP  AES-KWP  128, 192, 256 bits  Key Wrapping and
|   [NIST SP 800-38F]  |          |                     | Unwrapping      |     |
| -------------------- | -------- | ------------------- | --------------- | --- |
| A2836  AES-OFB       | AES-OFB  | 128, 192, 256 bits  | Encryption and  |     |
|   [NIST SP 800-38A]  |          |                     | Decryption      |     |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 4 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- |

A2836  AES-XTS Testing  AES-XTS  2x128 bits (AES- Storage Encryption and
|   Revision 2.0   |     | XTS-128)   | Decryption  |     |
| ---------------- | --- | ---------- | ----------- | --- |
[NIST SP 800-38E]  2x256 bits (AES-
XTS-256)
A2836  Counter DRBG  Counter DRBG  AES-256 with df and  Random Number
|   [NIST SP 800-90A-r1]  |             | no pr                | Generation      |     |
| ----------------------- | ----------- | -------------------- | --------------- | --- |
| A2836  DSA KeyGen       | DSA KeyGen  | (L,N) =              | Key Generation  |     |
|   [FIPS 186-4]          |             | (2048, 224), (2048,  |                 |     |
256), (3072, 256)
| A2836  DSA PQGGen  | DSA PQGGen  | (L,N) =              | Domain Parameter  |     |
| ------------------ | ----------- | -------------------- | ----------------- | --- |
|   [FIPS 186-4]     |             | (2048, 224), (2048,  | Generation        |     |
256), (3072, 256)
Hash algorithms:
SHA2-2241, SHA2-
256, SHA2-384,
SHA2-512
| A2836  DSA PQGVer  | DSA PQGVer  | (L,N) =              | Domain Parameter  |     |
| ------------------ | ----------- | -------------------- | ----------------- | --- |
|   [FIPS 186-4]     |             | (2048, 224), (2048,  | Verification      |     |
256), (3072, 256)
Hash algorithms:
SHA-12, SHA2-2243,
SHA2-256, SHA2-
383, SHA2-512
| A2836  DSA SigGen  | DSA SigGen  | (L,N) =              | Digital Signatures  |     |
| ------------------ | ----------- | -------------------- | ------------------- | --- |
|   [FIPS 186-4]     |             | (2048, 224), (2048,  |                     |     |
256), (3072, 256)
Hash algorithms:
SHA2-224, SHA2-
256, SHA2-384,
SHA2-512
| A2836  DSA SigVer  | DSA SigVer  | (L,N) =              | Digital Signatures  |     |
| ------------------ | ----------- | -------------------- | ------------------- | --- |
|   [FIPS 186-4]     |             | (1024, 160), (2048,  |                     |     |
224), (2048, 256),
(3072, 256)
Hash algorithms:
SHA-1, SHA2-224,
SHA2-256, SHA2-
384, SHA2-512.
A2836  ECDSA KeyGen  ECDSA KeyGen  NIST P-224, P-256,  Key Generation
|   [FIPS 186-4]  |     | P-384, P-521  |     |     |
| --------------- | --- | ------------- | --- | --- |
curves
A2836  ECDSA SigGen  ECDSA SigGen  NIST P-224, P-256,  Digital Signatures
|   [FIPS 186-4]  |     | P-384, P-521  |     |     |
| --------------- | --- | ------------- | --- | --- |
curves
Hash algorithms:
SHA2-224, SHA2-
256, SHA2-384,
SHA2-512
A2836  ECDSA SigVer  ECDSA SigVer  NIST P-224, P-256,  Digital Signatures
|   [FIPS 186-4]  |     | P-384, P-521  |     |     |
| --------------- | --- | ------------- | --- | --- |

1 (L,N) = (2048, 224) only.
2 (L,N) = (1024, 160) only.
3 (L, N) = (1024, 160) and (2048, 224) only.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 5 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- |

curves
Hash algorithms:
SHA2-224, SHA2-
256, SHA2-384,
SHA2-512
| A2836  | HMAC-SHA-1    | HMAC-SHA-1  | Key Length: 112- | Message              |     |
| ------ | ------------- | ----------- | ---------------- | -------------------- | --- |
|        | [FIPS 198-1]  |             | 512 bits         | Authentication Code  |     |
MAC Length: 80,
96, 160 bits
A2836  HMAC-SHA2-224  HMAC-SHA2-224  Key Length: 112- Message
|     | [FIPS 198-1]  |     | 512 bits  | Authentication Code  |     |
| --- | ------------- | --- | --------- | -------------------- | --- |
MAC Length: 224
bits
A2836  HMAC-SHA2-256  HMAC-SHA2-256  Key Length: 112- Message
|     | [FIPS 198-1]  |     | 512 bits  | Authentication Code  |     |
| --- | ------------- | --- | --------- | -------------------- | --- |
MAC Length: 128,
256 bits
A2836  HMAC-SHA2-384  HMAC-SHA2-384  Key Length: 112- Message
|     | [FIPS 198-1]  |     | 512 bits  | Authentication Code  |     |
| --- | ------------- | --- | --------- | -------------------- | --- |
MAC Length: 192,
384 bits
A2836  HMAC-SHA2-512  HMAC-SHA2-512  Key Length: 112- Message
|     | [FIPS 198-1]  |     | 512 bits  | Authentication Code  |     |
| --- | ------------- | --- | --------- | -------------------- | --- |
MAC Length: 256,
512 bits
A2836  KAS-ECC CDH- KAS-ECC CDH- ephemeralUnified  Key Agreement
|     | Component (CVL)       | Component  | NIST P-224, P-256,  | Primitives  |     |
| --- | --------------------- | ---------- | ------------------- | ----------- | --- |
|     | [NIST SP 800-56A-r3]  |            | P-384 and P- 521    |             |     |
|     |                       |            | curves              |             |     |
A2836  KAS-ECC-SSC  KAS-ECC-SSC  ephemeralUnified  Key Agreement
|     | [NIST SP 800-56A-r3]  |     | NIST P-224, P-256,  | Primitives  |     |
| --- | --------------------- | --- | ------------------- | ----------- | --- |
P-384 and P- 521
curves
| A2836  | KAS-FFC-SSC           | KAS-FFC-SSC  | dhEphem        | Key Agreement  |     |
| ------ | --------------------- | ------------ | -------------- | -------------- | --- |
|        | [NIST SP 800-56A-r3]  |              | 2048-8192 bit  | Primitives     |     |
modular Diffie-
Hellman groups;
including
FFDHE2048,
FFDHE3072,
FFDHE4096,
FFDHE6144,
FFDHE8192,
MODP2048,
MODP3072,
MODP4096,
MODP6144,
MODP8192,
FIPS 186-type FFC
parameter-size
sets FB and FC
A2836  KDA HKDF  KDA HKDF  HMAC Algorithm:  Key Derivation -
|     | [NIST SP 800-56C-r2]  |     | SHA2-224, SHA2- | Generic  |     |
| --- | --------------------- | --- | --------------- | -------- | --- |
256, SHA2-384,
SHA2-512
A2836  KDA TwoStep  KDA TwoStep  Two-Step Key  Key Derivation –
|     | [NIST SP 800-56C-r2]  |     | Derivation with  | Generic  |     |
| --- | --------------------- | --- | ---------------- | -------- | --- |
SHA-1, SHA2-224,
SHA2-256, SHA2-
384, SHA2-512 or
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 6 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- |

AES- CMAC;
counter and
feedback modes
A2836  KDF IKEv1 (CVL)  KDF IKEv1  Hash Algorithm:  Key Derivation –
  [NIST SP 800-135-r1]  SHA-1, SHA2-224,  Application Specific
SHA2-384
A2836  KDF IKEv2 (CVL)  KDF IKEv2  Hash Algorithm:  Key Derivation –
  [NIST SP 800-135-r1]  SHA-1, SHA2-224,  Application Specific
SHA2-256, SHA2-
384, SHA2-512
A2836  KDF SP800-108  KDF SP800-108  112-512 bits  Key Derivation –
|     | [NIST SP 800-108-r1]  |     | SHA-1, SHA2-224,  | Generic  |     |
| --- | --------------------- | --- | ----------------- | -------- | --- |
SHA2-256, SHA2-
384, SHA2-512,
AES-CMAC;
counter, feedback
and double
pipeline modes
A2836  KDF SRTP (CVL)  KDF SRTP  AES Key Length:  Key Derivation –
|     | [NIST SP 800-135-r1]  |     | 128, 192, 256  | Application Specific  |     |
| --- | --------------------- | --- | -------------- | --------------------- | --- |
A2836  KTS-IFC  KTS-IFC  KTS-OAEP-basic  Key Encapsulation and
|     | [NIST SP 800-56B-r2]  |     | Modulo: 2048,  | Un-encapsulation  |     |
| --- | --------------------- | --- | -------------- | ----------------- | --- |
3072, 4096 bits.
Hashes: SHA2-224,
SHA2-256, SHA2-
384, SHA2-512
| A2836  | PBKDF              | PBKDF  | SHA-1, SHA2-256  | Key Derivation –      |     |
| ------ | ------------------ | ------ | ---------------- | --------------------- | --- |
|        | [NIST SP 800-132]  |        |                  | Application Specific  |     |
A2836  RSA KeyGen  RSA KeyGen  2048, 3072, 4096  Key Generation
|     | [FIPS 186-4]  |     | bits  |     |     |
| --- | ------------- | --- | ----- | --- | --- |
A2836  RSA SigGen  RSA SigGen  RSASSA-PKCS1- Digital Signatures
|     | [FIPS 186-4]  |     | v1.5 and RSASSA- |     |     |
| --- | ------------- | --- | ---------------- | --- | --- |
PSS with SHA2-
224, SHA2-256,
SHA2-384, SHA2-
512 and 2048,
3072, 4096 bit
modulus
A2836  RSA SigVer  RSA SigVer  RSASSA-PKCS1- Digital Signatures
|     | [FIPS 186-4]  |     | v1.5 and RSASSA- |     |     |
| --- | ------------- | --- | ---------------- | --- | --- |
PSS with SHA-14,
SHA2-224, SHA2-
256, SHA2-384,
SHA2-512 and
10244, 2048, 3072,
4096 bit modulus
| A2836  | SHA-1         | SHA-1  | SHA-1  | Hash Function    |     |
| ------ | ------------- | ------ | ------ | ---------------- | --- |
|        | [FIPS 180-4]  |        |        | Not allowed for  |     |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 7 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- |

signature generation.

Allowed for legacy use4
for digital signature
verification.
Allowed for non-
digital-signature
applications.
| A2836  | SHA2-224      | SHA2-224  | SHA2-224  | Hash Function  |     |
| ------ | ------------- | --------- | --------- | -------------- | --- |
|        | [FIPS 180-4]  |           |           |                |     |
| A2836  | SHA2-256      | SHA2-256  | SHA2-256  | Hash Function  |     |
|        | [FIPS 180-4]  |           |           |                |     |
| A2836  | SHA2-384      | SHA2-384  | SHA2-384  | Hash Function  |     |
[FIPS 180-4]
| A2836  | SHA2-512      | SHA2-512  | SHA2-512  | Hash Function  |     |
| ------ | ------------- | --------- | --------- | -------------- | --- |
|        | [FIPS 180-4]  |           |           |                |     |
| A2836  | SHA3-224      | SHA3-224  | SHA3-224  | Hash Function  |     |
[FIPS 202]
| A2836  | SHA3-256  | SHA3-256  | SHA3-256  | Hash Function  |     |
| ------ | --------- | --------- | --------- | -------------- | --- |
[FIPS 202]
| A2836  | SHA3-384  | SHA3-384  | SHA3-384  | Hash Function  |     |
| ------ | --------- | --------- | --------- | -------------- | --- |
[FIPS 202]
| A2836  | SHA3-512  | SHA3-512  | SHA3-512  | Hash Function  |     |
| ------ | --------- | --------- | --------- | -------------- | --- |
[FIPS 202]
| A2836  | SHAKE-128            | SHAKE-128  | 128 bits  | Extensible Output  |     |
| ------ | -------------------- | ---------- | --------- | ------------------ | --- |
|        | [FIPS 202]           |            |           | Function           |     |
| A2836  | SHAKE-256            | SHAKE-256  | 256 bits  | Extensible Output  |     |
|        | [FIPS 202]           |            |           | Function           |     |
| A2836  | TDES-CBC             | TDES-CBC   | 192 bits  | Decryption4        |     |
|        | [NIST SP 800-67-r2]  |            |           |                    |     |
| A2836  | TDES-ECB             | TDES-ECB   | 192 bits  | Decryption4        |     |
|        | [NIST SP 800-67-r2]  |            |           |                    |     |
A2836  TLS v1.2 KDF RFC7627  TLS v1.2 KDF  Hash Algorithm:  Key Derivation –
|        | (CVL)                 |           | SHA2-256, SHA2- | Application Specific  |     |
| ------ | --------------------- | --------- | --------------- | --------------------- | --- |
|        | [NIST SP 800-135-r1]  |           | 384, SHA2-512   |                       |     |
| A2890  | SHA3-256              | SHA3-256  | N/A             | Vetted conditioner    |     |
[FIPS 202]
AES-KW  AES-KW (KTS)  SP 800-38F. KTS (key  128, 192, and 256- Key Transport
| A2836  | [NIST SP 800-38F]  | wrapping and             | bit keys providing  |     |     |
| ------ | ------------------ | ------------------------ | ------------------- | --- | --- |
|        |                    | unwrapping) per IG D.G.  | 128, 192, or 256    |     |     |
bits of encryption
strength
AES-KWP  AES-KWP (KTS)  SP 800-38F. KTS (key  128, 192, and 256- Key Transport
| A2836  | [NIST SP 800-38F]  | wrapping and             | bit keys providing  |     |     |
| ------ | ------------------ | ------------------------ | ------------------- | --- | --- |
|        |                    | unwrapping) per IG D.G.  | 128, 192, or 256    |     |     |
bits of encryption
strength
KTS-IFC  KTS-IFC (KTS)  SP 800-56Brev2. KTS-IFC  2048, 3072, and  Key Transport
| A2836  | [NIST SP 800-56B-r2]  | (key encapsulation and    | 4096-bit modulus     |     |     |
| ------ | --------------------- | ------------------------- | -------------------- | --- | --- |
|        |                       | un-encapsulation) per IG  | providing 112, 128,  |     |     |
|        |                       | D.G.                      | or 152 bits of       |     |     |
encryption
strength

4 Legacy usage only. These legacy algorithms can only be used on data that was generated prior to the Legacy
Date specified in FIPS 140-3 IG C.M
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 8 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- |

| N/A  ENT (NP)  | N/A  | N/A  | JitterEntropy  |     |
| -------------- | ---- | ---- | -------------- | --- |
[NIST SP 800-90B]
 Cryptographic Key
| Vendor  CKG  | Sections 5.1, 5.2 and 6.1  |     | Key Generation for  |     |
| ------------ | -------------------------- | --- | ------------------- | --- |
Affirmed  [NIST SP 800-133r2]  Generation; SP  symmetric and
|     |     | 800-133 and IG D.H  | asymmetric keys using  |     |
| --- | --- | ------------------- | ---------------------- | --- |
|     |     | (symmetric keys     | unmodified output      |     |
|     |     | and asymmetric      | from the DRBG.         |     |
seeds).
Table 4 – Approved Algorithms
The module does not implement Non-Approved Algorithms Allowed in the Approved Mode
of Operation or Non-Approved Algorithms Allowed in the approved Mode of Operation with
No Security Claimed.
The Table 5 below lists the Non-approved Algorithms Not Allowed in the Approved Mode of
Operation implemented by the module. The module restricts these algorithms to only be
available as part of the non-approved mode.
| Algorithm  | Caveat  |     | Use / Function  |     |
| ---------- | ------- | --- | --------------- | --- |
AES-KEY WRAP  AES-128, AES-192, AES-256 key wrapping superseded  Key Wrapping
by the methods in SP 800-38F
Brainpool  All services applying Brainpool standard curves  Key Establishment
(P224r1, P256r1, P384r1, P512r1) are non-approved
ChaCha20-Poly1305  ChaCha20-Poly1305 is not a service in NIST  Symmetric encryption and
|     | specifications, thus not approved  |     | decryption  |     |
| --- | ---------------------------------- | --- | ----------- | --- |
DSA Key Pair  P=1024/N=160 is non-approved since security  Digital Signatures
| Generation  | strength provided is less than 112  |     |     |     |
| ----------- | ----------------------------------- | --- | --- | --- |
DSA Signature  P=1024/N=160 is non-approved since security  Digital Signatures
| Generation  | strength provided is less than 112  |     |     |     |
| ----------- | ----------------------------------- | --- | --- | --- |
ECC Diffie-Hellman  NIST P-192 curve is non-approved since security  Key Establishment
strength provided is less than 112
ECDSA Key Pair  NIST P-192 curve is non-approved since security  Digital Signatures/Key
Generation  strength provided is less than 112  Establishment

ECDSA Signature  NIST P-192 curve is non-approved since security  Digital Signatures
| Generation  | strength provided is less than 112  |     |     |     |
| ----------- | ----------------------------------- | --- | --- | --- |
HMAC  80-104 bit keys are non-approved since security  Message Authentication Code
strength provided is less than 112
KDF NIST SP 800-108  80-104 bit keys are non-approved since security  Key Derivation
strength provided is less than 112
KTS (KEM NIST SP 800- RSA-KEM-KWS-basic key wrapping scheme is non- Key Transport
| 56B)  | approved since not compliant with SP 800-56Brev2  |     |     |     |
| ----- | ------------------------------------------------- | --- | --- | --- |
KTS (OAEP NIST SP 800- 1024 and 1536 bit keys are non-approved for RSA- Key Transport
| 56B)  | OAEP scheme key wrapping  |     |     |     |
| ----- | ------------------------- | --- | --- | --- |
MD5  MD5 is non-approved except for the use in  Message Digest
conjunction with SHA-1 in the TLS 1.0 / 1.1 KDF
RSA Encryption (PKCS  Non-approved since not compliant with SP 800- Key Wrapping
| #1 v1.5)  | 56Brev2  |     |     |     |
| --------- | -------- | --- | --- | --- |
RSA Key Pair  1024 and 1536 bit keys are non-approved since  Digital Signatures
| Generation  | security strength provided is less than 112  |     |     |     |
| ----------- | -------------------------------------------- | --- | --- | --- |
RSA Private Key  Non-approved since not compliant with SP 800- Key Transport
| Primitives (NIST SP 800- | 56Brev2, including decryption primitives and  |     |     |     |
| ------------------------ | --------------------------------------------- | --- | --- | --- |
| 56B)                     | signature generation primitives               |     |     |     |
RSA Public Key  Non-approved since not compliant with SP 800- Key Transport
| Primitives (NIST SP 800- | 56Brev2, including encryption primitives and  |     |     |     |
| ------------------------ | --------------------------------------------- | --- | --- | --- |
| 56B)                     | signature verification primitives             |     |     |     |
RSA Signature  1024 and 1536 bit keys are non-approved since  Digital Signatures
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 9 of 36

SafeZone SW Cryptographic Module 2.0
Generation security strength provided is less than 112
RSA Signature 1536 bit key is non-approved; legacy support for FIPS Digital Signatures
Validation 186-2
TLS1.0/1.1 KDF NIST SP Deprecated in favor of RFC7627 extended master Key Derivation
800-135rev1 secret computation
Triple-DES Encryption Deprecated by the end of 2023 Symmetric encryption
X25519 Key Agreement X25519 key agreement services are non-approved Key Establishment
since not included in SP 800-56Arev3
Table 5 -Non-Approved Algorithms Not Allowed in the Approved Mode of Operation
The Finite State Model (FSM) of the module is provided in a separate document SafeZone-
FIPS-Lib-2.0-FSM distributed with this security policy.
The cryptographic boundary of the module is defined in the Figure 1 below.
Control Output
Figure 1 - Cryptographic Boundary
2.1 Approved Mode of Operation
By default, the module is in Approved mode once initialized and does not require any special
initialization. The module will remain in approved mode of operation and the operator must
avoid using any non-approved services. Any use of non-approved services (as determined by
the indicator) will move module into the non-approved mode of operation. Any keys
generated using non-approved mode or services must not be used in the approved mode of
operation. The module needs to be re-initialized in order to move back into the approved
mode of operation.
3 Cryptographic module interfaces
As a software-only module, SafeZone FIPS SW Cryptographic Module provides a C-
programming language API for invocation of the FIPS 140-3 approved cryptographic
functions.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
10 of 36

SafeZone SW Cryptographic Module 2.0
The functions shall be called by the application which assumes the operator role during
application execution. The API with input parameters, output parameters, and function return
values, defines the four FIPS 140-3 logical interfaces: data input, data output, control input
and status output.
Physical port Logical Interface API
N/A - API Data Input The data read from memory area(s) provided to the invoked
function via parameters that point to the memory area(s).
N/A - API Control Input The API function invoked and function parameters designated as
control inputs.
N/A - API Data Output The data written to memory area(s) provided to the invoked
function via parameters that point to the memory area(s).
N/A - API Status Output The return value/data of the invoked API function.
Table 6. Ports and Interfaces
4 Roles, services, and authentication
The SafeZone FIPS SW Cryptographic Module supports the Crypto Officer (CO) and User
(U) roles. The operator of the module will assume one of these two roles. Only one role may
be active at a time. The Crypto Officer role is assumed implicitly upon module installation,
uninstallation, initialization, zeroization, and power-up self-testing. If initialization and self-
testing are successful, a transition to the User role is allowed and the User will be able to use
all keys and cryptographic operations provided by the module, and to create any CSPs
(except Trusted Root Key CSPs which may only be created in the Crypto Officer role).
The four unique run-time services given only to the Crypto Officer role are the ability to
initialize the module, to set-up key material for Trusted Root Key CSP(s), to modify the
entropy source, and to switch to the User role to perform any activities allowed for the User
role. The SafeZone FIPS SW Cryptographic Module does not support concurrent operators.
The module does not authenticate the User or the Crypto Officer role.
The roles, services, and the API are described in the table below.
Role Service Input Output
CO, U Get module information FLS_StaticConfig() Build
FL_IntactID() configuration,
identifiers
CO, U Get/set information on current module FLS_RuntimeConfigSetProperty, FLR_OK (0), error
configuration FLS_RuntimeConfigGetProperty or current runtime
Runrime configuration value
value
CO, U Get crypto module status FLS_LibStatus() Module status
CO, U Get crypto module version FLS_LibVersion() Module version
CO, U Get crypto module description FLS_LibDescription() Module
description
CO, U Get status of the asset store FLS_AssetStoreStatus() Asset store
memory status
CO, U Perform module self-tests FLS_LibSelfTest() FLR_OK (0) or
error
CO Initialize the module FLS_LibInit() FLR_OK (0) or
error
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
11 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |
| ------------------------------------- | --- | --- | --- |

| CO, U  Reset module state  | FLS_LibUnInit()  | FLR_OK (0) or  |     |
| -------------------------- | ---------------- | -------------- | --- |

error
| CO  Enter User role  | FLS_LibEnterUserRole()  | FLR_OK (0) or  |     |
| -------------------- | ----------------------- | -------------- | --- |
  error
| CO, U  Erase data from memory  | FLS_Erase()  | FLR_OK (0) or  |     |
| ------------------------------ | ------------ | -------------- | --- |
  Memory area to be erased
error
| CO, U  Erase asset          | FLS_EraseAsset()    | FLR_OK (0) or  |     |
| --------------------------- | ------------------- | -------------- | --- |
|                             | Asset to be erased  | error          |     |
| CO  Install entropy source  | FL_RbgInstall       | FLR_OK (0) or  |     |
  EntropySource() FLS_RbgRequest
error
SecurityStrength()
Entropy source
CO  Create trusted root key  FLS_RootKeyAllocateAndLoadValue FLR_OK (0) or
|     | ()  | error  |     |
| --- | --- | ------ | --- |
Key material
CO, U  Create key asset  FLS_AssetAllocateBasic()  FLR_OK (0) or
|     | FLS_AssetAllocate()  | error, Created  |     |
| --- | -------------------- | --------------- | --- |
FLS_AssetAllocateAnd
asset
AssociateKeyExtra()
FLS_AssetLoadValue()
FLS_AssetLoadMultipart()
FLS_AssetLoadMultipart
ConvertBigInt()
FLS_AssetPoke()
FL_LocalAllocate()
FL_LocalAllocateEx()
Key policy, key value
| CO, U  Copy key asset    | FLS_AssetCopyValue()  | FLR_OK (0) or        |     |
| ------------------------ | --------------------- | -------------------- | --- |
|                          | Source asset          | error, Target asset  |     |
| CO, U  Delete key asset  | FLS_AssetFree()       | FLR_OK (0) or        |     |
  FLS_LocalFree()
error
Asset to be deleted
FLS_AssetShow()
| CO, U  Examine key asset policy, size  |                       | FLR_OK (0) or       |     |
| -------------------------------------- | --------------------- | ------------------- | --- |
|                                        | FLS_AssetCheck()      | error,  Key policy  |     |
|                                        | Asset to be examined  | key size            |     |
FLS_AssetPeek()
| CO, U  Get key asset value  |     | FLR_OK (0) or  |     |
| --------------------------- | --- | -------------- | --- |

|                      | Asset to peek          | error, Key value  |     |
| -------------------- | ---------------------- | ----------------- | --- |
| CO, U  Generate key  | FLS_AssetLoadRandom()  |                   |     |

CO, U  Encryption and decryption  FLS_CipherInit()  FLR_OK (0) or
|     | FLS_CipherContinue()  | error, Plaintext /  |     |
| --- | --------------------- | ------------------- | --- |
|     | FLS_CipherFinish()    | ciphertext          |     |
Key asset, crypto parameters,
plaintext/ciphertext
FLS_CryptAuthInit()
| CO, U  Authenticated encryption and  |     | FLR_OK (0) or  |     |
| ------------------------------------ | --- | -------------- | --- |
FLS_CryptGcmAadContinue()
decryption  error, Plaintext /
FLS_CryptGcmAadFinish()
  ciphertext
FLS_CryptAuthContinue()
FLS_EncryptAuthFinish()
FLS_EncryptAuth
PacketFinish()
FLS_DecryptAuthFinish()
FLS_EncryptAuth
InitRandom()
FLS_EncryptAuthInitDeterministi
c()
FLS_CryptAuthInitTls13()
FLS_EncryptAuthTls13()
FLS_EncryptAuthFinishTls13()
FLS_DecryptAuthTls13()
FLS_DecryptAuthFinishTls13()
FLS_EncryptAuthSrtp()
FLS_DecryptAuthSrtp()
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 12 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |
| ------------------------------------- | --- | --- | --- |

FLS_EncryptAuthSrtcp()
FLS_DecryptAuthSrtcp()
Key asset, crypto parameters, additional
authenticated data, plaintext/ciphertext
| CO, U  MAC generation  | FLS_MacGenerateInit()      | FLR_OK (0) or  |     |
| ---------------------- | -------------------------- | -------------- | --- |
|                        | FLS_MacGenerateContinue()  | error, MAC     |     |
FLS_MacGenerateFinish()
Key asset, crypto parameters, input data
| CO, U  MAC verification  | FLS_MacVerifyInit()  | FLR_OK (0) or  |     |
| ------------------------ | -------------------- | -------------- | --- |
  FLS_MacVerifyContinue()
error, Verification
FLS_MacVerifyFinish()
status
Key asset, crypto parameters, input data
CO, U  Random number generation  FLS_RbgGenerateRandom()  FLR_OK (0) or
|     | Random data generation parameters  | error, Random  |     |
| --- | ---------------------------------- | -------------- | --- |
data
FLS_RbgReseed()
| CO, U  Random number generator reseeding  |                                   | FLR_OK (0) or       |     |
| ----------------------------------------- | --------------------------------- | ------------------- | --- |
|                                           | Seed                              | error,              |     |
| CO, U  Key derivation                     | FLS_KeyDeriveKdk()                | FLR_OK (0) or       |     |
|                                           | Key asset, derivation parameters  | error, Derived key  |     |
FLS_DeriveTlsPrf()
| CO, U  TLS v1.2 key derivation  |     | FLR_OK (0) or  |     |
| ------------------------------- | --- | -------------- | --- |
FLS_KeyDeriveKdk()
error, Derived key
Key asset, derivation parameters
CO, U  Key Derivation Through Extraction- FLS_HkdfExtract()  FLR_OK (0) or
| then-expansion   | FLS_HkdfExpandAsset()  | error, Derived key  |     |
| ---------------- | ---------------------- | ------------------- | --- |
|                  | FLS_HkdfExpand()       |                     |     |
FLS_Hkdf()
FLS_KeyDeriveKdk()
Derivation parameters, input key material
CO, U  IKEv1 key derivation  FLS_IkePrfExtract()  FLR_OK (0) or
  FLS_IKEv1ExtractSKEYID_DSA()
error, Derived key
FLS_IKEv1ExtractSKEYID_PSK()
FLS_IKEv1ExtractSKEYID_PKE()
FLS_IKEv1DeriveKeyingMaterial()
Derivation parametes, input key material
CO, U  IKEv2 key derivation  FLS_IkePrfExtract()  FLR_OK (0) or
|     | FLS_IKEv2ExtractSKEYSEED()  | error, Derived key  |     |
| --- | --------------------------- | ------------------- | --- |
FLS_IKEv2DeriveDKM()
FLS_IKEv2ExtractSKEYSEEDrekey()
Derivation parametes, input key material
CO, U  SRTP key derivation  FLS_SrtpKeyDerive()  FLR_OK (0) or
  Key asset, derivation paramenters
error, Derived key
CO, U  AES key wrapping  FLS_AssetsWrapAes38F()  FLR_OK (0) or
|     | FLS_AssetsUnwrapAes38F()  | error, Derived key  |     |
| --- | ------------------------- | ------------------- | --- |
Key asset, derivation parameters
| CO, U  AES data wrapping  | FLS_CryptKw()                  | FLR_OK (0) or   |     |
| ------------------------- | ------------------------------ | --------------- | --- |
|                           | Key asset, data to be wrapped  | error, Wrapped  |     |
data
CO, U  Trusted root key derivation  FLS_TrustedKdkDerive()  FLR_OK (0) or
|     | FLS_TrustedKekdkDerive()  | error, Derived key  |     |
| --- | ------------------------- | ------------------- | --- |
Key asset, derivation parameters
CO, U  Trusted KDK key derivation  FLS_TrustedKeyDerive()  FLR_OK (0) or
  Key asset, derivation parameters
error, Derived key
FLS_AssetWrapTrusted()
| CO, U  Trusted key wrapping  |     | FLR_OK (0) or  |     |
| ---------------------------- | --- | -------------- | --- |
FLS_AssetUnwrapTrusted()
  error, Wrapped
|     | Key assets, wrapping parameters  | key  |     |
| --- | -------------------------------- | ---- | --- |
FLS_KeyDerivePbkdf2()
| CO, U  PBKDF2 key derivation  |     | FLR_OK (0) or  |     |
| ----------------------------- | --- | -------------- | --- |

|     | Password, key derivation parameters  | error, Derived key  |     |
| --- | ------------------------------------ | ------------------- | --- |
CO, U  DSA/Diffie-Hellman Domain  FLS_AssetCheck()  FLR_OK (0) or
| Parameter verification  | Key asset to be examined  | error  |     |
| ----------------------- | ------------------------- | ------ | --- |
CO, U  Asymmetric key pair generation  FLS_AssetGenerateKeyPair()  FLR_OK (0) or
FLS_DH_KeyGen()
error, Generated
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 13 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |
| ------------------------------------- | --- | --- | --- |

|     | Key generation parameters  | key  |     |
| --- | -------------------------- | ---- | --- |
FLS_HashSignFips186()
| CO, U  Signature generation  |     | FLR_OK (0) or  |     |
| ---------------------------- | --- | -------------- | --- |
FLS_HashSignPkcs1()
  error, Signature
FLS_HashSignPkcs1Pss()
Key asset, hash value
CO, U  Signature verification  FLS_HashVerifyFips186()  FLR_OK (0) or
|     | FLS_HashVerifyRecoverPkcs1()  | error, verification  |     |
| --- | ----------------------------- | -------------------- | --- |
FLS_HashVerifyPkcs1()
result
FLS_HashVerifyPkcs1Pss()
Key asset, signature
FLS_AssetsWrapRsaOaep()
| CO, U  RSA-OAEP key wrapping  |     | FLR_OK (0) or  |     |
| ----------------------------- | --- | -------------- | --- |
  FLS_AssetsUnwrapRsaOaep()
error, Wrapped
|     | Key asset, input data / wrapped key  | key / unwrapped  |     |
| --- | ------------------------------------ | ---------------- | --- |
key asset
FLS_DeriveDh()
| CO, U  Diffie-Hellman key agreement  |     | FLR_OK (0) or  |     |
| ------------------------------------ | --- | -------------- | --- |
  FLS_DH_Derive()
error, Derived key
Private and public values
CO, U  Elliptic Curve Diffie-Hellman key  FLS_DeriveDh()  FLR_OK (0) or
| agreement                  | Private and public values  | error, Derived key  |     |
| -------------------------- | -------------------------- | ------------------- | --- |
| CO, U  Digest computation  | FLS_HashInit()             | FLR_OK (0) or       |     |
  FLS_HashContinue()
error, Hash value
FLS_HashFinish()
FLS_HashSingle()
Input data / message
FLS_HashSingle()
| CO, U  Extensible Output Function  |                       | FLR_OK (0) or     |     |
| ---------------------------------- | --------------------- | ----------------- | --- |
|                                    | Input data / message  | error, extended   |     |
value
FLS_LoadFinishedHash
| CO, U  Load precomputed digest  |     | FLR_OK (0) or  |     |
| ------------------------------- | --- | -------------- | --- |
  StateAlgo()
error, Target asset
Digest parameters
CO, U  Digest computation (non-approved)  FLS_HashInit()  FLR_OK (0) or
|     | FLS_HashContinue()  | error, Hash value  |     |
| --- | ------------------- | ------------------ | --- |
FLS_HashFinish()
FLS_HashSingle()
Input data / message
CO, U  Asymmetric key pair generation (non- FLS_AssetGenerateKeyPair()  FLR_OK (0) or
| approved)  | FLS_DH_KeyGen()  | error, Generated  |     |
| ---------- | ---------------- | ----------------- | --- |
Key generation parameters
key
CO, U  Signature generation (non-approved)  FLS_HashSignFips186()  FLR_OK (0) or
|     | FLS_HashSignPkcs1()  | error, Signature  |     |
| --- | -------------------- | ----------------- | --- |
FLS_HashSignPkcs1Pss()
Key asset, hash value
CO, U  Signature verification (non-approved)  FLS_HashVerifyFips186()  FLR_OK (0) or
|     | FLS_HashVerifyRecoverPkcs1()  | error, verification  |     |
| --- | ----------------------------- | -------------------- | --- |
FLS_HashVerifyPkcs1()
result
FLS_HashVerifyPkcs1Pss()
Key asset, signature
CO, U  Elliptic Curve Diffie-Hellman key  FLS_DeriveDh()  FLR_OK (0) or
Private and public values
agreement (non-approved)  error, Derived key
CO, U  MAC generation (non-approved)  FLS_MacGenerateInit()  FLR_OK (0) or
|     | FLS_MacGenerateContinue()  | error, MAC  |     |
| --- | -------------------------- | ----------- | --- |
FLS_MacGenerateFinish()
Key asset, crypto parameters,
input data
CO, U  MAC verification (non-approved)  FLS_MacVerifyInit()  FLR_OK (0) or
|     | FLS_MacVerifyContinue()  | error, Verification  |     |
| --- | ------------------------ | -------------------- | --- |
FLS_MacVerifyFinish()
status
Key asset, crypto parameters,
input data
FLS_AssetsWrapRsaKem()
| CO, U  RSA-KEM key wrapping (non- |     | FLR_OK (0) or  |     |
| --------------------------------- | --- | -------------- | --- |
FLS_AssetsUnwrapRsaKem()
approved)  error, Wrapped
Key asset, input data / wrapped
key / unwrapped
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 14 of 36

SafeZone SW Cryptographic Module 2.0
key key asset
CO, U RSA-OAEP key wrapping (non- FLS_AssetsWrapRsaOaep() FLR_OK (0) or
approved) FLS_AssetsUnwrapRsaOaep() error, Wrapped
Key asset, input data / wrapped
key / unwrapped
key
key asset
CO, U KDK key derivation (non-approved) FLS_KeyDeriveKdk() FLR_OK (0) or
Key asset, derivation error, Derived key
parameters
CO, U Trusted key wrapping (non-approved) FLS_AssetWrapTrusted() FLR_OK (0) or
FLS_AssetUnwrapTrusted() error, Wrapped
Key assets, wrapping parameters
key
CO, U RSA-PKCS#1 v1.5 key wrapping (non- FLS_AssetsWrapPkcs1v15() FLR_OK (0) or
approved) FLS_AssetsUnwrapPkcs1v15() error, Wrapped
Key asset, input data /wrapped
key / unwrapped
key
key asset
CO, U AES key wrapping (non-approved) FLS_AssetsWrapAes38F() FLR_OK (0) or
FLS_AssetsUnwrapAes38F() error, Derived key
Key asset, derivation
parameters
CO, U Encryption and decryption (non- FLS_CipherInit() FLR_OK (0) or
approved) FLS_CipherContinue() error, Plaintext /
FLS_CipherFinish()
ciphertext
Key asset, crypto parameters,
plaintext/ciphertext
CO, U X25519 (non-approved) FLS_X25519_KeyGen() FLR_OK (0) or
FLS_X25519_Derive() error, Derived key
Private and public values
CO, U TLS v1.0/1.1 key derivation (non- FLS_DeriveTlsPrf() FLR_OK (0) or
approved) FLS_KeyDeriveKdk() error, Derived key
Key asset, derivation
parameters
CO, U RSA signature generation primitive FLS_Pkcs1RSASP1() FLR_OK (0) or
(non-approved) Key asset, data to be signed error, Signature
CO, U RSA signature verification primitive FLS_Pkcs1RSAVP1() FLR_OK (0) or
(non-approved) Key asset, signature error, verification
result
CO, U RSA encryption primitive (non- FLS_Pkcs1RSAEP() FLR_OK (0) or
approved) Key asset, plaintext error, Ciphertext
CO, U RSA decryption primitive (non- FLS_Pkcs1RSADP() FLR_OK (0) or
approved) Key asset, ciphertext error, Plaintext
Table 7. Roles, Service Commands, Input and Output
The approved services are described in the table below.
The indicator column maybe None or ARG. None is used for non-security functions, and
they do not utilize the approved indicator. For services utilizing security functions the
indicator is specified as ARG. In this case the user of the service or function passes a pointer
as argument and the indicator value is returned to that pointer. A value of 0 means that the
service is approved and any non-zero value means it is a non-approved service.
G = Generate: The module generates or derives the SSP.
R = Read: The SSP is read from the module (e.g. the SSP is output).
W = Write: The SSP is updated, imported, or written to the module.
E = Execute: The module uses the SSP in performing a cryptographic operation.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
15 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- | --- |

Z = Zeroize: The module zeroizes the SSP. The previous value is overwritten by zeroes and is
no longer accessible.
ARG = Approved indicator

Access
Service  Description  Approved Security Functions  Keys  Rol Indic
rights
|     |     |     |     | and/or  | es  | ator  |
| --- | --- | --- | --- | ------- | --- | ----- |
to Keys
SSPs
and /
or SSPs
| Get module   | Return basic        | N/A  |     | None  | CO,  -  | None  |
| ------------ | ------------------- | ---- | --- | ----- | ------- | ----- |
| information  | information of the  |      |     |       | U       |       |
module
| Get/set         | Return current  | N/A  |     | None  | CO,-     | None  |
| --------------- | --------------- | ---- | --- | ----- | -------- | ----- |
| information on  | module          |      |     |       | U        |       |
| current module  | configuration   |      |     |       |          |       |
configuration
| Get crypto      | Return state of the  | N/A  |     | None  | CO,  -  | None  |
| --------------- | -------------------- | ---- | --- | ----- | ------- | ----- |
| module status   | module               |      |     |       | U       |       |
| Get crypto      | Returns version of   | N/A  |     | None  | CO,  -  | None  |
| module version  | the module           |      |     |       | U       |       |
| Get crypto      | Returns description  | N/A  |     | None  | CO,  -  | None  |
| module          | of the module        |      |     |       | U       |       |
description
| Get status of    | Returns the status  | N/A  |     | None  | CO,  -  | None  |
| ---------------- | ------------------- | ---- | --- | ----- | ------- | ----- |
| the asset store  | of the asset store  |      |     |       | U       |       |
| Perform          | Execute self-tests  | N/A  |     | None  | CO,  -  | None  |
| module self-     |                     |      |     |       | U       |       |
tests
| Initialize the  | Initializes the     | N/A  |     | None  | CO  -   | None  |
| --------------- | ------------------- | ---- | --- | ----- | ------- | ----- |
| module          | module              |      |     |       |         |       |
| Reset module    | Reset, zeroize and  | N/A  |     | None  | CO,  -  | None  |
| state           | finalizes the       |      |     |       | U       |       |
module
| Enter User role  | Enter regular user  | N/A  |     | None  | CO  -  | None  |
| ---------------- | ------------------- | ---- | --- | ----- | ------ | ----- |
mode
| Erase data from  | Erase data   | N/A  |     | Any  | CO,  Z  | None  |
| ---------------- | ------------ | ---- | --- | ---- | ------- | ----- |
| memory           |              |      |     |      | U       |       |
| Erase asset      | Erase asset  | N/A  |     | Any  | CO,  Z  | None  |
U
| Install entropy  | Install entropy    | N/A  |     | None  | CO  -  | None  |
| ---------------- | ------------------ | ---- | --- | ----- | ------ | ----- |
| source           | source to be used  |      |     |       |        |       |
Create trusted  Allocate and set   KDF SP800-108  Trusted  CO  G  ARG
| root key  | data for new root  |     |     | Root Key  |     |     |
| --------- | ------------------ | --- | --- | --------- | --- | --- |
key asset
Create key asset  Setup key policy,   N/A  Any keys  CO,  G, W  ARG
|     | allocate memory  |     |     |     | U   |     |
| --- | ---------------- | --- | --- | --- | --- | --- |
for key, and load
key value
Copy key asset  Copies key value  N/A  Any keys  CO,  R, W  ARG
|     |     |     |     |     | U   |     |
| --- | --- | --- | --- | --- | --- | --- |
Delete key asset  Deletes a key and  N/A  Any keys  CO,  Z  ARG
|                | zeroes the data   |      |     |           | U       |      |
| -------------- | ----------------- | ---- | --- | --------- | ------- | ---- |
| Examine key    | Get key size and  | N/A  |     | Any keys  | CO,  R  | ARG  |
| asset policy,  | check             |      |     |           | U       |      |
size
| Get key asset  | Get key value  | N/A  |     | Any keys  | CO,  R  | ARG  |
| -------------- | -------------- | ---- | --- | --------- | ------- | ---- |
| value          |                |      |     |           | U       |      |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 16 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- | --- |

Generate key  Generate random  CKG (Section 6.1)  AES keys  CO,  G, W  ARG
|     | key  |                             |     |             | U          |      |
| --- | ---- | --------------------------- | --- | ----------- | ---------- | ---- |
|     |      | TDES-CBC CKG (Section 6.1)  |     | Triple-DES  | CO,  G, W  | ARG  |
|     |      |                             |     | keys        | U          |      |
|     |      | CKG (Section 6.1)           |     | Key         | CO,  G, W  | ARG  |
|     |      |                             |     | Derivation  | U          |      |
keys
|     |     | CKG (Section 6.1)  |     | MAC keys  | CO,  G, W  | ARG  |
| --- | --- | ------------------ | --- | --------- | ---------- | ---- |
|     |     |                    |     |           | U          |      |
Encryption and  Service for data  AES-ECB, AES-CBC, AES-CTR, AES- AES keys  CO,  E  ARG
| decryption  | encryption and  | OFB, AES-XTS  |     |     | U   |     |
| ----------- | --------------- | ------------- | --- | --- | --- | --- |
decryption  TDES-CBC, Triple-DES ECB  Triple-DES  CO,  E  ARG
|     |     |     |     | keys  | U   |     |
| --- | --- | --- | --- | ----- | --- | --- |
Authenticated  Service for data  AES-CCM, AES-GCM  AES keys  CO,  E  ARG
| encryption and  | encryption and   |     |     |     | U    |     |
| --------------- | ---------------- | --- | --- | --- | ---- | --- |
| decryption      | decryption with  |     |     |     |      |     |
added
authentication
MAC generation  Service for MAC  AES-CMAC, AES-GMAC  AES keys  CO,  E  ARG
|     | generation  |                             |     |           | U       |      |
| --- | ----------- | --------------------------- | --- | --------- | ------- | ---- |
|     |             | HMAC-SHA-1, HMAC-SHA2-224,  |     | MAC keys  | CO,  E  | ARG  |
|     |             | HMAC-SHA2-256, HMAC-SHA2-   |     |           | U       |      |
384, HMAC-SHA2-512
MAC  Service for MAC  AES-CMAC, AES-GMAC  AES keys  CO,  E  ARG
| verification  | verification  |                             |     |           | U       |      |
| ------------- | ------------- | --------------------------- | --- | --------- | ------- | ---- |
|               |               | HMAC-SHA-1, HMAC-SHA2-224,  |     | MAC keys  | CO,  E  | ARG  |
|               |               | HMAC-SHA2-256, HMAC-SHA2-   |     |           | U       |      |
|               |               | 384, HMAC-SHA2-512          |     |           |         |      |
Random  Generate random  Counter DRBG  DRBG CTR- CO,  R  None
| number      | numbers by DRBG  |     |     | 256       | U   |     |
| ----------- | ---------------- | --- | --- | --------- | --- | --- |
| generation  |                  |     |     | entropy,  |     |     |
DRBG CTR-
256 seed,
DRBG CTR-
256 state:
Key,
DRBG CTR-
256 state: V
Random  Force reseeding of  Counter DRBG  DRBG CTR- CO,  W  None
| number     | random number  |     |     | 256        | U   |     |
| ---------- | -------------- | --- | --- | ---------- | --- | --- |
| generator  | generator      |     |     | entropy,   |     |     |
| reseeding  |                |     |     | DRBG CTR-  |     |     |
256 seed,
DRBG CTR-
256 state:
Key,
DRBG CTR-
256 state: V
Key derivation  Key derivation  KDF SP800-108  Key  CO,  W  ARG
|     |     |     |     | Derivation  | U   |     |
| --- | --- | --- | --- | ----------- | --- | --- |
keys,
KDF
Derived
Keys
TLS v1.2 key  Key derivation   TLS v1.2 KDF RFC7627  Key  CO,  W  ARG
| derivation  |     |     |     | Derivation  | U   |     |
| ----------- | --- | --- | --- | ----------- | --- | --- |
keys,
KDF
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 17 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- | --- |

Derived
Keys
Key Derivation  HKDF key   KDA HKDF, KDA TwoStep  Key  CO,  W  ARG
| Through          | derivation or key    |     |     | Derivation  | U   |     |
| ---------------- | -------------------- | --- | --- | ----------- | --- | --- |
| Extraction-then- | derivation with two  |     |     | keys,       |     |     |
| expansion        | steps                |     |     | KDF         |     |     |
Derived
Keys
| IKEv1 key   | Key derivation for  |  KDF IKEv1  |     | Key         | CO,  W  | ARG  |
| ----------- | ------------------- | ----------- | --- | ----------- | ------- | ---- |
| derivation  | IKEv1               |             |     | Derivation  | U       |      |
keys,
KDF
Derived
Keys
| IKEv2 key   | Key derivation for  |  KDF IKEv2  |     | Key         | CO,  W  | ARG  |
| ----------- | ------------------- | ----------- | --- | ----------- | ------- | ---- |
| derivation  | IKEv2               |             |     | Derivation  | U       |      |
keys,
KDF
Derived
Keys
| SRTP key    | Key derivation for  |  KDF SRTP  |     | Key         | CO,  W  | ARG  |
| ----------- | ------------------- | ---------- | --- | ----------- | ------- | ---- |
| derivation  | SRTP                |            |     | Derivation  | U       |      |
keys,
KDF
Derived
Keys
AES key  Wrap AES key 38F  AES-KW (KTS), AES-KWP (KTS)  AES keys  CO,  E  ARG
| wrapping  |     |     |     |     | U   |     |
| --------- | --- | --- | --- | --- | --- | --- |
AES data  Wrap AES data 38F  AES-KW, AES-KWP  AES keys  CO,  E  ARG
| wrapping  |     |     |     |     | U   |     |
| --------- | --- | --- | --- | --- | --- | --- |
Trusted root  Derive root key  KDF SP800-108  Trusted  CO,  W  ARG
| key derivation  |     |     |     | Root Key,  | U   |     |
| --------------- | --- | --- | --- | ---------- | --- | --- |
KDF
Derived
Keys
Trusted KDK key  KDK key derivation    KDF SP800-108  Key  CO,  R, E  ARG
| derivation  |     |     |     | Derivation  | U   |     |
| ----------- | --- | --- | --- | ----------- | --- | --- |
keys,
KDF
Derived
Keys
Trusted key  Wrap trusted key   KDF SP800-108 and AES-KW  Key  CO,  R, E  ARG
| wrapping  |     | (KTS)/AES-KWP (KTS)K  |     | Derivation  | U   |     |
| --------- | --- | --------------------- | --- | ----------- | --- | --- |
keys,
AES keys
| PBKDF2 key  | PBKDF2 key  | PBKDF  |     | KDF      | CO,  R, E  | ARG  |
| ----------- | ----------- | ------ | --- | -------- | ---------- | ---- |
| derivation  | derivation  |        |     | Derived  | U          |      |
Keys,
PBKDF
password
DSA/Diffie- DSA/Diffie-Hellman  DSA PQGVer  DSA keys  CO,  E  ARG
| Hellman  | Domain Parameter  |     |     |     | U   |     |
| -------- | ----------------- | --- | --- | --- | --- | --- |
| Domain   | verification      |     |     |     |     |     |
Parameter
verification
| Asymmetric key   | Generate            | RSA KeyGen              |     | RSA keys  | CO,  E  | ARG  |
| ---------------- | ------------------- | ----------------------- | --- | --------- | ------- | ---- |
| pair generation  | asymmetric key      |                         |     |           | U       |      |
|                  | pairs and           | DSA KeyGen, DSA PQGGen  |     | DSA keys  | CO,  E  | ARG  |
|                  | DSA/Diffie-Hellman  |                         |     |           | U       |      |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 18 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- | --- |

|     | Domain Parameter  | ECDSA KeyGen  |     | ECDSA keys  | CO,  E  | ARG  |
| --- | ----------------- | ------------- | --- | ----------- | ------- | ---- |
U
|     |     | KTS-IFC  |     | RSA keys  | CO,  E  | ARG  |
| --- | --- | -------- | --- | --------- | ------- | ---- |
U
|     |     | KAS-FFC-SSC  |     | DH keys  | CO,  E  | ARG  |
| --- | --- | ------------ | --- | -------- | ------- | ---- |
U
|     |     | KAS-ECC-SSC  |     | ECDH keys  | CO,  E  | ARG  |
| --- | --- | ------------ | --- | ---------- | ------- | ---- |
U
Signature  Generate signature  RSA SigGen  RSA keys  CO,  E  ARG
| generation  |     |             |     |           | U       |      |
| ----------- | --- | ----------- | --- | --------- | ------- | ---- |
|             |     | DSA SigGen  |     | DSA keys  | CO,  E  | ARG  |
U
|     |     | ECDSA SigGen  |     | ECDSA keys  | CO,  E  | ARG  |
| --- | --- | ------------- | --- | ----------- | ------- | ---- |
U
Signature  Verify signature  RSA SigVer  RSA keys  CO,  E  ARG
| verification  |     |             |     |           | U       |      |
| ------------- | --- | ----------- | --- | --------- | ------- | ---- |
|               |     | DSA SigVer  |     | DSA keys  | CO,  E  | ARG  |
U
|     |     | ECDSA SigVer  |     | ECDSA  | CO,  E  | ARG  |
| --- | --- | ------------- | --- | ------ | ------- | ---- |
|     |     |               |     | keys,  | U       |      |
Software
Integrity
Public Key
RSA-OAEP key  RSA-OAEP key  KTS-IFC (KTS)  RSA keys  CO,  E  ARG
| wrapping  | wrap  |     |     |     | U   |     |
| --------- | ----- | --- | --- | --- | --- | --- |
Diffie-Hellman  DH key agreement  KAS-FFC-SSC  DH keys,  CO,  E  ARG
| key agreement  |     |     |     | DH Shared  | U   |     |
| -------------- | --- | --- | --- | ---------- | --- | --- |
secrets
Elliptic Curve  Elliptic Curve DH  KAS-ECC-SSC  ECDH keys,  CO,  E  ARG
| Diffie-Hellman  | agreement  |     |     | ECDH    | U   |     |
| --------------- | ---------- | --- | --- | ------- | --- | --- |
| key agreement   |            |     |     | Shared  |     |     |
secrets
Digest  Compute a digest  SHA-1, SHA2-224, SHA2-256, SHA2- None  CO,  -  ARG
| computation  |     | 384, SHA2-512, SHA3-224, SHA3- |     |     | U   |     |
| ------------ | --- | ------------------------------ | --- | --- | --- | --- |
256, SHA3-384, SHA3-512
Extensible  Compute an  SHAKE-128, SHAKE-256  None  CO,  -  ARG
| Output  | extended output  |     |     |     | U   |     |
| ------- | ---------------- | --- | --- | --- | --- | --- |
Function
Load  Load a  SHA-1, SHA2-224, SHA2-256, SHA2- None  CO,  -  ARG
| precomputed  | precomputed  | 384, SHA2-512, SHA3-224, SHA3- |     |     | U   |     |
| ------------ | ------------ | ------------------------------ | --- | --- | --- | --- |
| digest       | digest       | 256, SHA3-384, SHA3-512        |     |     |     |     |
Table 8. Approved Services
| Service  | Description  | Algorithms  |     | Roles  Indicator  |     |     |
| -------- | ------------ | ----------- | --- | ----------------- | --- | --- |
Accessed
| Digest  | Compute a digest with MD5  | MD5  |     | CO, U  ARG  |     |     |
| ------- | -------------------------- | ---- | --- | ----------- | --- | --- |
computation
| Asymmetric  | Generate keys with unapproved      | RSA Key Pair     |     | CO, U  ARG  |     |     |
| ----------- | ---------------------------------- | ---------------- | --- | ----------- | --- | --- |
| key         | parameters (e.g., key lengths and  | Generation, DSA  |     |             |     |     |
| generation  | curves)                            | Key Pair         |     |             |     |     |
Generation,
ECDSA Key Pair
Generation,
Brainpool
| Signature   | Generate signatures with      | RSA Signature    |     | CO, U  ARG  |     |     |
| ----------- | ----------------------------- | ---------------- | --- | ----------- | --- | --- |
| generation  | unapproved parameters (e.g.,  | Generation, DSA  |     |             |     |     |
|             | key lengths and curves)       | Signature        |     |             |     |     |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 19 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- |

Generation,
ECDSA Signature
Generation,
Brainpool
| Signature     | Verify signature with unapproved  | RSA Signature  | CO, U  ARG  |     |
| ------------- | --------------------------------- | -------------- | ----------- | --- |
| verification  | key length                        | Validation     |             |     |
| Elliptic      | Elliptic Curve DH agreement with  | ECC Diffie-    | CO, U  ARG  |     |
| Curve Diffie- | unapproved curve                  | Hellman,       |             |     |
| Hellman key   |                                   | Brainpool      |             |     |
agreement
| MAC           | Service for MAC generation with    | HMAC           | CO, U  ARG  |     |
| ------------- | ---------------------------------- | -------------- | ----------- | --- |
| generation    | unapproved key lengths             |                |             |     |
| MAC           | Service for MAC verification with  | HMAC           | CO, U  ARG  |     |
| verification  | unapproved key lengths             |                |             |     |
| RSA-KEM       | RSA-KEM key wrap                   | KTS (KEM NIST  | CO, U  ARG  |     |
| key           |                                    | SP 800-56B)    |             |     |
wrapping
| RSA-OAEP  | RSA-OAEP key wrap  | KTS (OAEP NIST  | CO, U  ARG  |     |
| --------- | ------------------ | --------------- | ----------- | --- |
| key       |                    | SP 800-56B)     |             |     |
wrapping
| KDK key      | KDK key derivation   | KDF NIST SP     | CO, U  ARG  |     |
| ------------ | -------------------- | --------------- | ----------- | --- |
| derivation   |                      | 800-108         |             |     |
| Trusted key  | Wrap trusted key     | KDF NIST SP     | CO, U  ARG  |     |
| wrapping     |                      | 800-108         |             |     |
| RSA-PKCS#1   | RSA-PKCS#1 key wrap  | RSA Encryption  | CO, U  ARG  |     |
| v1.5 key     |                      | (PKCS #1 v1.5)  |             |     |
wrapping
| AES key     | AES key wrapping that does fulfill  | AES-KEY WRAP      | CO, U  ARG  |     |
| ----------- | ----------------------------------- | ----------------- | ----------- | --- |
| wrapping    | NIST SP 800-38F                     |                   |             |     |
| Encryption  | Service for data encryption and     | ChaCha20-         | CO, U  ARG  |     |
| and         | decryption                          | Poly1305, Triple- |             |     |
| decryption  |                                     | DES Encryption    |             |     |
| X25519      | X25519 Key agreement                | X25519 Key        | CO, U  ARG  |     |
Agreement
| TLS v1.0/1.1  | Key derivation, SP 800-135 rev 1  | TLS1.0/1.1 KDF  | CO, U  ARG  |     |
| ------------- | --------------------------------- | --------------- | ----------- | --- |
| key           |                                   | NIST SP 800-    |             |     |
| derivation    |                                   | 135rev1         |             |     |

| RSA         | Generate RSA primitive only  | RSA Private Key   | CO, U  ARG  |     |
| ----------- | ---------------------------- | ----------------- | ----------- | --- |
| signature   |                              | Primitives (NIST  |             |     |
| generation  |                              | SP 800-56B)       |             |     |
primitive
| RSA           | RSA verification primitive only  | RSA Public Key    | CO, U  ARG  |     |
| ------------- | -------------------------------- | ----------------- | ----------- | --- |
| signature     |                                  | Primitives (NIST  |             |     |
| verification  |                                  | SP 800-56B)       |             |     |
primitive
| RSA         | RSA encryption primitive only  | RSA Public Key    | CO, U  ARG  |     |
| ----------- | ------------------------------ | ----------------- | ----------- | --- |
| encryption  |                                | Primitives (NIST  |             |     |
| primitive   |                                | SP 800-56B)       |             |     |
| RSA         | RSA decryption primitive only  | RSA Private Key   | CO, U  ARG  |     |
| decryption  |                                | Primitives (NIST  |             |     |
| primitive   |                                | SP 800-56B)       |             |     |
Table 9. Non-approved Services

© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 20 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- | --- |

5  Software/Firmware security
The SafeZone FIPS SW Cryptographic Module must be linked with an application to become
executable. The software code of the module (libsafezone-sw-fips.so dynamically
loadable library) is linked with an end application producing an executable application for the
target platform. The application is installed in a platform-specific way, e.g., when purchased
from an application store for the platform. In some cases, there is no need for installation,
e.g., when a mobile equipment vendor includes the application with the equipment.
The SafeZone FIPS SW Cryptographic Module is loaded by loading an application that links
the library statically. The SafeZone FIPS SW Cryptographic Module is initialized
automatically upon loading. On some platforms the module is implemented as a dynamically
loadable module. In this case, the module is loaded as needed by the dynamic linker.
The integrity check of the cryptographic module is described in section 10.
The SafeZone FIPS SW Cryptographic Module does not support operator authentication and
thus does not require any authentication itself.
6  Operational environment
The operational environments are defined in Table 2 - Tested Operational Environments and
Table 3 - Vendor Affirmed Operational Environments.
The module runs in a modifiable operating environment and uses modern operating systems,
i.e., Linux. All processes spawned by the module are child processes of the module, and
ownership of a process cannot be changed.
7  Physical security
The cryptographic module is software-only and does not have any physical security
mechanisms.
8  Non-invasive security
The cryptographic module does not have non-invasive attack mitigation mechanisms.
9  Sensitive security parameters management
Key /  Streng Security  Generation  Import/E Establish Storage  Zeroisati Use and
| SSP  th  | function  |     | xport  | ment  | on  related  |     |
| -------- | --------- | --- | ------ | ----- | ------------ | --- |
| Name     | and Cert  |     |        |       | keys         |     |
/ Type
AES  128,  AES-ECB,  KDF SP800- Plaintext  N/A  Memory,  Asset  Symmetric
keys  192,  AES-CBC,  108, PBKDF,  imported    plaintext  deletion,  encryption/
| 256   | AES-CTR,   | KDF IKEv1,    | from   |     | module  decryption,  |     |
| ----- | ---------- | ------------- | ------ | --- | -------------------- | --- |
| bits  | AES-OFB,   | KDF IKEv2,    | TOEPP  |     | uninitializ          |     |
|       | AES-XTS,   | TLS v1.2 KDF  |        |     | ation                |     |
|       | AES-GCM,   | RFC7627,      |        |     |                      |     |
|       | AES-CCM,   | KDF SRTP,     |        |     |                      |     |
|       | AES-CMAC,  | KDA HKDF,     |        |     |                      |     |
|       | AES-GMAC,  | KDA           |        |     |                      |     |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 21 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- |

|     | AES-KW,  | TwoStep,     |     |     |     |
| --- | -------- | ------------ | --- | --- | --- |
|     | AES-KWP  | CKG (SP 800- |     |     |     |
|     | AES-KW   | 133r2 6.1)   |     |     |     |
(KTS), AES-
KWP (KTS)
(Cert. A2836)
Triple- 192  TDES-ECB  KDF SP800- Plaintext  N/A  Memory,  Asset  Symmetric
DES  bits  Decryption,  108, PBKDF,  imported    plaintext  deletion,  decryption
| keys  | TDES-CBC       | KDF IKEv1,    | from   | module      |     |
| ----- | -------------- | ------------- | ------ | ----------- | --- |
|       | Decryption     | KDF IKEv2,    | TOEPP  | uninitializ |     |
|       | (Cert. A2836)  | TLS v1.2 KDF  |        | ation       |     |
|       |                | RFC7627,      |        |             |     |
KDF SRTP,
KDA HKDF,
KDA
TwoStep,
CKG (SP 800-
133r2 6.1)

MAC  112- HMAC-SHA- KDF SP800- Plaintext  N/A  Memory,  Asset  Generating
keys  512  1, HMAC- 108, PBKDF,  imported    plaintext  deletion,  and
| bits  | SHA2-224,   | KDF IKEv1,    | from   | module  verifying   |     |
| ----- | ----------- | ------------- | ------ | ------------------- | --- |
|       | HMAC-SHA2-  | KDF IKEv2,    | TOEPP  | uninitializ HMAC    |     |
|       | 256, HMAC-  | TLS v1.2 KDF  |        | ation  authenticati |     |
|       | SHA2-384,   | RFC7627,      |        | on codes            |     |
|       | HMAC-SHA2-  | KDF SRTP,     |        |                     |     |
|       | 512 (Cert.  | KDA HKDF,     |        |                     |     |
|       | A2836)      | KDA           |        |                     |     |
|       |             | TwoStep,      |        |                     |     |
CKG (SP 800-
133r2 6.1)

RSA  1024,  RSA SigGen,  RSA KeyGen  Plaintext  N/A   Memory,  Asset  Digital
keys  2048,  RSA SigVer,  (FIPS 186-4),  imported  plaintext  deletion,  signature,
| 3072,  | RSA KeyGen,  | CKG (SP 800- | from  | module  Key  |     |
| ------ | ------------ | ------------ | ----- | ------------ | --- |
4096  KTS-IFC,  133r2 5.1,  TOEPP/Plai uninitializ Transport
| bits  | KTS-IFC (KTS)  | FIPS 186-4)  | ntext     | ation  |     |
| ----- | -------------- | ------------ | --------- | ------ | --- |
|       | (Cert. A2836)  |              | exported  |        |     |
|       |                |              | to RAM    |        |     |
DSA  (L,N) =   DSA SigGen,  DSA KeyGen  Plaintext  N/A   Memory,  Asset  Digital
keys  (2048,  DSA SigVer,  (FIPS 186-4),  imported  plaintext  deletion,  signature
| 224),   | DSA KeyGen     | CKG (SP 800- | from       | module      |     |
| ------- | -------------- | ------------ | ---------- | ----------- | --- |
| (2048,  | (Cert. A2836)  | 133r2 5.1,   | TOEPP/Plai | uninitializ |     |
| 256),   |                | FIPS 186-4)  | ntext      | ation       |     |
| (3072,  |                |              | exported   |             |     |
256)  to RAM
ECDSA  NIST P- ECDSA  ECDSA  Plaintext  N/A   Memory,  Asset  Digital
keys  224, P- SigGen,  KeyGen (FIPS  imported  plaintext  deletion,  signature
| 256, P- | ECDSA          | 186-4), CKG  | from       | module      |     |
| ------- | -------------- | ------------ | ---------- | ----------- | --- |
| 384, P- | SigVer,        | (SP 800-     | TOEPP/Plai | uninitializ |     |
| 521     | ECDSA          | 133r2 5.1,   | ntext      | ation       |     |
| curves  | KeyGen         | FIPS 186-4)  | exported   |             |     |
|         | (Cert. A2836)  |              | to RAM     |             |     |

DH  2048- KAS-FFC-SSC  NIST SP 800- Plaintext  N/A  Memory,  Asset  Key
keys  8192  (Cert. A2836)  56Ar3 key  imported  plaintext  deletion,  agreement
| bits  |     | pair         | from       | module      |     |
| ----- | --- | ------------ | ---------- | ----------- | --- |
|       |     | generation,  | TOEPP/Plai | uninitializ |     |
|       |     | CKG (SP 800- | ntext      | ation       |     |
|       |     | 133r2 5.2,   | exported   |             |     |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 22 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- |

|     |     | NIST SP 800- | to RAM  |     |     |
| --- | --- | ------------ | ------- | --- | --- |
56Ar3)

ECDH  NIST P- KAS-ECC-SSC  NIST SP 800- Plaintext  N/A  Memory,  Asset  Key
keys  224, P- (Cert. A2836)  56Ar3 key  imported  plaintext  deletion,  agreement
| 256, P- |     | pair         | from       | module      |     |
| ------- | --- | ------------ | ---------- | ----------- | --- |
| 384     |     | generation,  | TOEPP/Plai | uninitializ |     |
| and P-  |     | CKG (SP 800- | ntext      | ation       |     |
| 521     |     | 133r2 5.2,   | exported   |             |     |
| curves  |     | NIST SP 800- | to RAM     |             |     |
56Ar3)

DH  2048- KAS-FFC-SSC  N/A   Plaintext  N/A  Memory,  Asset  Key
Shared  8192  (Cert. A2836)  exported  plaintext  deletion,  agreement
| secrets  bits  |     |     | to RAM  | module  |     |
| -------------- | --- | --- | ------- | ------- | --- |
uninitializ
ation
ECDH  NIST P- KAS-ECC-SSC  N/A   Plaintext  N/A  Memory,  Asset  Key
Shared  224, P- (Cert. A2836)  exported  plaintext  deletion,  agreement
| secrets  256, P- |     |     | to RAM  | module  |     |
| ---------------- | --- | --- | ------- | ------- | --- |
384  uninitializ
and P-  ation
521
curves
Key  112- KDF SP800- N/A  Plaintext  N/A  Memory,  Asset  Key
Derivati 200  108, KDF  imported    plaintext  deletion,  derivation
| on keys  bits  | IKEv1, KDF  |     | from   | module      |     |
| -------------- | ----------- | --- | ------ | ----------- | --- |
|                | IKEv2, TLS  |     | TOEPP  | uninitializ |     |
v1.2 KDF  ation
RFC7627,
KDF SRTP,
KDA HKDF
(Cert. A2836)

KDF  112- KDF SP800- KDF SP800- Plaintext  N/A   Memory,  Asset  Key
Derived  200  108, PBKDF,  108, PBKDF,  exported   plaintext  deletion,  derivation
| keys  bits  | KDF IKEv1,    | KDF IKEv1,    | to RAM  | module      |     |
| ----------- | ------------- | ------------- | ------- | ----------- | --- |
|             | KDF IKEv2,    | KDF IKEv2,    |         | uninitializ |     |
|             | TLS v1.2 KDF  | TLS v1.2 KDF  |         | ation       |     |
|             | RFC7627,      | RFC7627,      |         |             |     |
|             | KDF SRTP,     | KDF SRTP,     |         |             |     |
|             | KDA HKDF      | KDA HKDF      |         |             |     |
(Cert. A2836)
DRBG  256- Counter  ENT (NP)  N/A  N/A  Memory,  Asset  Entropy
| CTR-  1024  | DRBG           |     |     | Plaintext  deletion,  | input      |
| ----------- | -------------- | --- | --- | --------------------- | ---------- |
| 256  bits   | (Cert. A2836)  |     |     | module                | materials  |
| entropy     |                |     |     | uninitializ           |            |
ation

DRBG  256- Counter  Counter  N/A  N/A  Memory,  Asset  Entropy
| CTR-  1024  | DRBG           | DRBG  |     | Plaintext  deletion,  | input      |
| ----------- | -------------- | ----- | --- | --------------------- | ---------- |
| 256  bits   | (Cert. A2836)  |       |     | module                | materials  |
| seed        |                |       |     | uninitializ           |            |
ation

DRBG  256  Counter  Counter  N/A  N/A  Memory,  Asset  Key for
| CTR-  bits  | DRBG           | DRBG  |     | Plaintext  deletion,  | DRBG used   |
| ----------- | -------------- | ----- | --- | --------------------- | ----------- |
| 256         | (Cert. A2836)  |       |     | module                | for random  |
| state:      |                |       |     | uninitializ           | number and  |
| Key         |                |       |     | ation                 | key/key     |
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 23 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- | --- |

  pair
Generation
purposes.
DRBG  128  Counter  Counter  N/A  N/A  Memory,  Asset  V value for
| CTR-  bits  | DRBG           | DRBG  |     |     | Plaintext  deletion,  | DRBG      |
| ----------- | -------------- | ----- | --- | --- | --------------------- | --------- |
| 256         | (Cert. A2836)  |       |     |     | module                | used for  |
| state: V    |                |       |     |     | uninitializ           | random    |
ation  number and
  key/key
pair
generation
purposes.
PBKDF  varies  PBKDF   N/A  Plaintext  N/A   Memory,  Asset  Password
(at least
| passwo | (Cert. A2836)  |     | imported  |     | plaintext  deletion,  | or  |
| ------ | -------------- | --- | --------- | --- | --------------------- | --- |
12
| rd  |     |     | from  |     | module  | passphrase  |
| --- | --- | --- | ----- | --- | ------- | ----------- |
charact TOEPP  uninitializ
ers)  ation

Trusted  256   KDF SP800- N/A  Plaintext  N/A   Memory,  Asset  Key used
Root  bits  108 (Cert.  imported  plaintext  deletion,  for deriving
| Key  | A2836)  |     | from   |     | module      | other keys   |
| ---- | ------- | --- | ------ | --- | ----------- | ------------ |
|      |         |     | TOEPP  |     | uninitializ | as per NIST  |
ation  SP 800-108.
  Can only
derive
‘Trusted
KDK’ and
‘Trusted
KEKDK’
keys.
Softwar NIST P- ECDSA SigVer  N/A  N/A  Embedded  Persisten none  Public key
| e  224    | (Cert. A2836)  |     |     | in the     | t storage,    | used by       |
| --------- | -------------- | --- | --- | ---------- | ------------- | ------------- |
| Integrit  |                |     |     | software,  | plaintext     | Power-on      |
| y Public  |                |     |     | plaintext  |               | Software      |
| Key       |                |     |     |            |               | Integrity to  |
| (not      |                |     |     |            |               | ensure the    |
| SSP)      |                |     |     |            |               | integrity of  |
the
Cryptograp
hic Module.
Table 10. SSPs

9.1  Random bit generators
The cryptographic module contains a Counter DRBG which uses AES-256 and derivation
function. By default, the DRBG is seeded with CPU Time Jitter Based Non-Physical True
Random Number Generator (JitterEntropy).
It is also possible that the crypto officer may install another entropy source to the
cryptographic module. The installed entropy source must be NIST SP 800-90B and FIPS
140-3 compliant. Enough bits of entropy must be provided according to the need of
cryptographic algorithms.
The RBG entropy sources are defined in the table below.

© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 24 of 36

SafeZone SW Cryptographic Module 2.0
Entropy sources Minimum number of Details
bits of entropy
JitterEntropy ENT 256 bits of entropy
Implemented by Stephan Mueller. It is an
(NP) minimum required to seed
entropy source based on CPU execution time
Counter DRBG AES-256
jitter.
The entropy source has NIST SP 800-90B
compliance. The version of the Jitterentropy
library applied in this cryptographic module
is 3.4.0.
The full description and documentation of the
CPU Jitter entropy source and Jitterentropy
library can be found at
https://www.chronox.de/jent.html
JitterEntropy ENT has a vetted SHA3-256
conditioning component, each SHA3-256
output contains 255 bits of entropy
(h_submitter = 0.333)
The Counter DRBG reads 512 bits from
JitterEntropy ENT for seeding each time
when instantiating and reseeding. 2 samples
of SHA3-256 output from JitterEntropy ENT
are gathered for each seed, which contains
510 bits of entropy.
Table 11. Non-Deterministic Random Number Generation Specification
10 Self-tests
The SafeZone FIPS SW Cryptographic Module includes the following self-tests:
• Pre-operational self-tests:
o Pre-operational software integrity test:
▪ Integrity test by ECDSA signature verify with NIST P-224 and SHA2-224
• Conditional self-tests:
o Conditional cryptographic algorithm self-tests (CAST):
▪ KAT test for SHA-1
▪ KAT test for SHA2-512
▪ KAT test for SHA3-224
▪ KAT test for HMAC-SHA2-256
▪ KAT test for AES-CBC encryption (128-bit key)
▪ KAT test for AES-CBC decryption (128-bit key)
▪ KAT test for AES-CCM encryption (128-bit key)
▪ KAT test for AES-CCM decryption (128-bit key)
▪ KAT test for AES-GCM encryption (128-bit key)
▪ KAT test for AES-GCM decryption (128-bit key)
▪ KAT test for AES-XTS encryption (128-bit key strength)
▪ KAT test for AES-XTS decryption (128-bit key strength)
▪ KAT test for AES-CMAC, 192-bit key
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
25 of 36

SafeZone SW Cryptographic Module 2.0
▪ KAT test for TDES-CBC encryption (192-bit key)
▪ KAT test for TDES-CBC decryption (192-bit key)
▪ KAT for Counter DRBG AES-256 (instantiate, generate and reseed;
includes AES-ECB mode encryption)
▪ KAT for RSA SigGen 2048-bit with SHA2-256 (PKCS #1 v1.5)
▪ KAT for RSA SigVer 2048-bit with SHA2-256 (PKCS #1 v1.5)
▪ KAT for DSA SigGen (P=2048/N=256 with SHA2-224)
▪ KAT for DSA SigVer (P=1024/N=160 with SHA2-224)
▪ KAT for ECDSA SigGen (NIST P-224 with SHA2-224)
▪ KAT for ECDSA SigVer (NIST P-224 with SHA2-224)
▪ KAT for KTS-IFC Key Encapsulation 2048-bit (RSA-OAEP)
▪ KAT for KTS-IFC Key Un-encapsulation 2048-bit (RSA-OAEP)
▪ KAT for KAS-FFC-SSC (P=2048/N=224)
▪ KAT for KAS-ECC-SSC (NIST P-224)
▪ KAT for KDF SP800-108 (Counter Mode)
▪ KAT for KDA HKDF (includes KDF SP800-108 Feedback Mode)
▪ KAT for KDF SP800-108 (Double Pipeline Mode)
▪ KAT for KDF IKEv1
▪ KAT for KDF IKEv2
▪ KAT for TLS v1.2 KDF RFC7627
▪ KAT for SP 800-90A-r1, Section 11.3 (Instantiate/Generate) health tests
for Counter DRBG AES-256
▪ KAT for SP 800-90A-r1, Section 11.3 (Reseed) health test Counter DRBG
AES-256
▪ Fault Detection Tests for SP 800-90B, Section 4 start-up and continuous
health tests (RCT and APT) for JitterEntropy ENT (NP).
o Conditional pair-wise consistency tests:
▪ Pair-wise consistency check for key pairs created for digital signature
purposes (DSA, FIPS 186-4)
▪ Pair-wise consistency check for key pairs created for digital signature
purposes (ECDSA, FIPS 186-4)
▪ Pair-wise consistency check for RSA key pairs created for digital signature
(FIPS 186-4) or key transport (NIST SP 800-56B) purposes.
▪ Pair-wise consistency check for key pairs created for key establishment
purposes (FFC DH and ECC DH, NIST SP 800-56A rev3)
All CAST are performed before pre-operational self-tests.
The KAT’s are done by performing memory comparing (C library function memcmp)
between calculations with known inputs and the expected correct results matching the inputs.
Self-tests are invoked automatically upon loading the cryptographic module. The
initialization function FLS_LibInit is executed automatically. Any error during the self-
tests will result the module in an error state, from where only recovered by invoking the
FLS_LibUninit or FLS_LibInit function.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
26 of 36

SafeZone SW Cryptographic Module 2.0
The FL_LibStatusAPI function can be used to obtain the module status. It returns
when the module has not yet been initialized and when the
FL_STATUS_INIT FL_STATUS_ERROR
module is in error state.
As it is recommended to self-test cryptographic components (like DRBG) frequently, the
module provides the capability to invoke the self-tests manually (on demand) with the
FL_LibSelfTestAPI function. The important difference between the manually invoked
self-tests and the automatically invoked self-tests when initializing the module is that the
manually invoked self-tests will not cause zeroization of the key material currently loaded in
the module, providing the tests execute successfully.
In general, if a self-test fails, the module will transition to the error state and the
return value (status) of the invoked API function will be something other than ,
FLR_OK
depending on the current situation.
Conditional self-tests for manual key entry and software/firmware load or bypass are not
provided, as these are not applicable. Any error during the conditional self-tests will result in
a module transition to the error state
The cryptographic module uses the ECDSA NIST P-224 signature of the module binary for
the integrity tests with SHA2-224 as the hash function. The public part of the key is always
included with the module. The private part is stored in Rambus version control system and
signing of the module is performed automatically by Rambus build system.
Before running the integrity test, tests for the signature algorithms are executed. In case of
failure in the integrity test the module will immediately transition to error state.
11 Life-cycle assurance
11.1 Version control
The SafeZone FIPS SW Cryptographic Module source code is maintained in a version
control system (Mercurial). Changes are reviewed and automatically built and tested with
continuous integration system (Jenkins).
11.2 CVE
There are no CVE’s which currently affect the module as the module is published.
11.3 User guidance for specific services
Some of the FIPS Publications or NIST Special Publications require that the Cryptographic
Module Security Policy mentions important configuration items for those algorithms. The
user of the module shall observe these rules.
11.3.1 NIST SP 800-108 Rev 1: Key Derivation Functions
All three key derivation functions, Counter Mode, Feedback Mode and Double-Pipeline
Iteration Mode are supported.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
27 of 36

SafeZone SW Cryptographic Module 2.0
11.3.2 NIST SP 800-56C Rev 2: Key-Derivation Methods in Key-Establishment Schemes
The SafeZone FIPS SW Cryptographic module provides hash and HMAC functions that can
be used for One-Step Key Derivation as introduced in NIST SP 800-56C Rev 2. The module
also offers Extraction-then-Expansion function that can be used for Two-Step Key Derivation
as introduced in NIST SP 800-56C Rev 2. The Two-Step Key Derivation function uses
HMAC with SHA-1/SHA224/SHA256/SHA384 or AES-CMAC and SHA512 and NIST SP
800-108 Key Derivation Function with Feedback Mode. The construct is compatible with
some uses of RFC 5869.
The following rules the user of the functions for NIST SP 800-56C Rev 2 Key Derivation
functions shall observe:
• Key derived using NIST SP 800-56C Rev 2 shall only be used as secret keying
material — such as a symmetric key used for data encryption or message integrity, a
secret initialization vector, or, perhaps, a key-derivation key that will be used to
generate additional keying material.
• The derived keying material shall not be used as a key stream for a stream cipher.
• When using HMAC algorithm for key derivation, the algorithms require a key. This
key corresponds to salt in NIST SP 800-56C Rev 2. If salt is to be omitted, use all-
zero-byte key at exactly the bit length of the hash algorithm.
• HKDF expansion function always uses NIST SP 800-108 Feedback Mode Key
Derivation Function with single byte counter. This is interoperable with RFC 5869.
• The two-part extraction and expansion operation always uses the same underlying
hash function or AES-CMAC for both extraction and expansion.
• AES-CMAC can be used to generate keys up to 128 bit security. For higher security
hash- or HMAC-based schemes shall be used.
• HMAC-SHA-1 and HMAC-SHA-2 functions can be used to generate keys with 112-
512 bit strength. See table below for details.
• If HMAC is used for key derivation, salt can be up-to one hash input block.
• If AES-CMAC is used, the key extraction phase may use 128 bit, 192 bit or 256 bit
salt, but the key-expansion step will always use AES-128-CMAC.
• The module does not support NIST SP 800-56C Rev 2 Single-Step Key Derivation.
• If the input for NIST SP 800-56C Key Derivation Function is a shared secret, the
input must be destroyed after extraction (e.g., with FLS_AssetFree).
• Two-Step Key Derivation will make use of both salt and KDK.
The input attributes and security strength of generated keys follows this table:
Hash or MAC Length of MAC algorithm The length of Security
for service optional salt (in for optional optional KDK strength s
bits) KDK (in bits) supported (in
bits)
(HMAC-)SHA- up-to 512 HMAC-SHA-1 160 112 ≤ s ≤ 160
1
(HMAC-)SHA- up-to 512 HMAC-SHA- 224 112 ≤ s ≤ 224
224 224
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
28 of 36

| SafeZone SW Cryptographic Module 2.0  |     |     |     |     |     |
| ------------------------------------- | --- | --- | --- | --- | --- |

| (HMAC-)SHA- | up-to 512   | HMAC-SHA- | 256  | 112 ≤ s ≤ 256  |     |
| ----------- | ----------- | --------- | ---- | -------------- | --- |
| 256         |             | 256       |      |                |     |
| (HMAC-)SHA- | up-to 1024  | HMAC-SHA- | 384  | 112 ≤ s ≤ 384  |     |
| 384         |             | 384       |      |                |     |
| (HMAC-)SHA- | up-to 1024  | HMAC-SHA- | 512  | 112 ≤ s ≤ 512  |     |
| 512         |             | 512       |      |                |     |
| AES-128-    | 128         | AES-128-  | 128  | 112 ≤ s ≤ 128  |     |
| CMAC        |             | CMAC      |      |                |     |
| AES-192-    | 192         | AES-192-  | 128  | 112 ≤ s ≤ 128  |     |
| CMAC        |             | CMAC      |      |                |     |
| AES-256-    | 256         | AES-256-  | 128  | 112 ≤ s ≤ 128  |     |
| CMAC        |             | CMAC      |      |                |     |

11.3.3  HMAC-based Extract-and-Expand Key Derivation Function (HKDF)
The SafeZone FIPS SW Cryptographic module provides HMAC-based Key Derivation
Function from RFC 5869, known as HKDF. This function is similar to NIST SP 800-56C
Rev 2 Two-Step Key Derivation, but not the same.

11.3.4  NIST SP 800-132: PBKDF Function
The key derived using NIST SP 800-132 shall only be used for storage purposes. The options
1a, 1b, 2a and 2b presented in NIST SP 800-132 for deriving the DPK (Data Protection Key)
from the MK (Master Key) are supported. The SafeZone FIPS Lib does not limit the length
of the password used in NIST SP 800-132 PBKDF key derivation.  The upper bound for the
strength of passwords usually used is between 5 or 6 bits per character, which indicates the
upper bound for the probability of the password being randomly guessed is 1 / (64 ^
length_of_password). To achieve security over 64 bits, the passwords must generally be
longer than 12 characters.
With compliance to NIST SP 800-132 and the FIPS 140-3 Implementation Guidance D.N,
these requirements and limits must be followed by user:
•
There is no maximum length of salt used, but at least 128 bits (16 bytes) of salt value
must be randomly generated.
•  The iteration count shall be as large as possible. The iteration count used must be at
least 1000 to meet the minimum requirements of NIST SP 800-132. However, often it
is recommendable to use much larger iteration counts, such as 100000 or 1000000,
when user-perceived performance is not critical.
•  Resulting MK must be used in the way as one of the following options as stated in
NIST SP 800-132:
o  Option 1a, the MK is used directly as the DPK.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
 29 of 36

SafeZone SW Cryptographic Module 2.0
o Option 1b, the MK is used as input to an approved KDF (NIST SP 800-108 or
NIST SP 800-56C-r2) in order to derive the DPK.
o Option 2a, the MK is used to protect a randomly generated DPK, the DPK is
protected with approved authenticated encryption algorithm (AES-GCM or
AES-CCM) or approved authentication technique (HMAC or AES-
GMAC/CMAC) and approved encryption algorithm (AES-
ECB/CBC/CTR/OFB/XTS).
o Option 2b, the MK is used as input to an approved KDF (NIST SP 800-108 or
NIST SP 800-56C-r2) in order to derive the key to protect a randomly
generated DPK, the DPK is protected with approved authenticated encryption
algorithm (AES-GCM or AES-CCM) or approved authentication technique
(HMAC or AES-GMAC/CMAC) and approved encryption algorithm (AES-
ECB/CBC/CTR/OFB/XTS).
11.3.5 NIST SP 800-38D: Galois/Counter Mode (GCM) and GMAC
The FIPS 140-3 Implementation Guidance C.H applies to AES-GCM and GMAC usage with
this module. Scenario/technique 1, 2 and 3 in IG C.H are supported by this module.
With compliance to technique 1 in IG C.H, the module supports AES-GCM with IPSec and
TLS v1.2, both must be initialized with FLS_EncryptAuthInitDeterministic
function for encryption and with FLS_CryptAuthInit for decryption. The
FLS_CryptAuthInit function is also used for subsequent encryption operations for
operation sequences started with the FLS_EncryptAuthInitDeterministic function
(In this case the input IV/Nonce must be NULL since IG C.H forbids using external IV for
encryption).
With compliance to technique 2 or 3 in IG C.H, the operator must use the
FLS_EncryptAuthInitRandom function if random IV generation (IG C.H Technique
2) is required, or in case of deterministic IV generation (IG C.H Technique 3), the
FLS_EncryptAuthInitDeterministic function. It is not possible to use random IV
generated externally.
The module supports AES-GCM with SRTP (RFC 7714). For SRTP, functions
FLS_EncryptAuthSrtp, FLS_EncryptAuthSrtcp have been introduced. These
functions provide equivalent functionality than
FLS_EncryptAuthInitDeterministic, but work with SRTP protocols. SRTP IV
consists of 32-bit field, SSRC (synchronization source), which acts like 32-bit Module Name
of IG C.H Technique 3. SRTP uses 48-bit counter ROC || SEQ. This counter is incremented
internal to the cryptographic module. The module will detect overflow of counter. It is the
responsibility of the users to rekey upon counter overflow. In addition, SRTP uses 96-bit
Encryption Salt that is XORed with other fields. For control purposes, SRTP has an
additional protocol, SRTCP. SRTCP protocol is otherwise identical to SRTP, but it uses
different keys, and IV format where ROC || SEQ is replaced by SRTCP index. SRTCP index
is incremented internal to the cryptographic module. The module will allow only 2^31
packets to be produced with SRTCP prior rekeying.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
30 of 36

SafeZone SW Cryptographic Module 2.0
• Note: If IV is generated internally in a deterministic manner, then in case a module’s
power is lost and then restored, the key used for the AES GCM encryption/decryption
must be re-distributed.
11.3.6 NIST SP 800-38E: XTS Mode
The module supports XTS Mode for Confidentiality on Storage Devices. Both XTS-AES-128
(256 bit key) and XTS-AES-256 (512 bit key) are supported. The XTS-AES key is parsed as
concatenation of two AES keys Key_1 and Key_2. As is explained in FIPS 140-3
Implementation Guidance C.I, it is required that Key_1 ≠ Key_2. If Key_1 = Key_2, attempt
to perform XTS-AES encryption or decryption will fail. The XTS Mode is only approved for
usage in storage applications.
11.3.7 NIST SP 800-133 Rev 2: Key Generation (CKG)
The module allows key generation and generates keys according to the following NIST SP
800-133-r2 sections: 5.1, 5.2, 6.1. Key generation will use NIST SP 800-90A Rev1 DRBG-
CTR AES-256. The output of the approved DRBG is used unmodified when symmetric keys
are generated. It is also used unmodified as random input for asymmetric key generation.
11.3.8 NIST SP 800-107 Rev 1: Truncated HMAC
The module supports truncation of HMAC results for all SHA-1 and SHA-2 family hash
functions. These include e.g., HMAC-SHA-1-80, HMAC-SHA-1-96, HMAC-SHA-256-128,
HMAC-SHA-384-192 and HMAC-SHA-512-256. Following guidance of NIST SP 800-107
Rev 1, it is not allowed to truncate HMAC to less than 32-bits. Therefore, minimum allowed
mac output length argument for the FLS_MacGenerateFinish or
FLS_MacVerifyFinish is 4.
11.3.9 NIST SP 800-56A Rev 3: Pair-Wise Key-Establishment Schemes (KAS-ECC and KAS-FFC)
The module provides Discrete Logarithm Cryptographic-based key agreements compliant
with NIST SP 800-56A-r3 according to scenario 2 path (1) of FIPS 140-3 Implementation
Guidance D.F. The KAS-ECC-SSC schemes provide between 112 and 256 bits of security
strength. The KAS-FFC-SSC schemes provide between 112 and 200 bits of security strength.
11.4 Porting maintaining validation
SafeZone FIPS 140-3 product is typically delivered in binary format. The product in binary
format is validated for platforms mentioned in the validation certificate. There is also another
product available from Rambus: source code product. This package can be recompiled by the
user for their target platform. However, if changes to the module are required, they need to be
processed as a revalidation for FIPS 140-3.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
31 of 36

SafeZone SW Cryptographic Module 2.0
When ported to an operational environment which is not listed on the validation certificate,
no claims can be made as to the correct operation of the module and the security strengths of
any keys generated by the module.
12 Mitigation of other attacks
The cryptographic module does not implement security mechanisms to mitigate other attacks.
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
32 of 36

SafeZone SW Cryptographic Module 2.0
Appendix A. Glossary and Abbreviations
AES Advanced Encryption Standard
CAVP Cryptographic Algorithm Validation Program
CBC Cipher Block Chaining
CFB Cipher Feedback
CMAC Cipher-based Message Authentication Code
CMVP Cryptographic Module Validation Program
CO Crypto Officer
CTR Counter Mode
DSA Digital Signature Algorithm
DRBG Deterministic Random Bit Generator
ECB Electronic Code Book
ECC Elliptic Curve Cryptography
FIPS Federal Information Processing Standards Publication
FSM Finite State Model
GCM Galois Counter Mode
HMAC Hash Message Authentication Code
KAS Key Agreement Scheme
KAT Known Answer Test
KDF Key Derivation Function
KW AES Key Wrap
KWP AES Key Wrap with Padding
MAC Message Authentication Code
NIST National Institute of Science and Technology
OFB Output Feedback
PSS Probabilistic Signature Scheme
RNG Random Number Generator
RSA Rivest, Shamir, Adleman
SHA Secure Hash Algorithm
SHS Secure Hash Standard
SSP Sensitive Security Parameter
U User
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
33 of 36

SafeZone SW Cryptographic Module 2.0
Appendix B. References
FIPS 140-3 FIPS PUB 140-3 – Security Requirements for Cryptographic Modules
March 2021
FIPS 140-3 IG Implementation Guidance for FIPS 140-3 and the Cryptographic Module
Validation Program
November 2021
FIPS 180-4 FIPS PUB 180-4 – Secure Hash Standard (SHS)
August 2015
FIPS 186-4 FIPS PUB 186-4 – Digital Signature Standard (DSS)
July 2013
FIPS 198-1 FIPS PUB 198-1 – The Keyed-Hash Message Authentication Code (HMAC)
July 2008
FIPS 202 FIPS PUB 202 – SHA-3 Standard: Permutation-Based Hash and Extendable-
Output Functions
August 2015
ISO/IEC 24759 ISO/IEC 24759 – Information technology – Security techniques – Test
requirements for cryptographic modules
March 2017
NIST SP 800-38A NIST Special Publication 800-38A – Recommendation for Block Cipher Modes
of Operation: Methods and Techniques
December 2001
NIST SP 800-38B NIST Special Publication 800-38B – Recommendation for Block Cipher Modes
of Operation: The CMAC Mode for Authentication
May 2005
NIST SP 800-38C NIST Special Publication 800-38C – Recommendation for Block Cipher Modes
of Operation: The CCM Mode for Authentication and Confidentiality
May 2004
NIST SP 800-38D NIST Special Publication 800-38C – Recommendation for Block Cipher Modes
of Operation: Galois/Counter Mode (GCM) and GMAC
November 2007
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
34 of 36

SafeZone SW Cryptographic Module 2.0
NIST SP 800-38E NIST Special Publication 800-38E – Recommendation for Block Cipher Modes
of Operation: The XTS-AES Mode for Confidentiality on Storage Devices
January 2010
NIST SP 800-38F NIST Special Publication 800-38F – Recommendation for Block Cipher Modes
of Operation: Methods for Key Wrapping
December 2012
NIST SP 800-56A-r3 NIST Special Publication 800-56A Revision 3 – Recommendation for Pair-
Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography
April 2018
NIST SP 800-56B-r2 NIST Special Publication 800-56B Revision 2 – Recommendation for Pair-
Wise Key Establishment Using Integer Factorization Cryptography
March 2019
NIST SP 800-56C-r2 NIST Special Publication 800-56C Revision 2 – Recommendation for Key-
Derivation Methods in Key-Establishment Schemes
August 2020
NIST SP 800-67-r2 NIST Special Publication 800-67 Revision 2 – Recommendation for the Triple
Data Encryption Algorithm (TDEA) Block Cipher
November 2017
NIST SP 800-90A-r1 NIST Special Publication 800-90A Revision 1 – Recommendation for Random
Number Generation Using Deterministic Random Bit Generators
June 2015
NIST SP 800-108 NIST Special Publication 800-108 – Recommendation for Key Derivation
Using Pseudorandom Functions (Revised)
October 2009
NIST SP 800-132 NIST Special Publication 800-132 – Recommendation for PBKDF, Part 1:
Storage Applications
December 2010
NIST SP 800-133-r2 NIST Special Publication 800-133 Revision 2 – Recommendation for
Cryptographic Key Generation
December 2011
NIST SP 800-135-r1 NIST Special Publication 800-135 Revision 1 – Recommendation for Existing
Application-Specific Key Derivation Functions
December 2011
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
35 of 36

SafeZone SW Cryptographic Module 2.0
NIST SP 800-140B NIST Special Publication 800-140B – CMVP Security Policy Requirements
March 2020
© Rambus Inc. This document can be reproduced and distributed only whole and intact, including this copyright notice.
36 of 36