Apple Inc.

Apple corecrypto Module v13.0
[Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Document Version 2.0
December 2024

Prepared by:

Lightship Security Inc.

1101-150 Isabella Street,

Ottawa, ON, K1S 1V7

www.lightshipsec.com

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 1 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Trademarks

Apple's trademarks applicable to this document are listed in https://www.apple.com/legal/intellectual-
property/trademark/appletmlist.html. Other company, product, and service names may be trademarks or
service marks of others.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 2 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

5.

6.1

5.1
5.2

4.1
4.2

Contents
1.  General ................................................................................................................................................................. 5
2.  Cryptographic Module Specification .............................................................................................................. 6
3.  Cryptographic Module Interfaces ................................................................................................................. 11
4.  Roles, Services and Authentication .............................................................................................................. 12
Authentication........................................................................................................................................................................... 12
Services ....................................................................................................................................................................................... 13
Software/Firmware Security ......................................................................................................................... 16
Integrity Techniques ............................................................................................................................................................... 16
On Demand Integrity Test...................................................................................................................................................... 16
6.  Operational Environment .............................................................................................................................. 17
Applicability ............................................................................................................................................................................... 17
7.  Physical Security .............................................................................................................................................. 18
8.  Non-invasive Security ..................................................................................................................................... 19
Sensitive Security Parameter Management ............................................................................................... 20
9.
Random Number Generation ................................................................................................................................................ 21
Key / SSP Generation .............................................................................................................................................................. 22
Key / SSP Establishment ........................................................................................................................................................ 22
Key / SSP Import/Export ....................................................................................................................................................... 22
Key / SSP Storage ..................................................................................................................................................................... 22
Key / SSP Zeroisation .............................................................................................................................................................. 23
10.  Self-tests ............................................................................................................................................................ 24
10.1  Pre-operational Software Integrity Test ........................................................................................................................... 24
10.2  Conditional Self-Tests ............................................................................................................................................................. 24
10.3  Error Handling .......................................................................................................................................................................... 25
11.  Life-cycle Assurance ........................................................................................................................................ 26
11.1  Delivery and Operation .......................................................................................................................................................... 26
11.2  Crypto Officer Guidance ......................................................................................................................................................... 26
12.  Mitigation of Attacks ....................................................................................................................................... 27

9.1
9.2
9.3
9.4
9.5
9.6

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 3 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Tables
Table 1 – Security levels ............................................................................................................................................................... 5
Table 2 – Tested operational environments. .......................................................................................................................... 6
Table 3 – Affirmed operational environments. ...................................................................................................................... 7
Table 4 – Approved algorithms .................................................................................................................................................. 9
Table 5 – Non-approved algorithms Not Allowed in the Approved Mode of Operation ............................................. 9
Table 6 – Ports and interfaces ..................................................................................................................................................11
Table 7 – Roles, Services, Input and Output ..........................................................................................................................12
Table 8 – Approved services .....................................................................................................................................................14
Table 9 – Non-approved services ............................................................................................................................................15
Table 10 – SSPs .............................................................................................................................................................................21
Table 11 – Non-Deterministic Random Number Generation Specification ..................................................................22
Table 12 – Conditional Cryptographic Algorithm Self-tests .............................................................................................25
Table 13 – Error Indicators .......................................................................................................................................................25

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 4 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

1.  General

This document is the non-proprietary FIPS 140-3 Security Policy for Apple corecrypto Module v13.0 [Intel,
Kernel, Software, SL1] cryptographic module. It contains the security rules under which the module must
operate and describes how this module meets the requirements as specified in FIPS PUB 140-3 (Federal
Information Processing Standards Publication 140-3) for a Security Level 1 module.

This document provides all tables and diagrams (when applicable) required by NIST SP 800-140B. The
column names of the tables follow the template tables provided in NIST SP 800-140B.

Table 1 describes the individual security areas of FIPS 140-3, as well as the Security Levels of those individual
areas.

Section

FIPS 140-3 Section Title

Security Level

1

2

3

4

5

6

7

8

9

10

11

12

General

Cryptographic module specification

Cryptographic module interfaces

Roles, services, and authentication

Software/Firmware security

Operational environment

Physical security

Non-invasive security

Sensitive security parameter management

Self-tests

Life-cycle assurance

Mitigation of other attacks

Table 1 – Security levels

1

1

1

1

1

1

N/A

N/A

1

1

1

N/A

The Module has an overall security level of 1.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 5 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

2.  Cryptographic Module Specification

The Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1] cryptographic module (hereafter referred
to as "the Module") is a software module running on a multi-chip standalone general-purpose computing
platform. The version of module is 13 written as v13.0. The module provides implementations of low-level
cryptographic primitives to the Host OS's (macOS Ventura v13) Security Framework and CommonCrypto. The
module has been tested by Lightship Security, Inc. CST lab on the following platforms with and without PAA:

#

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

Operating System

Hardware Platform

Processor

PAA/Acceleration

macOS Ventura v13

MacBook Air (2022)

Intel i5 (Amber Lake)

macOS Ventura v13

MacBook Air (2022)

Intel i7 (Ice Lake)

macOS Ventura v13

MacBook Pro (2022)

Intel i7 (Coffee Lake)

macOS Ventura v13

iMac (2022)

Intel i7 (Comet Lake)

macOS Ventura v13

MacBook Pro (2022)

Intel i9 (Coffee Lake)

macOS Ventura v13

iMac Pro (2022)

Xeon W SkyLake

macOS Ventura v13

Mac Pro (2022)

Xeon W Cascade Lake

macOS Ventura v13

Mac Pro (2022)

Intel i5 (Coffee Lake)

macOS Ventura v13

MacBook Air (2022)

Intel i5 (Amber Lake)

macOS Ventura v13

MacBook Air (2022)

Intel i7 (Ice Lake)

macOS Ventura v13

MacBook Pro (2022)

Intel i7 (Coffee Lake)

macOS Ventura v13

iMac (2022)

Intel i7 (Comet Lake)

macOS Ventura v13

MacBook Pro (2022)

Intel i9 (Coffee Lake)

macOS Ventura v13

iMac Pro (2022)

Xeon W SkyLake

macOS Ventura v13

Mac Pro (2022)

Xeon W Cascade Lake

macOS Ventura v13

Mac Pro (2022)

Intel i5 (Coffee Lake)

Table 2 – Tested operational environments.

PAA

PAA

PAA

PAA

PAA

PAA

PAA

PAA

No

No

No

No

No

No

No

No

In addition to the platforms listed above, Apple Inc. has also tested the module on the following platforms and
claims vendor affirmation on them:

#

1

2

3

4

5

6

7

8

9

10

11

12

Operating System

Hardware Platform

macOS Ventura v13

MacBook Pro - i5 (Ice Lake), 2021, 2020

macOS Ventura v13

MacBook Pro - i5 (Coffee Lake), 2021, 2020, 2019, 2018

macOS Ventura v13

MacBook Pro - i7 (Amber Lake), 2021, 2019, 2018

macOS Ventura v13

MacBook Pro - i7 (Coffee Lake), 2021, 2020, 2019, 2018

macOS Ventura v13

MacBook Pro - i7 (Ice Lake), 2021, 2020

macOS Ventura v13

MacBook Pro - i9 (Coffee Lake), 2021, 2019, 2018

macOS Ventura v13

MacBook Air - i5 (Ice Lake), 2021, 2020

macOS Ventura v13

MacBook Air - i7 (Ice Lake), 2021, 2020

macOS Ventura v13

MacBook Air - i5 (Amber Lake), 2021, 2019, 2018

macOS Ventura v13

MacBook Air - i7 (Amber Lake), 2021, 2018

macOS Ventura v13

Mac mini - i5 (Coffee Lake), 2021, 2018

macOS Ventura v13

Mac mini - i7 (Coffee Lake), 2021, 2018

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 6 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

13

14

15

16

17

18

19

macOS Ventura v13

iMac - i5 (Comet Lake), 2021, 2020

macOS Ventura v13

iMac - i7 (Comet Lake), 2021, 2020

macOS Ventura v13

iMac - i9 (Comet Lake), 2021, 2020

macOS Ventura v13

iMac - i5 (Coffee Lake), 2021, 2019

macOS Ventura v13

iMac - i7 (Coffee Lake), 2021, 2019

macOS Ventura v13

iMac - i9 (Coffee Lake), 2021, 2019

macOS Ventura v13

iMac - i9 (Comet Lake), 2022

Table 3 – Affirmed operational environments.

The CMVP makes no statement as to the correct operation of the module or the security strengths of the
generated keys when so ported if the specific operational environment is not listed on the validation
certificate.

The table below lists all Approved or Vendor-affirmed security functions of the module, including specific key
size(s) employed for approved services, and implemented modes of operation. The module is in the Approved
mode of operation when the module utilizes the services that use the security functions listed in the table
below. The Approved mode of operation is configured in the system by default and can only be transitioned
into the non-Approved mode by calling one of the non-Approved services listed in Table 9 – Non-approved
services. If the device starts up successfully, then the module has passed all self-tests and is operating in the
Approved mode.

CAVP Cert

A3618 (asm_aesni)
A3619 (asm_x86)
A3620 (c_aesni)
A3621 (c_asm)

A3626 (vng_asm)
A3627 (vng_aesni)

A3620 (c_aesni)
A3621 (c_asm)

A3620 (c_aesni)
A3621 (c_asm)

A3620 (c_aesni)
A3621 (c_asm)
A3626 (vng_asm)
A3627 (vng_aesni)

A3618 (asm_aesni)
A3619 (asm_x86)
A3620 (c_aesni)
A3621 (c_asm)
A3626 (vng_asm)
A3627 (vng_aesni)

A3626 (vng_asm)
A3627 (vng_aesni)

Algorithm and
Standard

AES
[FIPS 197]
[SP 800-38A]

AES
[FIPS 197]
[SP 800-38C]

AES
[FIPS 197]
[SP 800-38A]

AES
[FIPS 197]
[SP 800-38A]

AES
[FIPS 197]
[SP 800-38A]

AES
[FIPS 197]
[SP 800-38A]

AES
[FIPS 197]
[SP 800-38D]

Mode / Method

Description / Key Size /
Key Strength

Use / Function

CBC

CCM

128, 192, 256

Symmetric encryption and
decryption

128, 192, 256

Authenticated encryption
and decryption

CFB128

128, 192, 256

CFB8

CTR

128, 192, 256

128, 192, 256

Symmetric encryption and
decryption

Symmetric encryption and
decryption

Symmetric encryption and
decryption

ECB

128, 192, 256

Symmetric encryption and
decryption

GCM

128, 192, 256

Authenticated encryption
and decryption

A3620 (c_aesni)

AES

KW

128, 192, 256

Key wrapping

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 7 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

A3621 (c_asm)

A3620 (c_aesni)
A3621 (c_asm)

A3618 (asm_aesni)
A3619 (asm_x86)

A3620 (c_aesni)
A3621 (c_asm)
A3626 (vng_asm)
A3627 (vng_aesni)

A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

[FIPS 197]
[SP 800-38F]

AES
[FIPS 197]
[SP 800-38A]

XTS-AES
[FIPS 197]
[SP 800-38E]

OFB

XTS

128, 192, 256

Symmetric encryption and
decryption

128, 256

Symmetric encryption and
decryption on storage
devices

CTR_DRBG
[SP 800-90Ar1]

AES-CTR

Key Length/ Key Strength:
128, 256

Random Number
Generation

Derivation Function
Enabled: Yes

ECDSA
[FIPS 186-4]

KeyGen, KeyVer, SigGen,
SigVer

Curves: P-224, P-256, P-
384, P-521

Key Strength: from 112 to
256

Digital signatures and
asymmetric key generation
and verification

Cryptographic key
generation

Vendor Affirmed

CKG

Key Pair Generation (CKG)
using method in Sections 4
and 5.1 in [SP 800-133r2]

-

112 bits or greater

Message authentication

HMAC-SHA-1
HMAC-SHA2-224
HMAC-SHA2-256
HMAC-SHA2-384
HMAC-SHA2-512

HMAC-SHA2-512/256

112 bits or greater

Message authentication

A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)
A3628 (vng_intel)

A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

HMAC
[FIPS 198-1]

HMAC
[FIPS 198-1]

HMAC_DRBG
[SP 800-90Ar1]

SHA-1
SHA2-224
SHA2-256
SHA2-384
SHA2-512

A3624 (c_sse3)

KBKDF1
[SP 800-108r1]

Counter (CTR)
Feedback

112 bits or greater

Random Number
Generation

Key-based key derivation

HMAC-SHA-1
HMAC-SHA2-224
HMAC-SHA2-256
HMAC-SHA2-384
HMAC-SHA2-512

A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

RSA
[FIPS 186-4]

A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)
A3628 (vng_intel)

A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

SHS
[FIPS 180-4]

SHS
[FIPS 180-4]

KeyGen (ANSI X9.31),

KeyGen: 2048, 3072, 4096

SigGen (PKCS#1 v1.5) and
(PKCS PSS)

SigVer (PKCS#1 v1.5) and
(PKCS PSS)

SigGen: 2048, 3072, 4096

SigVer: 1024 (legacy use),
2048, 3072, 4096

Digital signatures and
asymmetric key generation
and verification

112 bits or greater

Message digest

SHA-1
SHA2-224
SHA2-256
SHA2-384
SHA2-512

SHA2-512/256

112 bits or greater

Message digest

A3625 (c_ltc)

Triple-DES

ECB

Keying Option: 1

Symmetric decryption

1 KBKDF: Supported Lengths: 8 to 4096 in increments of 8. Fixed Data Order: Before Fixed Data. When using HMAC as the PRF.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 8 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Table 4 – Approved algorithms

The module does not have non-Approved algorithms used in the Approved mode of operation (with or
without security claimed).

The table below lists non-Approved security functions that are not Allowed in the Approved Mode of
Operation:

Algorithm

Use / Function

RSA

ANSI X9.31 Key Pair Generation Key Size < 2048

RSA

X25519

Ed25519

PKCS#1 v1.5 and PSS Signature Generation Key Size < 2048

PKCS#1 v1.5 and PSS Signature Verification

Key Size< 1024

Key Encapsulation: OAEP, PKCS#1 v1.5 and PSS schemes

Key Agreement

Key Generation

Key Generation

Signature Generation

Signature Verification

ANSI X9.63 KDF

Hash based Key Derivation Function

RFC6637

Key Derivation Function

HKDF [SP 800-56C]

Key Derivation Function

DES

CAST5

RC4

RC2

MD2

MD4

MD5

RIPEMD

ECDSA

Encryption / Decryption, Key Size: 56-bits

Encryption / Decryption, Key Sizes: 40 to 128-bits in 8-bit increments

Encryption / Decryption, Key Sizes: 8 to 4096-bits

Encryption / Decryption Key Sizes 8 to 1024-bits

Message Digest, Digest size 128-bit

Message Digest, Digest size 128-bit

Message Digest, Digest size 128-bit

Message Digest, Digest size 160-bits

Key-pair generation: Curve P-192
Public key validation: Curve P-192
Signature Generation: Curve P-192
Signature Verification: Curve P-192
Key Pair Generation for compact point representation of points

Integrated Encryption Scheme
on elliptic curves (ECIES)

Encryption / Decryption

Blowfish

Encryption / Decryption

OMAC (One-Key CBC MAC)

MAC generation

Triple-DES [SP 800-67r2]2

CBC, ECB: Encryption/Decryption

Note: The module does not enforce the limit of 216 encryptions with the same Triple-DES key, as
required by FIPS 140-3 IG C.G.

Table 5 – Non-approved algorithms Not Allowed in the Approved Mode of Operation

2 Triple-DES encryption/decryption was tested as part of CAVP algorithm testing, but is not utilized for any services implemented/supp orted by the
module in Approved mode of operation.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 9 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

The Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1] executes within the kernel space of the
computing platforms and operating systems listed in Table 2 – Tested operational environments. Figure 1
below shows the logical block diagram3 representing the following information:

•  The location of the logical object of the module with respect to the operating system, other supporting

applications and the cryptographic boundary so that all the logical and physical layers between the logical
object and the cryptographic boundary are clearly defined; and

•  The interactions of the logical object of the module with the operating system and other supporting

applications resident within the cryptographic boundary.

Figure 1 – Logical block diagram

3 Kernel extension (KEXT) is a bundle that performs low-level tasks. KEXTs run in kernel space, which gives them elevated privileges and the ability to
perform tasks that user-space apps cannot.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 10 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

3.  Cryptographic Module Interfaces

As a software-only module, the module does not have physical ports. For the purpose of the FIPS 140-3
validation, the physical ports are interpreted to be the physical ports of the hardware platform on which it
runs.

The underlying logical interfaces of the module are the C language Kernel Interfaces (KPIs). In detail these
interfaces are described in the table below.

Physical port

Logical interface

Data that passes over port / interface

N/A

N/A

N/A

N/A

N/A

Data Input

Data Output

Data inputs are provided in the variables passed in the KPI and callable service
invocations, generally through caller-supplied buffers

Data outputs are provided in the variables passed in the KPI and callable service
invocations, generally through caller-supplied buffers

Control Input

Control inputs which control the mode of the module are provided through dedicated

parameters, namely the kernel module plist whose information is supplied to the

module by the kernel module loader.

Control Output

Not Applicable4

Status Output

Status output is provided in return codes and through messages. Documentation for each
KPI lists possible return codes. A complete list of all return codes returned by the C
language KPIs within the module is provided in the header files and the KPI
documentation. Messages are also documented in the KPI documentation.

Table 6 – Ports and interfaces

The module is optimized for library use within the macOS kernel space and does not contain any terminating
assertions or exceptions. It is implemented as a macOS dynamically loadable library. The dynamically
loadable library is loaded into the macOS kernel and its cryptographic functions are made available to macOS
kernel services only. Any internal error detected by the module is reflected back to the caller with an
appropriate return code. The calling macOS kernel service must examine the return code and act accordingly.

The module communicates any error status synchronously through the use of its documented return codes,
thus indicating the module’s status. It is the responsibility of the caller to handle exceptional conditions in a
FIPS 140-3 appropriate manner.

Caller-induced or internal errors do not reveal any sensitive material to callers. Cryptographic bypass
capability is not supported by the module.

4 The Module does not output control information, and thus has no specified control output interface.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 11 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

4.  Roles, Services and Authentication

The Module supports a single instance of one authorized role, designated as the Crypto-Officer. No support is
provided for multiple concurrent operators or a Maintenance Operator.

The table below lists the services available to the Crypto-Officer:

Role

Service

Input

Crypto-Officer (CO)

Symmetric encryption

Crypto-Officer (CO)

Symmetric decryption

Crypto-Officer (CO)

Key wrapping

Crypto-Officer (CO)

Key unwrapping

AES Key
Plain text data

AES Key
Cipher text data

Key-encryption-key
Key to be wrapped

Key-encryption-key
Wrapped key

Output

Cipher text

Plain text

Wrapped key

Unwrapped key

Crypto-Officer (CO)

Secure Hashing

Message

Message digest

Crypto-Officer (CO)

Message Authentication Code
(MAC) Generation

message, MAC key, MAC
algorithm

Message Authentication Code

Crypto-Officer (CO)

Message Authentication Code
(MAC) Verification

MAC, message, HMAC key,
MAC algorithm

pass/fail result

Crypto-Officer (CO)

Generate asymmetric key pair

Crypto-Officer (CO)

Generate digital signature

Random numbers, domain
parameters

private key, message, hash
function

Public/private key pair

Digital signature

Crypto-Officer (CO)

Verify digital signature

public key

True or False

Crypto-Officer (CO)

Generate random number

entropy, seed, V and key
values

random bit-string

Crypto-Officer (CO)

Derive key via KBKDF

KBKDF Key Derivation Key

Derived key

Crypto-Officer (CO)

Zeroise symmetric keys

Crypto-Officer (CO)

Zeroise asymmetric keys

Handler of symmetric crypto
function context

Handler of asymmetric crypto
function context

Released memory space

Released memory space

Crypto-Officer (CO)

Zeroise hash

Handler of hash context

Released memory space

Crypto-Officer (CO)

Self-test

Crypto-Officer (CO)

Show status

Crypto-Officer (CO)

Show module info

Instantiation

KPI invocation

KPI invocation

Status

Operational / error status

Module base name
Module version

Table 7 – Roles, Services, Input and Output

4.1  Authentication
FIPS 140-3 does not require an authentication mechanism for level 1 modules. Therefore, the module does
not implement an authentication mechanism for Crypto Officer. The Crypto Officer role is authorized to
access all services provided by the module (see Table 8 – Approved services and Table 9 – Non-approved
services below).

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 12 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

4.2  Services
The module implements a dedicated KPI function to indicate if a requested service utilizes an approved
security function. For services listed in Table 8 – Approved services, the indicator function returns 1. For
services listed in Table 9 – Non-approved services, the indicator function returns 0.

The table below lists all approved services that can be used in the approved mode of operation. The
abbreviations of the access rights to keys and SSPs have the following interpretation:

G = Generate: The module generates or derives the SSP.

R = Read: The SSP is read from the module (e.g., the SSP is output).

W = Write: The SSP is updated, imported, or written to the module.

E = Execute: The module uses the SSP in performing a cryptographic operation.

Z = Zeroise: The module zeroises the SSP.

N/A= The service does not access any SSP during its operation

Service

Description

ECDSA key pair
generation

Generate a
public/private key
pair

ECDSA signature
generation

Generate a digital
signature

ECDSA signature
verification

Verify a digital
signature

Approved
Security
Functions

ECDSA5
CKG

Keys and/or SSPs

Roles

Access rights
to Keys
and/or SSPs

Indicator

ECDSA key pair

CO

GR

ECDSA

ECDSA private key

CO

RE

ECDSA

ECDSA public key

CO

RWE

Derive key via
KBKDF

Derive keys

KBKDF

Key wrapping

Perform key wrapping  AES-KW

Key unwrapping

Perform key
unwrapping

AES-KW

Hashing

Compute a message
digest

SHA-1
SHA2-224
SHA2-256
SHA2-384
SHA2-512
SHA2-512/256

MAC Generation

MAC Verification

RSA key pair
generation

Compute a message
authentication code

Verify a message
authentication code

Generate a
public/private key
pair

RSA signature
generation

Generate a digital
signature

HMAC

HMAC

RSA6
CKG

RSA

KBKDF Key
derivation key
KBKDF Derived key

AES Key-encrypting
key

AES Key-encrypting
key

N/A

HMAC key

HMAC key

RSA key pair

CO

CO

CO

CO

CO

CO

CO

WE

GRE

WE

WE

N/A

WE

WE

GR

RSA private key

CO

RE

1

1

1

1

1

1

1

1

1

1

1

5 In accordance with Section 4 and 5.1 of NIST [SP 800-133r2] (CKG), the module uses its approved DRBG to generate random bits
and seeds used to generate asymmetric keys. Each generated seed is an unmodified output from the DRBG.
6 In accordance with Section 4 and 5.1 of NIST [SP 800-133r2] (CKG), the module uses its approved DRBG to generate random bits
and seeds used to generate asymmetric keys. Each generated seed is an unmodified output from the DRBG.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 13 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

RSA signature
verification

Verify a digital
signature

RSA

RSA public key

Random number
generation

Generate a random
number

CTR_DRBG

Self-test

Perform pre-
operational and
algorithm self-test

N/A

Show status

Return module status  N/A

Show module
info

Symmetric
encryption

Return module name
and versioning
information

N/A

Encrypt plaintext data  AES-CBC
AES-CCM
AES-CFB128
AES-CFB8
AES-CTR
AES-ECB
AES-OFB
AES-GCM
XTS-AES

Symmetric
decryption

Decrypt ciphertext
data

Zeroise
symmetric keys

Release all resources
of symmetric crypto
function context

AES-CBC
AES-CCM
AES-CFB128
AES-CFB8
AES-CTR
AES-ECB
AES-OFB
AES-GCM
XTS-AES

N/A

Zeroise
asymmetric keys

Release of all
resources of
asymmetric crypto
function context

N/A

Zeroise hash

Release all resources
of hash context

N/A

CO

CO

RWE

Input: WE
Seed: GE
V: GE
Key: GE

CO

N/A

1

1

1

CO

CO

N/A

N/A

N/A

N/A

CO

WE

1

DRBG entropy input
DRBG seed
DRBG 'V' value
DRBG 'Key' value

N/A

N/A

N/A

AES Key
AES GCM key
AES XTS key

AES Key
AES GCM key
AES XTS key

CO

WE

1

CO

Z

AES Key
AES GCM key
AES XTS key
AES Key-encrypting
key
KBKDF Key
derivation key
KBKDF Derived key

RSA key pair
ECDSA key pair

CO

HMAC key

CO

Z

Z

1

1

1

Table 8 – Approved services

The table below lists all non-Approved services that can only be used in the non-Approved mode of operation.

Service

Description

Algorithms Accessed

Role

Indicator

Key Encapsulation

Perform key wrapping

RSA encrypt

Key Decapsulation

Perform key unwrapping

RSA decrypt

EdDSA/X25519 key pair
generation

Generate a public/private key pair
Curve: Ed25519 and Curve25519

EdDSA KeyGen
X25519 KeyGen

CO

CO

CO

0

0

0

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 14 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

EdDSA signature
generation

EdDSA signature
verification

Generate a digital signature
Curve: Ed25519

Verify a digital signature
Curve: Ed25519

EdDSA SigGen

EdDSA SigVer

X25519 key agreement

Perform key agreement

X25519 Key agreement

ECDSA key pair
generation

ECDSA signature
generation

ECDSA Signature
verification

Generate a public/private key pair
Curve: P-192

Generate a digital signature
Curve: P-192

Verify a digital signature
Curve: P-192

ECDSA

ECDSA

ECDSA

RSA key pair generation  Generate a public/private key pair

ANSI X9.31

RSA signature
generation

RSA Signature
verification

Key Derivation

Key Derivation

Key Derivation

Generate MAC

Key size < 2048

Generate a digital signature
Key size < 2048

Verify a digital signature
Key size < 1024

Hash-based key derivation
Per: ANSI X9.63

Hash-based key derivation
Per: SP 800-56C HKDF

Hash-based key derivation
Per: RFC6637

PKCS#1 v1.5
PSS

PKCS#1 v1.5
PSS

SHA-1

SHA-256

SHA-256, SHA-512, AES-128, AES-256

Compute a message authentication
code

OMAC

Hashing

Compute a message digest

MD2, MD4, MD5, RIPEMD

Symmetric encryption

Perform symmetric data encryption

Symmetric decryption

Perform symmetric data decryption

Triple-DES, Blowfish, CAST5, DES, ECIES,
RC2, RC4

Triple-DES, Blowfish, CAST5, DES, ECIES,
RC2, RC4

Table 9 – Non-approved services

CO

CO

CO

CO

CO

CO

CO

CO

CO

CO

CO

CO

CO

CO

CO

CO

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

0

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 15 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

5.  Software/Firmware Security

5.1

Integrity Techniques

The Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1], which is made up of a single component, is
provided in the form of binary executable code. A software integrity test is performed on the runtime image
of the module. The HMAC-SHA2-256 implemented in the module is used as an approved algorithm for the
integrity test. If the test fails, the module enters an error state where no cryptographic services are provided
and data output is prohibited. In this state the module is not operational.

5.2  On Demand Integrity Test

Integrity tests are performed as part of the Pre-Operational Self-Tests. The software integrity test is
automatically executed at power-on. It can also be invoked by self-test service or powering-off and reloading
the module.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 16 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

6.  Operational Environment

6.1  Applicability

The Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1] operates in a modifiable operational
environment per FIPS 140-3 level 1 specifications. The module is supplied as part of macOS, a commercially
available general-purpose operating system executing on the computing platforms specified in section 2.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 17 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

7.  Physical Security

The FIPS 140-3 physical security requirements do not apply to the Apple corecrypto Module v13.0 [Intel,
Kernel, Software, SL1] since it is a software module.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 18 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

8.  Non-invasive Security

Currently, the ISO/IEC 19790:2012 non-invasive security area is not required by FIPS 140-3 (see NIST SP
800-140F). The requirements of this area are not applicable to the module.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 19 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

9.  Sensitive Security Parameter Management

The following table summarizes the keys and Sensitive Security Parameters (SSPs) that are used by the
cryptographic services implemented in the module:

Key/SSP
Name/
Type

AES key

Strength

128 to
256 bits

AES Key-
encrypting key

128 to
256 bits

Security
Function and
Cert. Number

AES (CBC, CCM,
CFB, CTR, ECB, KW,
OFB modes)
A3618 (asm_aesni)
A3619 (asm_x86)
A3620 (c_aesni)
A3621 (c_asm)
A3626 (vng_asm)
A3627 (vng_aesni)

AES-KW
A3620 (c_aesni)
A3621 (c_asm)

Genera-
tion

Import
/Export

Establishm
e-nt

Storage

Zeroisation

N/A

Imported
from kernel

N/A

No export

N/A. The
module
does not
provide
persistent
keys/SSPs
storage.

Automatic
zeroisation
when structure
is deallocated or
when the
system is
powered down

N/A

Imported
from kernel

N/A

AES GCM key

128 to
256 bits

AES (GCM mode)
A3626 (vng_asm)
A3627 (vng_aesni)

N/A

AES XTS key

128 and
256 bits

XTS-AES
A3618 (asm_aesni)
A3619 (asm_x86)

N/A

No export

Imported
from kernel

N/A

No export

Imported
from kernel

N/A

No export

HMAC key

>=112 bits

ECDSA public
key

112 to 256
bits

ECDSA private
key

HMAC-SHA-1
HMAC-SHA-2
A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)
A3628 (vng_intel)

ECDSA
A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

RSA public key

112 to 256
bits

RSA
A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

RSA private
key

N/A

Imported
from kernel

N/A

N/A

N/A

No export

Imported
from or
exported to
kernel

Exported to
kernel

Intermediate
keygen
values are
not output

N/A

N/A

Imported
from or
exported to
kernel

Exported to
kernel.
Intermediate
keygen
values are
not output

The key
pairs are
generated
conformant
to [SP 800-
133r2]
Section 4
(CKG) using
FIPS186-4
Key
Generation
method, and
the random
value used
in the key
generation
is generated
using [SP
800-90Ar1]
DRBG

The key
pairs are
generated
conformant
to [SP 800-
133r2]
Section 4
(CKG) using
FIPS186-4
Key
Generation

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 20 of 33

Use &
related
keys

Symmetric
Encryption
and
Decryption

Key
Wrapping
and
Unwrapping
(KTS)

Symmetric
Encryption
and
Decryption

Symmetric
Encryption
and
Decryption

Generate and
Verify MAC

Signature
verification

Signature
generation

Signature
verification

Signature
generation

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

method, and
the random
value used
in the key
generation
is generated
using [SP
800-90Ar1]
DRBG

Entropy Input
String

256 bits

Random Number
Generation

N/A

256 bits

DRBG Seed,
internal state:
V value and
Key

Internally
generated
as defined
by [SP 800-
90Ar1]

CTR_DRBG
A3620 (c_aesni)
A3621 (c_asm)
A3627 (vng_aesni)

HMAC_DRBG
A3622 (c_avx)
A3623 (c_avx2)
A3624 (c_sse3)

KBKDF Key
derivation key

Min: 112
bits

KBKDF
A3624 (c_sse3)

N/A

KBKDF
Derived key

Min: 112
bits

KBKDF
A3624 (c_sse3)

Generated
via KBKDF

N/A

Imported
from entropy
source

N/A

N/A

Imported
from calling
application

N/A

No export

No import

N/A

Exported to
calling
application

Table 10 – SSPs

Random
Number
Generation

Random
Number
Generation

Key
Derivation

Key
Derivation

9.1  Random Number Generation

A NIST approved deterministic random bit generator based on a block cipher as specified in NIST [SP 800-
90Ar1] is used. The default Approved DRBG used for random number generation is a CTR_DRBG using AES-
256 with derivation function and without prediction resistance. The random numbers used for key
generation are all generated by CTR_DRBG in this module. Per section 10.2.1.1 of [SP 800-90Ar1], the internal
state of CTR_DRBG is the value V and Key.

The module also employs a HMAC_DRBG for random number generation. The HMAC_DRBG is only used at the
early boot time of macOS kernel for memory randomization. The output of HMAC_DRBG is not used for key
generation. Per section 10.1.2.1 of [SP 800-90Ar1], the internal state of HMAC_DRBG is the value V, Key. The
deterministic random bit generators are seeded by “read_random”. The read_random is the Kernel Space
interface. Two entropy sources (one non-physical entropy source and one physical entropy source) residing
within the TOEPP provide the random bits. The output of entropy pool provides 256-bits of entropy to seed
and reseed [SP 800-90Ar1] DRBG during initialization (seed) and reseeding (reseed).

For both Apple Entropy sources tested in the OEs listed in Table 2, the customer does not have the ability to
modify the ES configuration settings (see details in Public Use Document referenced in 3 and 4).

The module also performs DRBG health tests according to section 11.3 of [SP 800-90Ar1].

Entropy source

Minimum number of
bits of entropy

Details

ESV Cert #E14 (physical source)

256

ESV Cert #E110 (non-physical source)

The seed is provided by post-processed entropy data from
two entropy sources. The entropy sources are located within
the physical perimeter of the module but outside the

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 21 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Table 11 – Non-Deterministic Random Number Generation Specification

cryptographic boundary of the module.

9.2  Key / SSP Generation

The module generates Keys and SSPs in accordance with FIPS 140-3 IG D.H. The cryptographic module
performs Cryptographic Key Generation (CKG) for asymmetric keys as per [SP 800-133r2] Section 4 (vendor
affirmed), compliant with [FIPS186-4], and using DRBG compliant with [SP 800-90Ar1]. A seed (the random
value) used in asymmetric key generation is obtained from [SP 800-90Ar1] DRBG. The key generation service
for RSA, ECDSA, as well as the [SP 800-90Ar1] DRBG have been ACVTS tested with algorithm certificates
found in Table 4 – Approved algorithms.

The module also implements KBKDF key derivation according to [SP 800-108r1] to derive symmetric keys.
The module supports both Counter and Feedback modes with HMAC-SHA-1, HMAC-SHA2-224, HMAC-SHA2-
256, HMAC-SHA2-384, or HMAC-SHA2-512 as the pseudo-random function (PRF).

9.3  Key / SSP Establishment

The module provides the following key/SSP establishment related services in the Approved mode:

•  AES Key Wrapping
The module implements a Key Transport Scheme (KTS) using AES-KW compliant to [SP 800-38F], IG D.G. The
SSP establishment methodology provides between 128 and 256 bits of encryption strength.

9.4  Key / SSP Import/Export

All keys and SSPs that are entered from, or output to module, are entered from or output to the invoking
application running on the same device. Keys/SSPs entered into the module are electronically entered in
plain text form. Keys/SSPs are output from the module in plain text form if required by the calling application.

The module allows the output of plaintext CSPs (for example: ECDSA or RSA Key Pairs). To prevent
inadvertent output of sensitive information, the module performs the following two independent internal
actions:

1.  The module will internally request the random number generation service to obtain the random numbers

and verify that the service completed without errors.

2.  Once the keys are generated the module will perform the pairwise consistency test and verify that the

test is completed without errors.

Only after successful completion of both actions, are the generated CSPs output via the KPI output parameter
in plaintext.

9.5  Key / SSP Storage

The Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1] stores ephemeral keys/SSPs in memory
only. They are received for use or generated by the module only at the command of the calling application.
The module does not provide persistent keys/SSPs storage.

The module protects all keys/SSPs through the memory separation and protection mechanisms provided by
the operating system. No process other than the module itself can access the keys/SSPs in its process’
memory.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 22 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

9.6  Key / SSP Zeroisation

Keys and SSPs are zeroised when the appropriate context object is destroyed or when the system is powered
down. Input and output interfaces are inhibited while zeroisation is performed.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 23 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

10.  Self-tests

This section specifies the pre-operational and conditional self-tests performed by the module. The pre-
operational and conditional self-tests ensure that the module is not corrupted and that the cryptographic
algorithms work as expected.

The module does not implement a bypass mode nor security functions critical to the secure operation of the
cryptographic module and thus, does not implement either a pre-operational bypass test or pre-operational
critical functions test.

While the module is executing the self-tests, services are not available and input and output are inhibited. If
the module fails pre-operational or conditional self-tests fail, it will report an error message indicating the
cause of the failure and enters the Error State (See section 10.3). The module permits operators to initiate the
pre-operational or conditional self-tests on demand for periodic testing of the module by rebooting the
system (i.e., power-cycling).

10.1  Pre-operational Software Integrity Test

The module performs a pre-operational software integrity test automatically when the module is loaded into
memory (i.e., at power on) before the module transitions to the operational state. A software integrity test is
performed on the runtime image of the Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1] with
HMAC-SHA2-256 used to perform the approved integrity technique. Prior to using HMAC-SHA-256,
Conditional Cryptographic Algorithm Self-Test (CAST) is performed. If the CAST on the HMAC-SHA-256 is
successful, the HMAC value of the runtime image is recalculated and compared with the stored HMAC value
pre-computed at compilation time.

10.2  Conditional Self-Tests

Conditional self-tests are to be performed by a cryptographic module when the conditions specified for the
following tests occur: Cryptographic Algorithm Self-Test, Pair-Wise Consistency Test.

The module does not implement any functions requiring a Software/Firmware Load Test, Manual Entry Test,
Conditional Bypass Test nor Conditional Critical Functions Test; therefore, these tests are not performed by
the module.

The following sub-sections describe the conditional tests supported by the Apple corecrypto Module v13.0
[Intel, Kernel, Software, SL1].

10.2.1.  Conditional Cryptographic Algorithm Self-Tests

In addition to the pre-operational software integrity test described in Section 10.1, the Apple corecrypto
Module v13.0 [Intel, Kernel, Software, SL1] also runs the Conditional Cryptographic Algorithm Self-Tests
(CAST) for all cryptographic functions of each approved cryptographic algorithm implemented by the module
during power-up as well. All CASTs are performed prior to the first operational use of the cryptographic
algorithm. These tests are detailed in Table 12 – Conditional Cryptographic Algorithm Self-tests below.

Algorithm(s)

HMAC-SHA256

Notes

CAST (KAT) performed prior to module’s integrity test during
POSTs

AES implementations selected by the module for the

Separate encryption / decryption operations are performed

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 24 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

corresponding environment

AES-CCM, AES-GCM, AES-XTS, AES-CBC, AES-ECB, AES-KW using
128-bit key

CTR_DRBG and HMAC_DRBG

Each DRBG mode tested separately

KAT and Health test per NIST [SP 800-90Ar1] Section 11.3

HMAC-SHA-1, HMAC-SHA2-256, HMAC-SHA2-512

KAT

SHA-1, SHA2-256, SHA2-512

Covered by high level HMAC self-test

RSA, 2048-bit modulus with SHA-256

Separate Signature generation/ verification KAT are performed

ECDSA, P-256 curve with SHA-256

Signature generation/verification are performed

KBKDF (counter and feedback modes)

KAT

Table 12 – Conditional Cryptographic Algorithm Self-tests

10.2.2.  Conditional Pairwise Consistency Test

The Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1] does generate RSA and ECDSA asymmetric
keys and performs the required RSA and ECDSA pair-wise consistency tests on the newly generated key pairs.

10.3  Error Handling

If any of the self-tests described in Sections 10.1, 10.2.1 or 10.2.2 fail, the module reports the cause of the
error and enters an error state. In the Error State, no cryptographic services are provided, and data output is
prohibited. The only method to recover from the error state is to power cycle the device which results in the
module being reloaded into memory and reperforming the pre-operational software integrity test and the
Conditional CASTs. The module will only enter into the operational state after successfully passing the pre-
operational software integrity test and the CASTs. The table below shows the different causes that lead to the
Error State and the status indicators reported.

Cause of Error

Error indicator

Failed Pre-operational Software

print statement “FAILED: fipspost_post_integrity” to stdout

Integrity Test

Failed Conditional CAST

print statement “FAILED: <event>” to stdout

(<event> refers to any of the cryptographic functions listed in Table 12 – Conditional
Cryptographic Algorithm Self-tests.)

Failed Conditional PCT

Error code “CCEC_GENERATE_KEY_CONSISTENCY” returned for ECDSA

Error code “CCRSA_GENERATE_KEY_CONSISTENCY” returned for RSA

Table 13 – Error Indicators

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 25 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

11.  Life-cycle Assurance

11.1  Delivery and Operation

The module is built into macOS Ventura v13 and delivered with device. There is no standalone delivery of the
module as a software library.

The vendor's internal development process guarantees that the correct version of module goes with its
intended macOS version. For additional assurance, the module is digitally signed by vendor and it is verified
during the integration into macOS.

This digital signature-based integrity protection during the delivery/integration process is not to be confused
with the HMAC-SHA2-256 based integrity check performed by the module itself as part of its pre-operational
self-tests.

11.2  Crypto Officer Guidance

The Approved mode of operation is configured in the system by default and can only be transitioned into the
non-Approved mode by calling one of the non-Approved services listed in Table 9 – Non-approved services. If
the device starts up successfully, then the module has passed all self-tests and is operating in the Approved
mode.

The ESV Public Use Document (PUD) reference for physical entropy source is:
https://csrc.nist.gov/CSRC/media/projects/cryptographic-module-validation-
program/documents/entropy/E14_PublicUse.pdf

The ESV Public Use Document (PUD) reference for non-physical entropy source is:
https://csrc.nist.gov/CSRC/media/projects/cryptographic-module-validation-
program/documents/entropy/E110_PublicUse.pdf

Apple Platform Certifications guide [platform certifications] and Apple Platform Security guide [SEC] are
provided by Apple which offers IT System Administrators with the necessary technical information to ensure
FIPS 140-3 Compliance of the deployed systems. This guide walks the reader through the system’s assertion
of cryptographic module integrity and the steps necessary if module integrity requires remediation.

The Crypto Officer shall consider the following requirements and restrictions when using the module:

o  AES-GCM IV is constructed in compliance with IG C.H scenario 1. The GCM IV generation follows
RFC 4106 and shall only be used for the IPsec protocol version 3. When the IV in RFC 4106
exhausts the maximum number of possible values for a given security association, either party to
the security association that encounters this condition triggers a rekeying with IKEv2 to establish
a new encryption key for the security association. The module uses RFC 7296 compliant IKEv2 to
establish the shared secret SKEYSEED from which the AES-GCM encryption keys are derived. In
case the module’s power is lost and then restored, the key used for the AES GCM
encryption/decryption shall be re-distributed. This condition is not enforced by the module.
This protocol has not been reviewed or tested by the CAVP and CMVP.

o  AES-XTS mode is only approved for hardware storage applications. The length of the AES-XTS

data unit does not exceed 220 blocks. The module checks explicitly that Key_1 ≠ Key_2 before
using the keys in the XTS-Algorithm to process data with them compliant with IG C.I.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 26 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

12.  Mitigation of Attacks

The module does not claim mitigation of other attacks.

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 27 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Appendix A.

Glossary and Abbreviations

AES

Advanced Encryption Standard

AES-NI

Advanced Encryption Standard New Instructions

CAVP

CAST

Cryptographic Algorithm Validation Program

Cryptographic Algorithm Self-Test

CAST5

A symmetric-key 64-bit block cipher with 128-bit key

CBC

CCM

CFB

Cipher Block Chaining

Counter with Cipher Block Chaining-Message Authentication Code

Cipher Feedback

CMVP

Cryptographic Module Validation Program

CSP

CTR

DRBG

ECB

Critical Security Parameter

Counter Mode

Deterministic Random Bit Generator

Electronic Code Book

ECDSA

Elliptic Curve Digital Signature Algorithm

ESVP

FIPS

GCM

HMAC

KAT

Entropy Source Validation Program

Federal Information Processing Standards

Galois Counter Mode

Hash Message Authentication Code

Known Answer Test

KBKDF

Key Based Key Derivation Function

KDF

KEXT

KW

MAC

KPI

NIST

Key Derivation Function

Kernel Extension

AES Key Wrap

Message Authentication Code

Kernel Programming Interface

National Institute of Standards and Technology

OAEP

Optimal Asymmetric Encryption Padding

OFB

PAA

PCT

PKG

PKV

PRF

PSS

PUD

RSA

SHA

SHS

Output Feedback

Processor Algorithm Acceleration

Pairwise Consistency Test

Key-Pair Generation

Public Key Validation

Pseudo-Random Function

Probabilistic Signature Scheme

Public Use Document (ESVP)

Rivest, Shamir, Adleman

Secure Hash Algorithm

Secure Hash Standard

TOEPP

Tested Operational Environment Physical Perimeter

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 28 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

XTS

XEX Tweakable Block Ciphertext Stealing

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 29 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Appendix B.

References

FIPS140-3

FIPS PUB 140-3 - Security Requirements for Cryptographic Modules
March 2019
https://doi.org/10.6028/NIST.FIPS.140-3

SP 800-140x

CMVP FIPS 140-3 Related Reference
https://csrc.nist.gov/Projects/cryptographic-module-validation-program/fips-140-3-
standards

FIPS140-3_IG

Implementation Guidance for FIPS PUB 140-3 and the Cryptographic Module
Validation Program
https://csrc.nist.gov/Projects/cryptographic-module-validation-program/fips-140-3-ig-
announcements

FIPS140-3_MM

CMVP FIPS 140-3 Draft Management Manual
https://csrc.nist.gov/CSRC/media/Projects/cryptographic-module-validation-
program/documents/fips%20140-3/Draft%20FIPS-140-3-
CMVP%20Management%20Manual%2009-18-2020.pdf

SP 800-140

FIPS 140-3 Derived Test Requirements (DTR)
https://csrc.nist.gov/publications/detail/sp/800-140/final

SP 800-140A

CMVP Documentation Requirements
https://csrc.nist.gov/publications/detail/sp/800-140a/final

SP 800-140B

CMVP Security Policy Requirements
https://csrc.nist.gov/publications/detail/sp/800-140b/final

SP 800-140C

CMVP Approved Security Functions
https://csrc.nist.gov/publications/detail/sp/800-140c/final

SP 800-140D

CMVP Approved Sensitive Security Parameter Generation and Establishment
Methods
https://csrc.nist.gov/publications/detail/sp/800-140d/final

SP 800-140E

CMVP Approved Authentication Mechanisms
https://csrc.nist.gov/publications/detail/sp/800-140e/final

SP 800-140F

CMVP Approved Non-Invasive Attack Mitigation Test Metrics
https://csrc.nist.gov/publications/detail/sp/800-140f/final

FIPS180-4

Secure Hash Standard (SHS)
March 2012
http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 30 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

FIPS186-4

FIPS197

FIPS198-1

PKCS#1

RFC3394

RFC5649

SP 800-38A

SP 800-38C

SP 800-38D

SP 800-38E

SP 800-38F

Digital Signature Standard (DSS)
July 2013
http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf

Advanced Encryption Standard
November 2001
http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf

The Keyed Hash Message Authentication Code (HMAC)
July 2008
http://csrc.nist.gov/publications/fips/fips198-1/FIPS-198-1_final.pdf

Public Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1
February 2003
http://www.ietf.org/rfc/rfc3447.txt

Advanced Encryption Standard (AES) Key Wrap Algorithm
September 2002
http://www.ietf.org/rfc/rfc3394.txt

Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm
September 2009
http://www.ietf.org/rfc/rfc5649.txt

NIST Special Publication 800-38A - Recommendation for Block Cipher Modes of
Operation Methods and Techniques
December 2001
http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf

NIST Special Publication 800-38C - Recommendation for Block Cipher Modes of
Operation: the CCM Mode for Authentication and Confidentiality
May 2004
http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf

NIST Special Publication 800-38D - Recommendation for Block Cipher Modes of
Operation: Galois/Counter Mode (GCM) and GMAC
November 2007
http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf

NIST Special Publication 800-38E - Recommendation for Block Cipher Modes of
Operation: The XTS AES Mode for Confidentiality on Storage Devices
January 2010
http://csrc.nist.gov/publications/nistpubs/800-38E/nist-sp-800-38E.pdf

NIST Special Publication 800-38F - Recommendation for Block Cipher Modes of
Operation: Methods for Key Wrapping
December 2012
http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-38F.pdf

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 31 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

SP 800-56Cr2

Recommendation for Key-Derivation Methods in Key-Establishment Schemes
August 2020
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Cr2.pdf

SP 800-57r5

NIST Special Publication 800-57 Part 1 Revision 5 - Recommendation for Key
Management Part 1: General
May 2020
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf

SP 800-67r1

NIST Special Publication 800-67 Revision 1 - Recommendation for the Triple Data
Encryption Algorithm (TDEA) Block Cipher
January 2012
http://csrc.nist.gov/publications/nistpubs/800-67-Rev1/SP-800-67-Rev1.pdf

SP 800-90Ar1

NIST Special Publication 800-90A - Revision 1 - Recommendation for Random
Number Generation Using Deterministic Random Bit Generators
June 2015
http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf

SP 800-90B

SP 800-108

NIST Special Publication 800-90B - Recommendation for the Entropy Sources Used
for Random Bit Generation
January 2018
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90B.pdf

NIST Special Publication 800-108 - Recommendation for Key Derivation Using
Pseudorandom Functions (Revised)
October 2009
http://csrc.nist.gov/publications/nistpubs/800-108/sp800-108.pdf

SP 800-131Ar2  NIST Special Publication 800-131A - Transitioning the Use of Cryptographic

Algorithms and Key Lengths
March 2019
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf

SP 800-132

NIST Special Publication 800-132 - Recommendation for Password-Based Key
Derivation - Part 1: Storage Applications
December 2010
http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf

SP 800-133r2

Recommendation for Cryptographic Key Generation
June 2020
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-133r2.pdf

SP 800-135r1

NIST Special Publication 800-135 Revision 1 - Recommendation for Existing
Application-Specific Key Derivation Functions
December 2011
http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-135r1.pdf

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 32 of 33

Apple corecrypto Module v13.0 [Intel, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

MACOS

SEC

macOS

macOS Technical Overview
https://developer.apple.com/macos/

Apple Platform Security Guide
https://support.apple.com/guide/security/welcome/web

Product security certifications for macOS
https://support.apple.com/HT201159

© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirety without revision.
Page 33 of 33

