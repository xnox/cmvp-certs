Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

FIPS 140-3 Non-Proprietary Security Policy

Document Version 1.2

July 30, 2025

Prepared for:

Prepared by:

Keysight Technologies
8310 N. Capital of Texas Hwy
Bldg. 2, Suite 300
Austin, TX 78731
keysight.com

KeyPair Consulting Inc.
987 Osos Street
San Luis Obispo, CA 93401
+1 805.316.5024
keypair.us

Copyright © 2025 Keysight Technologies
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Table of Contents

2

1

1.1

3
4

Introduction ............................................................................................................................................................................................................. 4
Confirming the Module Checksum, Functionality, and Versioning ................................................................................................................................ 4
Cryptographic Module Specification ......................................................................................................................................................................... 5
Basic Enforcement ........................................................................................................................................................................................................ 14
2.1
Enforcement and Guidance for GCM IVs ...................................................................................................................................................................... 15
2.2
Enforcement and Guidance for use of the Approved PBKDF ....................................................................................................................................... 16
2.3
2.4
Rules for setting the N and the S String in cSHAKE ...................................................................................................................................................... 16
2.5  Guidance for the use of Format-Preserving Encryption ............................................................................................................................................... 17
Cryptographic Key Generation ..................................................................................................................................................................................... 17
2.6
Cryptographic Module Interfaces ........................................................................................................................................................................... 17
Roles, Services, and Authentication ....................................................................................................................................................................... 18
4.1
Basic Guidance ............................................................................................................................................................................................................. 18
4.2  Assumption of Roles ..................................................................................................................................................................................................... 19
Services ......................................................................................................................................................................................................................... 19
4.3
Software/Firmware Security .................................................................................................................................................................................. 25
5
6  Operational Environment ....................................................................................................................................................................................... 25
6.1  Use of External RNG ..................................................................................................................................................................................................... 25
6.2  Additional Enforcement with a Java SecurityManager ................................................................................................................................................ 25
6.3  Approved Mode Configuration ..................................................................................................................................................................................... 26
6.4  Guidance for the use of DRBGs and Configuring the JVM's Entropy Source ................................................................................................................ 27
Physical Security .................................................................................................................................................................................................... 27
7
8  Non-Invasive Security ............................................................................................................................................................................................ 27
Sensitive Security Parameter Management ............................................................................................................................................................ 27
9
RBG Entropy Sources .................................................................................................................................................................................................... 33
10  Self-tests ................................................................................................................................................................................................................ 33
10.1  Pre-Operational Self-Tests ............................................................................................................................................................................................ 33
10.2  Conditional Self-Tests ................................................................................................................................................................................................... 33
10.3  Error Handling .............................................................................................................................................................................................................. 35
11  Life-Cycle Assurance ............................................................................................................................................................................................... 35
12  Mitigation of Other Attacks Policy .......................................................................................................................................................................... 36
Appendix: References and Definitions ........................................................................................................................................................................... 37

9.1

Page 2 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

List of Tables
Table 1. Security Levels ................................................................................................................................................................................................................. 4
Table 2. Tested Operational Environments ................................................................................................................................................................................... 6
Table 3. Vendor Affirmed Operational Environments ................................................................................................................................................................... 6
Table 4. Approved Algorithms ....................................................................................................................................................................................................... 8
Table 5. Non-Approved Algorithms Allowed in the Approved Mode of Operation with No Security Claimed .......................................................................... 11
Table 6. Non-Approved Algorithms Not Allowed in the Approved Mode of Operation ............................................................................................................. 12
Table 7. Ports and Interfaces ....................................................................................................................................................................................................... 17
Table 8. Roles, Service Commands, Input and Output ................................................................................................................................................................ 18
Table 9. Roles and Authentication .............................................................................................................................................................................................. 19
Table 10. Approved Services ....................................................................................................................................................................................................... 20
Table 11. Non-Approved Services ............................................................................................................................................................................................... 24
Table 12. SSPs .............................................................................................................................................................................................................................. 28
Table 13. Non-Deterministic Random Number Generation Specification .................................................................................................................................. 33

List of Figures
Figure 1. Cryptographic Boundary ................................................................................................................................................................................................ 5

Page 3 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Introduction

1
This document defines the Security Policy for the Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility, hereafter denoted the module. The
module is a cryptographic library and has a Multi-Chip Stand Alone embodiment. The module meets FIPS 140-3 overall Level 1 requirements. The SW version
is 2.0.0.

The FIPS 140-3 security levels for the module are given in Table 1 as follows:

ISO/IEC 24759
Section 6. Number

Table 1. Security Levels

FIPS 140-3 Section Title

1

2

3

4

5

6

7

8

9

10

11

12

General

Cryptographic Module Specification

Cryptographic Module Interfaces

Roles, Services, and Authentication

Software/Firmware Security

Operational Environment

Physical Security

Non-Invasive Security

Sensitive Security Parameter Management

Self-Tests

Life-Cycle Assurance

Mitigation of Other Attacks

Security
Level

1

1

1

1

1

1

N/A

N/A

1

1

1

1

1.1  Confirming the Module Checksum, Functionality, and Versioning

The module checksum, functionality, and versioning can be confirmed by executing the command:

java ‐cp bc‐fips‐2.0.0.jar org.bouncycastle.util.DumpInfo

which should display:

Version Info: BouncyCastle Security Provider (FIPS edition) v2.0.0
FIPS Ready Status: READY
Module SHA‐256 HMAC: 164c8ae41945cb85fdc65666fc4de7301a65d29659ecd455ee5199c7d42d107e

Indicating the jar represents the software release 2.0.0, that it has successfully passed all its startup tests, and that the software release is confirmed to have
a HMAC of:

164c8ae41945cb85fdc65666fc4de7301a65d29659ecd455ee5199c7d42d107e

Page 4 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

2  Cryptographic Module Specification
The module is intended for use by US Federal agencies and other markets that require a FIPS 140-3 validated Cryptographic Library. The module is of type
software and the module has a Multi-Chip Stand Alone embodiment; the cryptographic boundary is the Java Archive (JAR) file, bc-fips2.0.0.jar.

This module is the only software component within the Cryptographic Boundary and the only software component that carries out cryptographic functions
covered by FIPS 140-3. Figure 1 shows the logical relationship of the cryptographic module to the other software and hardware components of the computer.
The BC classes are executed on the Java Virtual Machine (JVM) using the classes of the Java Runtime Environment (JRE). The JVM is the interface to the
computer’s Operating System (OS) that is the interface to the various physical components of the computer.

Figure 1. Cryptographic Boundary

Page 5 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

The cryptographic module was tested on the following operational environments on the general-purpose computer (GPC) platforms detailed in Table 2,
which is also the TOEPP (Tested Operational Environment’s Physical Perimeter) of the module.

#

1

Operating System

Hardware Platform

Processor

PAA/Acceleration

NVOS 6.7 with Java SE Runtime Environment v8 (1.8)

Vision ONE

Intel i7 3555LE (Ivy Bridge)

Without PAA

Table 2. Tested Operational Environments

The cryptographic module will remain compliant with the FIPS 140-3 validation when operating on any general-purpose computer (GPC) provided that:

1)  No source code has been modified.

2)  The GPC uses the specified single-user platform, or another compatible single-user platform such as one of the Java SE Runtime Environments listed on

any of the following:

Table 3. Vendor Affirmed Operational Environments

#
1

2

3

4

5

6

7

8

9

Operating System
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
AppStack release 4.16.0 (requires NPB release 6.8.0) and later running Debian version 12.5 with
Java SE Runtime Environment v17 (1.17) container on MakoOS v2.1.1 and later

SecureStack release 2.13.0 (requires NPB release 6.8.0) and later running Debian version 12.5
with Java SE Runtime Environment v11 (1.11) container on MakoOS v2.1.1 and later

10

Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)

Hardware Platform
Vision Edge 40 Network Packet Broker (NPB) with Intel x86
Atom® (Rangely) C2538 processor
Vision 7712 NPB with Intel x86 Atom® (Rangely) C2538 processor

Vision 5812 NPB with Intel x86 Atom® (Rangely) C2538 processor

Vision Edge 100 NPB with Intel Xeon D-1518 (Broadwell)
processor
Vision Edge 50 NPB with Intel Xeon D-1518 (Broadwell) processor

Vision 7816 NPB with Intel Xeon D-1518 (Broadwell) processor

Vision ONE NPB with Intel i7 3555LE (Ivy Bridge) processor

Vision ONE NPB with Intel i7 3555LE (Ivy Bridge) processor,
including Visibility Application Module with Intel Xeon E5-2695
(Broadwell)
Vision ONE NPB with Intel i7 3555LE (Ivy Bridge) processor,
including Visibility Application Module with Intel Xeon E5-2695
(Broadwell)
Vision X NPB with Intel Xeon D-1527 (Broadwell-DE) processor

Page 6 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

#
11

12

13

14

15

16

17

18

19

20

21

22

23

Operating System
AppStack release 4.18.0 (requires NPB release 6.9.0) and later running Debian version 12.5 with
Java SE Runtime Environment v11 (1.11) container on MakoOS v2.1.1 and later

SecureStack release 2.13.0 (requires NPB release 6.8.0) and later running Debian version 12.5
with Java SE Runtime Environment v11 (1.11) container on MakoOS v2.1.1 and later

Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.0 and later on Yocto poky-scarthgap (v5.0.x) with Java SE Runtime
Environment v8 (1.8)
Vision NPB release 6.7.1 and later on Ubuntu version 22.04 LTS (Jammy Jellyfish) with Java SE
Runtime Environment v8 (1.8)
Vision NPB release 6.7.1 and later on Ubuntu version 22.04 LTS (Jammy Jellyfish) with Java SE
Runtime Environment v8 (1.8)
AppStack release 4.18.0 (requires NPB release 6.9.0) and later running on Debian 12.5 with Java
SE Runtime Environment v17 (1.17) container
SecureStack release 2.13.0 (requires NPB release 6.8.0) and later running on Debian 12.5 with
Java SE Runtime Environment v11 (1.11) container
Vision NPB release 6.7.1 and later on Ubuntu version 22.04 LTS (Jammy Jellyfish) with Java SE
Runtime Environment v8 (1.8)
Vision NPB release 6.7.1 and later on Ubuntu version 22.04 LTS (Jammy Jellyfish) with Java SE
Runtime Environment v8 (1.8)
Vision NPB release 6.9.0 and later on Ubuntu version 22.04 LTS (Jammy Jellyfish) with Java SE
Runtime Environment v8 (1.8)
AppStack release 4.18.0 (requires NPB release 6.9.0) and later running on Debian 12.5 with Java
SE Runtime Environment v17 (1.17) container
SecureStack release 2.14.0 (requires NPB release 6.9.0) and later running on Debian 12.5 with
Java SE Runtime Environment v11 (1.11) container

Hardware Platform
Vision X NPB with Intel Xeon D-1527 (Broadwell-DE) processor,
including MVX-AM4PC module with Intel Xeon-D 2718NT
(Skylake-D)
Vision X NPB with Intel Xeon D-1527 (Broadwell-DE) processor,
including MVX-AM4PC module with Intel Xeon-D 2718NT
(Skylake-D)
TradeVision NPB with Intel i7 3555LE (Ivy Bridge) processor

Vision Edge 10S NPB with Intel Celeron 3965U (Kaby Lake)
processor
Vision 9516 NPB with Intel Pentium D-1517 (Broadwell)
processor
Vision 400 NPB with Intel Xeon Silver 4314 (Icelake-SP) processor

Vision 400 NPB with Intel Xeon Silver 4314 (Icelake-SP) processor

Vision 400 NPB with Intel Xeon Silver 4314 (Icelake-SP) processor

Vision Edge 400S NPB with Intel Xeon D-1714) (Icelake-D)
processor
Vision Edge 400P NPB with Intel Xeon D-1627 (Hewitt Lake)
processor
Vision 400XT NPB with Intel Xeon Gold 6338N (Icelake-D)
processor
Vision 400XT NPB with Intel Xeon Gold 6338N (Icelake-D)
processor
Vision 400XT NPB with Intel Xeon Gold 6338N (Icelake-D)
processor

For the avoidance of doubt, it is hereby stated that the CMVP makes no statement as to the correct operation of the module or the security strengths of the
generated keys when so ported if the specific operational environment is not listed on the validation certificate.

The module implements the Approved and Non-Approved but Allowed cryptographic functions with no security claimed listed in Table 4 and Table 5 below.
There  are  algorithms,  modes,  and  keys  that  have  been  CAVP  tested  but  not  used  by  the  module.  Only  the  algorithms,  modes/methods,  and  key
lengths/curves/moduli shown in this table are used by the module. The module supports both Approved and Non-Approved mode of operation. Please see
Section 6.3 for configuration of the module in Approved mode of operation. Please see Section 11 for initialization steps.

Page 7 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Table 4. Approved Algorithms

CAVP Cert
A7176

A7176

A7176

A7176

A7176

A7176

A7176

A7176

A7176

Algorithm and Standard
AES
[FIPS 197, SP 800-38A], AESFF1
Format Preserving Encryption [SP
800-38G]
AES-CBC Ciphertext Stealing (CS)
[Addendum to SP 800-38A, Oct
2010]
CCM
[SP 800-38C]
CMAC
[SP 800-38B]
GCM/GMAC1
[SP 800-38D]
Counter DRBG
[SP 800-90Ar1]
Hash DRBG
[SP 800-90Ar1]
HMAC DRBG
[SP 800-90Ar1]
DSA2
[FIPS 186-4]

A7176

ECDSA
[FIPS 186-4]

A7176

KDA-HKDF
[SP 800-56C-rev2]

Mode/Method
ECB, CBC, OFB, CFB8,
CFB128, CTR, FF1

CBC-CS1, CBC-CS2,
CBC-CS3

N/A

AES

N/A

N/A

N/A

N/A

N/A

N/A

N/A

Description / Key Sizes(s) / Key Strength(s)
Key sizes: 128, 192, 256 bits

Use / Function
Encryption, Decryption

Key sizes: 128, 192, 256 bits

Encryption, Decryption

Key sizes: 128, 192, 256 bits

Generation, Authentication

Key sizes: AES with 128, 192, 256 bits

Generation, Authentication

Key sizes: 128, 192, 256 bits

Generation, Authentication

AES-128, AES-192, AES-256

SHA sizes: SHA-1, SHA2-224,
SHA2-256, SHA2-384, SHA2-512, SHA2-512/224, SHA2-512/256
SHA sizes: SHA-1, SHA2-224,
SHA2-256, SHA2-384, SHA2-512, SHA2-512/224, SHA2-512/256
Key sizes: 1024, 2048, 3072 bits (1024 only for SigVer)

Curves/Key sizes: P-192*, P-224, P-256, P-384, P-521, K163*,
K-233, K-283, K-409, K-571, B-163*, B-233, B283, B-409, B-571
* Curves only used for Signature Verification and Public Key Validation

PRFs: HMAC SHA-1, HMAC SHA-224, HMAC SHA-256,
HMAC SHA-384, HMAC SHA-512, HMAC SHA-512/224,
HMAC SHA-512/256, HMAC SHA3-224, HMAC SHA3-256,
HMAC SHA3-384, HMAC SHA3-512

AES-CTR DRBG

Hash DRBG

HMAC DRBG

PQG Generation, PQG
Verification,
Key Pair Generation,
Signature Generation,
Signature Verification
Public Key Generation,
Signature Generation,
Signature Verification,
Public Key Validation
Key Derivation

1 GCM encryption with an internally generated IV, see section 2.2 concerning external IVs. IV generation is compliant with IG C.H.
2 DSA signature generation with SHA-1 is only for use with protocols.

Page 8 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

CAVP Cert
A7176

Algorithm and Standard
HMAC
[FIPS 198-1]

Mode/Method
N/A

A7176

KAS-FFC3
[SP 800-56A-rev3]

A7176

KAS-ECC3
[SP 800-56A-rev3]

A7176

KDA, One Step
[SP 800-56C-rev2]

A7176

KDA, Two Step
[SP 800-56C-rev2]

N/A

N/A

N/A

N/A

CVL
A7176

CVL
A7176

CVL
A7176

KDF, Existing Application-Specific4
[SP 800-135-rev1]
KDF, Existing Application-Specific4
[SP 800-135-rev1]
KDF, Existing Application-Specific4
[SP 800-135-rev1]

N/A

N/A

N/A

Description / Key Sizes(s) / Key Strength(s)
SHA sizes: SHA-1, SHA-224, SHA-256, SHA-384, SHA-512,
SHA-512/224, SHA-512/256, SHA3-224, SHA3-256, SHA3-384,
SHA3-512
Domain Parameter Generation
Methods/Scheme: ffdhe2048, ffdhe3072, ffdhe4096,
ffdhe6144, ffdhe8192, MODP-2048, MODP-3072, MODP-4096,
MODP-6144, MODP-8192
dhHybrid1, MQV2, dhEphem, dhHybrid, OneFlow, MQV1,
dhOneFlow, dhStatic
Groups specified above providing between 112 and 200 bits of
encryption strength
Domain Parameter Generation
Methods/Scheme: P-224, P-256, P-384, P-521,K-233, K283,
K-409, K-571, B-233, B-283, B-409, B-571
ephemeralUnified, fullMqv, fullUnified, onePassDh,
onePassMqv, onePassUnified, staticUnified
Curves specified above providing between 112 and 256 bits of
encryption strength
PRFs: SHA-1, SHA-224, SHA-256, SHA-384, SHA-512,
SHA-512/224, SHA-512/256, SHA3-224, SHA3-256, SHA3-384,
SHA3-512, HMAC SHA-1, HMAC SHA-224, HMAC SHA-256,
HMAC SHA-384, HMAC SHA-512, HMAC SHA-512/224,
HMAC SHA-512/256, HMAC SHA3-224, HMAC SHA3-256,
HMAC SHA3-384, HMAC SHA3-512, KMAC-128, KMAC-256
PRFs: HMAC SHA-1, HMAC SHA-224, HMAC SHA-256,
HMAC SHA-384, HMAC SHA-512, HMAC SHA-512/224,
HMAC SHA-512/256, HMAC SHA3-224, HMAC SHA3-256,
HMAC SHA3-384, HMAC SHA3-512, KMAC-128, KMAC-256
TLS v1.0/1.1 KDF
SHA sizes: SHA2-256, SHA2-384, SHA2-512
TLS 1.2 KDF
SHA sizes: SHA2-256, SHA2-384, SHA2-512
SNMP KDF
Password Length: 64, 8192

Use / Function
Generation, Authentication

Key Agreement

Key Agreement

Key Derivation

Key Derivation

Key Derivation

Key Derivation

Key Derivation

3 Keys are not established directly into the module using the key agreement algorithms.
4 No parts of the protocols (TLS, SSHv2, X9.63, IKEv2, SRTP, SNMPv3), other than the approved cryptographic algorithms and the KDFs, have been reviewed or tested by the CAVP and CMVP.

Page 9 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

CAVP Cert
CVL
A7176

CVL
A7176

CVL
A7176

CVL
A7176
A7176

A7176

A7176

A7176

A7176

A7176

A7176

CVL
A7176

Algorithm and Standard
KDF, Existing Application-Specific4
[SP 800-135-rev1]
KDF, Existing Application-Specific4
[SP 800-135-rev1]

KDF, Existing Application-Specific4
[SP 800-135-rev1]
KDF, Existing Application-Specific4
[SP 800-135-rev1]
KDF, Password-Based
[SP 800-132]

KDF, using Pseudorandom
Functions5
[SP 800-108-rev1]

Key Wrapping Using Block
Ciphers6
[SP 800-38F]
RSA
[FIPS 186-4, ANSI X9.31-1998 and
PKCS #1 v2.1 (PSS and PKCS1.5)]
RSA
[FIPS 186-4, ANSI X9.31-1998 and
PKCS #1 v2.1 (PSS and PKCS1.5)]
RSA
[FIPS 186-4, ANSI X9.31-1998 and
PKCS #1 v2.1 (PSS and PKCS1.5)]
RSA
[FIPS 186-2, ANSI X9.31-1998 and
PKCS #1 v2.1 (PSS and PKCS1.5)]
RSA Decryption Primitive

Mode/Method
N/A

N/A

N/A

N/A

N/A

Counter Mode,
Feedback Mode,
Double-Pipeline
Iteration Mode
AES KW, KWP

N/A

N/A

N/A

N/A

N/A

Description / Key Sizes(s) / Key Strength(s)
SSH KDF
SHA sizes: SHA2-224
X9.63 KDF
SHA sizes: SHA2-224, SHA2-256, SHA2-384, SHA2-512

IKEv2 KDF
SHA sizes:SHA-1, SHA2-224, SHA2-256, SHA2-384, SHA2-512
SRTP KDF

Options: PBKDF with Option 1a
Types: HMAC-based KDF using SHA-1, SHA-224, SHA-256,
SHA-384, SHA-512
Types: CMAC-based KBKDF with AES, HMAC-based KBKDF with
SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA3-224,
SHA3-256, SHA3-384, SHA3-512

Use / Function
Key Derivation

Key Derivation
Can be used along with KAS-
SSC
Key Derivation

Key Derivation

Key Derivation

Key Derivation

Key sizes: 128, 192, 256 bits
(Key establishment methodology providing 128, 192 or 256 bits
of encryption strength)
Key sizes: 2048, 3072, 4096

Key Wrapping

Key Pair Generation

Key sizes: 2048, 3072, 4096

Signature Generation

Key sizes: 1024, 2048, 3072, 4096

Signature Verification

Key sizes: 1024, 1536, 2048, 3072, 4096

Signature Verification

2048

Component Test

5 Note: CAVP testing is not provided for use of the PRFs SHA-512/224 and SHA-512/256. These must not be used in approved mode.
6 Keys are not established directly into the module using key unwrapping.

Page 10 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Algorithm and Standard
RSA Signature Primitive

Mode/Method
N/A

Description / Key Sizes(s) / Key Strength(s)
2048

CAVP Cert
CVL
A7176
A7176

A7176

A7176

A7176

KTS-IFC
[SP 800-56B-rev2, Section 7.2.2]

N/A

KAS-IFC
[SP 800-56B-rev2, Section 7.2.1]

N/A

Safe Primes
[SP 800-56A-rev3]

SHS
[FIPS 180-4]

A7176

SHA-3, SHAKE
[FIPS 202]

A7176

SHA-3 Derived Functions
[SP 800-185]

Vendor
Affirmed IG
D.H

CKG using output from DRBG7
[SP 800-133-rev2]

N/A

N/A

N/A

N/A

N/A

RSA-OAEP with, and without, key confirmation.
Key sizes: 2048, 3072, 4096 providing between 112 and 152 bits
of encryption strength
Key Generation Method: rsakpg2-crt
RSASVE with, and without, key confirmation.
Key sizes: 2048, 3072, 4096 providing between 112 and 152 bits
of encryption strength
Parameter sets: ffdhe2048, ffdhe3072, ffdhe4096, ffdhe6144,
ffdhe8192, MODP-2048, MODP-3072, MODP-4096,
MODP-6144, MODP-8192
SHA sizes: SHA-1, SHA-224, SHA-256, SHA-384, SHA-512,
SHA-512/224, SHA-512/256

SHA3-224, SHA3-256, SHA3-384, SHA3-512, SHAKE128,
SHAKE256

Types: cSHAKE-128, KMAC-128, TupleHash-128, ParallelHash-
128, cSHAKE256, KMAC-256, TupleHash-256, ParallelHash-256

Section 5.1 (Asymmetric from DRBG)
Section 6.1 (Symmetric from DRBG)

Use / Function
Component Test

Key Transport

Key Agreement

Key Generation, Key
Verification

Digital Signature Generation,
Digital Signature Verification,
non-Digital Signature
Applications
Digital Signature Generation,
Digital Signature Verification,
non-Digital Signature
Applications
Digital Signature Generation,
Digital Signature Verification,
non-Digital Signature
Applications
Key Generation

Table 5. Non-Approved Algorithms Allowed in the Approved Mode of Operation with No Security Claimed

Algorithm
MD5 within TLS

Caveat
Allowed per IG 2.4.A, no security claimed

Use / Function
MD5 used within a TLS handshake

7 The resulting key or a generated seed is an unmodified output from a DRBG.

Page 11 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Table 6. Non-Approved Algorithms Not Allowed in the Approved Mode of Operation

Algorithm/Function
AES (non-compliant8)
ARC4 (RC4)

Blowfish

Camellia

CAST5

ChaCha20

ChaCha20-Poly1305

DES
Diffie-Hellman KAS (non-compliant9)
DSA (non-compliant10)
DSTU4145
ECDSA (non-compliant10)
EdDSA

ElGamal

FF3-1

GOST28147

GOST3410-1994

GOST3410-2001

GOST3410-2012

GOST3411

GOST3411-2012-256

GOST3411-2012-512

HMAC-GOST3411

HMAC-MD5

HMAC-RIPEMD128

HMAC-RIPEMD160

HMAC-RIPEMD256

Use/Function

Non-approved modes for AES

ARC4/RC4 stream cipher

Blowfish block cipher

Camellia block cipher

CAST5 block cipher

ChaCha20 stream cipher

AEAD ChaCha20 using Poly1305 as the MAC

DES block cipher

Non-compliant key agreement methods

Non-approved digest signatures using DSA

DSTU4145 EC algorithm

Non-approved digest signatures using ECDSA

Ed25519 and Ed448 signature algorithms

ElGamal key transport algorithm

Format Preserving Encryption – AES FF3-1

GOST-28147 block cipher

GOST-3410-1994 algorithm

GOST-3410-2001 EC algorithm

GOST-3410-2012 EC algorithm

GOST-3411-1994 message digest

GOST-3411-2012 256-bit message digest

GOST-3411-2012 512-bit message digest

GOST-3411 HMAC

MD5 HMAC

RIPEMD128 HMAC

RIPEMD160 HMAC

RIPEMD256HMAC

8 Support for additional modes of operation.
9 Support for additional key sizes and the establishment of keys of less than 112 bits of security strength.
10 Deterministic signature calculation, support for additional digests, and key sizes.

Page 12 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Algorithm/Function

HMAC-RIPEMD320

HMAC-TIGER

HMAC-WHIRLPOOL

HSS

IDEA
KAS11 using SHA-512/224 or SHA-512/256
KBKDF using SHA-512/224 or SHA-512/256 (non-compliant)

LMS

MD5

OpenSSL PBKDF (non-compliant)

PKCS#12 PBKDF (non-compliant)

PKCS#5 Scheme 1 PBKDF (non-compliant)

Poly1305

PRNG X9.31

RC2

RIPEMD128

RIPEMD160

RIPEMD256

RIPEMD320
RSA (non-compliant12)
RSA KTS (non-compliant13)
SCrypt (non-compliant)

SEED

Serpent

SipHash

SHACAL-2

TIGER

Triple-DES

Use/Function

RIPEMD320 HMAC

TIGER HMAC

WHIRLPOOL HMAC

HSS signature scheme (RFC 8708)

IDEA block cipher

Key Agreement using SHA-512/224 and SHA-512/256 based KDFs

PBKDF2 using the PRFs SHA-512/224 and SHA-512/256

LMS signature scheme (RFC 8708)

MD5 message digest

OpenSSL PBE key derivation scheme

PKCS#12 PBE key derivation scheme

PKCS#5 PBE key derivation scheme

Poly1305 message MAC

X9.31 PRNG

RC2 block cipher

RIPEMD128 message digest

RIPEMD160 message digest

RIPEMD256 message digest

RIPEMD320 message digest

Non-compliant RSA signature schemes

Non-compliant RSA key transport schemes

Scrypt using non-compliant PBKDF2

SEED block cipher

Serpent block cipher

SipHash MAC

SHACAL2 block cipher

TIGER message digest

Triple-DES cipher

11 Keys are not directly established into the module using key agreement or transport techniques.
12 Support for additional digests and signature formats, PKCS#1 1.5 key wrapping, support for additional key sizes.
13 Support for additional key sizes and the establishment of keys of less than 112 bits of security strength.

Page 13 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Algorithm/Function

Twofish

WHIRLPOOL

XDH

2.1  Basic Enforcement

Use/Function

Twofish block cipher

WHIRLPOOL message digest

X25519 and X448 key agreement algorithms

The module design corresponds to the module security rules. This section documents the security rules enforced by the cryptographic module to implement
the security requirements of this FIPS 140-3 Level 1 module:

1.  The module shall provide two distinct operator roles: User and Cryptographic Officer.
2.  The module does not provide authentication.
3.  The operator shall be capable of commanding the module to perform the power up self-tests by cycling power or resetting the module.
4.  Power up self-tests do not require any operator action.
5.  Data output shall be inhibited during self-tests, zeroization, and error states. Output related to keys and their use is inhibited until the key concerned has

been fully generated.

6.  Status information does not contain CSPs or sensitive data that if misused could lead to a compromise of the module.
7.  There are no restrictions on which keys or CSPs are zeroized by the zeroization service.
8.  The module does not support concurrent operators.
9.  The module does not have any external input/output devices used for entry/output of data.
10. The module does not enter or output plaintext CSPs from the module’s physical perimeter.
11. The module does not output intermediate key values.

HMAC algorithms specified in the Approved Algorithms table produce truncated versions of the HMAC in question. The right most bits are truncated as per
the NIST SP 800-107 rev1.

When the module is used within the context of Java Security Manager or the system/security property org.bouncycastle.fips.approved_only is set to true,
the module will start in approved mode and non-approved services are not accessible in this mode.

When the module is not used within the context of Java Security Manager, the module will start in a non-approved mode by default.

From non-approved mode to approved mode: It is a combination of granted permission (a) and request to change mode (b):
a.  org.bouncycastle.crypto.CryptoServicesPermission “changeToApprovedModeEnabled”
b.  CryptoServicesRegistrar.setApprovedMode(true)

The CSPs made available in non-approved mode will not be accessible, once the thread transitions into approved mode. The CSPs generated using the non-
approved mode cannot be passed or shared with algorithms operating in approved mode, and vice-versa. This is done by indicating within the class (object),
instantiating the key, as being created in an approved mode or non-approved mode.

Page 14 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Any attempt by a thread within the execution of the module to use the key in an opposite mode will result in an exception being generated by the module.
For example, if an RSA private key has been created in either approved or non-approved mode, then any request to access that key will first need to see if
the thread making the request is in the same mode.

From approved mode to non-approved mode: The module cannot transition from approved mode to non-approved mode. To initiate the module in non-
approved  mode,  either
in  the  context  of  Java  Security  Manager,  or  the  module  should  have  the  permission
“org.bouncycastle.crypto.CryptoServicesPermissionunapprovedModeEnabled” granted by the Java Security Manager.

it  should  not  be  used

2.2  Enforcement and Guidance for GCM IVs

IVs for GCM can be generated randomly, or via a FipsNonceGenerator. Where an IV is not generated within the module the module supports the importing
of GCM IVs.

In approved mode, when a GCM IV is generated randomly, the module enforces the use of an approved DRBG in line with Section 8.2.2 of SP 800-38D.

In approved  mode, when  a GCM IV is  generated using the  FipsNonceGenerator a counter  is used as the basis for the nonce and  the  IV is generated in
accordance with TLS protocol. Rollover of the counter in the FipsNonceGenerator will result in an IllegalStateException indicating the FipsNonceGenerator is
exhausted and, as per IG C.H, where used for TLS 1.2, rollover will terminate any TLS session in process using the current key and the exception can only be
recovered from by using a new handshake and creating a new FipsNonceGenerator.

In approved mode, importing a GCM IV for encryption that originates from outside the module is non-conformant. A service indicator for IV usage is provided
in the module through Java logging. Setting the logging level to Level.FINE for the named logger “org.bouncycastle.jcajce.provider.BaseCipher” will produce
a log message when an IV which may have been produced outside the module and/or not from a compliant source is detected. The log message will be of
the standard form including the detail:

FINE: Passed in GCM nonce detected: <IV value>

where <IV value> is a HEX representation of the IV in use.

Setting  the logging  level to Level.FINER will produce an additional log message for any  GCM IV which is used if the  previous Level.FINE message is  not
activated. Log messages in this case will show the detail as:

FINER: GCM nonce detected: <IV value>

where <IV value> is a HEX representation of the IV in use.

Per IG C.H, in the event module power is lost and restored the consuming application must ensure that any of its AES-GCM keys used for encryption or
decryption are re-distributed.

The AES-GCM Mode falls under:

•

•

IG C.H scenario 2: GCM IV is generated randomly, and the module uses an Approved DRBG that is internal to the module’s boundary. The IV length
is 96 bits.
IG C.H scenario 1 for TLSv1.2 protocol: The module is compatible with TLSv1.2 protocol and supports acceptable AES-GCM ciphersuites from Section
3.3.1 of the SP800-52rev2.

Page 15 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

2.3  Enforcement and Guidance for use of the Approved PBKDF

In line with the requirements for SP 800-132, keys generated using the approved PBKDF must only be used for storage applications. Any other use of the
approved PBKDF is non-conformant.

In approved mode the module enforces that any password used must encode to at least 14 bytes (112 bits) and that the salt is at least 16 bytes (128 bits)
long. The iteration count associated with the PBKDF should be as large as practical.

As the module is a general-purpose software module, it is not possible to anticipate all the levels of use for the PBKDF, however a user of the module should
also note that a password should at least contain enough entropy to be unguessable and also contain enough entropy to reflect the security strength required
for the key being generated. In the event a password encoding is simply based on ASCII a 14 byte password is unlikely to contain sufficient entropy for most
purposes as the standard set of printable characters only allows for as much as 6 bits of entropy per byte, giving a password which for the case of 14 bytes,
yields a key that has been generated using 14 * 6 bits, giving only 84 bits of security, well below what is required for a key with the same level of hardness
as a 112 bit one. Users are referred to Appendix A, “Security Considerations” of SP 800-132 for further information on password, salt, and iteration count
selection.

The iteration count value is provided by the user – and should be appropriate to the way the algorithm is being used (the memory hard augmentation of
PBKDF provided by SCRYPT uses an iteration count of 1), for straight PBKDF with no memory hard support, the iteration count provided by the user should
be at point where the maximum cost bearable by the user carrying out the key derivation in the normal course of usage. To ensure sufficient whitening of
the password in both cases, the module enforces a salt size of 128 bits in approved-only mode.

For users interested in introducing memory hardness as a layer on top of the PBKDF the scrypt augmentation to PBDKF based on HMAC SHA-256 (as described
in RFC 7914) is also available.

2.4  Rules for setting the N and the S String in cSHAKE

The cSHAKE algorithm offers to input string for customizing the output of the cSHAKE function, the Function-Name input (N) and the Customization String
(S).

The Function-Name input (N) is reserved for values specified by NIST and should only be set to the appropriate NIST specified value. Any other use of N is
non-conformant.

The Customization String (S) is available to allow users to customize the cSHAKE function as they wish. The length of S is limited to the available size of a byte
array in the JVM running the module.

Page 16 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

2.5  Guidance for the use of Format-Preserving Encryption

The module supports both FF1 and, in non-approved mode, FF3-1 format preserving encryption. Below shows the parameter constraints applicable to the
module’s implementation.

SP800-38G Format-Preserving Encryption Constraints:

radix
radixminlen
minlen
maxlen
maxTlen

in range of 2..216
>= 1000000
>= 2 octets
< 232 octets
>= 0 octets

in range of 2..216
>= 1000000
2 octets
2 * floor(logradix(296)) octets
8 octets (fixed)

An attempt to use the FF1 or FF3-1 without meeting the radixminlen constraint or by exceeding maxlen will result in an IllegalArgumentException. Note: only
FF1 should be used in approved mode.

2.6  Cryptographic Key Generation

The  module  performs  Cryptographic  Key  Generation  in  conformance  to  FIPS  140-3  IG  D.H.  The  CKG  for  symmetric  keys  and  seeds  used  for  generating
asymmetric keys is performed as per Section 4 of the SP800-133r2 and compliant with FIPS 186-4 and SP800-90Arev1 for DRBG. The seed used in asymmetric
key generation is the direct output of SP800-90Arev1 DRBG.

3  Cryptographic Module Interfaces
The module is a software module, and, therefore, control of the physical ports is outside of the module’s scope. The module does provide a set of logical
interfaces which are mapped to the following FIPS 140-3 defined logical interfaces: data input, data output, control input, status output, and power. When
the module performs self-tests, is in an error state, is generating keys, or performing zeroization, the module prevents all output on the logical data output
interface as only the thread performing the operation has access to the data. The module is single-threaded, and in an error state, the module does not
return any output data, only an error value. The module does not implement control output interface.

The mapping of the FIPS 140-3 logical interfaces to the module is described in Table 7.

Table 7. Ports and Interfaces

Logical Interface  Data that passes over port/interface
Data Input
Data Output
Control Input
Status Output

API input parameters – plaintext and/or ciphertext data.
API output parameters and return values – plaintext and/or ciphertext data.
API method calls – method calls, or input parameters, that specify commands and/or control data used to control the operation of the module.
API output parameters and return/error codes that provide status information used to indicate the state of the module.

Page 17 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

4  Roles, Services, and Authentication

4.1  Basic Guidance

The jar file representing the module needs to be installed in a JVM’s class path in a manner appropriate to its use in applications running on the JVM.

Functionality in the module is provided in two ways. At the lowest level there are distinct classes that provide access to the approved and non-approved
services provided by the module. A more abstract level of access can also be gained using strings providing operation names passed into the module’s Java
cryptography provider through the APIs described in the Java Cryptography Architecture (JCA) and the Java Cryptography Extension (JCE).

When the  module is being used in approved  mode, classes providing implementations of  algorithms which are not  approved, or allowed, are explicitly
disabled.

SSPs such as private and secret keys implement the Destroyable interface. Where appropriate these SSPs can be zeroized on demand by invoking the destroy()
method. The return of the destroy() method indicates that the zeroization is complete.

Roles, with corresponding service with input and output is specified in Table 8 below:

Table 8. Roles, Service Commands, Input and Output

Service
Role
Initialize Module and Run Self-Tests on Demand
CO/User
Show Status
CO/User
Info Service
CO/User
Zeroize / Power-off
CO/User
Data Encryption
CO/User
CO/User
Data Decryption
CO/User  MAC Calculation
CO/User
CO/User
CO/User
CO/User  Message Hashing
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User

Input
N/A
N/A
N/A
N/A
Key, Plaintext
Key, Ciphertext
Key, Message
Key, Message
Key, Message, Signature
N/A
Message
Key, Message
Keyed Message Hashing
TLS Parameters
TLS Key Derivation Function
KDF Parameters
SP 800-108-rev1 KDF
SSH Parameters
SSH Derivation Function
X9.63 Derivation Function
X9.63 Parameters
SP 800-56C-rev2 OneStep/TwoStep Key Derivation Function (KDM)  KDM Parameters
IKEv2 Parameters
IKEv2 Derivation Function

Signature Authentication
Signature Verification
DRBG (SP800-90Arev1) Output

Page 18 of 40

Output
Exception in case of failure
Boolean
Module name and version
Shutdown indication
Ciphertext
Plaintext
MAC
Signature
Boolean
Data
Hash
Hash
Data
Data
Data
Data
Data
Data

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Role
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User

Service
SRTP Derivation Function
PBKDF
Key Agreement Schemes
Key Wrapping
Key Unwrapping
Key Generation
Key Verification
Entropy Callback
DRBG Health-Tests
SSP Export Operation
Utility

4.2  Assumption of Roles

Input
SRTP Parameters
Password, PBKDF Parameters
Key Agreement keys, parameters
Wrapping key, Key
Unwrapping Key, Wrapped key
Key Generation Parameters
Key Pair
N/A
N/A
SSP
N/A

Output
Data
Data
Data
Wrapped key
Key
Key Pair
Boolean
Random bits
N/A
Data
N/A

The module supports two distinct operator roles, User and Cryptographic Officer (CO). The cryptographic module implicitly maps the two roles to the services.
A user is considered the owner of the thread that instantiates the module and, therefore, only one concurrent user is allowed.

Table 9 lists all operator roles supported by the module. The module does not support a maintenance role and/or bypass capability. The module does not
support authentication.

Role
CO
User

Authentication Method
N/A – Authentication not required for Level 1
N/A – Authentication not required for Level 1

Authentication Strength
N/A
N/A

Table 9. Roles and Authentication

4.3  Services

Table 10 lists the services and a description of each service with the usage and roles.

Services in the module are accessed via the public APIs of the jar file. The ability of a thread to invoke non-approved services depends on whether it has
been  registered  with  the  module  as  approved  mode  only.  In  approved  only  mode  no  non-approved  services  are  accessible.  In  the  presence  of  a  Java
SecurityManager approved mode services specific to a context, such as DSA and ECDSA for use in TLS, require specific permissions to be configured in the
JVM configuration by the Cryptographic Officer or User.

In the absence of a Java SecurityManager specific services related to protocols such as TLS are available, however must only be used in relation to those
protocols.

Page 19 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

The modes of access shown in the table are defined as:

•  G = Generate: The module generates or derives the SSP.
•  E = Execute: The module uses the SSP in performing a cryptographic operation.
•  R = Read: The SSP is read from the module (e.g. the SSP is output).
•  W = Write: The SSP is updated, imported, or written to the module.
•  Z = Zeroize: The module zeroizes the SSP.

Service

Description

Approved Security Functions

Keys and/or SSPs

Roles

Table 10. Approved Services

Indicator14

Access rights
to Keys
and/or SSPs

Initialize Module
and Run Self-Tests
on Demand
Show Status

Info Service

Zeroize /
Power-off

Data Encryption

The JRE will call the static
constructor for self-tests on module
initialization.
A user can call FipsStatus.IsReady()
at any time to determine if the
module is ready.
CryptoServicesRegistrar.
IsInApprovedOnlyMode() can be
called to determine the FIPS mode of
operation.
A user can call DumpInfo.main() at
any time to display the module
version, checksum, and status
information.
SSPs can be zeroized on demand by
invoking the destroy() method or
power cycle the module.
Used to encrypt data.

N/A

N/A

N/A

N/A

AES-ECB, AES-CBC, AES-OFB,
AES-CFB8, AES-CFB128,
AES-CTR, AES-CBC-CS, CCM,
GCM, FF1

N/A

N/A

CO/User  N/A

Flag

CO/User  N/A

Flag

N/A

CO/User  N/A

Flag

All SSPs

CO/User

Z

AES Encryption Key

CO/User

E

Flag

Flag

14 Flag is accessed by calling the method CryptoServicesRegistrar.isInApprovedOnlyMode() - this method will return true if the thread is running in approved mode, false otherwise.

Page 20 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Service

Description

Approved Security Functions

Keys and/or SSPs

Roles

Data Decryption

Used to decrypt data.

MAC Calculation

Used to calculate data integrity
codes with CMAC.

AES-ECB, AES-CBC, AES-OFB,
AES-CFB8, AES-CFB128,
AES-CTR, AES-CBC-CS, CCM,
GCM, FF1
CMAC, GMAC

Signature
Authentication

Used to generate signatures (DSA,
ECDSA, RSA).

DSA, ECDSA, RSA

Signature
Verification

DRBG
(SP800-90Arev1)
output

Used to verify digital signatures.

DSA, ECDSA, RSA

Used for random number, IV and key
generation.

Counter DRBG,
Hash DRBG,
HMAC DRBG

Page 21 of 40

Indicator14

Flag

Flag

Flag

Flag

AES Decryption Key

CO/User

Access rights
to Keys
and/or SSPs
E

AES Authentication Key,
HMAC Authentication Key,
KMAC Authentication Key
DSA Signing Key,
EC Signing Key,
RSA Signing Key
DSA Verification Key,
EC Verification Key,
RSA Verification Key
AES Encryption Key,
AES Decryption Key,
AES Authentication Key,
AES Wrapping Key,
DH Agreement Private Key,
DH Agreement Public Key,
DRBG Seed, Internal State V and
C value, and DRBG Key,
DSA Signing Key,
DSA Verification Key,
EC Agreement Private Key,
EC Agreement Public Key,
EC Signing Key,
EC Verification Key,
HMAC Authentication Key,
KMAC Authentication Key,
RSA Signing Key,
RSA Verification Key,
RSA Key Transport Private Key,
RSA Key Transport Public Key
DRBG Seed, Internal State V and
C value, and DRBG Key

CO/User

E

CO/User

E

CO/User

E

CO/User  G

Flag

CO/User

E

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Service

Description

Approved Security Functions

Keys and/or SSPs

Roles

Indicator14

Access rights
to Keys
and/or SSPs

Message Hashing

Used to generate message digest,
SHAKE output.

Keyed Message
Hashing
TLS Key Derivation
Function
SP 800-108-rev1
KDF
SSH Derivation
Function
X9.63 Derivation
Function

Used to calculate data integrity
codes with HMAC and KMAC.
Used to calculate a value suitable to
be used for a master secret in TLS.
Used to calculate a value suitable to
be used for a secret key.
Used to calculate a value suitable to
be used for a secret key.
Used to calculate a value suitable to
be used for a secret key.

SHS, SHA-3, SHAKE, SHA-3
Derived Functions (cSHAKE,
TupleHash, ParallelHash)
HMAC, SHA-3 Derived
Functions (KMAC)
HKDF, KDF, Existing Application-
Specific (TLS KDF)
KBKDF, using Pseudorandom
Functions
Existing Application-Specific
(SSH KDF)
Existing Application-Specific
(X9.63 KDF)

SP 800-56C-rev2
OneStep/TwoStep
Key Derivation
Function (KDM)

IKEv2 Derivation
Function
SRTP Derivation
Function
PBKDF

Used to calculate a value suitable to
be used for a secret key.

HKDF, KDF One Step, KDF Two
Step

Used to calculate a value suitable to
be used for a secret key.
Used to calculate a value suitable to
be used for a secret key.
Used to generate a key using an
encoding of a password and message
hash.

Existing Application-Specific
(IKEv2)
Existing Application-Specific
(SRTP)
KDF, Password-Based

Page 22 of 40

N/A

CO/User  N/A

Flag

HMAC Authentication Key,
KMAC Authentication Key
TLS KDF Secret Value

CO/User

E

CO/User

E

SP800-108-rev1 KDF Secret Value  CO/User

E

SSH KDF Secret Value

CO/User

E

CO/User  G

DH Agreement Private Key,
EC Agreement Private Key,
RSA Signing Key
X9.63 KDF Secret Value
DH Agreement Private Key,
EC Agreement Private Key,
RSA Signing Key
SP800-56C-rev2 KDF Secret Value  CO/User
CO/User
IKEv2 KDF Secret Value

E
CO/User
CO/User  G

E
E

SRTP KDF Secret Value

CO/User

E

HMAC Authentication Key,
KMAC Authentication Key
HMAC Authentication Key,
KMAC Authentication Key,
PBDKF Secret

CO/User  G

CO/User

E

Flag

Flag

Flag

Flag

Flag

Flag

Flag

Flag

Flag

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Service

Description

Approved Security Functions

Keys and/or SSPs

Roles

Indicator14

Access rights
to Keys
and/or SSPs

Key Agreement
Schemes

Used to calculate key agreement
values (SP800-56A-rev3, Diffie-
Hellman).

KAS-FFC, KAS-ECC, KAS-IFC,
SafePrimes

Key Wrapping

Used to encrypt a key value (RSA,
AES).

AES KW, AES KWP, KTS-IFC

Key Unwrapping

Used to decrypt a key value (RSA,
AES)

AES KW, AES KWP, KTS-IFC

Key Generation

Used to generate key pair.

RSA KeyGen, DSA KeyGen,
ECDSA KeyGen, CKG

Key Verification

Used to verify key pair.

ECDSA KeyVer

Entropy Callback

Gathers entropy in a passive manner
from a user-provided function.

DRBG, CKG

DRBG Health-Tests  Used to perform checks of incoming
entropy against Section 4.4 of SP800-
90B.

DRBG

AES Encryption Key,
AES Decryption Key,
AES Authentication Key,
AES Wrapping Key,
HMAC Authentication Key,
KMAC Authentication Key
DH Agreement Private Key,
EC Agreement Private Key,
RSA Key Transport Private Key
AES Wrapping Key,
HMAC Authentication Key,
KMAC Authentication Key,
RSA Key Transport Private Key
AES Wrapping Key,
HMAC Authentication Key,
KMAC Authentication Key,
RSA Key Transport Public Key
DRBG Output,
DSA Signing Key,
DSA Verification Key,
EC Signing Key,
EC Verification Key,
RSA Signing Key,
RSA Verification Key
EC Signing Key,
EC Verification Key
DRBG Seed, Internal State V and
C value, and DRBG Key
N/A

CO/User  G

Flag

CO/User

E

CO/User

E

Flag

CO/User

E

Flag

CO/User

E

Flag

CO/User

E

CO/User  G

CO/User  N/A

Flag

Flag

Flag

Page 23 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Service

Description

Approved Security Functions

Keys and/or SSPs

Roles

Indicator14

Access rights
to Keys
and/or SSPs

SSP Export
Operation

Returns a CSP as data that can be
used for later output.

N/A

Utility

Miscellaneous utility functions, does
not access CSPs.

N/A

AES Encryption Key,
AES Decryption Key,
AES Authentication Key,
AES Wrapping Key,
DH Agreement Private Key,
DH Agreement Public Key,
DSA Signing Key,
DSA Verification Key,
EC Agreement Private Key,
EC Agreement Public Key,
EC Signing Key,
EC Verification Key,
HMAC Authentication Key,
KMAC Authentication Key,
RSA Signing Key,
RSA Verification Key,
RSA Key Transport Private Key,
RSA Key Transport Public Key
N/A

CO/User  R

Flag

CO/User  N/A

Flag

Table 11. Non-Approved Services

Service
Data Encryption
Data Decryption
MAC Calculation
DRBG (SP800-90Arev1) output
Key Agreement Schemes
Key Wrapping
Key Unwrapping

Description
Used to encrypt data
Used to decrypt data
Used to calculate data integrity codes with CMAC
Used for random number, IV and key generation
Used to calculate key agreement values
Used to encrypt a key value (Triple-DES)
Used to decrypt a key value (Triple-DES)

Algorithms Accessed
Triple-DES
Triple-DES
Triple-DES CMAC
ctrDRBG-Triple-DES
Triple-DES
Triple-DES KW
Triple-DES KW

Role
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User
CO/User

Indicator15
Flag
Flag
Flag
Flag
Flag
Flag
Flag

15 Flag is accessed by calling the method CryptoServicesRegistrar.isInApprovedOnlyMode() - this method will return true if the thread is running in approved mode, false otherwise.

Page 24 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

5  Software/Firmware Security
The module type is software. The module has a Multi-Chip Stand Alone embodiment; the cryptographic boundary is the Java Archive (JAR) file, bc-fips-
2.0.0.jar.

Each time the module is powered up, it runs the pre-operational tests to ensure that the integrity of the module has been maintained. Self–tests are available
on demand by power cycling the module.

The integrity is verified using HMAC-SHA2-256. The HMAC of the module JAR file excluding directories and metadata is calculated and compared to the
expected value embedded within the module’s properties. If the calculated value does not match the expected value, the module raises an error and fails to
load. The integrity test can be performed on demand by power cycling the host platform.

CASTs are performed prior to the first use of services related to the test target. CASTs also run periodically on service invocation. Initial CAST self–tests are
available on demand by power cycling the module and then invoking the service related to the test target.

6  Operational Environment
The module operates in a modifiable operational environment under the FIPS 140-3 definitions. The module runs on a GPC running one of the operating
systems specified in the approved operational environment list in Table 2. Each approved operating system manages processes and threads in a logically
separated manner. The module’s user is considered the owner of the calling application that instantiates the module within the process space of the Java
Virtual Machine. The module optionally uses the Java Security Manager and starts in approved mode by default when used with the Java Security Manager.

6.1  Use of External RNG

The  module  makes  use  of  the  JVM's  configured  SecureRandom  entropy  source  to  provide  entropy  when  required.  The  module  will  request  entropy  as
appropriate to the security strength and seeding configuration for the DRBG that is using it and for the default DRBG will request a minimum of 256 bits of
entropy.  In  approved  mode  the  minimum  amount  of  entropy  that  can  be  requested  by  a  DRBG  is  112  bits.  The  module  will  wait  until  the
SecureRandom.generateSeed() returns the requested amount of entropy, blocking if necessary.

The JVMs entropy source can be configured through setting the security property:
securerandom.strongAlgorithms

in the JVM's java.security file.

6.2  Additional Enforcement with a Java SecurityManager

In  the presence of a  Java  SecurityManager approved mode services specific to a context,  such as DSA  and ECDSA for use in TLS, require specific policy
permissions to be configured in the JVM configuration by the Cryptographic Officer or User. The SecurityManager can also be used to restrict the ability of
particular code bases to examine CSPs. See Section 6.3 for further advice.

In the absence of a Java SecurityManager, specific services related to protocols such as TLS are available, however must only be used in relation to those
protocols.

Page 25 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

6.3  Approved Mode Configuration

In default operation the module will start with all algorithms and services enabled.

If the module detects that the system property org.bouncycastle.fips.approved_only is set to true the module will start in approved mode and non-approved
mode functionality will not be available.

If the underlying JVM is running with a Java Security Manager installed the module will be running in approved mode with secret and private key export
disabled. When the module is not used within the context of the Java Security Manager, it will start by default in the non-approved mode.

Use of the module with a Java Security manager requires the setting of some basic permissions to allow the module HMAC-SHA-256 software integrity test
to take place as well as to allow the module itself to examine secret and private keys. The basic permissions required for the module to operate correctly
with a Java Security manager are indicated by a Y:

Available Java Permissions

Permission
RuntimePermission
RuntimePermission
PropertyPermission
SecurityPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission
CryptoServicesPermission

Settings
“getProtectionDomain”
“accessDeclaredMembers”
“java.runtime.name”, “read”
"putProviderProperty.BCFIPS"
“unapprovedModeEnabled”
“changeToApprovedModeEnabled”
“exportSecretKey”
“exportPrivateKey”
“exportKeys”
“tlsNullDigestEnabled”
“tlsPKCS15KeyWrapEnabled”
“tlsAlgorithmsEnabled”
“defaultRandomConfig”
“threadLocalConfig”
“globalConfig”

Req  Usage

Allows checksum to be carried out on jar.
Allows use of reflection API within the provider.

Y
Y
N  Only if configuration properties are used.
N  Only if provider installed during execution.
N  Only if non-approved mode algorithms required.
N  Only if threads allowed to change modes.
To allow export of secret keys only.
N
To allow export of private keys only.
N
Y
Required to be applied for the module itself. Optional for any other codebase.
N  Only required for TLS digest calculations.
N  Only required if TLS is used with RSA encryption.
Enables both NullDigest and PKCS15KeyWrap.
N
Allows setting of default SecureRandom.
N
Required to set a thread local property in the CryptoServicesRegistrar.
N
Required to set a global property in the CryptoServicesRegistrar.
N

The JVM's entropy source is checked according to SP 800-90B, Section 4.4 using the suggest C values for the Repetition Count Test (Section 4.4.1) and the
Adaptive  Proportion  Test  (Section  4.4.2)  by  default.  These  values  can  also  be  configured  by  the  Cryptographic  Officer  using  the  security  property:
“org.bouncycastle.entropy.factors” which takes a comma separated list of C values, one for 4.4.1 and one for 4.4.2, and a value of H.

Page 26 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

6.4  Guidance for the use of DRBGs and Configuring the JVM's Entropy Source

A  user  can  instantiate  the  default  Approved  DRBG  for  the  module  explicitly  by  using  SecureRandom.getInstance("DEFAULT",  "BCFIPS"),  or  by  using  a
BouncyCastleFipsProvider object instead of the provider name as appropriate. This will seed the Approved DRBG from the live entropy source of the JVM
with a number of bits of entropy appropriate to the security strength of the default Approved DRBG configured for the module.

The JVM's entropy source is checked according to SP 800-90B, Section 4.4 using the suggest C values for the Repetition Count Test (Section 4.4.1) and the
Adaptive Proportion Test (Section 4.4.2). These values can also be configured by the user using the security property: “org.bouncycastle.entropy.factors”
which takes a comma separated list of C values, one for 4.4.1 and one for 4.4.2, and a value of H. For the default the property would be set as:
org.bouncycastle.entropy.factors: 4, 13, 8.0

in the java.security property file.

An additional option is available using the Approved Hash_DRBG and the process outlined in SP800 90A, Section 8.6.5. This can be turned on by following
the instructions in Section 2.3 of the User Guide. The two DRBGs are instantiated in a chain as a "Source DRBG" to seed the "Target DRBG" in accordance
with Section 7 of Draft NIST SP 800-90C, where the Target DRBG is the default Approved DRBG used by the module.

The initial seed and the subsequent reseeds for the DRBG chain come from the live entropy source configured for the JVM. The DRBG chain will reseed
automatically by pausing for 20 requests (which will usually equate to 5120 bytes). An entropy gathering thread reseeds the DRBG chain when it has gathered
sufficient entropy (currently 256 bits) from the live entropy source. Once reseeded, the request counter is reset and the reseed process begins again.

The “Source DRBG” in the chain is internal to the module and inaccessible to the user to ensure it is only used for generating seeds for the default Approved
DRBG of the module.

The user shall ensure that the entropy source is configured per Section 6.1 of this Security Policy and will block, or fail, if it is unable to provide the amount
of entropy requested.

7  Physical Security
This section is not applicable as the module is a software module.

8  Non-Invasive Security
This section is not applicable to this module.

9  Sensitive Security Parameter Management
All Sensitive Security Parameters (SSPs) used by the module are described in this section in Table 12. All usage of these SSPs by the module (including all SSP
lifecycle states) is described in the services detailed in Section 4.3. Please note that the module does not perform automatic  SSP establishment, it only
provides the components to the calling application which can be used in SSP establishment.

Page 27 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Establishment  Storage

Zeroisation

Use & related keys

Key/SSP Name/
Type
AES Encryption Key  128, 192, 256

Strength

bits

AES Decryption Key  128, 192, 256

bits

AES Authentication
Key

128, 192, 256
bits

Security Function and
Cert. Number
AES ECB, CBC, OFB,
CFB8, CFB128, CTR,
FF1, CBCCS1, CBCCS2,
CBCCS3, GCM, CKG
A7176
AES ECB, CBC, OFB,
CFB8, CFB128, CTR,
FF1, CBCCS1, CBCCS2,
CBCCS3, GCM, CKG
A7176
AES CMAC, GMAC,
CKG
A7176

Generation

DRBG16

Table 12. SSPs

Import/
Export
Import17,
Export18

N/A

DRBG16

Import17,
Export18

N/A

DRBG16

Import17,
Export18

AES Wrapping Key

128, 192, 256
bits

AES KW, KWP, CKG
A7176

DRBG16

Import17,
Export18

DH Agreement
Private Key

112, 128,
152, 176, 200
bits

KAS-FFC, CKG
A7176

DH Agreement
Public Key

112, 128,
152, 176, 200
bits

KAS-FFC, CKG
A7176

DRBG16

DRBG16

Import17,
Export18

Import17,
Export18

N/A

N/A

N/A

N/A

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle

N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle
destroy()
service call or
host platform
power cycle
destroy()
service call or
host platform
power cycle
Not zeroized,
public key value
known outside
of module

AES encryption19

AES decryption

AES CMAC/GMAC

AES (128/192/256) key
wrapping key for KTS

Diffie-Hellman key
agreement

Diffie-Hellman key
agreement

16 Key generator used in conjunction with an approved DRBG.
17 Import done via key constructor and/or factory (Electronic Entry).
18 Export done via key recovery using getEncoded() method and followed by separate step to export key details as either plaintext or encrypted (Electronic Entry).
19 The AES-GCM key and IV is generated randomly per IG C.H, and the Initialization Vector (IV) is a minimum of 96 bits. In the event module power is lost and restored, the consuming application
must ensure that any of its AES-GCM keys used for encryption or decryption are re-distributed.

Page 28 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Establishment  Storage

Zeroisation

Use & related keys

Key/SSP Name/
Type
DSA Signing Key

Strength

Security Function and
Cert. Number
112, 128 bits  DSA Signature

Generation

DRBG16

DSA Verification
Key

80, 112, 128
bits

Generation, CKG
A7176

DSA Signature
Verification, CKG
A7176

EC Agreement
Private Key

112, 128,
192, 256 bits

KAS-ECC, CKG
A7176

DRBG16

DRBG16

Import/
Export
Import17,
Export18

Import17,
Export18

Import17,
Export18

N/A

N/A

N/A

EC Agreement
Public Key

112, 128,
192, 256 bits

KAS-ECC, CKG
A7176

DRBG16

Import17,
Export18

N/A

EC Signing Key

112, 128,
192, 256 bits

ECDSA Signature
Generation, CKG
A7176

DRBG16

Import17,
Export18

N/A

EC Verification Key  80, 112, 128,
192, 256 bits

ECDSA Signature
Verification, CKG
A7176

DRBG16

Import17,
Export18

N/A

HMAC/KMAC
Authentication Key

112-256 bits

SHA-1, SHA2, SHA3,
KMAC, CKG
A7176

DRBG16

Import17,
Export18

N/A

Page 29 of 40

N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle
Not zeroized,
public key value
known outside
of module
destroy()
service call or
host platform
power cycle

N/A, the module
does not provide
persistent
storage

Not zeroized,
public key value
known outside
of module

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle

N/A, the module
does not provide
persistent
storage

Not zeroized,
public key value
known outside
of module

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle

DSA signature
generation

DSA signature
verification

EC (P-224, P-256, P-384,
P-521, K-233, K-283,
K-409, K571, B-233,
B-283, B-409 and
B-571) key agreement
EC (P-224, P-256, P-384,
P-521, K-233, K-283,
K-409, K571, B-233,
B-283, B-409 and
B-571) key agreement
ECDSA (P-224, P-256,
P-384, P-521, K-233,
K-283, K-409, K-571,
B-233, B-283, B-409
and B-571) signature
generation
ECDSA (P-192, P-224,
P-256, P-384, P-521,
K-163, K-233, K-283,
K-409, K-571, B-163,
B-233, B-283, B-409
and B-571) signature
verification
Keyed-Hash calculation
(SHA-1, SHA2, SHA-3,
KMAC)

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Establishment  Storage

Zeroisation

Use & related keys

Key/SSP Name/
Type
RSA Signing Key

Strength

112, 128, 152
bits

Security Function and
Cert. Number
RSA Signature
Generation, CKG
A7176

Generation

DRBG16

RSA Verification
Key

80, 112, 128,
152 bits

RSA Signature
Verification, CKG
A7176

RSA Key Transport
Private Key20

112, 128, 152
bits

KTS-IFC, CKG
A7176

RSA Key Transport
Public Key20

112, 128, 152
bits

KTS-IFC, CKG
A7176

DRBG16

DRBG16

DRBG16

Import/
Export
Import17,
Export18

Import17,
Export18

Import17,
Export18

Import17,
Export18

N/A

N/A

N/A

N/A

IKEv2 KDF Secret
Value

112, 128,
192,
256 bits

KDF IKEv2
A7176

PBKDF Secret Value  112-256 bits

PBKDF
A7176

SP 800-56C-rev2
OneStep/TwoStep
KDF Secret Value

112, 128,
192, 256 bits

SP 800-108-rev1
KDF Secret Value

112, 128,
192, 256 bits

KDA OneStep SP800-
56Cr2, KDA TwoStep
SP800-56Cr2
A7176
KDF SP800-108
A7176

N/A

N/A

N/A

N/A

N/A

N/A

N/A

N/A

Generated as
output of an
IKEv2
agreement
scheme
Generated as
output of a
PBE key and a
PRF
Generated as
output of an
agreement
scheme

Generated as
output of an
agreement
scheme

20 RSA key transport using PKCS#1 1.5 padding is deprecated through 2023 and disallowed after 2023.

Page 30 of 40

N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage

N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle
Not zeroized,
public key value
known outside
of module
destroy()
service call or
host platform
power cycle
Not zeroized,
public key value
known outside
of module
destroy()
service call or
host platform
power cycle

destroy()
service call or
host platform
power cycle
destroy()
service call or
host platform
power cycle

destroy()
service call or
host platform
power cycle

RSA signature
generation

RSA signature
verification

RSA key transport and
decryption

RSA key transport

Key Derivation

Key Derivation

Key Derivation

Key Derivation

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Establishment  Storage

Zeroisation

Use & related keys

Key/SSP Name/
Type
SRTP KDF Secret
Value

Strength

128, 192, 256
bits

Security Function and
Cert. Number
KDF SRTP
A7176

SSH KDF Secret
Value

80, 112, 128,
192, 256 bits

KDF SSH
A7176

TLS Premaster
Secret Value

384 bits

KDF TLS
A7176

TLS KDF Secret
Value

112, 128,
192, 256 bits

KDF TLS
A7176

X9.63 KDF Secret
Value

112, 128,
192, 256 bits

KDF ANS 9.63
A7176

Entropy Input
String

>128 bits

N/A

Generation

Generated as
output of an
SRTP
agreement
scheme
Generated as
output of an
SSH
agreement
scheme
Protocol
version (2
bytes) and 46
bytes from a
DRBG16
Generated as
output of TLS
agreement
scheme
Generated as
output of an
agreement
scheme
N/A

CTR DRBG Seed

128, 192, 256
bits

N/A

N/A

CTR DRBG V Value

128 bits

N/A

From seed
value

Import/
Export
N/A

N/A

N/A

N/A

Import17,
Export18

N/A

N/A

N/A

N/A

N/A

Obtained
from the
entropy
source
Obtained
from the
entropy
source
N/A

N/A

N/A

N/A

Page 31 of 40

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle

N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle

Key Derivation

Key Derivation

Used to derive keys
using TLS KDF

N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage

destroy()
service call or
host platform
power cycle
destroy()
service call or
host platform
power cycle
destroy()
service call or
host platform
power cycle
Immediately
after use or
host platform
power cycle
reseed() service
call or host
platform power
cycle

Key Derivation

Key Derivation

Random Number
Generation

Internal use

Internal use

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Key/SSP Name/
Type
CTR DRBG Key

Strength

128, 192, 256
bits

Security Function and
Cert. Number
N/A

Generation

From DRBG V
value

Import/
Export
N/A

N/A

Establishment  Storage

Zeroisation

Use & related keys

Hash DRBG Seed

112, 128,
192, 256 bits

N/A

N/A

Hash DRBG V Value  112, 128,

N/A

192, 256 bits

From seed
value

N/A

From external
entropy
source

N/A

N/A

Hash DRBG C Value  112, 128,

N/A

192, 256 bits

From DRBG V
value

N/A

N/A

HMAC DRBG Seed

112, 128,
192, 256 bits

N/A

N/A

HMAC DRBG V
Value

112, 128,
192, 256 bits

N/A

From seed
value

N/A

From external
entropy
source

N/A

N/A

HMAC DRBG Key

112, 128,
192, 256 bits

N/A

From DRBG V
value

N/A

N/A

DRBG Output

128, 192, 256
bits

N/A

DRBG

N/A

N/A

Page 32 of 40

N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage
N/A, the module
does not provide
persistent
storage

reseed() service
call or host
platform power
cycle
Immediately
after use or
host platform
power cycle
reseed() service
call or host
platform power
cycle
reseed() service
call or host
platform power
cycle
Immediately
after use or
host platform
power cycle
reseed() service
call or host
platform power
cycle
reseed() service
call or host
platform power
cycle
destroy()
service call or
host platform
power cycle

Internal use

Internal use

Internal use

Internal use

Internal use

Internal use

Internal use

Used as seed for
asymmetric key
generation or for
symmetric key
generation

FIPS 140-3 Security Policy

9.1  RBG Entropy Sources

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

The module’s use of Non-Deterministic Random Number Generators is determined by the settings described in Section 6.1.

Table 13. Non-Deterministic Random Number Generation Specification

Entropy sources

Passive Entropy

Minimum number of bits
of entropy
128

Details

As per FIPS 140-3 IG 9.3.A Section 2b, a minimum of 16 bytes is required from the source configured for seed
generation for the JVM. The entropy reader will block until the seed generator has provided the minimum number of
bytes.

10  Self-tests
CASTs are performed prior to the first use of services related to the test target. CASTs also run periodically on service invocation. Initial CAST self–tests are
available on demand by power cycling the module and then invoking the service related to the test target.

10.1  Pre-Operational Self-Tests

Each time the module is powered up, it performs the pre-operational self-tests to confirm that sensitive data have not been damaged. The pre-operational
tests include the Software Integrity test, which verifies the module using HMAC-SHA2-256, and the HMAC and SHS Conditional Cryptographic Algorithm Self-
Tests (CAST)  which are run prior to the Software Integrity  test to ensure the correctness  of the HMAC used. Pre-operational self–tests are available on
demand by power cycling the module.

10.2  Conditional Self-Tests

The module performs conditional self-tests when the conditions specified for cryptographic algorithm self-test and pair-wise consistency tests occur. Below
are the self-tests implemented:

Conditional Cryptographic Algorithm Self-Tests:
•  AES-ECB Encryption KAT (128 bits)
•  AES-ECB Decryption KAT (128 bits)
•  AES-CCM Encryption KAT (128 bits)
•  AES-CCM Decryption KAT (128 bits)
•  AES-CMAC Generation KAT (128 bits)
•  AES-CMAC Verification KAT (128 bits)
•  KAS-ECC Primitive “Z” Computation KAT (P-256, B-233)
•  KAS-FFC Primitive “Z” Computation KAT (ffdhe2048)
•  HASH_DRBG SHA2-256 KAT (Health Tests: Generate, Reseed, Instantiate functions per Section 11.3 of SP800-90Arev1)
•  HMAC-DRBG HMAC-SHA2-256 KAT (Health Tests: Generate, Reseed, Instantiate functions per Section 11.3 of SP800-90Arev1)

Page 33 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

•  CTR_DRBG AES-CTR 256 bits KAT (Health Tests: Generate, Reseed, Instantiate functions per Section 11.3 of SP800-90Arev1)
•  DSA Signature Generation KAT (2048 bits)
•  DSA Signature Verification KAT (2048 bits)
•  ECDSA Signature Generation KAT (P-256)
•  ECSDA Signature Verification KAT (P-256)
•  AES-GCM Encrypt KAT (128 bits)
•  AES-GCM Decrypt KAT (128 bits)
•  HMAC-SHA2-256 KAT
•  HMAC-SHA2-512 KAT
•  HMAC-SHA3-256 KAT
•  KDA OneStep KAT
•  KDA TwoStep KAT
•  KBKDF KAT (Counter, Feedback, Double Pipeline)
•  PBKDF KAT (HMAC-SHA2-256)
•  SHA-3 KAT (cSHAKE-128)
•  RSA Signature Generation KAT (2048 bits)
•  RSA Signature Verification KAT (2048 bits)
•  RSA Encryption KAT SP800-56Brev2 (2048 bits)
•  RSA Decryption KAT SP800-56Brev2 (2048 bits)
•  SHA-1 KAT
•  SHA2-256 KAT
•  SHA2-512 KAT
•  SHAKE256 KAT
•  ANS 9.63 KDF KAT
•
IKEv2 KDF KAT
•  SNMP KDF KAT
•  SRTP KDF KAT
•  SSH KDF KAT
•  TLS 1.0 KDF KAT
•  TLS 1.1 KDF KAT
•  TLS 1.2 KDF KAT

Page 34 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Conditional Pair-wise Consistency Tests:
•  DH pair-wise consistency test
•  DSA pair-wise consistency test
•  EC DH pair-wise consistency test
•  ECDSA pair-wise consistency test
•  RSA pair-wise consistency test

10.3  Error Handling

If any of the above-mentioned self-tests fail, the module enters an error state called “Hard Error” state. Upon entering the error state, the module outputs
status by way of an exception. An example exception for AES Encryption failure is mentioned below:

“Failed self-test on encryption: AES”

The module can be recovered by power cycling the module which results in execution of preoperational self-tests and conditional cryptographic algorithm
self-tests. If the tests pass, then the module will be available for use.

11  Life-Cycle Assurance
Vulnerabilities found in the module will be reported on the National Vulnerability Database, located at https://nvd.nist.gov/.

Researchers and users are encouraged to report any security related concerns to feedbackcrypto@bouncycastle.org. A PGP public key can be provided if
confidentiality is required around the report.

Please find the procedures for secure installation, initialization, startup and operation of the module:

The module exists as part of the running JVM as such:

•  Secure  installation  of  the  module  requires  the  use  of  the  unchanged  jar  to  loaded  into  a  JVM  via  either  the  class-path  or  the  module-path  as

appropriate to the JVM and its usage.

•

Initialization of the module will occur on startup of the module by the JVM. The user can trigger initialization by attempting to invoke any service in
the module or simply calling FipsStatus.isReady() which will only return true if the module has been successfully initialized.

•  Once the JVM has loaded the module and the module has been initialized, the startup phase can be over, and the module is able to provide services.

•  Operation of the module consists of calling the various APIs providing services, the module code will make use of the current thread for doing any

required CASTs and health tests and then provide a service object to the user capable of performing the requested service.

BC-FJA 2.0.0 User guide can be downloaded here: https://downloads.bouncycastle.org/fipsjava/BC-FJA-UserGuide-2.0.0.pdf

Page 35 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

12  Mitigation of Other Attacks Policy
The module implements basic protections to mitigate against timing-based attacks against its internal implementations. There are two countermeasures
used.

The first is Constant Time Comparisons, which protect the digest and integrity algorithms by strictly avoiding “fast fail” comparison of MACs, signatures, and
digests so the time taken to compare a MAC, signature, or digest is constant regardless of whether the comparison passes or fails.

The second is made up of Numeric Blinding and decryption/signing verification which both protect the RSA algorithm.

Numeric Blinding prevents timing attacks against RSA decryption and signing by providing a random input into the operation which is subsequently eliminated
when the result is produced. The random input makes it impossible for a third party observing the private key operation to attempt a timing attack on the
operation as they do not have knowledge of the random input and consequently the time taken for the operation tells them nothing about the private value
of the RSA key.

Decryption/signing verification is carried out by calculating a primitive encryption or signature verification operation after a corresponding decryption or
signing operation before the result of the decryption or signing operation is returned. The purpose of this is to protect against Lenstra's CRT attack by verifying
the correctness of the private key calculations involved. Lenstra's CRT attack takes advantage of undetected errors in the use of RSA private keys with CRT
values and, if exploitable, can be used to discover the private value of the RSA key.

Page 36 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

Appendix: References and Definitions
The following standards are referred to in this Security Policy:

ANSI X9.31
FIPS 140-3
FIPS 180-4
FIPS 186-3
FIPS 186-4
FIPS 197
FIPS 198-1
FIPS 202
IG
PKCS#1 v2.1
PKCS#5
PKCS#12
SP 800-38A
SP 800-38B
SP 800-38C
SP 800-38D
SP 800-38F
SP 800-38G
SP 800-56A-rev3
SP 800-56B-rev2
SP 800-56C-rev2
SP 800-67-rev2
SP 800-89
SP 800-90A
SP 800-90B
SP 800-108-rev1
SP 800-132
SP 800-133-rev2
SP 800-135-rev1

X9.31-1998, Digital Signatures using Reversible Public Key Cryptography for the Financial Services Industry (rDSA), September 9, 1998
Security Requirements for Cryptographic modules, March 22, 2019
Secure Hash Standard (SHS)
Digital Signature Standard (DSS)
Digital Signature Standard (DSS)
Advanced Encryption Standard
The Keyed-Hash Message Authentication Code (HMAC)
SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions
Implementation Guidance for FIPS PUB 140-3 and the Cryptographic Module Validation Program

RSA Cryptography Standard
Password-Based Cryptography Standard
Personal Information Exchange Syntax Standard Recommendation for the Triple Data Encryption Algorithm (TDEA) Block Cipher
Recommendation for Block Cipher Modes of Operation: Three Variants of Ciphertext Stealing for CBC Mode
Recommendation for Block Cipher Modes of Operation: The CMAC Mode for Authentication
Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and Confidentiality
Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC
Recommendation for Block Cipher Modes of Operation: Methods for Key Wrapping
Recommendation for Block Cipher Modes of Operation: Methods for Format-Preserving Encryption
Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography
Recommendation for Pair-Wise Key Establishment Schemes Using Integer Factorization Cryptography
Recommendation for Key Derivation through Extraction-then-Expansion
Recommendation for the Triple Data Encryption Algorithm (TDEA) Block Cipher
Recommendation for Obtaining Assurances for Digital Signature Applications
Recommendation for Random Number Generation Using Deterministic Random Bit Generators
Recommendation for the Entropy Sources Used for Random Bit Generation
Recommendation for Key Derivation Using Pseudorandom Functions
Recommendation for Password-Based Key Derivation
Recommendation for Cryptographic Key Generation
Recommendation for Existing Application – Specific Key Derivation Functions

Page 37 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

The following are acronyms used in this Security Policy:

AES
API
BC
BC-FJA
CBC
CCM
CDH
CFB
CMAC
CMVP
CO
CPU
CS
CSP
CTR
CVL
DES
DH
DRAM
DRBG
DSA
DSTU4145
EC
ECB
ECC
ECDSA
EdDSA
EMC
EMI
FIPS
GCM
GMAC
GOST

Advanced Encryption Standard
Application Programming Interface
Bouncy Castle
Bouncy Castle FIPS Java API
Cipher-Block Chaining
Counter with CBC-MAC
Computational Diffie-Hellman
Cipher Feedback Mode
Cipher-based Message Authentication Code
Crypto Module Validation Program
Cryptographic Officer
Central Processing Unit
Ciphertext Stealing
Critical Security Parameter
Counter-mode
Component Validation List
Data Encryption Standard
Diffie-Hellman
Dynamic Random Access Memory
Deterministic Random Bit Generator
Digital Signature Authority
Ukrainian DSTU-4145-2002 Elliptic Curve Scheme
Elliptic Curve
Electronic Code Book
Elliptic Curve Cryptography
Elliptic Curve Digital Signature Authority
Edwards Curve DSA using Ed25519, Ed448
Electromagnetic Compatibility
Electromagnetic Interference
Federal Information Processing Standards
Galois/Counter Mode
Galois Message Authentication Code
Gosudarstvennyi Standard Soyuza SSR/Government Standard of the Union of Soviet Socialist Republics

Page 38 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

GPC
HMAC
IG
JAR
JCA
JCE
JDK
JRE
JVM
IV
KAS
KAT
KDF
KW
KWP
KMAC
MAC
MD5
N/A
OCB
OFB
OS
PBKDF
PKCS
PQG
RC
RIPEMD
RSA
SHA
SSP
TCBC
TCFB
TDEA
TDES

General Purpose Computer
key-Hashed Message Authentication Code
See References
Java ARchive
Java Cryptography Architecture
Java Cryptography Extension
Java Development Kit
Java Runtime Environment
Java Virtual Machine
Initialization Vector
Key Agreement Scheme
Known Answer Test
Key Derivation Function
Key Wrap
Key Wrap with Padding
KECCAK Message Authentication Code
Message Authentication Code
Message Digest algorithm MD5
Non Applicable
Offset Codebook Mode
Output Feedback
Operating System
Password-Based Key Derivation Function
Public Key Cryptography Standards
Diffie-Hellman Parameters P, Q and G
Rivest Cipher, Ron’s Code
RACE Integrity Primitives Evaluation Message Digest
Rivest Shamir Adleman
Secure Hash Algorithm
Sensitive Security Parameter
TDEA Cipher-Block Chaining
TDEA Cipher Feedback Mode
Triple Data Encryption Algorithm
Triple Data Encryption Standard

Page 39 of 40

FIPS 140-3 Security Policy

Keysight BC-FJA (Bouncy Castle FIPS Java API) for Network Visibility

TECB
TOFB
TLS
USB
XDH
XOF

TDEA Electronic Codebook
TDEA Output Feedback
Transport Layer Security
Universal Serial Bus
Edwards Curve Diffie-Hellman using X25519, X448
Extendable-Output Function

Page 40 of 40

