Apple Inc.

Apple corecrypto Module v12.0 [Apple silicon, Kernel,
Software, SL1]
FIPS 140-3 Non-Proprietary Security Policy

October 2024

Prepared for:

Apple

One Apple Park Way

Cupertino, CA 95014

Prepared by:

atsec information security corporation

4516 Seton Center Parkway, Suite 250

Austin, TX 78759

www.atsec.com

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Trademarks

Apple’s trademarks applicable to this document are listed in https://www.apple.com/legal/intellectual-
property/trademark/appletmlist.html.

Other company, product, and service names may be trademarks or service marks of others.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 2 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Table of Contents

4.1
4.2
4.3

1  General ..................................................................................................................................................................... 5
2  Cryptographic Module Specification .............................................................................................................. 6
Tested Operational Environments ............................................................................................................................................. 6
2.1
2.2
Vendor-affirmed Operational Environments ........................................................................................................................ 6
2.3  Modes of operation ........................................................................................................................................................................ 7
Vendor Affirmed Algorithms ....................................................................................................................................................... 7
2.4
2.5
Approved Algorithms ..................................................................................................................................................................... 8
2.6  Non-Approved Algorithms Allowed in the Approved Mode of Operation ........................................................... 11
2.7  Non-Approved Algorithms Allowed in the Approved Mode of Operation with No Security Claimed ...... 11
2.8  Non-Approved Algorithms Not Allowed in the Approved Mode of Operation .................................................. 11
2.9  Module components ................................................................................................................................................................... 12
3  Cryptographic Module Interfaces .................................................................................................................. 13
4  Roles, services, and authentication ................................................................................................................ 14
Roles .................................................................................................................................................................................................. 14
Authentication ............................................................................................................................................................................... 14
Services ............................................................................................................................................................................................. 14
5  Software/Firmware security ............................................................................................................................. 18
5.1
Integrity Techniques .................................................................................................................................................................... 18
5.2  On-Demand Integrity Test ........................................................................................................................................................ 18
6  Operational Environment ................................................................................................................................. 19
7  Physical Security .................................................................................................................................................. 20
8  Non-invasive Security ........................................................................................................................................ 21
9  Sensitive Security Parameter Management ................................................................................................ 22
Random Number Generation .................................................................................................................................................. 24
Key/SSP Generation ..................................................................................................................................................................... 24
Keys/SSPs Establishment ........................................................................................................................................................... 24
Keys/SSPs Import/Export ........................................................................................................................................................... 24
Keys/SSPs Storage ........................................................................................................................................................................ 25
Keys/SSPs Zeroization ................................................................................................................................................................. 25
10  Self-tests ................................................................................................................................................................ 26
Pre-operational Software Integrity Test .......................................................................................................................... 26
Conditional Self-Tests ............................................................................................................................................................ 26
Conditional Cryptographic Algorithm Self-Tests ........................................................................................................................... 26
Conditional Pairwise Consistency Test ............................................................................................................................................... 27
Error States ................................................................................................................................................................................. 27
11  Life-cycle assurance ............................................................................................................................................ 29
Delivery and Operation .......................................................................................................................................................... 29
Administrator Guidance ........................................................................................................................................................ 29
Non-Administrator Guidance .............................................................................................................................................. 29
Design and Rules ...................................................................................................................................................................... 29
End of Life ................................................................................................................................................................................... 30
12  Mitigation of other attacks ............................................................................................................................... 31

11.1
11.2
11.3
11.4
11.5

9.1
9.2
9.3
9.4
9.5
9.6

10.2.1
10.2.2

10.1
10.2

10.3

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 3 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

List of Tables

Table 1 - Security Levels .................................................................................................................................................................................. 5
Table 2 - Tested Operational Environments ............................................................................................................................................ 6
Table 3 - Vendor Affirmed Operational Environments ....................................................................................................................... 7
Table 4 - Modes of Operation ...................................................................................................................................................................... 7
Table 5 - Vendor Affirmed Algorithms ...................................................................................................................................................... 7
Table 6 - Approved Algorithms ................................................................................................................................................................. 10
Table 7 - Non-Approved Algorithms Not Allowed in the Approved Mode of Operation ................................................. 12
Table 8 - Executable Code Sets ................................................................................................................................................................. 12
Table 9 - Ports and Interfaces .................................................................................................................................................................... 13
Table 10 - Roles ............................................................................................................................................................................................... 14
Table 11 - Security Function Implementations .................................................................................................................................... 14
Table 12 - Approved Services .................................................................................................................................................................... 16
Table 13 - Non-Approved Services .......................................................................................................................................................... 17
Table 14 - SSPs ................................................................................................................................................................................................. 24
Table 15 – Entropy Sources ......................................................................................................................................................................... 24
Table 16 - Storage Areas .............................................................................................................................................................................. 25
Table 17 – Pre-Operational Self-Tests .................................................................................................................................................... 26
Table 18 - Self-Tests ...................................................................................................................................................................................... 27
Table 19- Error states .................................................................................................................................................................................... 28

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 4 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

1

General

This document is the non-proprietary FIPS 140-3 Security Policy for Apple corecrypto Module v12.0 [Apple
silicon, Kernel, Software, SL1] cryptographic module. It contains the security rules under which the module must
operate and describes how this module meets the requirements as specified in FIPS PUB 140-3 (Federal
Information Processing Standards Publication 140-3) for a Security Level 1 module.

This document provides all tables and diagrams (when applicable) required by NIST SP 800-140B. The column
names of the tables follow the template tables provided in NIST SP 800-140B.

Table 1 describes the individual security areas of FIPS 140-3, as well as the Security Levels of those individual
areas.

ISO/IEC 24759 Section
6.[Number Below]

FIPS 140-3 Section Title

Security Level

1

2

3

4

5

6

7

8

9

10

11

12

General

Cryptographic Module Specification

Cryptographic Module Interfaces

Roles, Services, and Authentication

Software/Firmware Security

Operational Environment

Physical Security

Non-invasive Security

Sensitive Security Parameter Management

Self-tests

Life-cycle Assurance

1

1

1

1

1

1

Not Applicable

Not Applicable

1

1

1

Mitigation of Other Attacks

Not Applicable

Table 1 - Security Levels

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 5 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

2

Cryptographic Module Specification

The Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1] cryptographic module (hereafter
referred to as “the module”) is a Software module running on a multi-chip standalone general-purpose
computing platform. The version of module is 12.0. The module provides implementations of low-level
cryptographic primitives to the Device OS’s (iOS 15, iPadOS 15, watchOS 8, tvOS 15, T2 OS 12 and macOS 12
Monterey) Security Framework and Common Crypto.

2.1

Tested Operational Environments

#  Operating System

Hardware Platform

Processor

PAA/Acceleration

iPadOS 15
1
iPadOS 15
2
iPadOS 15
3
iPadOS 15
4
iPadOS 15
5
iPadOS 15
6
iPadOS 15
7
iPadOS 15
8
iPadOS 15
9
iPadOS 15
10
iPadOS 15
11
iOS 15
12
iOS 15
13
iOS 15
14
iOS 15
15
iOS 15
16
iOS 15
17
18
iOS 15
19  watchOS 8
20  watchOS 8
21  watchOS 8
22  watchOS 8
23  watchOS 8
24
25
26
27  macOS 12 Monterey
28  macOS 12 Monterey
29  macOS 12 Monterey

tvOS 15
tvOS 15
T2OS 12

iPad (5th generation)
iPad Pro 9.7-inch
iPad (7th generation)
iPad Pro 10.5 inch
iPad mini (5th generation)
iPad Pro 11-inch (1st generation)
iPad Pro 11-inch (2nd generation)
iPad (9th generation)
iPad Air (4th generation)
iPad mini (6th generation)
iPad Pro 11-inch (3rd generation)
iPhone 6S
iPhone 7 Plus
iPhone X
iPhone XS Max
iPhone 11 Pro
iPhone 12
iPhone 13 Pro Max
Apple Watch Series S3
Apple Watch Series S4
Apple Watch Series S5
Apple Watch Series S6
Apple Watch Series S7
Apple TV 4K
Apple TV 4K (2nd generation)
Apple Security Chip T2
MacBook Pro (13-inch, M1, 2020)
MacBook Pro 14-inch
MacBook Pro 16-inch

Apple A Series A9
Apple A Series A9X
Apple A Series A10 Fusion
Apple A Series A10X Fusion
Apple A Series A12 Bionic
Apple A Series A12X Bionic
Apple A Series A12Z Bionic
Apple A Series A13 Bionic
Apple A Series A14 Bionic
Apple A Series A15 Bionic
Apple M Series M1
Apple A Series A9
Apple A Series A10 Fusion
Apple A Series A11 Bionic
Apple A Series A12 Bionic
Apple A Series A13 Bionic
Apple A Series A14 Bionic
Apple A Series A15 Bionic
Apple S Series S3
Apple S Series S4
Apple S Series S5
Apple S Series S6
Apple S Series S7
Apple A Series A10X Fusion
Apple A Series A12 Bionic
Apple T Series T2
Apple M Series M1
Apple M Series M1 Pro
Apple M Series M1 Max

Table 2 - Tested Operational Environments

With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA
With and without PAA

2.2

Vendor-affirmed Operational Environments

#

1
2
3
4
5

Operating System

Hardware Platform

iPadOS 15
iPadOS 15
iPadOS 15
iPadOS 15
iPadOS 15

iPad Pro 12.9-inch
iPad (6th generation)
iPad Pro 12.9-inch (2nd generation)
iPad Air (3rd generation)
iPad (8th generation)

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 6 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

#

6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28

Operating System

Hardware Platform

iPadOS 15
iPadOS 15
iPadOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
iOS 15
watchOS 8
macOS 12 Monterey
macOS 12 Monterey
macOS 12 Monterey

iPad Pro 12.9-inch (3rd generation)
iPad Pro 12.9-inch (4th generation)
iPad Pro 12.9-inch (5th generation)
iPhone SE
iPhone 6S Plus
iPhone 7
iPhone 8
iPhone 8 Plus
iPhone XS
iPhone XR
iPhone 11
iPhone 11 Pro Max
iPhone SE (2nd generation)
iPhone 12 mini
iPhone 12 Pro
iPhone 12 Pro Max
iPhone 13 mini
iPhone 13
iPhone 13 Pro
Apple Watch SE
MacBook Air
Mac mini
iMac (24-inch)

Table 3 - Vendor Affirmed Operational Environments

The CMVP makes no statement as to the correct operation of the module or the security strengths of the
generated keys when so ported if the specific operational environment is not listed on the validation certificate.

2.3  Modes of operation

The module operates in Approved and Non-Approved mode of operation. The mode is implicit and is based on
the service utilized. The table below provides a summary of the implementation.

Name

Description

Type

Status Indicator

Approved
mode

Approved mode of operation is entered when the
module utilizes the services that use the security
functions listed in the Table 5 and Table 6.

Approved
mode

return a '1' from fips_allowed_mode() for block cipher
functions and fips_allowed() for all other services to indicate
the executed cryptographic algorithm was approved

Non-
Approved
mode

Non-Approved mode of operation is entered
when the module utilizes non-approved security
functions in Table 7.

Non-
Approved
mode

return a '0' from fips_allowed_mode() for block cipher
functions and fips_allowed() for all other services to indicate
the executed cryptographic algorithm was non-approved

Table 4 - Modes of Operation

2.4

Vendor Affirmed Algorithms

Algorithm

Algorithm Properties  Use / Function

CKG [SP800-133r2]
(asymmetric)

Vendor affirmed

Cryptographic key Generation for ECDSA key pair; FIPS 140-3 IG D.H and SP800-133r2
section 4 example 1

Table 5 - Vendor Affirmed Algorithms

© 2024 Apple Inc., All rights reserved.

This document may be reproduced and distributed only in its original entirely without revision.

 7 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

2.5

Approved Algorithms

The table below lists all Approved or Vendor-affirmed security functions of the module, including specific key
size(s) employed for approved services, and implemented modes of operation.

CAVP Cert.

Algorithm and
Standard

Mode / Method  Description / Key Size(s) / Key
Strength(s)

Use / Function

A2793, A2865
(asm_arm)

AES
  [FIPS 197]
  [SP 800-38A]

A2794, A2866 (c_asm)  AES

A2796, A2868
(vng_asm)

A2793, A2865
(asm_arm)

  [FIPS 197]
  [SP 800-38A]

AES
  [FIPS 197]
 [SP 800-38A]
 [SP 800-38C]
 [SP 800-38D]

AES
  [FIPS 197]
  [SP 800-38A]

CBC

CBC

CCM

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

CFB128

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

A2794, A2866 (c_asm)  AES

CFB128

  [FIPS 197]
  [SP 800-38A]

A2794, A2866 (c_asm)  AES

CFB8

  [FIPS 197]
  [SP 800-38A]

A2794, A2866 (c_asm)  AES

A2796, A2868
(vng_asm)

A2793, A2865
(asm_arm)

  [FIPS 197]
  [SP 800-38A]

AES
  [FIPS 197]
 [SP 800-38A]
 [SP 800-38C]
 [SP 800-38D]

AES
  [FIPS 197]
  [SP 800-38A]

A2794, A2866 (c_asm)  AES

A2796, A2868
(vng_asm)

  [FIPS 197]
  [SP 800-38A]

AES
  [FIPS 197]
 [SP 800-38A]

CTR

CTR

ECB

ECB

ECB

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 8 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

CAVP Cert.

Algorithm and
Standard

Mode / Method  Description / Key Size(s) / Key
Strength(s)

Use / Function

A2796, A2868
(vng_asm)

A2793, A2865
(asm_arm)

AES
  [FIPS 197]
 [SP 800-38A]
 [SP 800-38C]
 [SP 800-38D]

AES
  [FIPS 197]
  [SP 800-38A]

GCM

OFB

A2794, A2866 (c_asm)  AES

OFB

A2793, A2865
(asm_arm)

  [FIPS 197]
  [SP 800-38A]

AES
  [FIPS 197]
 [SP 800-38E]

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

Key Size / Key Strength: 128, 192, 256
bits

Symmetric Encryption
and Decryption

XTS

Key Size / Key Strength: 128, 256 bits

Symmetric Encryption
and Decryption

A2794, A2866 (c_asm)  KTS (AES)

AES-KW

[SP 800-38F]

Key Size / Key Strength: 128, 192, 256
bits

Key Wrapping

A2794, A2866 (c_asm)  DRBG

[SP800-90ARev1]

CTR_DRBG: AES-128,
AES-256

Key Size / Key Strength: 128, 256 bits
Derivation Function Enabled, No
Prediction Resistance

Random Number
Generation

A2796, A2868
(vng_asm)

DRBG
[SP800-90ARev1]

CTR_DRBG: AES-128,
AES-256

Key Size / Key Strength: 128, 256 bits
Derivation Function Enabled, No
Prediction Resistance

Random Number
Generation

A2797, A2869 (vng_ltc)  RSA

[FIPS 186-4]

PKCS#1 v1.5 and PKCS
PSS

Key Size: 2048, 3072, 4096 bits
Key Strength: from 112 to 150 bits

Digital Signature
Generation

A2797, A2869 (vng_ltc)  RSA

[FIPS 186-4]

PKCS#1 v1.5 and PKCS
PSS

Key Size: 1024 (legacy), 2048, 3072,
4096 bits
Key Strength: from 80 to 150 bits

Digital Signature
Verification

A2797, A2869 (vng_ltc)  ECDSA

 ANSI X9.62
 [FIPS 186-4]

Key Pair Generation
(CKG) using method in
Section 4 example 1 of
SP 800-133r2.
[FIPS  186-4] Appendix
B.4.2 Testing
Candidates

A2797, A2869 (vng_ltc)  ECDSA

N/A

Curve: P-224, P-256, P-384, P-521
Key Strength: from 112 to 256 bits

Asymmetric Key
Generation

Curve: P-224, P-256, P-384, P-521 bits
Key Strength: from 112 to 256 bits

Asymmetric Key
Validation

 ANSI X9.62
 [FIPS 186-4]

A2797, A2869 (vng_ltc)  ECDSA

 ANSI X9.62
 [FIPS 186-4]

A2797, A2869 (vng_ltc)  ECDSA

 ANSI X9.62
 [FIPS 186-4]

SHA2-224, SHA2-256,
SHA2-384, SHA2-512

Curve: P-224, P-256, P-384, P-521 bits
Key Strength: from 112 to 256 bits

Digital Signature
Generation

SHA1 (legacy), SHA2-
224, SHA2-256, SHA2-
384, SHA2-512

Curve: P-224, P-256, P-384, P-521 bits
Key Strength: from 112 to 256 bits

Digital Signature
Verification

A2797, A2869 (vng_ltc)  SHS

SHA-1

N/A

Message Digest

 [FIPS 180-4]

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 9 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

CAVP Cert.

Algorithm and
Standard

Mode / Method  Description / Key Size(s) / Key
Strength(s)

Use / Function

A2797, A2869 (vng_ltc)  SHS

SHA-224

 [FIPS 180-4]

A2797, A2869 (vng_ltc)  SHS

SHA-256

 [FIPS 180-4]

A2797, A2869 (vng_ltc)  SHS

SHA-384

 [FIPS 180-4]

A2797, A2869 (vng_ltc)  SHS

SHA-512

 [FIPS 180-4]

N/A

N/A

N/A

N/A

Message Digest

Message Digest

Message Digest

Message Digest

A2797, A2869 (vng_ltc)  SHS

SHA-512/256

N/A

Message Digest

A2795, A2867 (c_ltc)

A2795, A2867 (c_ltc)

A2795, A2867 (c_ltc)

A2798, A2870
(vng_neon)

 [FIPS 180-4]

SHS
 [FIPS 180-4]

SHS
 [FIPS 180-4]

SHS
 [FIPS 180-4]

SHS
 [FIPS 180-4]

SHA-384

SHA-512

N/A

N/A

Message Digest

Message Digest

SHA-512/256

N/A

Message Digest

SHA-256 for all CPUs in
Table 2 except S3)

N/A

A2797, A2869 (vng_ltc)  HMAC

SHA-1

 [FIPS 198]

A2797, A2869 (vng_ltc)  HMAC

SHA-224

 [FIPS 198]

A2797, A2869 (vng_ltc)  HMAC

SHA-256

 [FIPS 198]

A2797, A2869 (vng_ltc)  HMAC

SHA-384

 [FIPS 198]

A2797, A2869 (vng_ltc)  HMAC

SHA-512

 [FIPS 198]

A2797, A2869 (vng_ltc)  HMAC

SHA-512/256

A2795, A2867 (c_ltc)

A2795, A2867 (c_ltc)

A2795, A2867 (c_ltc)

A2798, A2870
(vng_neon)

 [FIPS 198]

HMAC
 [FIPS 198]

HMAC
 [FIPS 198]

HMAC
 [FIPS 198]

HMAC
 [FIPS 198]

SHA-384

SHA-512

SHA-512/256

Key Size:  128 - 262144 bits
Key Strength: 128 bits

Key Size: 224 - 262144 bits
Key Strength: 224 bits

Key Size:  256 - 262144 bits
Key Strength: 256 bits

Key Size: 384 - 262144 bits
Key Strength: 384 bits

Key Size: 512 - 262144 bits
Key Strength: 512 bits

Key Size: 512 - 262144 bits
Key Strength: 256 bits

Key Size: 384 - 262144 bits
Key Strength: 384 bits

Key Size: 512 - 262144 bits
Key Strength: 512 bits

Key Size: 512 - 262144 bits
Key Strength: 256 bits

SHA-256 (for all CPUs
in Table 2 except S3)

Key Size:  256 - 262144 bits
Key Strength: 256 bits

Table 6 - Approved Algorithms

Message Digest

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

Message
authentication (MAC)

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 10 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

2.6  Non-Approved Algorithms Allowed in the Approved Mode of Operation

There are no non-Approved but “Allowed functions” with security claimed algorithms in approved mode.

2.7  Non-Approved Algorithms Allowed in the Approved Mode of Operation with No

Security Claimed

There are no non-Approved Allowed functions with no security claimed algorithms in approved mode.

2.8  Non-Approved Algorithms Not Allowed in the Approved Mode of Operation

The table below lists the non-Approved algorithms and security functions that are used in the non-Approved
mode of operation:

Algorithm/Functions

RSA Signature Generation

RSA Signature Verification

RSA Key Wrapping

Ed25519

ANSI X9.63 KDF

RFC6637

HKDF [SP800-56C]

DES

CAST5

AES-GCM using external IV

RC4

RC2

MD2

MD4

MD5

RIPEMD

ECDSA

Integrated Encryption Scheme on elliptic curves (ECIES)

Use / Function

PKCS#1 v1.5 and PSS Signature Generation
Key Size < 2048
PKCS#1 v1.5 and PSS Signature Verification
Key Size < 1024
OAEP, PKCS#1 v1.5 and -PSS schemes

Key Agreement
Key Generation
Signature Generation
Signature Verification
Hash based Key Derivation Function

Key Derivation Function

Key Derivation Function

Encryption / Decryption
  Key Size 56-bits
Encryption / Decryption
  Key Sizes 40 to 128-bits in 8-bit increments
Authenticated Encryption / Decryption

Encryption / Decryption
  Key Sizes 8 to 4096-bits
Encryption / Decryption
  Key Sizes 8 to 1024-bits
Message Digest
  Digest size 128-bit
Message Digest
  Digest size 128-bit
Message Digest
   Digest size 128-bit
Message Digest
  Digest size 160-bits
PKG: Curve P-192 with security strength of 96 bits
PKV: Curve P-192
Signature Generation: Curve P-192
Signature Verification: Curve P-192
Key Pair Generation for compact point representation of points
Hybrid Encryption scheme

Blowfish

Encryption / Decryption

OMAC (One-Key CBC MAC)

MAC generation / verification

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 11 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Algorithm/Functions

Triple-DES [SP 800-67]

Use / Function

Encryption/Decryption with modes CBC, ECB

Table 7 - Non-Approved Algorithms Not Allowed in the Approved Mode of Operation

2.9  Module components

Package/File Names

Software Version

Integrity Test Implemented

corecrypto-1217.40.11

12.0

HMAC-SHA-256

Table 8 - Executable Code Sets

The module cryptographic boundary is delineated by the dotted green rectangle in the Figure 1. The Apple
corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1] executes within the kernel space of the computing
platforms and operating systems listed in Table 2 - Tested Operational Environments. In the block diagram
below, the Kernel Extension (KEXT) is a bundle that performs low-level tasks. KEXTs run in kernel space, which
gives them elevated privileges and the ability to perform tasks that user-space apps can’t.

The tested operational environment’s physical perimeter (TOEPP) is represented by the most exterior black line in
the block diagram Figure 1.

Figure 1 - Block diagram

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 12 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

3

Cryptographic Module Interfaces

The underlying logical interfaces of the module are the C language Kernel Interfaces (KPIs). In detail these
interfaces are described in (Table 9 ):

Physical Ports

Logical Interface1  Data that passes over port/interface

As a software-only
module, the module does
not have physical ports.
Physical Ports are
interpreted to be the
physical ports of the
hardware platform on
which it runs

Data Input

Data Output

Control Input

Status Output

Data inputs are provided in the variables passed in the KPI and callable service
invocations, generally through caller-supplied buffers

Data outputs are provided in the variables passed in the KPI and callable service
invocations, generally through caller-supplied buffers

Control inputs which control the mode of the module are provided through dedicated
parameters, namely the kernel module plist whose information is supplied to the module
by the kernel module loader.

Status output is provided in return codes and through messages. Documentation for
each KPI lists possible return codes. A complete list of all return codes returned by the C
language KPIs within the module is provided in the header files and the KPI
documentation. Messages are also documented in the KPI documentation.

Table 9 - Ports and Interfaces

The module is optimized for library use within the Device OS kernel space and does not contain any terminating
assertions or exceptions. It is implemented as a Device OS dynamically loadable library. The dynamically loadable
library is loaded into the Device OS kernel and its cryptographic functions are made available to Device OS kernel
services only. Any internal error detected by the module is returned to the caller with an appropriate return code.
The calling Device OS kernel service must examine the return code and act accordingly.

The module communicates any error status synchronously through the use of its documented return codes, thus
indicating the module’s status.

Caller-induced or internal errors do not reveal any sensitive material to callers.

1 The module does not implement a Control Output Logical Interface

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 13 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

4

Roles, services, and authentication

4.1

Roles

The module supports a single instance of one authorized role: The Crypto Officer. No support is provided for
multiple concurrent operators.

Name

Type

Operator Type

Authentication Method

Crypto Officer

Role

CO

Implicit

4.2

Authentication

Table 10 - Roles

FIPS 140-3 does not require an authentication mechanism for level 1 modules. Therefore, the module does not
support an authentication mechanism for Crypto Officer. The Crypto Officer role is authorized to access all
services provided by the module (see Table 12 - Approved Services and Table 13 - Non-Approved Services
below).

4.3

Services

Name

Type

Description

SF Properties

Algorithm Properties

KTS

KTS

SP 800-38F, IG D.G. AES Key
Wrapping and Unwrapping

128, 192, and 256-bit AES keys providing
128, 192, or 256 bits of encryption strength

AES-KW/ A2794, A2866

Table 11 - Security Function Implementations

The module implements a dedicated KPI function to indicate if a requested service utilizes an approved security
function. For services listed in Table 12 - Approved Services, the indicator function returns 1 to indicate that the
security function is approved.

Name

Description

Indicator  Inputs

Outputs

Approved Security
Functions

Symmetric
Encryption

Symmetric
Decryption

1

1

Executes AES-
mode encrypt
operation

Executes AES-
mode decrypt
operation

AES key, plaintext data  ciphertext data

AES key, ciphertext
data

plaintext data

AES-CBC, AES-CCM,
AES-CFB128, AES-
CFB8, AES-CTR, AES-
ECB, AES-GCM, AES-
OFB, AES-XTS

AES-CBC, AES-CCM,
AES-CFB128, AES-
CFB8, AES-CTR, AES-
ECB, AES-GCM, AES-
OFB, AES-XTS

Roles  Access
rights
to Keys
and/ or
SSPs

CO

W, E

CO

W, E

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 14 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Name

Description

Indicator  Inputs

Outputs

Approved Security
Functions

Roles  Access
rights
to Keys
and/ or
SSPs

AES Key Wrapping  Executes AES-
key wrapping
operation

AES Key
Unwrapping

Message Digest
Generation

Message
Authentication
Code (MAC)
Generation

Signature
generation (RSA)

Signature
verification (RSA)

Signature
generation (ECDSA)

Signature
verification (ECDSA)

Executes AES-
key unwrapping
operation

Generate a
digest for the
requested
algorithm

Generate a
Message
Authentication
Code

Sign a message
with a specified
RSA private key

Verify the
signature of a
message with a
specified RSA
public key

Sign a message
with a specified
ECDSA private
key

Verify the
signature of a
message with a
specified ECDSA
public key

1

1

1

1

1

1

1

1

AES key wrapping key,
unwrapped key

AES key wrapping key,
wrapped key

wrapped key

AES-KW

CO

W, E

unwrapped key

AES-KW

CO

W, E

Message

message digest

HMAC key, MAC
algorithm, message

MAC

SHA-1, SHA-224, SHA-
256, SHA-384, SHA-
512, SHA-512/256

CO

N/A

CO

W, E

HMAC-SHA-1, HMAC-
SHA-224, HMAC-SHA-
256, HMAC-SHA-384,
HMAC-SHA-512,
HMAC-SHA-512/256

RSA private key,
message, hash
algorithm

computed signature

RSA SigGen

CO

W, E

RSA public key, digital
signature, message,
hash algorithm

pass/fail result of
digital signature
verification

RSA SigVer

CO

W, E

ECDSA private key,
message, hash
algorithm

ECDSA public key,
digital signature,
message, hash
algorithm

computed signature

ECDSA SigGen

CO

W, E

pass/fail result of
digital signature
verification

ECDSA SigVer

CO

W, E

Random number
generation

Generate
Random number

1

Output length

Random bit-string

CTR_DRBG (Entropy
Input, DRBG seed,
Internal state V value
and key)

CO

E/ G, W, E
/ G, W, E

key pair generation
(ECDSA)

Public key
validation (ECDSA)

Zeroization

1

1

Generate a
keypair for a
requested elliptic
curve

Verify a public
key for a
requested elliptic
curve

1

Release all
resources of
symmetric crypto
function context

key size

ECDSA Key Pair

ECDSA KeyGen, CKG  CO

G, R

ECDSA public key

pass/fail result of key
pair verification

ECDSA KeyVer

CO

E, W

N/A

N/A

N/A

CO

Z

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 15 of 35

Roles  Access
rights
to Keys
and/ or
SSPs

CO

Z

CO

Z

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Name

Description

Indicator  Inputs

Outputs

Approved Security
Functions

1

Release all
resources of hash
context

Release of all
resources of
asymmetric
crypto function
context

Execute the
CASTs

1

1

N/A

N/A

None

Self-test

N/A

N/A

N/A

N/A

pass/fail results of self-
tests

Algorithms listed in
table Conditional self-
test

CO

N/A

Show Status

Return the
module status

Show Module Info  Return Module
Base Name and
Module Version
Number

None

None

status output

None

None

name and version
information

N/A

N/A

CO

N/A

CO

N/A

Table 12 - Approved Services

The abbreviations of the access rights to keys and SSPs have the following interpretation:

G = Generate: The module generates or derives the SSP.

R = Read: The SSP is read from the module (e.g., the SSP is output).

W = Write: The SSP is updated, imported, or written to the module.

E = Execute: The module uses the SSP in performing a cryptographic operation.

Z = Zeroise: The module zeroises the SSP.

N/A= The service does not access any SSP during its operation

Service

Description

Algorithms Accessed

Role

Triple-DES encryption / decryption  TDES-CBC, TDES-ECB

RSA Key Wrapping

RSA Signature Generation

The CAST does not perform the full KTS, only the raw RSA
encrypt/ decrypt.

PKCS#1 v1.5 and PSS Signature Generation

Key Size < 2048

Triple-DES

RSA encrypt/decrypt

RSA Signature Generation

CO

CO

CO

RSA Signature Verification

PKCS#1 v1.5 and PSS Signature Verification

RSA Signature Verification

CO

Key Size < 1024

ECDSA Key-pair Generation (PKG)
and ECDSA Key Validation (PKV)

ECDSA PKG and PKV using curve P-192

ECDSA Key Generation,
ECDSA Key Validation

ECDSA Signature Generation

ECDSA Signature Generation using curve P-192

ECDSA Signature Generation

ECDSA Signature Verification

ECDSA Signature Verification using curve P-192

ECDSA Signature Verification

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

CO

CO

CO

 16 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Service

Description

ECDSA Key Pair Generation for
compact point representation of
points

Key Pair Generation for compact point representation of
points

Algorithms Accessed

Role

ECDSA Key Generation

CO

Ed25519 Key Generation

Ed25519 Key Generation

Ed25519 Key Generation

CO

Ed25519 Signature Generation

EdDSA Signature Generation over Curve25519

Ed25519 Sig Generation

CO

Ed25519 Signature Verification

EdDSA Signature Verification over Curve25519

Ed25519 Sig Verification

CO

Ed25519 Key Agreement

Ed25519 Key Agreement

Ed25519 Key Agreement

ECIES

Elliptic Curve encrypt

ANSI X9.63 Key Derivation

SHA-1 hash-based key derivation function

SP800-56C Key Derivation (HKDF)  SHA-256 hash-based key derivation function

RFC 6637 Key Derivation

SHA hash based key derivation function

ECIES Encrypt

SHA-1

SHA-256

SHA-256, SHA-512, AES-128,
AES-256

OMAC Message Authentication
Code Generation and Verification

One-Key CBC MAC using 128-bit key

OMAC

Message digest generation.

Message digest generation using non-approved algorithms  MD2, MD4, MD5, RIPEMD

Authenticated Encryption /
decryption

Encrypt a plaintext / Decrypt a ciphertext

AES-GCM using external IV

CO

CO

CO

CO

CO

CO

CO

CO

(other) symmetric encryption /
decryption

symmetric encryption / decryption using non-approved
algorithms

Blowfish, CAST5, DES, RC2, RC4   CO

Table 13 - Non-Approved Services

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 17 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

5

Software/Firmware security

5.1

Integrity Techniques

The Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1], which is made up of a single
component, is provided in the form of binary executable code. A software integrity test is performed on the
runtime image of the module. The HMAC-SHA256 implemented in the module is used as the approved
algorithm for the integrity test. If the test fails, the module enters an error state where no cryptographic services
are provided, and data output is prohibited i.e., the module is not operational.

5.2  On-Demand Integrity Test

Integrity test is performed as part of the Pre-Operational Self-Tests. It is automatically executed at power-on.
Integrity test on demand is performed by power-cycling the computing platform .

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 18 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

6

Operational Environment

The Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1] operates in a modifiable operational
environment per FIPS 140-3 level 1 specifications. The module is supplied as part of Device OS, a commercially
available general-purpose operating system executing on the computing platforms specified in section 2.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 19 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

7

Physical Security

The FIPS 140-3 physical security requirements do not apply to the Apple corecrypto Module v12.0 [Apple silicon,
Kernel, Software, SL1], since it is a software module.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 20 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

8

Non-invasive Security

Currently, the ISO/IEC 19790:2012 non-invasive security area is not required by FIPS 140-3 (see NIST SP 800-
140F). The requirements of this area are not applicable to the module.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 21 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

9

Sensitive Security Parameter Management

The following table summarizes the keys and Sensitive Security Parameters (SSPs) that are used by the
cryptographic services implemented in the module:

Generation

Impor
t/
Export

Estab
lishm
ent

Storage

Zeroisation

N/A

RAM

N/A

Import
from
calling
applicat
ion
No
Export

Automatic
zeroisation when
structure is
deallocated or
when the system
is powered down

Use and
related
keys

Use:
Symmetric
Encryption
and
Decryption
Related
keys: N/A

Strength

Key/ SSP
Name /
Type

AES Key /
CSP

128 to 256
bits

Security
Function and
Cert. Number

AES-CBC (A2792,
A2794, A2865,
A2866)
AES-CCM (A2796,
A2868)
AES-CFB128
(A2793, A2794,
A2865, A2866)
AES-CFB8
(A27494, A2866)
AES-CTR (A2794,
A2796, A2866,
A2868)
AES-ECB (A2793,
A2794, A2796,
A2865, A2866,
A2868)
AES-GCM (A2796,
A2868)
AES-OFB (A2794,
A2866)
AES-XTS (A2793,
A2865)

AES Key-
wrapping key
/ CSP

128 to 256
bits

AES-KW
(A2794, A2866)

N/A

HMAC Key /
CSP

128-256
bits

N/A

HMAC-SHA-1,
HMAC-SHA-224,
HMAC-SHA-256,
HMAC-SHA-384,
HMAC-SHA-512,
HMAC-SHA-
512/256
(A2797, A2869,
A2795, A2867,
A2798, A2870)

N/A

RAM

N/A

RAM

Import
from
calling
applicat
ion
No
Export

Import
from
calling
applicat
ion
No
Export

112 to 256
bits

ECDSA KeyGen
(A2797, A2869)

ECDSA public
key
(including
intermediate
keygen
values) PSP

N/A

RAM

The key pairs
are generated
conformant to
SP800-133r2
(CKG) using
FIPS186-4 Key

Import
and
Export
to
calling
applicat

Automatic
zeroisation when
structure is
deallocated or
when the system
is powered down

Automatic
zeroisation when
structure is
deallocated or
when the system
is powered down

Use: Key
Wrapping
Related
keys: N/A

Use:
Message
authenticati
on code
generation
(HMAC)
Related
keys: N/A

Automatic
zeroisation when
structure is
deallocated or
when the system
is powered

Use: Digital
Signature
verification
Related
keys: DRBG
internal

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 22 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Key/ SSP
Name /
Type

Strength

Security
Function and
Cert. Number

Generation

Impor
t/
Export

Estab
lishm
ent

Storage

Zeroisation

ECDSA
private key
(including
intermediate
keygen
values) CSP

Generation
method, and
the random
value used in
the key
generation is
generated
using SP800-
90ARev1
DRBG

RSA public
key / PSP

112 to 150
bits

RSA SigGen,
RSA SigVer
(A2797, A2869)

N/A

RSA private
key / CSP

ion.
Interme
diate
keygen
values
are not
output.

Import
from
calling
applicat
ion
No
Export.

N/A

RAM

down.
Intermediate
keygen values
are zeroized
before the
module returns
from the key
generation
function.

Automatic
zeroisation when
structure is
deallocated or
when the system
is powered
down.

256 bits

DRBG
Entropy
Input / CSP
(IG D.L)

Random Number
Generation
E14, E15 (see PUD
referenced in
section 11.2)

Obtained from
two entropy
sources

DRBG Seed /
CSP (IG D.L)

256 bits

CTR_DRBG
(A2797, A2869,
A2796, A2868,
A2795, A2867,
A2794, A2866)

Derived from
entropy input
string as
defined by
SP800-
90ARev1

N/A

N/A

RAM

When the system
is powered down

N/A

N/A

RAM

When the system
is powered down

256 bits

DRBG
internal state:
V value and
Key / CSP (IG
D.L)

CTR_DRBG
(A2797, A2869,
A2796, A2868,
A2795, A2867,
A2794, A2866)

Derived from
seed as
defined by
SP800-
90Arev1

N/A

N/A

RAM

When the system
is powered down

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

Use and
related
keys

state,
ECDSA
private key

Use: Digital
Signature
generation
Related
keys: DRBG
internal
state,
ECDSA
public key

Use: Digital
Signature
verification
Related
keys: DRBG
internal
state, RSA
private key

Use: Digital
Signature
generation
Related
keys: DRBG
internal
state, RSA
public key

Use
Random
Number
Generation
Related
keys: DRBG
seed

Use
Random
Number
Generation
Related
keys: DRBG
entropy
input,
DRBG
internal
state

Use:
Random
Number
Generation
Related
keys: DRBG
seed

 23 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

9.1

Random Number Generation

Table 14 - SSPs

A NIST approved deterministic random bit generator based on a block cipher as specified in NIST [SP 800-
90ARev1] is used. The DRBG is a CTR_DRBG using AES-256 with derivation function and without prediction
resistance. The random numbers used for key generation are all generated by CTR_DRBG in this module. Per
section 10.2.1.1 of [SP 800-90ARev1], the internal state of CTR_DRBG is the value V and Key. The module
performs DRBG health tests according to section 11.3 of [SP800-90Arev1].

The module also performs DRBG health tests according to section 11.3 of [SP800-90ARev1].

No non-DRBG functions or instances are able to access the DRBG internal state

The deterministic random bit generators are seeded by “read_random”. The read_random is the kernel space
interface. Two entropy sources (one non-physical entropy source and one physical entropy source) residing
within the TOEPP provide the random bits. The output of entropy pool provides 256-bits of entropy to seed and
reseed SP800-90ARev1 DRBG during initialization (seed) and reseeding (reseed).

Name

Minimum number of
bits of entropy

Conditioning Components (CAVP number if
vetted)

ESV Cert #E14:
Apple corecrypto physical entropy
source
ESV Cert #E15:
Apple corecrypto non-physical
entropy source

256 bits

256 bits

The entropy source consists of twenty-four Free Ring
Oscillator (FROs) with a vetted conditioning function SHA-
256 (ACVP cert. # C1223)
The non-physical entropy source is based upon interrupt
timings with a vetted conditioning function SHA-256 (ACVP
certs. # A2797, A2869

Table 15 – Entropy Sources

9.2

Key/SSP Generation

The module generates Keys and SSPs in accordance with FIPS 140-3 IG D.H. The cryptographic module performs
Cryptographic Key Generation (CKG) for asymmetric (ECDSA) keys as per [SP800-133r2] section 4 example 1
(vendor affirmed), compliant with [FIPS186-4], and using DRBG compliant with [SP800-90ARev1]. A seed (i.e., the
random value) used in asymmetric key generation is obtained from [SP800-90ARev1] DRBG. The key generation
service for ECDSA as well as the [SP 800-90ARev1] DRBG have been ACVT tested with algorithm certificates
found in Table 6.

9.3

Keys/SSPs Establishment

The module provides the following key/SSP establishment services in the Approved mode:

•  AES-Key Wrapping: The module implements a Key Transport Scheme (KTS) using AES-KW compliant to

[SP800-38F], IG D.G. The SSP establishment methodology provides between 128 and 256 bits of
encryption strength.

9.4

Keys/SSPs Import/Export

All keys and SSPs that are entered from, or output to module, are entered from or output to the invoking
application running on the same device. Keys/ SSPs entered into the module are electronically entered in plain
text form. The module only outputs ECDSA keys in plain text form when key generation service is requested by
the calling application.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 24 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

9.5

Keys/SSPs Storage

Name

Description

RAM

The module stores ephemeral keys/SSPs in RAM provided by the operational
environment. They are received for use or generated by the module only at the
command of the calling application. The operating system protects all keys/SSPs
through the memory separation and protection mechanisms. No process other
than the module itself can access the keys/SSPs in its process’ memory.

9.6

Keys/SSPs Zeroization

Table 16 - Storage Areas

Persistence Type

dynamic

Keys and SSPs are explicitly zeroised when the appropriate context object is destroyed or when the system is
powered down. Input and output interfaces are inhibited while zeroisation is performed.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 25 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

10

Self-tests

While the module is executing the self-tests, services are not available, and input and output are inhibited. If the
test fails either pre-operational and conditional self-tests, the module reports an error message indicating the
cause of the failure and enters the Error State (See section 10.3). The module permits operators to initiate the
pre-operational and conditional self-tests on demand and periodic testing of the module by rebooting the
system (i.e., power-cycling).

10.1  Pre-operational Software Integrity Test

The module performs a pre-operational software integrity test automatically when the module is loaded into
memory (i.e., at power on) before the module transitions to the operational state. A software integrity test is
performed on the runtime image of the Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1] with
HMAC-SHA256 which is an approved integrity technique. Prior to using HMAC-SHA-256, a Conditional
Cryptographic Algorithm Self-Tests (CASTs) is performed.

Algorithm

Test Properties

Test Method

Type

Indicator

Details

HMAC-SHA-256

112-bit key

Message
Authentication

Softwar
e
Integrity

Module
successful
execution

The HMAC value of the runtime image is
recalculated and compared with the stored
HMAC value pre-computed at compilation
time

Table 17 – Pre-Operational Self-Tests

10.2  Conditional Self-Tests

10.2.1 Conditional Cryptographic Algorithm Self-Tests

In addition to the pre-operational software integrity test described in Section 10.1, the module runs the CASTs
for all cryptographic functions of each approved cryptographic algorithm implemented by the module each time
the module starts.

Algorithm

Test Properties

Test Method  Type

Indicator  Details

Condition

AES-CBC
AES-XTS
AES-ECB

AES-CBC
AES-ECB

128-bit key

KAT

CAST  Module

Encryption

becomes
operational

128-bit key

KAT

CAST  Module

Decryption

becomes
operational

AES-CCM

128-bit key

KAT

CAST  Module

Authenticated encryption

becomes
operational

AES-CCM
AES-GCM

128-bit key

KAT

CAST  Module

Authenticated decryption

becomes
operational

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

CTR_DRBG

AES 128-bit key

KAT

CAST  Module

becomes

KAT and Health test per
SP800-90Arev1 section

Test runs at Power-on
before the integrity

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 26 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Algorithm

Test Properties

Test Method  Type

Indicator  Details

Condition

HMAC-SHA256

SHA2-256

KAT

CAST  Module

becomes
operational

CAST is performed prior to
module’s pre-operational
software integrity test

Test runs at Power-on
before the integrity
test

operational

11.3

test

HMAC-SHA-1

SHA-1

KAT

CAST  Module

MAC

becomes
operational

HMAC-SHA-512  SHA-512

KAT

CAST  Module

MAC

becomes
operational

KAT

CAST  Module

Message digest

SHA-1
SHA-256
SHA-512

CAST is covered by
higher level HMAC KAT
per IG 10.3.B

RSA Signature
Generation

2048-bit modulus with
SHA-256

KAT

RSA Signature
Verification

2048-bit modulus with
SHA-256

KAT

becomes
operational

CAST  Module

Sign

becomes
operational

CAST  Module

Verify

becomes
operational

ECDSA Signature
Generation

P-224 curve with SHA-
224

ECDSA Signature
Verification

P-224 curve with SHA-
224

KAT

CAST  Module

Sign

becomes
operational

KAT

CAST  Module

Verify

becomes
operational

Table 18 - Self-Tests

10.2.2 Conditional Pairwise Consistency Test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

Test runs at Power-on
before the integrity
test

The Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1] generates ECDSA asymmetric key pairs
and performs a pair-wise consistency tests on the newly generated key pairs.

10.3  Error States

If any of the self-tests described in Sections 10.1, 10.2.1 or 10.2.2 fail, the module reports the cause of the error
and enters an error state. In the Error State, no cryptographic services are provided, and data output is
prohibited. The only method to recover from the error state is to power cycle the device which results in the
module being reloaded into memory and reperforming the pre-operational test and the Conditional algorithm
self-tests. The module will only enter into the operational state after successfully passing the pre-operational
self-test and the conditional self-tests.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 27 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

State
Name

Error State

Error State

Description

Conditions

The HMAC-SHA-256 value
computed over the module did not
match the pre-computed value
The computed value in the
invoked Conditional CAST did not
match the known value

Pre-operational
Software Integrity
Test failure
Conditional CAST
failure

Recovery
Method

module reset

module reset

Error State

The signature failed to verify
successfully in the Conditional PCT.

Conditional PCT
failure

module reset

Indicator

Error message “FAILED: fipspost_post_integrity”
is sent to the caller

Error message “FAILED:<event>” is sent to the
caller
(<event> refers to any of the cryptographic
functions listed in Table 18 - Self-Tests.)
Error message
“CCEC_GENERATE_KEY_CONSISTENCY”
returned for ECDSA Key Generation

Table 19- Error states

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 28 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

11

Life-cycle assurance

11.1  Delivery and Operation

The module is built into DeviceOS defined in section 2 and delivered with Device OS. There is no standalone
delivery of the module as a software library.

The vendor’s internal development process guarantees that the correct version of module goes with its intended
Device OS version. For additional assurance, the module is digitally signed by vendor, and it is verified during the
integration into Device OS.

This digital signature-based integrity protection during the delivery/integration process is not to be confused
with the HMAC-256 based integrity check performed by the module itself as part of its pre-operational self-tests.

11.2  Administrator Guidance

The Approved mode of operation is configured in the system by default and can only be transitioned into the
non-Approved mode by calling one of the non-Approved services listed in Table 13 - Non-Approved Services. If
the device starts up successfully, then the module has passed all self-tests and is operating in the Approved
mode.

The ESV Public Use Document (PUD) reference for physical entropy source is:
https://csrc.nist.gov/CSRC/media/projects/cryptographic-module-validation-
program/documents/entropy/E14_PublicUse.pdf

The ESV Public Use Document (PUD) reference for non-physical entropy source is:
https://csrc.nist.gov/CSRC/media/projects/cryptographic-module-validation-
program/documents/entropy/E15_PublicUse.pdf

Apple Platform Certifications guide [platform certifications] and Apple Platform Security guide [SEC] are provided
by Apple which offers IT System Administrators with the necessary technical information to ensure FIPS 140-3
Compliance of the deployed systems. This guide walks the reader through the system’s assertion of
cryptographic module integrity and the steps necessary if module integrity requires remediation.

11.3  Non-Administrator Guidance

Not Applicable

11.4  Design and Rules

The Crypto Officer shall consider the following requirements and restrictions when using the module:

o  AES-GCM internal IV is constructed in compliance with IG C.H scenario 1. The GCM IV generation follows
RFC 4106 and shall only be used for the IPsec protocol version 3. When the IV in RFC 4106 exhausts the
maximum number of possible values for a given security association, either party to the security association
that encounters this condition triggers a rekeying with IKEv2 to establish a new encryption key for the
security association. The module uses RFC 7296 compliant IKEv2 to establish the shared secret SKEYSEED
from which the AES-GCM encryption keys are derived. In case the module’s power is lost and then restored,
the key used for the AES GCM encryption/decryption shall be re-distributed. This condition is not enforced
by the module.
This protocol has not been reviewed or tested by the CAVP and CMVP.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 29 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

o  AES-XTS mode is only approved for hardware storage applications. The length of the AES-XTS data unit
does not exceed 220 blocks. The module checks explicitly that Key_1 ≠ Key_2 before using the keys in the
XTS-Algorithm to process data with them compliant with IG C.I.

o  RSA modulus size (IG C.F): In compliance with FIPS 186-4, the RSA signature verification is greater or equal

to 1024 bits. All supported RSA modulus sizes have been CAVP tested.

o  Legacy use (IG C.M): Per SP800-131r2, the SHA-1 within FIPS 186-4 RSA and ECDSA Digital Signature
Verification is used in approved mode (for legacy use), the RSA 1024-bit modulus is used in approved
mode for FIPS 186-4 signature verification (for legacy use).

11.5  End of Life

The module secure sanitization is accomplished by first powering the module down, which will zeroize all SSPs
within volatile memory. Following the power-down, an uninstall by way of system wipe or system update will
zeroize the binary file listed in section 2.9.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 30 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

12  Mitigation of other attacks

The module does not claim mitigation of other attacks.

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 31 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Appendix A.

Glossary and Abbreviations

AES
CAVP
CAST
CAST5
CBC
CCM
CFB
CMVP
CSP
CTR
DRBG
ECB
ESVP
FIPS
GCM
HMAC
KAT
KDF
KEXT
KW
MAC
KPI
NIST
OFB
PAA
PKG
PKV
PSS
PUD
RSA
SHA
SHS
TOEPP
XTS

Advanced Encryption Standard
Cryptographic Algorithm Validation Program
Cryptographic Algorithm Self-Test
A symmetric-key 64-bit block cipher with 128-bit key
Cipher Block Chaining
Counter with Cipher Block Chaining-Message Authentication Code
Cipher Feedback
Cryptographic Module Validation Program
Critical Security Parameter
Counter Mode
Deterministic Random Bit Generator
Electronic Code Book
Entropy Source Validation Program
Federal Information Processing Standards Publication
Galois Counter Mode
Hash Message Authentication Code
Known Answer Test
Key Derivation Function
Kernel Extension
AES Key Wrap
Message Authentication Code
Kernel Programming Interface
National Institute of Science and Technology
Output Feedback
Processor Algorithm Acceleration
Key-Pair Generation
Public Key Validation
Probabilistic Signature Scheme
Public Use Document
Rivest, Shamir, Addleman
Secure Hash Algorithm
Secure Hash Standard
Tested Operational Environment Physical Perimeter
XEX-based Tweaked-codebook mode with cipher text Stealing

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 32 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

Appendix B.

References

FIPS140-3

SP 800-140x

FIPS140-3_IG

FIPS140-3_MM

FIPS PUB 140-3 - Security Requirements for Cryptographic Modules
March 2019
https://doi.org/10.6028/NIST.FIPS.140-3

CMVP FIPS 140-3 Related Reference
https://csrc.nist.gov/Projects/cryptographic-module-validation-program/fips-140-3-standards

Implementation Guidance for FIPS PUB 140-3 and the Cryptographic Module Validation Program
August 2023
https://csrc.nist.gov/Projects/cryptographic-module-validation-program/fips-140-3-ig-announcements

CMVP FIPS 140-3 Draft Management Manual
https://csrc.nist.gov/CSRC/media/Projects/cryptographic-module-validation-program/documents/fips%20140-
3/Draft%20FIPS-140-3-CMVP%20Management%20Manual%2009-18-2020.pdf

SP 800-140

FIPS 140-3 Derived Test Requirements (DTR)
https://csrc.nist.gov/publications/detail/sp/800-140/final

SP 800-140A

CMVP Documentation Requirements

SP 800-140B

SP 800-140C

SP 800-140D

https://csrc.nist.gov/publications/detail/sp/800-140a/final

CMVP Security Policy Requirements
https://csrc.nist.gov/publications/detail/sp/800-140b/final

CMVP Approved Security Functions
https://csrc.nist.gov/publications/detail/sp/800-140c/final

CMVP Approved Sensitive Security Parameter Generation and Establishment Methods
https://csrc.nist.gov/publications/detail/sp/800-140d/final

SP 800-140E

CMVP Approved Authentication Mechanisms https://csrc.nist.gov/publications/detail/sp/800-140e/final

SP 800-140F

FIPS180-4

FIPS186-4

FIPS197

FIPS198-1

PKCS#1

RFC3394

CMVP Approved Non-Invasive Attack Mitigation Test Metrics https://csrc.nist.gov/publications/detail/sp/800-
140f/final

Secure Hash Standard (SHS)
March 2012
http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf

Digital Signature Standard (DSS)
July 2013
http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf

Advanced Encryption Standard
November 2001
http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf

The Keyed Hash Message Authentication Code (HMAC)
July 2008
http://csrc.nist.gov/publications/fips/fips198-1/FIPS-198-1_final.pdf

Public Key Cryptography Standards (PKCS) #1: RSA Cryptography
Specifications Version 2.1
February 2003
http://www.ietf.org/rfc/rfc3447.txt

Advanced Encryption Standard (AES) Key Wrap Algorithm
September 2002
http://www.ietf.org/rfc/rfc3394.txt

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 33 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

RFC5649

SP800-38A

SP800-38C

SP800-38D

SP800-38E

SP800-38F

SP800-56Cr2

SP800-57

SP800-67

SP800-90Ar1

SP800-90B

SP800-108

SP800-131Ar2

SP800-133r2

Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm
September 2009
http://www.ietf.org/rfc/rfc5649.txt

NIST Special Publication 800-38A - Recommendation for Block Cipher Modes of Operation Methods and
Techniques
December 2001
http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf

NIST Special Publication 800-38C - Recommendation for Block Cipher Modes of Operation: the CCM Mode for
Authentication and Confidentiality
May 2004
http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf

NIST Special Publication 800-38D - Recommendation for Block Cipher Modes of Operation:  Galois/Counter
Mode (GCM) and GMAC
November 2007
http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf

NIST Special Publication 800-38E - Recommendation for Block Cipher Modes of Operation: The XTS AES Mode for
Confidentiality on Storage Devices
January 2010
http://csrc.nist.gov/publications/nistpubs/800-38E/nist-sp-800-38E.pdf

NIST Special Publication 800-38F - Recommendation for Block Cipher Modes of Operation: Methods for Key
Wrapping
December 2012
http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-38F.pdf

Recommendation for Key-Derivation Methods in Key-Establishment Schemes
August 2020
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Cr2.pdf

NIST Special Publication 800-57 Part 1 Revision 5 - Recommendation for Key Management Part 1: General
May 2020
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf

NIST Special Publication 800-67 Revision 1 - Recommendation for the Triple Data Encryption Algorithm (TDEA)
Block Cipher
January 2012
http://csrc.nist.gov/publications/nistpubs/800-67-Rev1/SP-800-67-Rev1.pdf

NIST Special Publication 800-90A - Revision 1 - Recommendation for Random Number Generation Using
Deterministic Random Bit Generators
June 2015
http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf

NIST Special Publication 800-90B - Recommendation for the Entropy Sources Used for Random Bit Generation
January 2018
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90B.pdf

NIST Special Publication 800-108r1 - Recommendation for Key Derivation Using Pseudorandom Functions
Aug 2022
https://doi.org/10.6028/NIST.SP.800-108r1

Transitioning the Use of Cryptographic Algorithms and Key Lengths
March 2019
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf

Recommendation for Cryptographic Key Generation
June 2020
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-133r2.pdf

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 34 of 35

Apple corecrypto Module v12.0 [Apple silicon, Kernel, Software, SL1]

FIPS 140-3 Non-Proprietary Security Policy

SP800-135

NIST Special Publication 800-135 Revision 1 - Recommendation for Existing Application-Specific Key Derivation
Functions
December 2011
http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-135r1.pdf

SEC

Apple Platform Security
https://support.apple.com/guide/security/welcome/web

https://manuals.info.apple.com/MANUALS/1000/MA1902/en_US/apple-platform-security-guide.pdf

platform certifications

Apple Platform Certifications
https://support.apple.com/guide/certifications/welcome/web

This document may be reproduced and distributed only in its original entirely without revision.

© 2024 Apple Inc., All rights reserved.

 35 of 35

