Amazon Linux 2023 Kernel Cryptographic API

Versions:
Kernel 6.1.41-64.118.amzn2023, 6.1.41-64.118.fips.amzn2023
Libkcapi 1.4.0-105.amzn2023

FIPS 140-3 Non-Proprietary Security Policy

Document Version: 1.2

Document Date: 2024-09-20

Prepared by:
atsec information security corporation
4516 Seton Center Pkwy, Suite 250
Austin, TX 78759
www.atsec.com

© 2024 Amazon Web Services, Inc., atsec information security.

This document may be reproduced whole and intact including the Copyright notice.

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Table of Contents

1 General ........................................................................................................................... 6
1.1 Overview ....................................................................................................................................... 6
1.2 Security Levels .............................................................................................................................. 6
1.2.1 Additional Information ........................................................................................................... 6
2 Cryptographic Module Specification ................................................................................. 8
2.1 Description .................................................................................................................................... 8
2.2 Tested and Vendor Affirmed Version and Identification .................................................................. 8
2.3 Excluded Components ................................................................................................................... 9
2.4 Modes of Operation ........................................................................................................................ 9
2.5 Algorithms ................................................................................................................................... 10
2.6 Security Function Implementations .............................................................................................. 12
2.7 Algorithm Specific Information ..................................................................................................... 13
2.7.1 AES GCM IV ......................................................................................................................... 13
2.7.2 AES XTS .............................................................................................................................. 13
2.7.3 RSA ..................................................................................................................................... 13
2.7.4 SP 800-56Ar3 Assurances .................................................................................................... 13
2.7.5 Legacy Use .......................................................................................................................... 13
2.8 RBG and Entropy ......................................................................................................................... 14
2.9 Key Generation ............................................................................................................................ 14
2.10 Key Establishment ..................................................................................................................... 14
2.11 Industry Protocols ...................................................................................................................... 15
3 Cryptographic Module Interfaces ................................................................................... 16
3.1 Ports and Interfaces ..................................................................................................................... 16
4 Roles, Services, and Authentication ............................................................................... 17
4.1 Authentication Methods ............................................................................................................... 17
4.2 Roles ........................................................................................................................................... 17
4.3 Approved Services ....................................................................................................................... 17
4.4 Non-Approved Services ................................................................................................................ 18
4.5 External Software/Firmware Loaded ............................................................................................. 19
5 Software/Firmware Security .......................................................................................... 20
5.1 Integrity Techniques .................................................................................................................... 20
5.2 Initiate On-Demand Integrity Test ................................................................................................ 20
6 Operational Environment ............................................................................................... 21
6.1 Operational Environment Type and Requirements ....................................................................... 21
6.2 Configurable Settings and Restrictions ......................................................................................... 21
7 Physical Security ........................................................................................................... 22
8 Non-Invasive Security ................................................................................................... 23
9 Sensitive Security Parameters Management .................................................................. 24
9.1 Storage Areas .............................................................................................................................. 24
9.2 SSP Input-Output Methods ........................................................................................................... 24
9.3 SSP Zeroization Methods.............................................................................................................. 24
9.4 SSPs ............................................................................................................................................ 24
9.5 Transitions ................................................................................................................................... 26

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

2 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

10 Self-Tests .................................................................................................................... 27
10.1 Pre-Operational Self-Tests .......................................................................................................... 27
10.2 Conditional Self-Tests ................................................................................................................ 27
10.3 Periodic Self-Tests...................................................................................................................... 28
10.4 Error States................................................................................................................................ 28
10.5 Operator Initiation of Self-Tests.................................................................................................. 29
11 Life-Cycle Assurance ................................................................................................... 30
11.1 Installation, Initialization, and Startup Procedures ...................................................................... 30
11.2 Administrator Guidance ............................................................................................................. 30
11.3 Non-Administrator Guidance ...................................................................................................... 30
11.4 End of Life Procedures ............................................................................................................... 30
12 Mitigation of Other Attacks ......................................................................................... 31
Appendix A. Glossary and Abbreviations ........................................................................... 32
Appendix B. References ................................................................................................... 34

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

3 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

List of Tables

Table 1 - Security Levels ....................................................................................................................................................................... 6

Table 2 - Tested Module Identification .................................................................................................................................................. 9

Table 3 - Tested Operational Environments .......................................................................................................................................... 9

Table 4 - Software, Hardware, Hybrid Vendor Affirmed Operational Environment .............................................................................. 9

Table 5 - Modes List and Description .................................................................................................................................................. 10

Table 6 - Approved Algorithms ............................................................................................................................................................ 11

Table 7 - Vendor Affirmed Algorithms ................................................................................................................................................. 12

Table 8 - Non-Approved, Not Allowed Algorithms ............................................................................................................................... 12

Table 9 - Security Function Implementations ..................................................................................................................................... 13

Table 10 - Entropy Certificates ............................................................................................................................................................ 14

Table 11 - Entropy ............................................................................................................................................................................... 14

Table 12 - Ports and Interfaces ........................................................................................................................................................... 16

Table 13 - Roles ................................................................................................................................................................................... 17

Table 14 - Approved Services.............................................................................................................................................................. 18

Table 15 - Non-Approved Services ...................................................................................................................................................... 19

Table 16 - Storage Areas ..................................................................................................................................................................... 24

Table 17 - SSP Input-Output Methods ................................................................................................................................................. 24

Table 18 - SSP Zeroization Methods .................................................................................................................................................... 24

Table 19 - SSP Information First .......................................................................................................................................................... 25

Table 20 - SSP Information Second ..................................................................................................................................................... 26

Table 21 - Pre-Operational Self-Tests .................................................................................................................................................. 27

Table 22 - Conditional Self-Tests ......................................................................................................................................................... 28

Table 23 - Error States ........................................................................................................................................................................ 29

List of Figures

Figure 1 – Block Diagram ...................................................................................................................................................................... 8

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

4 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Copyrights and Trademarks
Amazon is a registered trademark of Amazon Web Services, Inc. or its affiliates.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

5 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

1  General

1.1  Overview

This document is the non-proprietary FIPS 140-3 Security Policy for Amazon Linux 2023 Kernel
Cryptographic API versions:

•  Kernel: 6.1.41-64.118.amzn2023 (Amazon Linux 2023) and 6.1.41-64.118.fips.amzn2023

(SnowOS 1.0)

•  Libkcapi: 1.4.0-105.amzn2023

It contains the security rules under which the module must operate and describes how this module
meets the requirements as specified in FIPS PUB 140-3 (Federal Information Processing Standards
Publication 140-3) for an overall Security Level 1 module.

This Non-Proprietary Security Policy may be reproduced and distributed, but only whole and intact and
including this notice. Other documentation is proprietary to their authors.

1.2  Security Levels

Table 1 describes the individual security areas of FIPS 140-3, as well as the security levels of those
individual areas.

ISO/IEC 24759 Section 6
Subsections

FIPS 140-3 Section Title

Security Level

1

2

3

4

5

6

7

8

9

10

11

12

General

Cryptographic Module Specification

Cryptographic Module Interfaces

Roles, Services, and Authentication

Software/Firmware Security

Operational Environment

Physical Security

Non-invasive Security

Sensitive Security Parameter Management

Self-tests

Life-cycle Assurance

Mitigation of Other Attacks

Overall

Table 1 - Security Levels

1

1

1

1

1

1

Not Applicable

Not Applicable

1

1

1

Not Applicable

1

1.2.1  Additional Information

This Security Policy describes the features and design of the module named Amazon Linux 2023 Kernel
Cryptographic API using the terminology contained in the FIPS 140-3 specification. The FIPS 140-3
Security Requirements for Cryptographic Module specifies the security requirements that will be
satisfied by a cryptographic module utilized within a security system protecting sensitive but
unclassified information. The NIST/CCCS Cryptographic Module Validation Program (CMVP) validates
cryptographic module to FIPS 140-3. Validated products are accepted by the Federal agencies of both
the USA and Canada for the protection of sensitive or designated information.

This FIPS 140-3 non-proprietary Security Policy may be reproduced and distributed, but only whole and
intact and including this notice. Other documentation is proprietary to their authors.

In preparing the Security Policy document, the laboratory formatted the vendor-supplied documentation
for consolidation without altering the technical statements therein contained. The further refining of the
Security Policy document was conducted iteratively throughout the conformance testing, wherein the
Security Policy was submitted to the vendor, who would then edit, modify, and add technical contents.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

6 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

The vendor would also supply additional documentation, which the laboratory formatted into the
existing Security Policy, and resubmitted to the vendor for their final editing.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

7 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

2  Cryptographic Module Specification

2.1  Description

Purpose  and  Use:  The  Amazon  Linux  2023  Kernel  Cryptographic  API  (hereafter  referred  to  as  “the
module”) provides a C language application program interface (API) for use by other (kernel space and
user  space)  processes  that  require  cryptographic  functionality.  The  module  operates  on  a  general-
purpose computer as part of the Linux kernel. Its cryptographic functionality can be accessed using the
Linux Kernel Crypto API.

Module Type: Software

Module Embodiment: Multi-chip standalone

Module Characteristics: N/A

Cryptographic Boundary: The cryptographic boundary of the module is defined as the kernel binary
and  the  kernel  crypto  object  files,  the  libkcapi  library,  and  the  sha512hmac  binary,  which  is  used  to
verify  the  integrity  of  the  software  components.  In  addition,  the  cryptographic  boundary  contains  the
.hmac files which store the expected integrity values for each of the software components.

Tested  Operational  Environment’s  Physical  Perimeter  (TOEPP):  The  TOEPP  of  the  module  is
defined as the general-purpose computer on which the module is installed.

2.2  Tested and Vendor Affirmed Version and Identification

Figure 1 – Block Diagram

Tested Module Identification – Software, Firmware, Hybrid (Executable Code Sets):

Package/File Names

Software/ Firmware Version

EC2 c7g.metal:
/boot/vmlinuz-6.1.41-64.118.amzn2023.aarch64

EC2 c6i.metal:
/boot/vmlinuz-6.1.41-64.118.amzn2023.x86_64
AWS Snowball, AWS Snowblade, AWS Snowcone:
/boot/vmlinuz-6.1.41-64.118.fips.amzn2023.x86_64

EC2 c7g.metal, EC2 c6i.metal:
6.1.41-64.118.amzn2023
AWS Snowball, AWS Snowblade,
AWS Snowcone:
6.1.41-64.118.fips.amzn2023

Integrity Test
Implemented

HMAC-SHA-512

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

8 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

EC2 c7g.metal:
*.ko and *.ko.xz files in /usr/lib/modules/6.1.41-
64.118.amzn2023.aarch64/kernel/crypto/
*.ko.xz files in /usr/lib/modules/6.1.41-
64.118.amzn2023.aarch64/kernel/arch/aarch64/crypto
EC2 c6i.metal:
*.ko and *.ko.xz files in /usr/lib/modules/6.1.41-
64.118.amzn2023.x86_64/kernel/crypto/
*.ko.xz files in /usr/lib/modules/6.1.41-
64.118.amzn2023.x86_64/kernel/arch/x86/crypto/
AWS Snowball, AWS Snowblade, AWS Snowcone:
*.ko and *.ko.xz files in /usr/lib/modules/6.1.41-
64.118.fips.amzn2023.x86_64/kernel/crypto/
*.ko.xz files in /usr/lib/modules/6.1.41-
64.118.fips.amzn2023.x86_64/kernel/arch/x86/crypto
/usr/lib64/libkcapi.so.1.4.0
/usr/lib/sha512hmac

RSA Signature
Verification

1.4.0-105.amzn2023

HMAC-SHA-512

Table 2 - Tested Module Identification

Tested Operational Environments - Software, Firmware, Hybrid: The module has been tested on
the  following  platforms  with  the  corresponding  module  variants  and  configuration  options  with  and
without PAA:

Operating System  Hardware Platform

Processor(s)

PAA/PAI

Version(s)

Amazon Linux 2023  EC2 c7g.metal

AWS Graviton3

Amazon Linux 2023  EC2 c6i.metal

Intel Xeon Platinum
8375C

SnowOS 1.0

SnowOS 1.0

AWS Snowball

AMD EPYC 7702

AWS Snowblade

Intel Xeon Gold
6314U

SnowOS 1.0

AWS Snowcone

Intel Atom C3558

Amazon Linux 2023  EC2 c7g.metal

AWS Graviton3

None

Amazon Linux 2023  EC2 c6i.metal

Intel Xeon Platinum
8375C

SnowOS 1.0

SnowOS 1.0

AWS Snowball

AMD EPYC 7702

AWS Snowblade

Intel Xeon Gold
6314U

SnowOS 1.0

AWS Snowcone

Intel Atom C3558

Table 3 - Tested Operational Environments

6.1.41-64.118.amzn2023 and
1.4.0-105.amzn2023

Neon,
Cryptography
Extensions
(PAA)

AES-NI (PAA)

6.1.41-64.118.fips.amzn2023 and
1.4.0-105.amzn2023

6.1.41-64.118.amzn2023 and
1.4.0-105.amzn2023

6.1.41-64.118.fips.amzn2023 and
1.4.0-105.amzn2023

Vendor-Affirmed  Operational  Environments  -  Software,  Firmware,  Hybrid:  The  vendor  affirms
the  following  platforms  with  the  corresponding  module  variants  and  configuration  options  with  and
without PAA:

Operating System

Hardware Platform

Bottlerocket v1.20.0  EC2 c7g.metal with Intel Xeon Platinum 8375C (PAA: AES-NI)

Bottlerocket v1.20.0  EC2 c6i.metal with AWS Graviton3 processor (PAA: Neon, Cryptography Extensions)

Table 4 - Software, Hardware, Hybrid Vendor Affirmed Operational Environment

2.3  Excluded Components

There are no components excluded from the requirements of the FIPS 140-3 standard.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

9 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

2.4  Modes of Operation

Modes List and Description:

Name

Approved mode

Non-approved mode

Description

Automatically entered whenever
an approved service is requested

Type

Approved

Automatically entered whenever a
non-approved service is requested

Non-approved

Status Indicator

Equivalent to the indicator of the
requested service

Equivalent to the indicator of the
requested service

Table 5 - Modes List and Description

After passing all pre-operational self-tests and cryptographic algorithm self-tests executed on start-up,
the  module  automatically  transitions  to  the  approved  mode.  No  operator  intervention  is  required  to
reach this point.

Mode change instructions and status indicators: The module automatically switches between the
approved  and  non-approved  modes  depending  on  the  services  requested  by  the  operator.  The  status
indicator of the mode of operation is equivalent to the indicator of the service that was requested.

Degraded Mode Description:  The module does not implement a degraded mode of operation.

2.5  Algorithms

Approved  Algorithms:  Table  6  lists  all  approved  cryptographic  algorithms  of  the  module,  including
specific key lengths employed for approved services (Table 14), and implemented modes or methods of
operation of the algorithms.

Algorithm
Name

AES-CBC

AES-CBC-CS3

AES-CCM

AES-CFB128

AES-CMAC

AES-CTR

AES-ECB

AES-GCM

AES-GMAC

AES-KW

CAVP Cert

Algorithm Capabilities

OE (Implementation)  Reference

A4551, A4554, A4557,
A4558, A4561, A4563,
A4566

A4551, A4554, A4557,
A4558, A4561, A4566

A4551, A4554, A4557,
A4558, A4566

A4551, A4554, A4558,
A4566

A4551, A4554, A4557,
A4558, A4566

A4551, A4554, A4557,
A4558, A4561, A4563,
A4566

A4551, A4552, A4553,
A4554, A4555, A4556,
A4557, A4558, A4559,
A4560, A4561, A4563,
A4564, A4565, A4566,
A4567, A4568

A4551, A4552, A4553,
A4554, A4555, A4556,
A4558, A4559, A4560,
A4563, A4564, A4565,
A4566, A4567,  A4568

A4551, A4554, A4558,
A4566

A4551, A4554, A4558,
A4566

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits
IV Generation: Internal (encryption) & External
(decryption)
IV Generation Mode: 8.2.2

Key size: 128, 192, 256 bits

Key size: 128, 192, 256 bits

Amazon Linux 2023 on EC2
c7g.metal
Amazon Linux 2023 on EC2
c6i.metal
SnowOS 1.0 on AWS Snowball
SnowOS 1.0 on AWS Snowblade
SnowOS 1.0 on AWS Snowcone

FIPS 197
SP 800-38A

FIPS 197
SP 800-38A
Addendum

FIPS 197
SP 800-38C

FIPS 197
SP 800-38A

FIPS 197
SP 800-38B

FIPS 197
SP 800-38A

FIPS 197
SP 800-38A

FIPS 197
SP 800-38D

FIPS 197
SP 800-38D

FIPS 197
SP 800-38F

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

10 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

CAVP Cert

Algorithm Capabilities

OE (Implementation)  Reference

Algorithm
Name

AES-OFB

AES-XTS

CTR_DRBG

A4551, A4554, A4558,
A4566

A4551, A4554, A4557,
A4558, A4561, A4563,
A4566

A4551, A4552, A4553,
A4554, A4555, A4556,
A4558, A4559, A4560,
A4563, A4564, A4565,
A4566, A4567, A4568

Key size: 128, 192, 256 bits

Key size: 128, 256 bits

Size: AES-128, AES-192, AES-256
Without derivation function
With/without prediction resistance

ECDSA

A4551

Key Pair Generation
Mode: Testing Candidates (Appendix B.4.2)
Curves: P-256, P-384

Hash_DRBG

A4551, A4569, A4570,
A4571

Hashes: SHA-1, SHA-256, SHA-512
With/without prediction resistance

HMAC_DRBG

A4551, A4569, A4570,
A4571

Hashes: SHA-1, SHA-256, SHA-512
With/without prediction resistance

HMAC

A4551, A4557, A4569,
A4570, A4571

SHA-1
Key size: 112-524288 bits

A4551, A4557, A4561,
A4562, A4569, A4570,
A4571

SHA-224, SHA-256
Key size: 112-524288 bits

A4551, A4557, A4562,
A4569, A4570, A4571

SHA-384, SHA-512
Key size: 112-524288 bits

A4551, A4557

SHA3-224, SHA3-256, SHA3-384, SHA3-512
Key size: 112-524288 bits

KAS-ECC-SSC

A4551

KAS-FFC-SSC

A4551

RSA

A4551, A4569, A4570,
A4571

Safe Primes

A4551

Scheme: Ephemeral Unified Model
Roles: initiator, responder
Curves: P-256, P-384

Scheme: dhEphem
Roles: initiator, responder
Groups: ffdhe2048, ffdhe3072, ffdhe4096,
ffdhe6144, ffdhe8192

Signature Verification
Padding: PKCS#1 v1.5
Hashes: SHA-1, SHA-224, SHA-256, SHA-384, SHA-
512
Modulus: 4096 bits

Key Pair Generation
Mode: Testing Candidates (Appendix 5.6.1.1.4)
Groups: ffdhe2048, ffdhe3072, ffdhe4096,
ffdhe6144, ffdhe8192

SHA-1

SHA-224

SHA-256

SHA-384

SHA-512

A4551, A4557, A4569,
A4570, A4571

N/A

A4551, A4557, A4561,
A4562, A4569, A4570,
A4571

N/A

A4551, A4557, A4562,
A4569, A4570, A4571

N/A

FIPS 197
SP 800-38A

FIPS 197
SP 800-38E

SP 800-90Ar1

FIPS 186-4

SP 800-90Ar1

SP 800-90Ar1

FIPS 198-1
FIPS 180-4

FIPS 198-1
FIPS 180-4

FIPS 198-1
FIPS 180-4

FIPS 198-1
FIPS 202

SP 800-56Ar3

FIPS 186-4

SP 800-56Ar3

FIPS 180-4

SHA3-224

A4551, A4557

N/A

FIPS 202

SHA3-256

SHA3-384

SHA3-512

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

11 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Vendor Affirmed Algorithms:

Table 6 - Approved Algorithms

Algorithm Name

Algorithm Capabilities

OE (Implementation)

References

Cryptographic Key
Generation (CKG)

Key Pair Generation using Safe
Primes and EC

Amazon Linux 2023 on EC2 c7g.metal  SP 800-133r2 Section

4, 5.1, and 5.2

Amazon Linux 2023 on EC2 c6i.metal

SnowOS 1.0 on AWS Snowball

SnowOS 1.0 on AWS Snowblade

SnowOS 1.0 on AWS snowcone

Table 7 - Vendor Affirmed Algorithms

Non-Approved,  Allowed  Algorithms:  The  module  does  not  implement  non-approved  algorithms
allowed in the approved mode of operation.

Non-Approved,  Allowed  Algorithms  with No Security  Claimed:  The  module  does  not  implement
non-approved algorithms allowed in the approved mode of operation with no security claimed.

Non-Approved, Not Allowed Algorithms: Table 8 lists all non-approved cryptographic algorithms of
the module employed by the non-approved services in Table 15.

Name

Use and Function

AES GCM with external IV

Encryption

KBKDF (libkcapi)

HKDF (libkcapi)

Key Derivation

Key Derivation

PBKDF2 (libkcapi)

Password-Based Key Derivation

RSA

Encryption Primitive

Decryption Primitive

RSA with PKCS#1 v1.5 padding

Signature Generation (pre-hashed message)
Signature Verification (pre-hashed message)

Key Encapsulation

Key Un-encapsulation

2.6  Security Function Implementations

Table 8 - Non-Approved, Not Allowed Algorithms

Name

Type

Description

SF Capabilities

Algorithms

KAS-ECC-SSC

KAS  EC Diffie-Hellman Shared
Secret Computation

KAS-FFC-SSC

KAS  Diffie-Hellman Shared

Secret Computation

Security strength: 128, 192 bits
Compliant with SP 800-56Ar3 and
Scenario 2 (1) of FIPS 140-3 IG D.F

Security strength: 112-200 bits
Compliant with SP 800-56Ar3 and
Scenario 2 (1) of FIPS 140-3 IG D.F

KAS-ECC-SSC (SP 800-
56Ar3)

KAS-FFC-SSC (SP 800-
56Ar3)

AES-KW

AES-CCM

KTS

KTS

AES-GCM/WRAP

KTS

Key wrapping/unwrapping Security strength: 128, 192, 256 bits  AES-KW (SP 800-38F)

Key wrapping/unwrapping
using authenticated
encryption (as permitted
by IG D.G)
Key wrapping using
authenticated encryption

Security strength: 128, 192, 256 bits  AES-CCM (SP 800-38C)

IV generated internally
Security strength: 128, 192, 256 bits

AES-GCM (SP 800-38D)

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

12 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

AES-GCM/UNWRAP  KTS

(as permitted by IG D.G)
Key unwrapping using
authenticated encryption
(as permitted by IG D.G)

IV provided externally
Security strength: 128, 192, 256 bits

AES-GCM (SP 800-38D)

AES-CBC with
HMAC
AES-CTR with
HMAC

KTS

KTS

Key wrapping/unwrapping
using “combination”
mode encryption (as
permitted by IG D.G)

Security strength: 128, 192, 256 bits
Hashes: SHA-1, SHA-256, SHA-384,
SHA-512

AES-CBC (SP 800-38A)
HMAC (FIPS 198-1)
AES-CTR (SP 800-38A)
HMAC (FIPS 198-1)

Table 9 - Security Function Implementations

2.7  Algorithm Specific Information

2.7.1 AES GCM IV

The Crypto Officer shall consider the following requirements and restrictions when using the module.

For  IPsec,  the  module  offers  the  AES  GCM  implementation  and  uses  the  context of  Scenario  1  of FIPS
140-3  IG  C.H.  The  mechanism  for  IV  generation  is  compliant  with  RFC  4106.  IVs  generated  using  this
mechanism may only be used in the context of AES GCM encryption within the IPsec protocol.

The module does not implement IPsec. The module’s implementation of AES GCM is used together with
an  application  that  runs  outside  the  module’s  cryptographic  boundary.  This  application  must  use  RFC
7296  compliant  IKEv2  to  establish  the  shared  secret  SKEYSEED  from  which  the  AES  GCM  encryption
keys are derived.

The  design  of  the  IPsec  protocol  implicitly  ensures  that  the  counter  (the  nonce_explicit  part  of  the  IV)
does not exhaust the maximum number of possible values for a given session key.

In the event the module’s power is lost and restored, the consuming application must ensure that a new
key for use with the AES GCM key encryption or decryption under this scenario shall be established.

The module also provides a non-approved AES GCM encryption service which accepts arbitrary external
IVs from the operator. This service can be requested by invoking the crypto_aead_encrypt API function
with  an  AES  GCM  handle. When  this  is  the  case, the  API  will  not set  an approved  service  indicator,  as
described in Table 14.

2.7.2 AES XTS

In accordance with IG C.I, the module implements a check to ensure that the two AES keys used in the
AES-XTS algorithm are not identical.

The length of a single data unit encrypted or decrypted with AES XTS shall not exceed 220 AES blocks,
that is 16MB, of data per XTS instance. An XTS instance is defined in Section 4 of SP 800-38E.

The  XTS  mode  shall  only  be  used  for  the  cryptographic  protection  of  data on  storage  devices. It  shall
not be used for other purposes, such as the encryption of data in transit.

2.7.3 RSA

For RSA signature verification, all supported, approved modulus sizes have been CAVP tested

2.7.4 SP 800-56Ar3 Assurances

To comply with the assurances found in Section 5.6.2 of SP 800-56Ar3, the operator must use the Diffie-
Hellman  and  elliptic  curve  Diffie-Hellman  shared  secret  computation  algorithms  with  the  NVMe  and
Bluetooth related protocols. Additionally, the module’s approved key pair generation service (see Table
14) must be used to generate ephemeral Diffie-Hellman or EC Diffie-Hellman key pairs, or the key pairs
must be obtained from another FIPS-validated module. As part of this service, the module will internally
perform the full public key validation of the generated public key.

The module’s shared secret computation service will internally perform the full public key validation of
the peer DH public key, and the partial public key validation of the peer EC public key, complying with
Section 5.6.2.2.2 of SP 800-56Ar3.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

13 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

2.7.5 Legacy Use

Digital signature verification using SHA-1 is allowed for legacy use only.

2.8  RBG and Entropy

Vendor Name

Certificate Number

Amazon

Cert. E105

Table 10 - Entropy Certificates

 Name

Type

Operational
Environment

Sample Size

Entropy Per
Sample

Conditioning
Component

Amazon Kernel CPU
Time Jitter RNG
Entropy Source

Non-
physical

See Table 3

256 bits

256 bits

SHA3-256 (A4551)

Table 11 - Entropy

The  module  implements  three  different  Deterministic  Random  Bit  Generator  (DRBG)  implementations
based  on  SP  800-90Ar1:  CTR_DRBG,  Hash_DRBG,  and  HMAC_DRBG.  Each  of  these  DRBG
implementations  can  be  instantiated  by  the  operator  of  the  module,  using  the  parameters  listed  in
Table 6. When instantiated, these DRBGs can be used to generate random numbers for external usage.

Additionally, the module employs a specific HMAC-SHA-512 DRBG implementation for internal purposes
(e.g.  to  generate  asymmetric  key  pairs).  This  DRBG  is  initially  seeded  with  384  output  bits  from  the
entropy  source  (corresponding  to  384  bits  of  entropy)  and  reseeded  with  256  output  bits  from  the
entropy source (corresponding to 256 bits of entropy).

The  module  complies  with  the  Public  Use  Document  for  ESV  certificate  E105  seeding  the
aforementioned  DRBG  using  the  jent_kcapi_random  function,  which  corresponds  to  the  GetEntropy()
function. The operational environment of the module is identical to the one listed on the ESV certificate.
There are no maintenance requirements for the entropy source.

The  following  is  the  link  to  the  Public  Use  Document  of  Amazon  Kernel  CPU  Time  Jitter  RNG  Entropy
Source:

https://csrc.nist.gov/CSRC/media/projects/cryptographic-module-validation-
program/documents/entropy/E105_PublicUse.pdf

2.9  Key Generation

The module implements Cryptographic Key Generation (CKG, vendor affirmed), compliant with SP 800-
133r2. When random values are required, they are directly obtained as output from the SP 800-90Ar1
approved  DRBG,  compliant  with  Section  4  of  SP  800-133r2  (without  XOR).  The  following  methods  are
implemented:

•  Safe  Primes  key  pair  generation:  compliant  with  SP  800-133r2,  Section  5.2,  which  maps  to  SP
800-56Ar3. The method described in Section 5.6.1.1.4 of SP 800-56Ar3 (“Testing Candidates”) is
used.

•  EC  key  pair  generation:  compliant  with  SP  800-133r2,  Section  5.1,  which  maps  to  FIPS  186-4.
The method described in Appendix B.4.2 of FIPS 186-4 (“Testing Candidates”) is used. Note that
this generation method is also used to generated ECDH key pairs.

Intermediate  key  generation  values  are  not  output  from  the  module  and  are  explicitly  zeroized  after
processing the service.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

14 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

2.10  Key Establishment

The module implements SSP agreement and SSP transport methods as listed in Table 9.

The module implements the P-256 and P-384 curves.

For P-256, N is 256 bits and s is 128 bits.
For P-384, N is 384 bits and s is 192 bits.

The  module  implements  the  ffdhe2048,  ffdhe3072,  ffdhe4096,  ffdhe6144,  and  ffdhe8192  safe  prime
groups.

For ffdhe2048, N is 2048 bits and s is 112 bits
For ffdhe3072, N is 3072 bits and s is 128 bits
For ffdhe4096, N is 4096 bits and s is 152 bits
For ffdhe6144, N is 6144 bits and s is 176 bits
For ffdhe8192, N is 8192 bits and s is 200 bits

(N is the bit length of the private key and s is the maximum security strength supported)

2.11  Industry Protocols

AES-GCM with internal IV generation in the approved mode is compliant with RFC 4106 and shall only
be used in conjunction with the IPsec protocol.

Diffie-Hellman and EC Diffie-Hellman shall only be used with the NVMe and Bluetooth related protocols.

No  other  parts  of  the  NVMe,  Bluetooth,  or  IPSec  protocols,  other  than  those  mentioned  above,  have
been tested by the CAVP and CMVP.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

15 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

3  Cryptographic Module Interfaces

3.1  Ports and Interfaces

Physical Port

Logical Interface

Data that passes over the port/interface

As a software-only module, the
module does not have physical
ports. Physical Ports are
interpreted to be the physical
ports of the hardware platform on
which it runs.

Data Input

API data input parameters, AF_ALG type sockets

Data Output

API output parameters, AF_ALG type sockets

Control Input

API function calls, API control input parameters, AF_ALG
type sockets, kernel command line

Status Output

API return values, AF_ALG type sockets, kernel logs

Table 12 - Ports and Interfaces

The  logical  interfaces  are  the  APIs  through  which  the  applications  request  services.  These  logical
interfaces are logically separated from each other by the API design. The module does not implement a
control output interface.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

16 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

4  Roles, Services, and Authentication

4.1  Authentication Methods

The module does not implement authentication.

4.2  Roles

Name

Type

Operator Type

Authentication Methods

Crypto Officer

Role

CO

N/A

Table 13 - Roles

The module supports the Crypto Officer role only. This sole role is implicitly and always assumed by the
operator of the module. No support is provided for multiple concurrent operators.

4.3  Approved Services

Name

Description

Indicator

Inputs

Outputs

Message Digest  Compute a

message digest

crypto_shash_init returns
0

Message

Digest value

Encryption

Decryption

Encrypt a
plaintext

Decrypt a
ciphertext

Authenticated
Encryption

Encrypt a
plaintext

Authenticated
Decryption

Decrypt a
ciphertext

crypto_skcipher_setkey
returns 0

AES key, IV,
plaintext

Ciphertext

For all except AES GCM:
crypto_aead_setkey
returns 0
For AES GCM:
crypto_aead_get_flags(tf
m) has the
CRYPTO_TFM_FIPS_COMP
LIANCE flag set

AES key, IV,
ciphertext

Plaintext

AES key, IV,
plaintext

Ciphertext,
MAC tag

AES key, IV,
ciphertext,
MAC tag

Plaintext

Roles  SSP Access

CO

N/A

AES key: W, E

AES key: W, E
HMAC key: W, E

Security
Functions

SHA-1, SHA-224,
SHA-256, SHA-384,
SHA-512, SHA3-224,
SHA3-256, SHA3-384,
SHA3-512

AES CBC, CBC-CS3,
CFB128, CTR, ECB,
KW, OFB, XTS

AES CCM, GCM
(internal IV)
AES CBC or CTR with
HMAC-SHA-1, HMAC-
SHA-256, HMAC-SHA-
384, or HMAC-SHA-
512

AES CCM, GCM
(external IV)
AES CBC or CTR with
HMAC-SHA-1, HMAC-
SHA-256, HMAC-SHA-
384, or HMAC-SHA-
512

Message
Authentication

Compute a MAC
tag

crypto_shash_init returns
0

AES key,
message

MAC tag

AES CMAC, GMAC

AES key: W, E

HMAC key,
message

DH private
key, DH public
key

EC private
key, EC public
key

Group

HMAC-SHA-1, HMAC-
SHA-224, HMAC-SHA-
256, HMAC-SHA-384,
HMAC-SHA-512,
HMAC-SHA3-224,
HMAC-SHA3-256,
HMAC-SHA3-384,
HMAC-SHA3-512

Shared secret  KAS-FFC-SSC

KAS-ECC-SSC

DH private
key, DH public
key

Safe Primes Key Pair
Generation

HMAC key: W, E

DH private key: W, E
DH public key: W, E
Shared secret: G, R

EC private key: W, E
EC public key: W, E
Shared secret: G, R

DH private key: G, R
DH public key: G, R
Intermediate key
generation value: G,

Shared Secret
Computation

Compute a
shared secret

crypto_kpp_compute_sha
red_secret returns 0

Key Pair
Generation

Generate a key
pair

crypto_kpp_set_secret
and
crypto_kpp_generate_pu
blic_key return 0

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

17 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Name

Description

Indicator

Inputs

Outputs

Security
Functions

Roles  SSP Access

Random
Number
Generation

Error Detection
Code

Compression

Generic System
Call

Generate
random bytes

crypto_rng_get_bytes
returns 0

None

None

None

Compute an
EDC (crc32,
crct10dif)

Compress data
(deflate, lz4,
lz4hc, lzo, zlib-
deflate, zstd)

Use the kernel
to perform
various non-
cryptographic
operations

Curve

EC private
key, EC public
key

EC Key Pair
Generation

Output length  Random bytes  CTR_DRBG,
Hash_DRBG,
HMAC_DRBG

Message

EDC

N/A

Data

Compressed
data

N/A

Identifier,
various
arguments

Various return
values

N/A

Show Version  Return the

None

Show Status

Self-Test

module name
and version
information

Return the
module status

Perform the
CASTs and
integrity tests

None

None

N/A

N/A

N/A

Module name
and version

N/A

Module status  N/A

Pass/fail

SHA, SHA-3, AES,
HMAC, KAS-FFC-SSC,
KAS-ECC-SSC,
CTR_DRBG,
Hash_DRBG,
HMAC_DRBG, RSA

See Table 22 for
specifics

E, Z

EC private key: G, R
EC public key: G, R
Intermediate key
generation value: G,
E, Z

Entropy input: W, E
DRBG seed: E, G
Internal state: E, G

N/A

N/A

N/A

N/A

N/A

N/A

Zeroization

Zeroize all SSPs  None

Any SSP

N/A

N/A

All SSPs: Z

The following convention is used to specify access rights to SSPs:

•  Generate (G): The module generates or derives the SSP.

Table 14 - Approved Services

•  Read (R): The SSP is read from the module (e.g. the SSP is output).

•  Write (W): The SSP is updated, imported, or written to the module.

•  Execute (E): The module uses the SSP in performing a cryptographic operation.

•  Zeroize (Z): The module zeroizes the SSP.

•  N/A: The module does not access any SSP or key during its operation.

4.4  Non-Approved Services

Name

Description

Security Functions

Role

AES GCM External IV
Encryption

Encrypt a plaintext using AES GCM with an
external IV

AES GCM (external IV)

CO

Key Derivation

Derive a key from a key-derivation key or a
shared secret

KBKDF (libkcapi)

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

18 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Name

Description

Security Functions

Role

Password-Based Key
Derivation

Encryption Primitive

Derive a key from a password

PBKDF2 (libkcapi)

HKDF (libkcapi)

Compute the raw RSA encryption of a
plaintext/ciphertext

RSA

Decryption Primitive

Compute the raw RSA decryption of a
plaintext/ciphertext

Signature Generation
(pre-hashed message)

Generate a digital signature for a pre-hashed
message

RSA with PKCS#1 v1.5 padding

Signature Verification
(pre-hashed message)

Verify a digital signature for a pre-hashed
message

Key Encapsulation

Encapsulate a secret key using RSA with
PKCS#1 v1.5 padding

Key Un-encapsulation  Un-encapsulate a secret key using RSA with
PKCS#1 v1.5 padding

4.5  External Software/Firmware Loaded

The module does not load external software or firmware.

Table 15 - Non-Approved Services

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

19 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

5  Software/Firmware Security

5.1

Integrity Techniques

The Linux kernel binary is integrity tested using an HMAC-SHA-512 calculation performed by the
sha512hmac utility (which utilizes the module’s HMAC and SHA-512 implementations) which compares
the computed HMAC value with a precomputed HMAC value. An HMAC-SHA-512 calculation is also
performed on the sha512hmac utility and the libkcapi library to verify their integrity by comparing the
computed HMAC value with a precomputed HMAC value. The kernel crypto object files listed in Table 3.
are loaded on start-up by the module and verified using RSA signature verification with PKCS#1 v1.5
padding, SHA-512, and a 4096-bit key.

5.2

Initiate On-Demand Integrity Test

Integrity tests are performed as part of the pre-operational self-tests, which are executed when the
module is initialized. The integrity tests can be invoked on demand by unloading and subsequently re-
initializing the module, which will perform (among others) the software integrity tests.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

20 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

6  Operational Environment

6.1  Operational Environment Type and Requirements

Type of Operating Environment: The module operates in a modifiable operational environment. The
module  runs  on  commercially  available  general-purpose  operating  systems  (Amazon  Linux  2023  and
SnowOS  1.0),  which  allows  modification,  loading,  and  execution  of  software  that  is  not  part  of  the
validated module.

How  Requirements  are  Satisfied:  The  operating  system  provides  process  isolation  and  memory
protection mechanisms that ensure appropriate separation for memory access among the processes on
the  system.  Each  process  has  control  over  its  own  data  and  uncontrolled  access  to  the  data  of  other
processes is prevented.

6.2  Configurable Settings and Restrictions

The module shall be installed as stated in Section 11.

Instrumentation tools like the ptrace system call, gdb and strace, user space live patching, as well as
other tracing mechanisms offered by the Linux environment such as  ftrace or systemtap, shall not be
used  in  the  operational  environment.  The  use  of  any  of  these  tools  implies  that  the  cryptographic
module is running in a non-validated operational environment.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

21 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

7  Physical Security

The module is comprised of software only and therefore this section is not applicable.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

22 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

8  Non-Invasive Security

This module does not implement any non-invasive security mechanism and therefore this section is not
applicable.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

23 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

9  Sensitive Security Parameters Management

9.1  Storage Areas

Storage Area Name

Description

Persistence Type

RAM

Temporary storage for SSPs used by the module as part of
service execution

Dynamic

Table 16 - Storage Areas

The module does not perform persistent storage of SSPs. The SSPs are temporarily stored in the RAM in
plaintext  form.  SSPs  are  provided  to  the  module  by  the  calling  process  and  are  destroyed  when
released by the appropriate zeroization function calls.

9.2  SSP Input-Output Methods

Name

From

To

Format Type

Distribution Type  Entry Type

API input parameters  Operator calling

AF_ALG_type sockets
(input)

application
(TOEPP)

API output parameters  Cryptographic

module

AF_ALG type sockets
(output)

Cryptographic
module

Operator calling
application
(TOEPP)

Plaintext

Manual

Electronic

9.3  SSP Zeroization Methods

Table 17 - SSP Input-Output Methods

Method

Description

Rationale

Operator Initiation Capability

Free cipher
handle

Zeroizes the SSPs
contained within
the cipher handle

Memory occupied by
SSPs is overwritten
with zeroes, which
renders the SSP values
irretrievable.

Automatic

Automatically
zeroized by the
module when no
longer needed

Remove power
from the
module

De-allocates the
volatile memory
used to store
SSPs

Memory occupied by
SSPs is overwritten
with zeroes, which
renders the SSP values
irretrievable.
Volatile memory used
by the module is
overwritten within
nanoseconds when
power is removed

By calling the appropriate zeroization functions:
AES Key: crypto_free_skcipher and crypto_free_aead
HMAC Key: crypto_free_shash and crypto_free_ahash
Internal State (V, Key), Internal State (V, C):
crypto_free_rng
DH Public Key & DH Private Key: crypto_free_kpp
EC Public Key & EC Private Key: crypto_free_kpp
RSA Public Key: public_key_free

N/A

By removing power

All data output is inhibited during zeroization.

9.4  SSPs

Table 18 - SSP Zeroization Methods

Name

Description

Size

Strength

Type

Generated By  Established By

AES Key

AES key used for
encryption,
decryption, and
computing MAC tags

XTS: 256, 512 bits
Other modes: 128,
192, 256 bits

XTS: 128, 256 bits
Other modes: 128,
192, 256 bits

Symmetric key  N/A

N/A

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

24 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Name

Description

Size

Strength

Type

Generated By  Established By

HMAC Key

Shared Secret

HMAC key used for
computing MAC tags

Shared secret
generated by (EC)
Diffie-Hellman

Entropy input

DRBG Seed

Entropy input used to
seed the DRBGs (IG
D.L)

DRBG seed derived
from entropy input (IG
D.L)

112-524288 bits

112-256 bits

Symmetric key  N/A

N/A

P-256, P-384

128, 192 bits

Shared secret  N/A

ffdhe2048, ffdhe3072,
ffdhe4096, ffdhe6144,
ffdhe8192

112-200 bits

SP 800-56Ar3 (KAS-
ECC-SSC)

SP 800-56Ar3 (KAS-
FFC-SSC)

256-384 bits

256-384 bits

Entropy input  Entropy Source

N/A

CTR_DRBG: 256, 320,
384 bits
Hash_DRBG: 440, 888
bits
HMAC_DRBG: 160,
256, 512 bits

CTR_DRBG: 128,
192, 256 bits
Hash_DRBG: 128,
256 bits
HMAC_DRBG: 128,
256 bits

Seed

See Table 11

CTR_DRBG,
Hash_DRBG,
HMAC_DRBG

N/A

Internal state  CTR_DRBG,

N/A

HMAC_DRBG

Internal state  Hash_DRBG

N/A

Internal State
(V, Key)

Internal state of
CTR_DRBG and
HMAC_DRBG instances
(IG D.L)

CTR_DRBG: 256, 320,
348 bits
HMAC_DRBG: 320,
512, 1024 bits

Internal State
(V, C)

DH Public Key

Internal state of
Hash_DRBG instances
(IG D.L)

Public key used for
Diffie-Hellman

DH Private Key  Private key used for

Hash_DRBG: 880,
1776 bits

ffdhe2048, ffdhe3072,
ffdhe4096, ffdhe6144,
ffdhe8192

EC Public Key

Diffie-Hellman

Public key used for
ECDH

EC Private Key  Private key used for

ECDH

Intermediate
Key Generation
Value

Temporary value
generated during Key
Pair Generation
services

112-200 bits

Public key

112-200 bits

Private key

P-256, P-384

128, 192 bits

Public key

Private key

N/A

SP 800-56Ar3 (Safe
Primes) Section
5.6.1.1.4 Testing
Candidates

FIPS 186-4 Appendix
B.4.2 Testing
Candidates

N/A

2048-8192 bits

112-200 bits

Intermediate
value

CKG

N/A

Table 19 - SSP Information First

Name

Used By

Inputs/Outputs  Storage  Temporary

Zeroization  Category  Related SSPs

API input parameters
AF_ALG type sockets
(input)
No output

RAM

Storage
Duration

For the
duration of the
service

CSP

None

Free cipher
handle
Remove power
from the module

AES Key

HMAC Key

Encryption
Decryption
Authenticated
Encryption
Authenticated
Decryption
Message Authentication

Message Authentication
Authenticated
Encryption
Authenticated
Decryption

Shared Secret  Shared Secret

Computation

No input
API output
parameters, AF_ALG
type sockets (output)

Entropy Input  Random Number

Generation

No input
No output

From
generation
until DRBG
Seed is created

CSP

None

Automatic

CSP

Remove power
from the module

CSP

DH Public Key, DH
Private Key, EC
Public Key, EC
Private Key

DRBG Seed

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

25 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

DRBG Seed

Internal State
(V, Key)

Internal State
(V, C)

No input
No output

No input
No output

No input
No output

DH public Key  Shared Secret

DH private
Key

Computation
Key Pair Generation

Shared Secret
Computation
Key Pair Generation

EC Public Key  Shared Secret

API input parameters
AF_ALG type sockets
(input)
API output parameters
AF_ALG type sockets
(output)

Computation
Key Pair Generation

Shared Secret
Computation
Key Pair Generation

Key Pair Generation

EC Private
Key

Intermediate
Key
Generation
Value

9.5  Transitions

While the
DRBG is
instantiated

From DRBG
instantiation
until DRBG
termination

For the
duration of the
service

Free cipher
handle
Remove power
from the module

CSP

CSP

CSP

PSP

CSP

PSP

CSP

Entropy Input,
Internal State

DRBG Seed

DRBG Seed

DH Private Key,
Shared Secret

DH Public Key,
Shared Secret

EC Private Key,
Shared Secret

EC Public Key,
Shared Secret

DH Private Key, DH
Public Key, EC
Private Key, EC
Public Key

No input
No output

Automatic

CSP

Table 20 - SSP Information Second

The SHA-1 algorithm as implemented by the module will be non-approved for all purposes, starting
January 1, 2030.

The RSA algorithm as implemented by the module conforms to FIPS 186-4, which has been superseded
by FIPS 186-5. FIPS 186-4 will be withdrawn on February 3, 2024.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

26 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

10  Self-Tests

10.1  Pre-Operational Self-Tests

Algorithm

Implementation  Test Properties  Test Method  Test Type

Indicator

Details

HMAC-SHA-512

AVX2, C, CE

128-bit key

Message
Authentication

Software
integrity

RSA

C

PKCS#1 v1.5 with
SHA-512
4096-bit key

Signature
Verification

Table 21 - Pre-Operational Self-Tests

Module
becomes
operational

Integrity test for vmlinuz
and libkcapi components

Integrity test for kernel
object files

The  pre-operational  software  integrity  tests  are  performed  automatically when  the  module  is  powered
on,  before  the  module  transitions  into  the  operational  state.  While  the  module  is  executing  the  self-
tests,  services  are  not  available,  and  data  output  (via  the  data  output  interface)  is  inhibited  until  the
tests  are  successfully  completed.  The  module  transitions  to  the  operational  state  only  after  the  pre-
operational self-tests are passed successfully.

10.2  Conditional Self-Tests

Algorithm

Implementation

Test Properties

Test
Method

Type  Indicator  Details  Condition

AES-CBC

AESNI, C, CE, NEON

128, 192, 256-bit keys

KAT

CAST  Module is

operational

Encryption
Decryption

Module
initialization

AES-CBC-CS3

AESNI, C, CE, NEON

128-bit keys

AES-CCM

AESNI, C, CE

128, 192, 256-bit keys
128-bit IVs

AES-CFB128

AESNI, C, CE

128, 192, 256-bit keys

AES-CMAC

AESNI, C, CE, NEON

128, 256-bit keys

AES-CTR

AESNI, C, CE, NEON

128, 192, 256-bit keys

AES-ECB

AESNI, C, CE, NEON

128, 192, 256-bit keys

AES-GCM
(internal IV)

AES-GCM
(external IV)

AESNI, C

AESNI, C

128, 192, 256-bit keys
96-bit IVs

128, 192, 256-bit keys

AES-OFB

AESNI, C, CE

128-bit keys

AES-XTS

AESNI, C, CE, NEON

128, 256-bit keys

CTR_DRBG

Hash_DRBG

HMAC_DRBG

C

C

C

AES-128, AES-192, AES-256 without
prediction resistance
AES-128 with prediction resistance

SHA-256 with/without prediction
resistance

SHA-256, SHA-512 without
prediction resistance
SHA-256 with prediction resistance

HMAC-SHA-1

C, CE

32-64-bit keys

HMAC-SHA-224  C, CE

32-1048-bit keys

HMAC-SHA-256  C, CE

32-64-bit keys

HMAC-SHA-384  AVX2, C, CE

32-1048-bit keys

Message
Authentication

Encryption
Decryption

Encryption

Decryption

Encryption
Decryption

Instantiate
Seed
Reseed
Generate
(compliant to
SP 800-90A
Section 11.3)

Message
Authentication

Before
integrity test

Module

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

27 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Algorithm

Implementation

Test Properties

HMAC-SHA-512  AVX2, C, CE, SSSE3

32-1048-bit keys

HMAC-SHA3-224  C, CE

32-1048-bit keys

HMAC-SHA3-256  C, CE

32-1048-bit keys

HMAC-SHA3-384  C, CE

32-1048-bit keys

HMAC-SHA3-512  C, CE

32-1048-bit keys

Test
Method

Type  Indicator  Details  Condition

initialization

KAS-ECC-SSC

KAS-FFC-SSC

C

C

SHA-1

SHA-224

SHA-256

SHA-384

SHA-512

SHA3-224

SHA3-256

SHA3-384

SHA3-512

RSA

Safe Primes

EC

AVX, AVX2, C, CE,
SSSE3

ARM64, AVX, AVX2, C,
CE, NEON, SSSE3

ARM64, AVX, AVX2, C,
CE, SSSE3

C, CE

C, CE

C, CE

C, CE

C

C

C

Entropy Source  C

P-256, P-384

ffdhe2048

0–8184-bit messages

Shared Secret
Computation

Message
Digest

PKCS#1 v1.5 with SHA-256
4096-bit key

Signature
Verification

N/A

N/A

Cutoff C = 61
1024 samples

Cutoff C = 355
Window W = 512
1024 samples

Intermittent cutoff C = 31
Permanent cutoff C = 61

Intermittent cutoff C = 325
Permanent cutoff C = 355
Window W = 512

APT

RCT

APT

PCT

PCT

Key Pair
Generation is
successful

SP 800-56Ar3
Section
5.6.2.1.4

Key Pair
Generation

RCT

CAST  Entropy

source is
operational

Entropy source
start-up test

Entropy
source
initialization

jent_kcapi_ran
dom returns 0

Entropy source
continuous test

Continuously

Table 22 - Conditional Self-Tests

The  module  performs  self-tests  on  all  approved  cryptographic  algorithms  as  part  of  the  approved
services supported in the approved mode of operation, using the tests shown in Table 22.

Upon generation of a DH or EC key pair, the module will perform a pair-wise consistency test (PCT) as
shown in Table 22, which provides some assurance that the generated key pair is well formed. This test
consists of the PCT described in Section 5.6.2.1.4 of SP 800-56Ar3.

Data output through the data output interface is inhibited during the conditional self-tests. The module
does not return control to the calling application until the tests are completed. If any of these tests fails,
the module transitions to the error state (Section 10.4).

10.3  Periodic Self-Tests

The module does not implement periodic self-tests.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

28 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

10.4  Error States

Name

Description

Condition

Recovery Method

Status Indicator

Error State

The Linux kernel immediately
stops executing

Any self-test failure

Restart of the module  Kernel panic

Table 23 - Error States

If the module fails any of the self-tests, the module enters the error state. In the error state, the output
interface is inhibited, and the module accepts no more inputs or requests (as the module is no longer
running).

10.5  Operator Initiation of Self-Tests

The software integrity tests, CASTs and entropy source start-up tests can be invoked on demand by
unloading and subsequently re-initializing the module. The PCTs can be invoked on demand by
requesting the Key Pair Generation service.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

29 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

11  Life-Cycle Assurance

11.1  Installation, Initialization, and Startup Procedures

The module is distributed as a part of the Amazon Linux 2023 and SnowOS 1.0 package in the form of
the  kernel-6.1.41-64.118.amzn2023.rpm,  kernel-6.1.41-64.118.fips.amzn2023.rpm,  and
libkcapi-
hmaccalc-1.4.0-105.amzn2023.0.1.rpm packages.

11.2  Administrator Guidance

Before the RPM packages are installed, the Amazon Linux 2023 or SnowOS 1.0 system must operate in
the  approved  mode.  This  can  be  achieved  by  switching  the  system  into  the  approved  mode  after  the
installation. Execute the fips-mode-setup --enable command. Restart the system. More information can
be found at the vendor documentation.

The Crypto Officer must verify the Amazon Linux 2023 or SnowOS 1.0 system operates in the approved
mode  by  executing  the  fips-mode-setup  --check  command,  which  should  output  “FIPS  mode  is
enabled.”

installation  of

After
the  “cat
/proc/sys/crypto/fips_name” command. The Crypto Officer must ensure that the proper name is listed in
the output as follows:

the  Crypto  Officer  must  execute

the  RPM  packages,

Amazon Linux 2023 Kernel Cryptographic API

Then,  the  Crypto  Officer  must  execute  the  “cat  /proc/sys/crypto/fips_version”  and  “rpm  -q  libkcapi-
hmaccalc” commands. These commands must output the following (one line per output):

EC2 c7g.metal:

6.1.41-64.118.amzn2023.aarch64

libkcapi-hmaccalc-1.4.0-105.amzn2023.0.1.aarch64

EC2 c6i.metal:

6.1.41-64.118.amzn2023.x86_64

libkcapi-hmaccalc-1.4.0-105.amzn2023.0.1.x86_64

AWS Snowball, AWS Snowblade, AWS Snowcone:

6.1.41-64.118.fips.amzn2023.x86_64

libkcapi-hmaccalc-1.4.0-105.amzn2023.0.1.x86_64

11.3  Non-Administrator Guidance

There is no non-administrator guidance.

11.4  End of Life Procedures

As the module does not persistently store SSPs, secure sanitization of the module consists of unloading
the  module.  This  will  zeroize  all  SSPs  in  volatile  memory.  Then,  if  desired,  the  RPM  packages  can  be
uninstalled from the Amazon Linux 2023 or SnowOS 1.0 system.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

30 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

12  Mitigation of Other Attacks

The module does not offer mitigation of other attacks and therefore this section is not applicable.

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

31 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Appendix A.  Glossary and Abbreviations

AES

AES-NI

API

CAST

CAVP

CBC

CCM

CE

CFB

CKG

CMAC

CMVP

CSP

CTR

CTS

DH

DRBG

ECB

ECDH

Advanced Encryption Standard

Advanced Encryption Standard New Instructions

Application Programming Interface

Cryptographic Algorithm Self-Test

Cryptographic Algorithm Validation Program

Cipher Block Chaining

Counter with Cipher Block Chaining-Message Authentication Code

Cryptography Extensions

Cipher Feedback

Cryptographic Key Generation

Cipher-based Message Authentication Code

Cryptographic Module Validation Program

Critical Security Parameter

Counter

Ciphertext Stealing

Diffie-Hellman

Deterministic Random Bit Generator

Electronic Code Book

Elliptic Curve Diffie-Hellman

ECDSA

Elliptic Curve Digital Signature Algorithm

FIPS

GCM

GMAC

HKDF

HMAC

IPsec

KAS

KAT

KBKDF

KTS

Federal Information Processing Standards

Galois Counter Mode

Galois Counter Mode Message Authentication Code

HMAC-based Key Derivation Function

Keyed-Hash Message Authentication Code

Internet Protocol Security

Key Agreement Scheme

Known Answer Test

Key-based Key Derivation Function

Key Transport Scheme

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

32 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

KW

MAC

NIST

OFB

PAA

Key Wrap

Message Authentication Code

National Institute of Science and Technology

Output Feedback

Processor Algorithm Acceleration

PBKDF2

Password-based Key Derivation Function v2

PCT

PKCS

RSA

SHA

SSC

SSP

XTS

Pair-Wise Consistency Test

Public-Key Cryptography Standards

Rivest, Shamir, Adleman

Secure Hash Algorithm

Shared Secret Computation

Sensitive Security Parameter

XEX-based Tweaked-codebook mode with cipher text Stealing

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

33 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

Appendix B.  References

FIPS 140-3

FIPS 140-3 IG

FIPS 180-4

FIPS 186-4

FIPS 186-5

FIPS 197

FIPS 198-1

FIPS 202

PKCS#1

FIPS PUB 140-3 - Security Requirements For Cryptographic Modules
March 2019
https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-3.pdf

Implementation Guidance for FIPS PUB 140-3 and the Cryptographic Module Validation
Program
https://csrc.nist.gov/Projects/cryptographic-module-validation-program/fips-140-3-ig-
announcements

Secure Hash Standard (SHS)
March 2012
https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf

Digital Signature Standard (DSS)
July 2013
https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf

Digital Signature Standard (DSS)
February 2023
https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf

Advanced Encryption Standard
November 2001
https://csrc.nist.gov/publications/fips/fips197/fips-197.pdf

The Keyed Hash Message Authentication Code (HMAC)
July 2008
https://csrc.nist.gov/publications/fips/fips198-1/FIPS-198-1_final.pdf

SHA-3 Standard:  Permutation-Based Hash and Extendable-Output Functions
August 2015
https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf

Public Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1
February 2003
https://www.ietf.org/rfc/rfc3447.txt

RFC 4106

The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)

June 2005

https://datatracker.ietf.org/doc/html/rfc4106

SP 800-38A

SP 800-38A
Addendum

Recommendation for Block Cipher Modes of Operation Methods and Techniques
December 2001
https://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf

Recommendation for Block Cipher Modes of Operation: Three Variants of Ciphertext Stealing
for CBC Mode
October 2010
https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a-add.pdf

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

34 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

SP 800-38B

SP 800-38C

SP 800-38D

SP 800-38E

SP 800-38F

SP 800-56Ar3

SP 800-90Ar1

SP 800-90B

SP 800-108r1

Recommendation for Block Cipher Modes of Operation: The CMAC Mode for Authentication
May 2005
https://csrc.nist.gov/publications/nistpubs/800-38B/SP_800-38B.pdf

Recommendation for Block Cipher Modes of Operation: the CCM Mode for Authentication and
Confidentiality
May 2004
https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf

Recommendation for Block Cipher Modes of Operation:  Galois/Counter Mode (GCM) and GMAC
November 2007
https://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf

Recommendation for Block Cipher Modes of Operation: The XTS AES Mode for Confidentiality
on Storage Devices
January 2010
https://csrc.nist.gov/publications/nistpubs/800-38E/nist-sp-800-38E.pdf

Recommendation for Block Cipher Modes of Operation: Methods for Key Wrapping
December 2012
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-38F.pdf

Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm
Cryptography
April 2018
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf

Recommendation for Random Number Generation Using Deterministic Random Bit Generators
June 2015
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf

Recommendation for the Entropy Sources Used for Random Bit Generation
January 2018
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90B.pdf

NIST Special Publication 800-108 - Recommendation for Key Derivation Using Pseudorandom
Functions
August 2022
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-108r1.pdf

SP 800-131Ar2

SP 800-133r2

SP 800-140Br1

Transitioning the Use of Cryptographic Algorithms and Key Lengths
March 2019
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf

Recommendation for Cryptographic Key Generation
June 2020
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-133r2.pdf

CMVP Security Policy Requirements
November 2023
https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-140Br1.pdf

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

35 of 36

Amazon Linux 2023 Kernel Cryptographic API

FIPS 140-3 Non-Proprietary Security Policy

This document can be reproduced and distributed only whole and intact, including this copyright notice.

© 2024 Amazon Web Services, Inc., atsec information security.

36 of 36

