FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
FIPS 140-3 Non-Proprietary Security Policy
AWS Key Management Service HSM
Hardware version 3.0, firmware version 1.8.104
Document Version 0.35
October 25, 2024
Document Version 0.35 Page 1 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Table of Contents
1. General.................................................................................................................................................. 4
2. Cryptographic Module Specification .................................................................................................... 5
3. Cryptographic Module Interfaces ....................................................................................................... 12
4. Roles, Services, and Authentication ................................................................................................... 13
5. Software/Firmware Security ............................................................................................................... 44
6. Operational Environment ................................................................................................................... 45
7. Physical Security ................................................................................................................................. 46
8. Non-invasive Security ......................................................................................................................... 47
9. Sensitive Security Parameters Management ...................................................................................... 48
10. Self-Tests ............................................................................................................................................. 66
11. Life-cycle Assurance ............................................................................................................................ 68
12. Mitigation of Other Attacks ................................................................................................................ 69
Document Version 0.35 Page 2 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
List of Tables
Table 1 – Security Levels ............................................................................................................................................... 4
Table 2 - Cryptographic Module Tested Configuration ................................................................................................ 5
Table 3 –Approved Algorithms ..................................................................................................................................... 9
Table 4 – Non-Approved Algorithms Allowed in the Approved Mode of Operation ................................................... 9
Table 5 - Non-Approved Algorithms Allowed in the Approved Mode of Operation with No Security Claimed ........ 10
Table 6 – Ports and Interfaces .................................................................................................................................... 12
Table 7 – Roles and Authentication ............................................................................................................................ 13
Table 8 – Roles, Service Commands, Input and Output ............................................................................................. 22
Table 9 – Approved Services ....................................................................................................................................... 42
Table 10 – Physical Security Inspection Guidelines .................................................................................................... 46
Table 11 – EFP/EFT ...................................................................................................................................................... 46
Table 12 – Hardness Testing Temperature Ranges .................................................................................................... 46
Table 13 – SSPs ........................................................................................................................................................... 64
Table 14 – Non-Deterministic Random Number Generator Specification ................................................................. 65
List of Figures
Figure 1 – Cryptographic Module Boundary (Front)................................................................................................... 11
Figure 2 - Cryptographic Module Boundary (Back) .................................................................................................... 11
Document Version 0.35 Page 3 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
1. General
This document defines the Non-Proprietary Security Policy for the AWS Key Management Service HSM module by
Amazon Web Services, Inc. The module meets the FIPS 140-3 overall Level 3 requirements. Table 1 lists the security
level of for each area in the FIPS 140-3 validation:
ISO/IEC 24759 Section  FIPS 140-3 Section Title  Security Level
6
| 1   | General                                  | 3    |
| --- | ---------------------------------------- | ---- |
| 2   | Cryptographic module specification       | 3    |
| 3   | Cryptographic module interfaces          | 3    |
| 4   | Roles, services, and authentication      | 3    |
| 5   | Software/Firmware security               | 3    |
| 6   | Operational environment                  | N/A  |
| 7   | Physical security                        | 3    |
| 8   | Non-invasive security                    | N/A  |
| 9   | Sensitive security parameter management  | 3    |
| 10  | Self-tests                               | 3    |
| 11  | Life-cycle assurance                     | 3    |
| 12  | Mitigation of other attacks              | N/A  |
Table 1 – Security Levels

|     |     |     |
| --- | --- | --- |
Page 4 of 71
Document Version 0.35
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
2. Cryptographic Module Specification
The AWS Key Management Service HSM is used exclusively by AWS as a component of the AWS Key Management
Service (KMS). The module is not directly accessible to customers of KMS. The cryptographic functions of the mod-
ule are used to fulfill requests under specific public AWS KMS APIs.
The module runs firmware versions 1.8.104 on hardware version 3.0 and is classified as a Hardware module with a
multi-chip standalone embodiment. The cryptographic boundary is defined as the module case, and the module
runs on a non-modifiable operating environment. The module follows the initialization/installation requirements
found in Section 11.
Model Hardware Firmware Version Distinguishing Features
[Part Number and Ver-
sion]
AWS Key Management Service 3.0 1.8.104 DC power input. No maintenance
HSM cover
Table 2 - Cryptographic Module Tested Configuration
The AWS Key Management Service HSM operates only in an Approved mode of operation. The module does not
support any non-approved algorithms not allowed in the Approved mode of operation.
The module’s cryptographic algorithm implementations have received the following certificate numbers from the
Cryptographic Algorithm Validation Program (CAVP). Although additional modes and key lengths were included in
the CAVP algorithm testing, the table below represents the actual modes and key lengths used by the services of
the module.
CAVP Cert1 Algorithm and Mode/Method Description / Key Size(s) / Key Use / Function
Standard Strength(s)
AWS Key Management Service Cryptographic Library
A1908 AES ECB, CBC, CTR Direction: Decrypt, Encrypt Encryption, Decryption
FIPS 197, SP Key Length: 128, 256
800-38A
A1908 GCM2 AES GCM: Generation, Authentica-
SP 800-38D Direction: Decrypt, Encrypt tion, Encryption,
Decryption
IV Generation: External3
IV Generation Mode: 8.2.2
Key Length: 128, 256
Tag Length: 96, 128
IV Length: 96
Payload Length: 64, 128, 192
AAD Length: 128, 256
1 There are algorithms, modes, and key/moduli sizes that have been CAVP-tested but are not used by any approved service of
the module. Only the algorithms, modes/methods, and key lengths/curves/moduli shown in this table are used by an approved
service of the module.
2 Per IG C.H (Scenario 2), IVs are internally generated using an approved DRBG, with length of 96 bits (per SP 800-38D).
3 The IV generation is internal to the module, but external to the algorithm boundary
Document Version 0.35 Page 5 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
CAVP Cert1  Algorithm and  Mode/Method  Description / Key Size(s) / Key  Use / Function
|     | Standard  |     | Strength(s)  |     |
| --- | --------- | --- | ------------ | --- |

A1908  KTS  AES KWP  Direction: Decrypt, Encrypt  Key Transport using AES
KWP
|     | SP 800-38F per  |     | Cipher: Cipher   |     |
| --- | --------------- | --- | ---------------- | --- |
|     | IG D.G          |     | Key Length: 256  |     |
Payload Length: 128, 192, 512
A1908  KTS  AES GCM  Direction: Decrypt, Encrypt  Key Transport using AES
|     | SP 800-38D and  |     | Cipher: Cipher   | GCM  |
| --- | --------------- | --- | ---------------- | ---- |
|     | SP 800-38F per  |     | Key Length: 256  |      |
IG D.G
Payload Length: 160, 256, 384, 512, 2048,
3072, 4096
A1908  DRBG   CTR DRBG   Capabilities:  Random Bit Generation
|     | SP 800-90A  |     | Mode: AES-256  |     |
| --- | ----------- | --- | -------------- | --- |
Derivation Function Enabled: Yes
Additional Input: 384
Entropy Input: 384
Nonce: 384
Personalization String Length: 384
Returned Bits: 512
A1908  ECDSA    KeyGen  Curve: P-256, P-384, P-521  Key Pair Generation
|     | FIPS 186-4  |     | Secret Generation Mode: Extra Bits, Testing  |     |
| --- | ----------- | --- | -------------------------------------------- | --- |
Candidates
|     |     | KeyVer  | Curve: P-256, P-384, P-521  | Public Key Validation  |
| --- | --- | ------- | --------------------------- | ---------------------- |
SigGen Component  Curve: P-256, P-384, P-521  Signature Generation
Component
Hash Algorithm: SHA2-256, SHA2-384,
SHA2-512
|     |     | SigGen  | Curve: P-256, P-384, P-521  | Signature Generation  |
| --- | --- | ------- | --------------------------- | --------------------- |
Hash Algorithm: SHA2-256, SHA2-384,
SHA2-512
|     |     | SigVer  | Curve: P-256, P-384, P-521  | Signature Verification  |
| --- | --- | ------- | --------------------------- | ----------------------- |
Hash Algorithm: SHA2-256, SHA2-384,
SHA2-512
Generation, Authentica-
| A1908  | HMAC        | SHA-1     | MAC: 80-160 Increment 8   |       |
| ------ | ----------- | --------- | ------------------------- | ----- |
|        | FIPS 198-1  |           | Key Length: 160           | tion  |
|        |             | SHA2-256  | MAC: 128-256 Increment 8  |       |
Key Length: 256
|     |     | SHA2-384  | MAC: 192-384 Increment 8  |     |
| --- | --- | --------- | ------------------------- | --- |
Key Length: 384
|     |     | SHA2-512  | MAC: 256-512 Increment 8  |     |
| --- | --- | --------- | ------------------------- | --- |
Key Length: 512
Page 6 of 71
| Document Version 0.35  |     |     |     |     |
| ---------------------- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
CAVP Cert1 Algorithm and Mode/Method Description / Key Size(s) / Key Use / Function
Standard Strength(s)
A1908 RSA KeyGen Capabilities: Key Pair Generation
FIPS 186-4 Key Generation Mode: B.3.3
Properties:
Modulo: 2048, 3072, 4096
Primality Tests: Table C.2
Properties:
Modulo: 2048, 3072, 4096
Primality Tests: Table C.3
Public Exponent Mode: Random
Private Key Format: Chinese Remainder
Theorem
SigGen Signature Type: PKCSPSS Signature Generation
Properties:
Modulo: 2048, 3072, 4096
(Note: All supported modulus sizes have
been algorithm tested according to IG C.F)
Hash Pair:
Hash Algorithm: SHA2-256
Salt Length: 0
Hash Pair:
Hash Algorithm: SHA2-384
Salt Length: 0
Hash Pair:
Hash Algorithm: SHA2-512
Salt Length: 0
SigVer Signature Type: PKCSPSS Signature Verification
Properties:
Modulo: 2048, 3072, 4096
(Note: All supported modulus sizes have
been algorithm tested according to IG C.F)
Hash Pair:
Hash Algorithm: SHA2-256
Salt Length: 0
Hash Pair:
Hash Algorithm: SHA2-384
Salt Length: 0
Hash Pair:
Hash Algorithm: SHA2-512
Salt Length: 0
Decryption Primitive Modulo Length: 2048 Component Test
Signature Primitive Private Key Format: standard Signature Generation
Public Exponent Mode: random Component
Document Version 0.35 Page 7 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
CAVP Cert1  Algorithm and  Mode/Method  Description / Key Size(s) / Key  Use / Function
|     | Standard  |     | Strength(s)  |     |
| --- | --------- | --- | ------------ | --- |
A1908  SHS   SHA-1  Message Length: 0-65536 Increment 8  non-Digital Signature
Applications
FIPS 180-4
  SHA2-256  Message Length: 0-65536 Increment 8  Digital Signature Gener-
ation and Verification
SHA2-384  Message Length: 0-65536 Increment 8  Digital Signature Gener-
ation and Verification
SHA2-512  Message Length: 0-65536 Increment 8  Digital Signature Gener-
ation and Verification
A1908  KTS-IFC   RSA-OAEP without key  Modulo: 2048, 3072, 4096  Key Transport,
SP 800-56Brev2  confirmation  Key Generation Methods: rsakpg1-basic,  Optional RSA encapsula-
per IG D.G  Key sizes: 2048, 3072,  rsakpg1-crt, rsakpg1-prime-factor, rsakpg2- tion schemes for
and 4096 bits
  basic, rsakpg2-crt, rsakpg2-prime-factor  protecting keys that cus-
|     |     |     | Scheme:  | tomers import into AWS  |
| --- | --- | --- | -------- | ----------------------- |
KMS
|     |     | Hybrid Key-Transport  | KTS-OAEP-basic:  |     |
| --- | --- | --------------------- | ---------------- | --- |
scheme incorporating
Key Transport Method:
KTS-OAEP and SP 800-
|     |     | 38F  | Hash Algorithms: SHA-1, SHA2-256  |     |
| --- | --- | ---- | --------------------------------- | --- |
Supports Null Associated Data
Associated Data Encoding: concatenation
KAS Role: initiator, responder
Key Length: 1024
SSP establishment methodology
provides between 112 and 150 bits of en-
cryption strength
| A1908  | KAS                | KAS-ECC                  |                                           | Key Agreement  |
| ------ | ------------------ | ------------------------ | ----------------------------------------- | -------------- |
|        | SP 800-56Arev3     | (Cofactor) Ephemeral     | P-384 curve providing 192 bits of encryp- |                |
|        | per IG D.F Sce-    | Unified scheme with key  | tion strength                             |                |
|        | nario 2, path (2)  | confirmation             |                                           |                |

A1908  KAS  KAS-ECC  P-384 curve providing 192 bits of encryp- Key Agreement
|     | SP 800-56Arev3     | (Cofactor) One-Pass Dif- | tion strength  |     |
| --- | ------------------ | ------------------------ | -------------- | --- |
|     | per IG D.F Sce-    | fie-Hellman scheme with  |                |     |
|     | nario 2, path (2)  | key confirmation         |                |     |

A1908  KDA  [SP 800-56Crev1]  Auxiliary Function Methods:  Key Derivation
|     | SP 800-56Crev1  | One-step key derivation  | Auxiliary Function Name: SHA2-256  |     |
| --- | --------------- | ------------------------ | ---------------------------------- | --- |
MAC Salting Methods: default, random
Auxiliary Function Methods:
Auxiliary Function Name: SHA2-384
MAC Salting Methods: default, random
Page 8 of 71
| Document Version 0.35  |     |     |     |     |
| ---------------------- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
CAVP Cert1  Algorithm and  Mode/Method  Description / Key Size(s) / Key  Use / Function
|         | Standard  |                           | Strength(s)  |     |                 |
| ------- | --------- | ------------------------- | ------------ | --- | --------------- |
| Vendor  | CKG       | [SP 800-133rev2, Section  | N/A          |     | Key Generation  |
4]
| Affirmed  | SP 800-133rev2  |                         |     |     |     |
| --------- | --------------- | ----------------------- | --- | --- | --- |
| IG D.H    |                 | Seeding for asymmetric  |     |     |     |
key generation uses un-
modified DRBG output

[SP 800-133rev2, Section
6.1]
Symmetric key genera-
tion uses unmodified
DRBG output

[SP 800-133rev2, Section
6.2]
Symmetric keys can be
derived
AWS Key Management Service Key Derivation Function Library
A1910  KBKDF  Counter Mode  Capabilities: KDF Mode: Counter MAC  Key Derivation
|     | SP 800-108  | HMAC-based KDF with  | Mode: HMAC-SHA2-256 Supported              |     |     |
| --- | ----------- | -------------------- | ------------------------------------------ | --- | --- |
|     |             | SHA2-256             | Lengths: 8-4096 Increment 8 Fixed Data Or- |     |     |
der: Before Fixed Data Counter Length: 32
Supports Empty IV Custom Key In Length: 0
Entropy Source
N/A  ENT (P)  Entropy source  384 bits  Provides seeding mate-
rial for the DRBG
SP 800-90B
A1791  Conditioning  AES-ECB  Key Length: 128  Provides seeding mate-
|     | Components  |              |                      |     | rial for the DRBG  |
| --- | ----------- | ------------ | -------------------- | --- | ------------------ |
|     |             | AES-CBC-MAC  | Payload Length: 128  |     |                    |
Counter DRBG
Table 3 –Approved Algorithms

| Algorithm  |     | Caveat  |     | Use / Function  |     |
| ---------- | --- | ------- | --- | --------------- | --- |
ECDSA secp256k1  key agreement; key establishment methodol- [IG C.A]
ogy provides 128 bits of encryption strength
Curves: secp256k1 may only be used in block-
chain related applications
Table 4 – Non-Approved Algorithms Allowed in the Approved Mode of Operation
| Algorithm  | Caveat  | Use / Function  |     |     |     |
| ---------- | ------- | --------------- | --- | --- | --- |
HMAC-SHA1 (non-com- No security  Used as defined by the IPMI specification on the Baseboard Management Controller (BMC)
pliant)  claimed  which operates completely independently from the rest of the module’s functionality
HMAC-SHA1-96 (non- No security  Used as defined by the IPMI specification on the Baseboard Management Controller (BMC)
compliant)  claimed  which operates completely independently from the rest of the module’s functionality
Page 9 of 71
| Document Version 0.35  |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Algorithm Caveat Use / Function
HMAC-MD5 No security Used as defined by the IPMI specification on the Baseboard Management Controller (BMC)
claimed which operates completely independently from the rest of the module’s functionality
HMAC-SHA2-256-128 No security Used as defined by the IPMI specification on the Baseboard Management Controller (BMC)
(non-compliant) claimed which operates completely independently from the rest of the module’s functionality
AES-CBC-128 (non- No security Used as defined by the IPMI specification on the Baseboard Management Controller (BMC)
compliant) claimed which operates completely independently from the rest of the module’s functionality
Table 5 - Non-Approved Algorithms Allowed in the Approved Mode of Operation with No Security Claimed
Document Version 0.35 Page 10 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
The cryptographic boundary consists of the entire module as shown in Figures 1 and 2.
Figure 1 – Cryptographic Module Boundary (Front)
Figure 2 - Cryptographic Module Boundary (Back)
Document Version 0.35 Page 11 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
3. Cryptographic Module Interfaces
The module provides a number of physical and logical interfaces to the device, and the physical interfaces provided
by the module are mapped to four FIPS 140-3 defined logical interfaces: data input, data output, control input, and
status output. The control output interface is not applicable. The logical interfaces and their mapping are provided
in the following table:
Physical port Logical inter- Data that passes over port/interface
face
25 Gigabit Ethernet Port Data Input Main session interface for cryptographic services
25 Gigabit Ethernet Port Data Output Main session interface for cryptographic services
25 Gigabit Ethernet Port Control Input Main session interface for cryptographic services
IPMI / Gigabit Ethernet Port Control Input Provides serial console access, query power on / off
25 Gigabit Ethernet Port Status Output Main session interface for cryptographic services
IPMI / Gigabit Ethernet Port Status Output Provides serial console access, query power on / off
Power Power N/A
Table 6 – Ports and Interfaces
Document Version 0.35 Page 12 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
4. Roles, Services, and Authentication
Operators of the module may assume the following three roles implicitly:
KMS Front End Role (KMS-FE) - The KMS front end hosts perform actions on behalf of customers of AWS KMS.
KMS Coordinator Role (KMS-C) - Non-public facing KMS hosts perform actions on behalf of KMS administrators in
the Administrator Role.
Administrator Role (Admin) - Employees of AWS who are authorized to manage the module.
For FIPS 140-3 purposes, the KMS Coordinator and Administrator roles serve as the Cryptographic Officer role per
FIPS 140-3 requirements. The KMS-Front End role serves as the User role per FIPS 140-3 requirements.
The module supports only identity-based authentication and requires RSA or ECDSA signatures using RSA with 2048-
bit, 3072-bit, or 4096-bit keys, or ECDSA with P-384. Operators of the module are identified by unique Operator
Signature Public Key (QOS). The list of operator keys and the role of each operator are configured using either the
Initialize or InitializeAndCreateDomain service. Operators interact with the module by submitting digitally signed
commands to the module. The module authenticates operators by verifying the digitally signed commands submit-
ted to the module.
Role Authentication Method Authentication Strength
KMS Front End Role (KMS-FE) Identity based authentication. Com- 112 to 192 bits of security
mands are signed using the operator’s
RSA 2048, 3072, 4096 or ECDSA P384 key
KMS Coordinator Role (KMS-C) Identity based authentication. Com- 112 to 192 bits of security
mands are signed using the operator’s
RSA 2048, 3072, 4096 or ECDSA P384 key
Administrator Role (Admin) Identity based authentication. Com- 112 to 192 bits of security
mands are signed using the operator’s
RSA 2048, 3072, 4096 or ECDSA P384 key
Table 7 – Roles and Authentication
The list of services supported by the module are listed in Table 8. Unless otherwise specified, access to services can
be configured to require one or more members of one or more roles listed in Table 7. These services are used only
by components of KMS to fulfill requests under specific public AWS KMS APIs and cannot be used directly by KMS
customers. See http://docs.aws.amazon.com/kms/latest/APIReference/Welcome.html for a list of the current pub-
lic AWS KMS APIs.
Strength of Authentication
Authentication to the module requires RSA (2048 or 4096-bit) or ECDSA (P-384) signature verification. These au-
thentication methods are cryptographically strong and provide between 112 to 192 bits of security. The possibility
of a single random authentication attempt succeeding is 2-112 which is far less than the required minimum of less
than 1/1,000,000.
Document Version 0.35 Page 13 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Assuming an upper bound of 232 authentication requests per second, the possibility of a random authentication
succeeding within a one-minute period is (60*232)/2112 = 15/278 which is significantly less than 1/100,000. The cryp-
tographic strengths of the digital signatures used for authentication create such difficulty in achieving a successful
random authentication attempt that even the theoretical maximum bandwidth of the 25 Gb/second Ethernet port
is not significant enough to allow enough attempts in a one-minute period.
Document Version 0.35 Page 14 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Services
Role Service Input Output
Cryptographic Services
KMS-FE, Create None A HSM Backing Key encrypted with the active Do-
KMS-C, main Key (DKn), or
Admin An Import Wrapping Key Pair (dIWK, QIWK)
The IWK private key is encrypted with the active Do-
main Key (DKn)
The IWK public key
KMS-FE, ImportKey The private key of an Import Wrapping Key Pair The Customer Supplied Key, encrypted with the cur-
KMS-C, (IWK) encrypted with the active or a recent iter- rent active domain key (DKn)
Admin ation of domain key (DKn or DKn-1)
Customer Supplied Key (CSK), encrypted with
the public key of the Import Wrapping Key. This
may use the wrapping methods as defined in
section 9.2 or 9.3 of SP 800-56B, using the
ephemeral Import Wrapping Envelope Key
(IWEK)
KMS-FE, RefreshKey HBK or CSK encrypted with a recent iteration of HBK or CSK encrypted with the active domain key
KMS-C, a Domain Key (DKn-1) (DKn)
Admin
KMS-FE, Encrypt A HBK or CSK encrypted with the active or a re- N/A (encrypted ciphertext)
KMS-C, cent iteration of domain key (DKn or DKn-1)
Admin
KMS-FE, Decrypt A HBK or CSK encrypted with a Domain Key Arbitrary data or CDK encrypted using the HOSK
KMS-C, (DKn)
Admin Ciphertext or encrypted Customer Data Key
(CDK)
Customer Data Encryption Public Key (QCDEK)
Document Version 0.35 Page 15 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
| Role  Service  | Input  | Output  |
| -------------- | ------ | ------- |
KMS-FE,  ReEncrypt  A HBK or CSK encrypted with the active or a re- N/A (encrypted ciphertext)
| KMS-C,  | cent iteration of domain key (DKn or DKn-1)  |     |
| ------- | -------------------------------------------- | --- |

| Admin  | used to decrypt the provided ciphertext  |     |
| ------ | ---------------------------------------- | --- |
A HBK or CSK encrypted with the active or a re-
cent iteration of domain key (DKn or DKn-1)
used to encrypt the resulting plaintext
Ciphertext or encrypted Customer Data Key
(CDK)
KMS-FE,  Sign  HBK or CSK encrypted with the active domain  None (signature)
| KMS-C,  | key (DKn)  |     |
| ------- | ---------- | --- |

Admin
KMS-FE,  Verify  HBK or CSK encrypted with the active domain  None
| KMS-C,  | key (DKn)  |     |
| ------- | ---------- | --- |

Admin
(signature to be verified)
KMS-FE,  EncryptRandomBytes  HBK or CSK encrypted by the active domain key  A number of random bytes that may be used as Cus-
KMS-C,  (DKn)  tomer Data Keys (CDK) encrypted by the HBK or CSK

Admin
KMS-FE,  GenerateAndEncryptRandomBytes  HBK or CSK encrypted by the active domain key  A number of random bytes that may be used as Cus-
| KMS-C,  | (DKn)  | tomer Data Keys (CDK) encrypted by the HOSK  |
| ------- | ------ | -------------------------------------------- |

Admin
|     | Customer Data Encryption Public Key (QCDEK)  | A number of random bytes that may be used as Cus- |
| --- | -------------------------------------------- | ------------------------------------------------- |
tomer Data Keys (CDK) encrypted by the HBK or CSK

KMS-FE,  HBK or CSK encrypted by the active domain key  An asymmetric Customer Data Key (CDK) private key
GenerateDataKeyPair
| KMS-C,  | (DKn)  | encrypted by the HOSK  |
| ------- | ------ | ---------------------- |

Admin  Customer Data Encryption Public Key (QCDEK)  An asymmetric Customer Data Key (CDK) private key
|     |     | encrypted by the HBK or CSK  |
| --- | --- | ---------------------------- |
KMS-FE,  GenerateDataKeyPairWithoutPlaintext  HBK or CSK encrypted by the active domain key  An asymmetric Customer Data Key (CDK) private key
| KMS-C,  | (DKn)  | encrypted by the HBK or CSK  |
| ------- | ------ | ---------------------------- |

Admin
KMS-FE,  Generate  Customer Data Encryption Public Key (QCDEK)  None
KMS-C,

Admin
Page 16 of 71
Document Version 0.35
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Role Service Input Output
KMS-FE, GetParametersForReplication None Public Replication Agreement Key (QRAK 1 )
KMS-C, Private Replication Agreement Key (dRAK
1
) en-
Admin crypted by the active domain key (DKn)
KMS-FE, WrapKeyForReplication Public Replication Agreement Key (QRAK 1 ) Public Replication Agreement Key (QRAK 2 )
KMS-C, HBK encrypted by the active domain key (DKn) Customer Replicated Key (CRK) encrypted by the
Admin Replication Agreement Key Pair (dRAK , QRAK ) Replication Wrapping Key (RWK)
2 2
KMS-FE, ImportReplicatedKey Private Replication Agreement Key (dRAK 1 ) en- HBK encrypted by the active domain key (DKn)
KMS-C, crypted by the active domain key (DKn) Customer Replication Key (CRK)
Admin Public Replication Agreement Key (QRAK )
2
Customer Supplied Key (CSK) encrypted by the
Replication Wrapping Key (RWK)
Configuration Services
KMS-FE, CreateDomain List of Operator Signature Public Keys (QOS) A Domain Token containing:
KMS-C,
• List of Operator Signature Public Keys (QOS)
Admin
• List of HSM Signature Public Keys (QHSK) of all
members of the domain
• List of HSM Key Agreement Public Keys (QHAK) of
all members of the domain
• Encrypted Initial Domain Key (DK0)
• Encrypted Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing Key (dRSK0)
• Public Replication Signing Key (QRSK0)
Document Version 0.35 Page 17 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Role Service Input Output
KMS-FE, IngestDomain A Domain Token containing the following CSPs: The unmodified input Domain Token
KMS-C,
• List of Operator Signature Public Keys (QOS)
Admin
• List of HSM Signature Public Keys (QHSK) of all
members of the domain
• List of HSM Key Agreement Public Keys
(QHAK) of all members of the domain
• Encrypted Domain Keys (DKn)
• Encrypted Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing Key
(dRSKn)
Public Replication Signing Key (QRSKn)
KMS-FE, ForgetDomain A Domain Token containing the following CSPs: The unmodified input Domain Token
KMS-C,
• List of Operator Signature Public Keys (QOS)
Admin
• List of HSM Signature Public Keys (QHSK) of all
members of the domain
• List of HSM Key Agreement Public Keys
(QHAK) of all members of the domain
• Encrypted Domain Keys (DKn)
• Encrypted Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing Key
(dRSKn)
Public Replication Signing Key (QRSKn)
KMS-FE, GetDomain None A Domain Token containing:
KMS-C,
• List of Operator Signature Public Keys (QOS)
Admin
• List of HSM Signature Public Keys (QHSK) of all
members of the domain
• List of HSM Key Agreement Public Keys (QHAK) of
all members of the domain
• Encrypted Domain Keys (DKn)
• Encrypted Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing Key (dRSKn)
Public Replication Signing Key (QRSKn)
Document Version 0.35 Page 18 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
| Role  Service  | Input  | Output  |
| -------------- | ------ | ------- |
KMS-FE,  ChangeDomain  A Domain Token containing:  An updated Domain Token containing the following
KMS-C,  • List of Operator Signature Public Keys (QOS)  CSPs:

Admin
|     | • List of HSM Signature Public Keys (QHSK) of all  | • List of Operator Signature Public Keys (QOS)     |
| --- | -------------------------------------------------- | -------------------------------------------------- |
|     | members of the domain                              | • List of HSM Signature Public Keys (QHSK) of all  |
|     | • List of HSM Key Agreement Public Keys            | members of the domain                              |
|     | (QHAK) of all members of the domain                | • List of HSM Key Agreement Public Keys (QHAK) of  |
|     | • Encrypted Domain Keys (DKn)                      | all members of the domain                          |
|     | • Encrypted Domain Key Encryption Key (DKEK)       | • Encrypted Domain Keys (DKn)                      |
|     | • Encrypted Private Replication Signing Key        | • Encrypted Domain Key Encryption Key (DKEK)       |

(dRSKn)
|     | • Public Replication Signing Key (QRSKn)  | Encrypted Private Replication Signing Key (dRSKn)  |
| --- | ----------------------------------------- | -------------------------------------------------- |

Public Replication Signing Key (QRSKn)
HSM Signature Public Keys (QHSK) and HSM Key

Agreement Public Keys (QHAK) of the domain
members to be added (optional)
List of Operator Signature Public Keys (QOS)
(optional)
List of Public Replication Signing Keys
(QRSKm, …, QRSKn) (optional)
KMS-FE,  Initialize  One or more Domain Tokens. Each Domain To- None
| KMS-C,  | ken contains:  |     |
| ------- | -------------- | --- |

Admin
• List of Operator Signature Public Keys (QOS)
• List of HSM Signature Public Keys (QHSK) of all
members of the domain
• List of HSM Key Agreement Public Keys
(QHAK) of all members of the domain
• Encrypted Domain Keys (DKn)
• Encrypted Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing Key
(dRSKn)
Public Replication Signing Key (QRSKn)
Page 19 of 71
Document Version 0.35
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Role Service Input Output
All (un- InitializeAndCreateDomain List of Operator Signature Public Keys (QOS) A Domain Token containing:
authenti
• List of Operator Signature Public Keys (QOS)
cated)
• List of HSM Signature Public Keys (QHSK) of all
members of the domain
• List of HSM Key Agreement Public Keys (QHAK) of
all members of the domain
• Encrypted Initial Domain Key (DK0)
• Encrypted Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing Key (dRSKn)
Public Replication Signing Key (QRSKn)
KMS-FE, Attest HSM Signature Key Pair (dHSK, QHSK) HSM Signature Public Key (QHSK)
KMS-C, Host Agreement Public Key (QHAK) HSM Agreement Public Key (QHAK)
Admin
Operator Signature Public Key(s) (QOS)
HSM Session Key Encryption Key (HSKEK)
HSM-to-Operator Session Key (HOSK)
KMS-FE, GetAttestationChallenge None None
KMS-C,
Admin
KMS-FE, GetAttestationIdentity None None
KMS-C,
Admin
All (un- Wipe None None
authenti
cated)
All (un- GetInitialDomainName None None
authenti
cated)
All (un- DeactivateAndReboot None None
authenti
cated)
Document Version 0.35 Page 20 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Role Service Input Output
One NegotiateSessionKey Operator Ephemeral Agreement Public Key Encrypted HSM-Operator Session Key (HOSK) en-
member (QOEAK) crypted with the Domain Key (DKn) or HSM Session
from any Key Encryption Key (HSKEK)
role HSM-Operator Session Key (HOSK) encrypted with a
256-bit key derived from the shared secret estab-
lished using elliptic curve Diffie Hellman key
exchange (NIST-P384) using the HSM Ephemeral
Agreement Public Key (QE) and the Operator Ephem-
eral Agreement Public Key (QOEAK)
HSM Ephemeral Agreement Public Key (QE)
KMS-FE, UpdateHostConfiguration None None
KMS-C,
Admin
Audit Log Services
KMS-FE, ListLogs None None
KMS-C,
Admin
KMS-FE, GetLog None None
KMS-C,
Admin
KMS-FE, DeleteLog None None
KMS-C,
Admin
Other Services
All (un- Ping None Returns “healthy” if the module is operating in Ap-
authenti proved mode. Returns “failure” if the module is not
cated) operating in Approved mode.
All (un- Approved None Returns “healthy” if the module is operating in Ap-
authenti proved mode. Returns “failure” if the module is not
cated) operating in Approved mode.
All (un- Version None Module name, hardware version and firmware ver-
authenti sion
cated)
Document Version 0.35 Page 21 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
| Role  Service                 |     |     | Input  |     | Output                |     |     |
| ----------------------------- | --- | --- | ------ | --- | --------------------- | --- | --- |
| All (un- Hardware monitoring  |     |     | None   |     | Hardware sensor data  |     |     |
| authenti                      |     |     |        |     |                       |     |     |
cated)
| All (un- Power management  |     |     | None  |     | None  |     |     |
| -------------------------- | --- | --- | ----- | --- | ----- | --- | --- |
| authenti                   |     |     |       |     |       |     |     |
cated)
| All (un- Serial over LAN (SOL)  |     |     | None  |     | None  |     |     |
| ------------------------------- | --- | --- | ----- | --- | ----- | --- | --- |
| authenti                        |     |     |       |     |       |     |     |
cated)
Table 8 – Roles, Service Commands, Input and Output
Each approved service provides an indicator when the service utilizes an approved cryptographic algorithm, security function, or  process in an ap-
proved manner. Per IG 2.4.C, the module implements a global indicator via the “Approved” service which is a persistent indicator that only returns
healthy if the module is running in its approved mode of operation where approved services are executing.
Approved Services
Approved services supported by the module are listed in Table 9.
 s
|      |     |           |  r   |     |     |          |      |
| ---- | --- | --------- | ---- | --- | --- | -------- | ---- |
|      | n   |  d        | o    |     |     | t h s P  |      |
|      | o   | s         | /    |     |     | g S      |      |
|      | it  | e  y   n  | d    |     |     | ir S     | r    |
|      | p   | v o       | n    |     |     |  s  r    | o    |
| e    | ir  | o t ir it | a    |     |     |  s y o   | t    |
| c iv |     | r         |  s   |     | s   | s e      | a    |
|      | c s | p u c n   | y s  |     | e   | e K / d  | c id |
| r    | e   | p c       | e P  |     | lo  | c c  o n |      |
| e    | D   | A e u     | K S  |     | R   | A        | n    |
| S    |     |   S F     |   S  |     |     | t a      | I    |
Create  Generates and en- CTR DRBG  HSM Backing Key  KMS-FE,  Generate  “healthy”
crypts either an  AES GCM  IWK public and private keys  KMS-C,  Read
|     | HSM Backing Key     |        |                       |     | Admin  |          |     |
| --- | ------------------- | ------ | --------------------- | --- | ------ | -------- | --- |
|     |                     | KBKDF  | Active Domain Key (DK | )   |        | Execute  |     |
|     | (HBK) or an Import  |        |                       | n   |        |          |     |
Wrapping Key Pair  RSA (keygen)  HSM-to-Operator Session Key (HOSK)  Zeroize
|     | (dIWK, QIWK) pri- | ECDSA (keygen)  | DRBG (CTR AES) V and AES key  |     |     |     |     |
| --- | ----------------- | --------------- | ----------------------------- | --- | --- | --- | --- |
vate key
|     |     | CKG  |     |     |     |     |     |
| --- | --- | ---- | --- | --- | --- | --- | --- |
Page 22 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     |     | t s      |     |
| --- | --- | -------- | ------ | --- | --- | -------- | --- |
|     | n   |  d       | o      |     |     | h P      |     |
|     | o   | s        | /      |     |     | g S      |     |
|     | it  | e  y   n | d      |     |     | ir S     | r o |
| e   | p   | v t o    | n      |     |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     |     | y o      | t a |
| iv  | c   | r p u c  |  s s   |     | s   | s e e /  | c   |
|     | s   | p c n    | y P    |     | e   | c K d    | id  |
| r e | e   | e u      | e S    |     | lo  | c  o n   |     |
| S   | D   | A S F    | K S    |     | R   | A a      | n   |
|     |     |          |        |     |     | t        | I   |
ImportKey  Decrypts a Cus- AES GCM  The private key of an Import Wrapping Key  KMS-FE,  Read  “healthy”
|     | tomer Supplied Key  |                     | Pair (dIWK, QIWK)            |     | KMS-C,  |          |     |
| --- | ------------------- | ------------------- | ---------------------------- | --- | ------- | -------- | --- |
|     |                     | KBKDF               |                              |     |         | Execute  |     |
|     | (CSK) and re-en-    |                     | Customer Supplied Key (CSK)  |     | Admin   |          |     |
|     |                     | KTS-IFC (RSA-OAEP)  |                              |     |         | Zeroize  |     |
crypts it with the
|     |                    |     | Active Domain Key (DK               | )   |     |        |     |
| --- | ------------------ | --- | ----------------------------------- | --- | --- | ------ | --- |
|     | active Domain Key  |     |                                     | n   |     | Write  |     |
|     | (DK )              |     | HSM-to-Operator Session Key (HOSK)  |     |     |        |     |
n
RefreshKey  Re-encrypts an  AES GCM  HBK or CSK encrypted with a recent itera- KMS-FE,  Read  “healthy”
|     | HSM Backing Key   |        | tion of a Domain Key (DKn or DKn-1)         |     | KMS-C,  |          |     |
| --- | ----------------- | ------ | ------------------------------------------- | --- | ------- | -------- | --- |
|     |                   | KBKDF  |                                             |     |         | Execute  |     |
|     | (HBK) key or Cus- |        |                                             |     | Admin   |          |     |
|     |                   |        | Active or a recent iteration of Domain Key  |     |         | Zeroize  |     |
tomer Supplied Key
(DKn or DKn-1)
Write
(CSK) encrypted
HSM-to-Operator Session Key (HOSK)
with a recent itera-
tion of the domain
key (DK ) with the
n-1
active domain key
(DK n )
Encrypt  Encrypt an arbitrary  AES GCM  A HBK or CSK encrypted with the active or  KMS-FE,  Read  “healthy”
|     | set of bytes using  |     | a recent iteration of domain key (DKn or  |     | KMS-C,  |     |     |
| --- | ------------------- | --- | ----------------------------------------- | --- | ------- | --- | --- |
Execute
|     | the DEK derived  |     | DKn-1)  |     | Admin  |     |     |
| --- | ---------------- | --- | ------- | --- | ------ | --- | --- |
Zeroize
|     | from the provided  |     | Active or a recent iteration of Domain Key  |     |     |     |     |
| --- | ------------------ | --- | ------------------------------------------- | --- | --- | --- | --- |
Write
|     | HBK or CSK  |     | (DKn or DKn-1)   |     |     |     |     |
| --- | ----------- | --- | ---------------- | --- | --- | --- | --- |
HSM-to-Operator Session Key (HOSK)
Data Encryption Key (DEK)
Page 23 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
Decrypt  Decrypts ciphertext  AES GCM  A HBK or CSK encrypted with a Domain Key  KMS-FE,  Read  “healthy”
|     | using the DEK de- |     | (DK )                                  | KMS-C,  |          |     |
| --- | ----------------- | --- | -------------------------------------- | ------- | -------- | --- |
|     |                   |     | n                                      |         | Execute  |     |
|     | rived from the    |     | Ciphertext or encrypted Customer Data  | Admin   |          |     |
Zeroize
|     | provided HBK or  |     | Key (CDK)  |     |        |     |
| --- | ---------------- | --- | ---------- | --- | ------ | --- |
|     | CSK              |     |            |     | Write  |     |
Arbitrary data or CDK encrypted using the
Generate
HOSK
Active or a recent iteration of domain key
(DK  or DK )
n n-1
HSM-to-Operator Session Key (HOSK)
Data Encryption Key (DEK)
Customer Data Encryption Public Key
(QCDEK)
Customer Data Encryption Symmetric Key
(SCDEK)

ReEncrypt  Decrypts ciphertext  AES GCM  A HBK or CSK encrypted with the active or  KMS-FE,  Read  “healthy”
|     | using the DEK de- |     | a recent iteration of domain key (DK      |  or  KMS-C,  |          |     |
| --- | ----------------- | --- | ----------------------------------------- | ------------ | -------- | --- |
|     |                   |     |                                           | n            | Execute  |     |
|     | rived from the    |     | DK ) used to decrypt the provided cipher- | Admin        |          |     |
|     |                   |     | n-1                                       |              | Zeroize  |     |
|     | provided HBK or   |     | text                                      |              |          |     |
|     | CSK, then re-en-  |     |                                           |              | Write    |     |
A HBK or CSK encrypted with the active or
|     | crypts the resulting  |     | a recent iteration of domain key (DK |  or  |     |     |
| --- | --------------------- | --- | ------------------------------------ | ---- | --- | --- |
n
|     | plaintext under the  |     | DK ) used to encrypt the resulting  |     |     |     |
| --- | -------------------- | --- | ----------------------------------- | --- | --- | --- |
n-1
DEK from a sepa-
plaintext
rately provided HBK
Ciphertext or encrypted Customer Data
or CSK
Key (CDK)
This operation does
Active or a recent iteration of Domain Key
not expose the
(DK n  or DK n-1 )
plaintext
HSM-to-Operator Session Key (HOSK)
Data Encryption Key (DEK)
Page 24 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
Sign  Performs an ECDSA  CTR DRBG  HBK or CSK encrypted with the active do- KMS-FE,  Read  “healthy”
|     | or RSA sign opera- |          | main key (DKn)              | KMS-C,  |          |     |
| --- | ------------------ | -------- | --------------------------- | ------- | -------- | --- |
|     |                    | AES GCM  |                             |         | Execute  |     |
|     | tion, or HMAC      |          | Domain Key (DKn or DKn-1)   | Admin   |          |     |
|     |                    | RSA      |                             |         | Zeroize  |     |
operation using the
HSM-to-Operator Session Key (HOSK)
|     | provided HBK or  | ECDSA  |                               |     | Write  |     |
| --- | ---------------- | ------ | ----------------------------- | --- | ------ | --- |
|     | CSK              | SHS    | DRBG (CTR AES) V and AES key  |     |        |     |
|     |                  | HMAC   |                               |     |        |     |
Verify  Performs an ECDSA  AES GCM  HBK or CSK encrypted with the active do- KMS-FE,  Read  “healthy”
|     | or RSA verify, or  |        | main key (DKn)              | KMS-C,  |          |     |
| --- | ------------------ | ------ | --------------------------- | ------- | -------- | --- |
|     |                    | RSA    |                             |         | Execute  |     |
|     | HMAC operation     |        |                             | Admin   |          |     |
|     |                    | ECDSA  | Domain Key (DKn or DKn-1)   |         | Zeroize  |     |
using the provided
|     |     | SHS  | HSM-to-Operator Session Key (HOSK)  |     | Write  |     |
| --- | --- | ---- | ----------------------------------- | --- | ------ | --- |
HBK or CSK
HMAC
EncryptRan- Generate a number  CTR DRBG  HBK or CSK encrypted with the active do- KMS-FE,  Read  “healthy”
domBytes  of random bytes  AES GCM  main key (DKn)  KMS-C,  Execute
|     | and encrypt it using  |      | A number of random bytes that may be  | Admin  |          |     |
| --- | --------------------- | ---- | ------------------------------------- | ------ | -------- | --- |
|     |                       | CKG  |                                       |        | Zeroize  |     |
the DEK derived
used as Customer Data Keys (CDK) en-
|     | from the specified  |     |     |     | Write  |     |
| --- | ------------------- | --- | --- | --- | ------ | --- |
crypted by the HBK or CSK
HBK or CSK
Domain Key (DKn or DKn-1)
The random bytes
HSM-to-Operator Session Key (HOSK)
may be used as
DRBG (CTR AES) V and AES key
cryptographic key
material as Cus-
Data Encryption Key (DEK)
tomer Data Keys
|     | (CDK)  |     |     |     |     |     |
| --- | ------ | --- | --- | --- | --- | --- |

Page 25 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
GenerateAndEn- Generate a number  CTR DRBG  HBK or CSK encrypted with the active do- KMS-FE,  Generate  “healthy”
cryptRandomBytes  of random bytes for  main key (DKn)  KMS-C,
|     |                     | AES GCM  |                                       |        | Read     |     |
| --- | ------------------- | -------- | ------------------------------------- | ------ | -------- | --- |
|     | use and encrypt it  |          | A number of random bytes that may be  | Admin  |          |     |
|     |                     | CKG      |                                       |        | Execute  |     |
|     | using the DEK de-   |          | used as Customer Data Keys (CDK) en-  |        |          |     |
|     | rived from the      |          |                                       |        | Zeroize  |     |
crypted by the HBK or CSK
|     | specified HBK or  |     |     |     | Write  |     |
| --- | ----------------- | --- | --- | --- | ------ | --- |
A number of random bytes that may be
CSK
used as Customer Data Keys (CDK) en-
The random bytes
crypted by the HOSK
may be used as
Domain Key (DKn or DKn-1)
cryptographic key
HSM-to-Operator Session Key (HOSK)
material as Cus-
|     | tomer Data Keys  |     | DRBG (CTR AES) V and AES key  |     |     |     |
| --- | ---------------- | --- | ----------------------------- | --- | --- | --- |
(CDK)
Data Encryption Key (DEK)

Customer Data Encryption Public Key
Note that the Gen-
(QCDEK)
erateAndEncryptRa
|     | ndomBytes API will  |     | Customer Data Encryption Symmetric Key  |     |     |     |
| --- | ------------------- | --- | --------------------------------------- | --- | --- | --- |
|     | return encrypted    |     | (SCDEK)                                 |     |     |     |
versions of the ran-

dom bytes in 2
|     | forms  |     |     |     |     |     |
| --- | ------ | --- | --- | --- | --- | --- |
Page 26 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     |     | t s      |     |
| --- | --- | -------- | ------ | --- | --- | -------- | --- |
|     | n   |  d       | o      |     |     | h P      |     |
|     | o   | s        | /      |     |     | g S      |     |
|     | it  | e  y   n | d      |     |     | ir S     | r o |
| e   | p   | v t o    | n      |     |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     |     | y o      | t a |
| iv  | c   | r p u c  |  s s   |     | s   | s e e /  | c   |
|     | s   | p c n    | y P    |     | e   | c K d    | id  |
| r e | e   | e u      | e S    |     | lo  | c  o n   |     |
| S   | D   | A S F    | K S    |     | R   | A a      | n   |
|     |     |          |        |     |     | t        | I   |
GenerateDataKey- Generate an asym- CTR DRBG  HBK or CSK encrypted by the active do- KMS-FE,  Generate  “healthy”
| Pair  | metric key pair and  |                 | main key (DK                           | )   | KMS-C,  |          |     |
| ----- | -------------------- | --------------- | -------------------------------------- | --- | ------- | -------- | --- |
|       |                      | RSA (keygen)    |                                        | n   |         | Read     |     |
|       | encrypt it with the  |                 | An asymmetric Customer Data Key (CDK)  |     | Admin   |          |     |
|       |                      | ECDSA (keygen)  |                                        |     |         | Execute  |     |
|       | specified HBK or     |                 | private key encrypted by the HOSK      |     |         |          |     |
|       | CSK The asymmet-     | AES GCM         |                                        |     |         | Zeroize  |     |
An asymmetric Customer Data Key (CDK)
|     | ric key pair will be  | CKG  |     |     |     | Write  |     |
| --- | --------------------- | ---- | --- | --- | --- | ------ | --- |
private key encrypted by the HBK or CSK
used as crypto-

Active or a recent iteration of domain key
graphic key
|     |                  |     | (DK  or DK                           | )   |     |     |     |
| --- | ---------------- | --- | ------------------------------------ | --- | --- | --- | --- |
|     | material as Cus- |     | n                                    | n-1 |     |     |     |
|     | tomer Data Keys  |     | HSM-to-Operator Session Key (HOSK)   |     |     |     |     |
(CDK)
DRBG (CTR AES) V and AES key

Customer Data Encryption Public Key
Note that the Gen-
(QCDEK)
erateDataKeyPair
Customer Data Encryption Symmetric Key
API will return en-
|     | crypted versions of  |     | (SCDEK)  |     |     |     |     |
| --- | -------------------- | --- | -------- | --- | --- | --- | --- |
|     | the CDK in 2 forms   |     |          |     |     |     |     |

GenerateDataKey- Generate an asym- CTR DRBG  HBK or CSK encrypted by the active do- KMS-FE,  Generate  “healthy”
PairWithoutPlainte metric key pair and  main key (DK )   KMS-C,
|     |                      | RSA (keygen)    |                                        | n   |        | Read     |     |
| --- | -------------------- | --------------- | -------------------------------------- | --- | ------ | -------- | --- |
| xt  | encrypt it with the  |                 |                                        |     | Admin  |          |     |
|     |                      | ECDSA (keygen)  | An asymmetric Customer Data Key (CDK)  |     |        | Execute  |     |
specified HBK or
private key encrypted by the HBK or CSK
|     | CSK The asymmet- | AES GCM  |     |     |     | Zeroize  |     |
| --- | ---------------- | -------- | --- | --- | --- | -------- | --- |
Active or a recent iteration of domain key
|     | ric key pair will be  | CKG  |                                      |     |     | Write  |     |
| --- | --------------------- | ---- | ------------------------------------ | --- | --- | ------ | --- |
|     |                       |      | (DK  or DK                           | )   |     |        |     |
|     | used as crypto-       |      | n                                    | n-1 |     |        |     |
|     | graphic key           |      | HSM-to-Operator Session Key (HOSK)   |     |     |        |     |
material as Cus-
DRBG (CTR AES) V and AES key
tomer Data Keys

(CDK)
Page 27 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |      |        |  r     |     | t s      |     |
| --- | --- | ---- | ------ | ------ | --- | -------- | --- |
|     | n   |  d   |        | o      |     | h P      |     |
|     | o   |      | s      | /      |     | g S      |     |
|     | it  | e    |  y   n | d      |     | ir S     | r o |
| e   | p   | v    | t o    | n      |     |  s  s  r |     |
| c   | ir  | o    | ir it  | a      |     | y o      | t a |
| iv  | c   | r p  | u c    |  s s   | s   | s e e /  | c   |
|     | s   | p    | c n    | y P    | e   | c K d    | id  |
| r e | e   |      | e u    | e S    | lo  | c  o n   |     |
| S   | D   | A    | S F    | K S    | R   | A a      | n   |
|     |     |      |        |        |     | t        | I   |
Generate  Generate a speci- CTR DRBG  HSM-to-Operator Session Key (HOSK)  KMS-FE,  Read  “healthy”
|     | fied number of    |          |     |                                      | KMS-C,  |          |     |
| --- | ----------------- | -------- | --- | ------------------------------------ | ------- | -------- | --- |
|     |                   | AES GCM  |     | DRBG (CTR AES) V and AES key         |         | Execute  |     |
|     | random bytes, up  |          |     |                                      | Admin   |          |     |
|     |                   | CKG      |     | Customer Data Encryption Public Key  |         | Zeroize  |     |
to 1024 bytes
|     |     |     |     | (QCDEK)  |     | Write  |     |
| --- | --- | --- | --- | -------- | --- | ------ | --- |
Customer Data Encryption Symmetric Key
(SCDEK)

GetParameters- This API generates  CTR DRBG  Public Replication Agreement Key (QRAK 1 )  KMS-FE,  Generate  “healthy”
ForReplication  a new Replication  ECDSA (keygen)  Private Replication Agreement Key (dRAK )  KMS-C,  Read
1
|     | Agreement Key Pair  |          |     |                                        | Admin  |          |     |
| --- | ------------------- | -------- | --- | -------------------------------------- | ------ | -------- | --- |
|     |                     | AES GCM  |     | encrypted by the active domain key (DK | n )    | Execute  |     |
|     | (dRAK , QRAK        | )        |     |                                        |        |          |     |
|     | 1                   | 1        |     | Replication Agreement Key Pair (dRAK   | ,      |          |     |
|     |                     | CKG      |     |                                        | 1      | Zeroize  |     |
The Private Replica-
QRAK 1 )
|     | tion Agreement Key  |     |     |     |     |     |     |
| --- | ------------------- | --- | --- | --- | --- | --- | --- |
HSM-to-Operator Session Key (HOSK)
(dRAK ) is en-
|     | 1   |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- |
Active or a recent iteration of domain key
|     | crypted with the  |     |     |     |     |     |     |
| --- | ----------------- | --- | --- | --- | --- | --- | --- |
(DK  or DK )
|     | domain key (DK | n )  |     | n n-1 |     |     |     |
| --- | -------------- | ---- | --- | ----- | --- | --- | --- |
Active or a recent iteration of a Private

|     |                      |     |     | Replication Signing Key (dRSK  or dRSK | )   |     |     |
| --- | -------------------- | --- | --- | -------------------------------------- | --- | --- | --- |
|     | The API also signs   |     |     | n                                      | n-1 |     |     |
|     | all output with the  |     |     | DRBG (CTR AES) V and AES key           |     |     |     |
Private Replication

|     | Signing Key (dRSK |     |     |     |     |     |     |
| --- | ----------------- | --- | --- | --- | --- | --- | --- |
n
or dRSK )
n-1
Page 28 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |      |        |  r     |     |     | t s      |     |
| --- | --- | ---- | ------ | ------ | --- | --- | -------- | --- |
|     | n   |  d   |        | o      |     |     | h P      |     |
|     | o   |      | s      | /      |     |     | g S      |     |
|     | it  | e    |  y   n | d      |     |     | ir S     | r o |
| e   | p   | v    | t o    | n      |     |     |  s  s  r |     |
| c   | ir  | o    | ir it  | a      |     |     | y o      | t a |
| iv  | c   | r p  | u c    |  s s   |     | s   | s e e /  | c   |
|     | s   | p    | c n    | y P    |     | e   | c K d    | id  |
| r e | e   |      | e u    | e S    |     | lo  | c  o n   |     |
| S   | D   | A    | S F    | K S    |     | R   | A a      | n   |
|     |     |      |        |        |     |     | t        | I   |
WrapKeyForRepli- This API takes an in- KAS (ECCDH)   Public Replication Agreement Key (QRAK )  KMS-FE,  Read  “healthy”
1
| cation  | put a public       |                    |     |                                         |     | KMS-C,  |          |     |
| ------- | ------------------ | ------------------ | --- | --------------------------------------- | --- | ------- | -------- | --- |
|         |                    | KDA (one-step KDF  |     | HBK encrypted by the active domain key  |     |         | Execute  |     |
|         | Replication Agree- | SHA2)              |     | (DK )                                   |     | Admin   |          |     |
|         |                    |                    |     | n                                       |     |         | Zeroize  |     |
|         | ment Key (QRAK     | 1 )                |     |                                         |     |         |          |     |
|         |                    | AES GCM            |     | Replication Agreement Key Pair (dRAK    | ,   |         |          |     |
|         | generated from a   | n                  |     |                                         | 2   |         | Write    |     |
QRAK )
|     | HSM, and gener-    | ECDSA  |     | 2                                        |     |     |     |     |
| --- | ------------------ | ------ | --- | ---------------------------------------- | --- | --- | --- | --- |
|     | ates a new         |        |     | Public Replication Agreement Key (QRAK   |     | )   |     |     |
|     |                    |        |     |                                          |     | 2   |     |     |
|     | Replication Agree- |        |     | Customer Replicated Key (CRK) encrypted  |     |     |     |     |
|     | ment Key pair      |        |     | by the Replication Wrapping Key (RWK)    |     |     |     |     |
|     | (dRAK , QRAK       | )      |     |                                          |     |     |     |     |
|     | 2                  | 2      |     | HSM-to-Operator Session Key (HOSK)       |     |     |     |     |
|     | QRAK 1  and dRAK   | 2      |     |                                          |     |     |     |     |
Active or a recent iteration of domain key
are combined using
(DK  or DK )
|     | the Diffie-Hellmann  |     |     | n n-1                                        |                |     |     |     |
| --- | -------------------- | --- | --- | -------------------------------------------- | -------------- | --- | --- | --- |
|     | key exchange to      |     |     | Active or a recent iteration of the Private  |                |     |     |     |
|     |                      |     |     | Replication Signing Key (dRSK                | n  or dRSK n-1 | )   |     |     |
produce a shared
|     | secret and derive a  |     |     | Active or a recent iteration of the Public  |                |     |     |     |
| --- | -------------------- | --- | --- | ------------------------------------------- | -------------- | --- | --- | --- |
|     | symmetric secret     |     |     | Replication Singing Key (QRSK               | n  or QRSK n-1 | )   |     |     |
key (the Replication
Replication Agreement RWK Shared Secret
Wrapping Key,
Z (RRZ)
RWK)
Customer Replication Key (CRK)
The RWK is then
|     | used to encrypt an  |     |     |     |     |     |     |     |
| --- | ------------------- | --- | --- | --- | --- | --- | --- | --- |
HBK, resulting in a

Customer Repli-
|     | cated Key (CRK)  |     |     |     |     |     |     |     |
| --- | ---------------- | --- | --- | --- | --- | --- | --- | --- |
Page 29 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
ImportReplicat- This API combines  KAS (ECCDH)   Private Replication Agreement Key (dRAK )  KMS-FE,  Read  “healthy”
1
edKey  two Replication  encrypted by the active domain key (DK )  KMS-C,
|     |                     | KDA (one-step KDF  |                                           | n         | Execute  |     |
| --- | ------------------- | ------------------ | ----------------------------------------- | --------- | -------- | --- |
|     | Agreement Key       | SHA2)              | Public Replication Agreement Key (QRAK    | )  Admin  |          |     |
|     |                     |                    |                                           | 2         | Zeroize  |     |
|     | (dRAK 1  and QRAK 2 | )                  |                                           |           |          |     |
|     |                     | AES GCM            | Customer Supplied Key (CSK) encrypted by  |           |          |     |
|     | using t he Diffie-  |                    |                                           |           | Write    |     |
the Replication Wrapping Key (RWK)
|     | Hellmann key ex-   | ECDSA  |                                         |     |     |     |
| --- | ------------------ | ------ | --------------------------------------- | --- | --- | --- |
|     | change to produce  |        | HBK encrypted by the active domain key  |     |     |     |
SHS
(DK )
|     | a shared secret and   |     | n                                    |     |     |     |
| --- | --------------------- | --- | ------------------------------------ | --- | --- | --- |
|     | derive a Replication  |     | HSM-to-Operator Session Key (HOSK)   |     |     |     |
Wrapping Key
Active or a recent iteration of domain key
(RWK)
(DK  or DK )
n n-1
The RWK is used to
Active or a recent iteration of the Public
decrypt the Cus-
|     |                   |     | Replication Singing Key (QRSK  or QRSK | )   |     |     |
| --- | ----------------- | --- | -------------------------------------- | --- | --- | --- |
|     | tomer Replicated  |     | n                                      | n-1 |     |     |
Replication Agreement RWK Shared Secret
Key (CRK), obtain-
Z (RRZ)
ing an HBK, which is
|     | then re-encrypted  |     | Customer Replication Key (CRK)  |     |     |     |
| --- | ------------------ | --- | ------------------------------- | --- | --- | --- |
using the Domain
|     | Key (DK )  |     |     |     |     |     |
| --- | ---------- | --- | --- | --- | --- | --- |
n
|     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- |
The API also vali-
dates input using
the Public Replica-
tion Signing Key
|     | (QRSK n  or QRSK n-1 | )   |     |     |     |     |
| --- | -------------------- | --- | --- | --- | --- | --- |
Page 30 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
CreateDomain  Creates a new do- CTR DRBG  List of Operator Signature Public Keys  KMS-FE,  Generate  “healthy”
|     | main token for a  |                    | (QOS)                                | KMS-C,  |          |     |
| --- | ----------------- | ------------------ | ------------------------------------ | ------- | -------- | --- |
|     |                   | KAS (ECCDH)        |                                      |         | Read     |     |
|     | new domain, but   |                    | HSM Signature Key Pair (dHSK, QHSK)  | Admin   |          |     |
|     |                   | KDA (one-step KDF  |                                      |         | Execute  |     |
does not join the
|     |                    | SHA2)    | HSM Agreement Key Pair (dHAK, QHAK)  |     |          |     |
| --- | ------------------ | -------- | ------------------------------------ | --- | -------- | --- |
|     | HSM to the domain  |          |                                      |     | Zeroize  |     |
|     | yet                | AES GCM  | HSM Agreement DKEK Shared Secret Z   |     |          |     |
|     |                    | ECDSA    | (HDKZ)                               |     |          |     |
RSA
HSM Agreement DKEK Wrapping Key
SHS
(HDWK)

Initial Domain Key (DK)
0
|     |     |     | Replication Signing Key (dRSK , QRSK )  |     |     |     |
| --- | --- | --- | --------------------------------------- | --- | --- | --- |
0 0
A Domain Token containing:
• List of Operator Signature Public Keys
(QOS)
• List of HSM Signature Public Keys (QHSK)
of all members of the domain
• List of HSM Key Agreement Public Keys
(QHAK) of all members of the domain
|     |     |     | • Encrypted Initial Domain Key (DK )  |     |     |     |
| --- | --- | --- | ------------------------------------- | --- | --- | --- |
0
•  Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing
Key (dRSK )
0
|     |     |     | • Public Replication Signing Key (QRSK )  |     |     |     |
| --- | --- | --- | ----------------------------------------- | --- | --- | --- |
0
• DRBG (CTR AES) V and AES key
Page 31 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
IngestDomain  Joins a domain or  CTR DRBG  A Domain Token containing the following  KMS-FE,  Read  “healthy”
| receive an updated  | KAS (ECCDH)    | CSPs:                                     | KMS-C,  | Execute  |
| ------------------- | -------------- | ----------------------------------------- | ------- | -------- |
| domain token        |                | • List of Operator Signature Public Keys  | Admin   |          |
|                     | (one-step KDF  |                                           |         | Zeroize  |
|                     | SHA2)          | (QOS)                                     |         |          |
Write
• List of HSM Signature Public Keys (QHSK)
AES GCM
of all members of the domain
|     | ECDSA  | • List of HSM Key Agreement Public Keys  |     |     |
| --- | ------ | ---------------------------------------- | --- | --- |
|     | RSA    | (QHAK) of all members of the domain      |     |     |
|     | SHA2   | • Encrypted Domain Keys (DKn)            |     |     |
•  Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing
Key (dRSKn)
• Public Replication Signing Key (QRSKn)

HSM Signature Public Key (QHSK) of a
known member of the domain
HSM Agreement Private Key (dHAK)
HSM Agreement DKEK Shared Secret Z
(HDKZ)
HSM Agreement DKEK Wrapping Key
(HDWK)
Operator Signature Public Keys (QOS)
Domain Key (DKn)
Operator Signature Public Keys (QOS)
HSM Signature Public Keys (QHSK) of all
members of the domain
HSM Key Agreement Public Keys (QHAK) of
all members of the domain
Encrypted Private Replication Signing Key
(dRSKn)
Public Replication Signing Key (QRSKn)
DRBG (CTR AES) V and AES key

ForgetDomain  Deletes domain in- ECDSA  A Domain Token containing the following  KMS-FE,  Read  “healthy”
| formation as it  | RSA  | CSPs:  | KMS-C,  | Execute  |
| ---------------- | ---- | ------ | ------- | -------- |
| pertains to a    |      |        | Admin   |          |
Page 32 of 71
Document Version 0.35
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |      |        |  r     |     | t s      |     |
| --- | --- | ---- | ------ | ------ | --- | -------- | --- |
|     | n   |  d   |        | o      |     | h P      |     |
|     | o   |      | s      | /      |     | g S      |     |
|     | it  | e    |  y   n | d      |     | ir S     | r o |
| e   | p   | v    | t o    | n      |     |  s  s  r |     |
| c   | ir  | o    | ir it  | a      |     | y o      | t a |
| iv  | c   | r p  | u c    |  s s   | s   | s e e /  | c   |
|     | s   | p    | c n    | y P    | e   | c K d    | id  |
| r e | e   |      | e u    | e S    | lo  | c  o n   |     |
| S   | D   | A    | S F    | K S    | R   | A a      | n   |
|     |     |      |        |        |     | t        | I   |
particular domain  SHA2  • List of Operator Signature Public Keys  Zeroize
on the module in-
(QOS)
|     | cluding all Domain   |         |     | • List of HSM Signature Public Keys (QHSK)  |     |     |     |
| --- | -------------------- | ------- | --- | ------------------------------------------- | --- | --- | --- |
|     | Keys (DK n , DK      | n-1 ),  |     | of all members of the domain                |     |     |     |
|     | effectively leaving  |         |     | • List of HSM Key Agreement Public Keys     |     |     |     |
the domain
(QHAK) of all members of the domain
• Encrypted Domain Keys (DK n )
•  Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing
Key (dRSK n )
|     |     |     |     | • Public Replication Signing Key (QRSK )  |     |     |     |
| --- | --- | --- | --- | ----------------------------------------- | --- | --- | --- |
n

Domain Key (DK )
n
Operator Signature Public Keys (QOS)
HSM Signature Public Keys (QHSK) of all
members of the domain
HSM Key Agreement Public Keys (QHAK) of
all members of the domain
GetDomain  Retrieves the cur- ECDSA  A Domain Token containing:  KMS-FE,  Read  “healthy”
|     | rent version of the  |       |     |                                             | KMS-C,  |          |     |
| --- | -------------------- | ----- | --- | ------------------------------------------- | ------- | -------- | --- |
|     |                      | RSA   |     | • List of Operator Signature Public Keys    |         | Execute  |     |
|     | domain token for a   |       |     | (QOS)                                       | Admin   |          |     |
|     |                      | SHA2  |     |                                             |         | Zeroize  |     |
|     | specified domain     |       |     | • List of HSM Signature Public Keys (QHSK)  |         |          |     |
of all members of the domain
• List of HSM Key Agreement Public Keys
(QHAK) of all members of the domain
• Encrypted Domain Keys (DK
n )
•  Domain Key Encryption Key (DKEK)
• Encrypted Private Replication Signing
Key (dRSK )
n
|     |     |     |     | • Public Replication Signing Key (QRSK n )  |     |     |     |
| --- | --- | --- | --- | ------------------------------------------- | --- | --- | --- |
Domain Key (DK n )
Operator Signature Public Keys (QOS)
Page 33 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
ChangeDomain  Modifies the cur- CTR DRBG  A Domain Token containing:  KMS-FE,  Generate  “healthy”
|     | rent state of an    |                |                                             | KMS-C,  |          |     |
| --- | ------------------- | -------------- | ------------------------------------------- | ------- | -------- | --- |
|     |                     | KAS (ECCDH)    | • List of Operator Signature Public Keys    |         | Read     |     |
|     | operational domain  |                | (QOS)                                       | Admin   |          |     |
|     |                     | (one-step KDF  |                                             |         | Execute  |     |
|     |                     | SHA2)          | • List of HSM Signature Public Keys (QHSK)  |         |          |     |
Zeroize
of all members of the domain
|     |     | AES GCM  |     |     | Write  |     |
| --- | --- | -------- | --- | --- | ------ | --- |
• List of HSM Key Agreement Public Keys
|     |     | ECDSA  | (QHAK) of all members of the domain  |     |     |     |
| --- | --- | ------ | ------------------------------------ | --- | --- | --- |
RSA
• Encrypted Domain Keys (DK n )
|     |     | SHA2  | •  Domain Key Encryption Key (DKEK)  |     |     |     |
| --- | --- | ----- | ------------------------------------ | --- | --- | --- |
• Encrypted Private Replication Signing
Key (dRSK )
n
|     |     |     | • Public Replication Signing Key (QRSK n )  |     |     |     |
| --- | --- | --- | ------------------------------------------- | --- | --- | --- |

HSM Signature Public Keys (QHSK) and
HSM Key Agreement Public Keys (QHAK) of
the domain members to be added (op-
tional)
List of Operator Signature Public Keys
(QOS) (optional)
List of Public Replication Signing Keys
(QRSK , …, QRSK ) (optional)
m n
Domain Key Encrypting Key (DKEK)
Domain Key (DK )
n
HSM Ephemeral Agreement Key Pair (dE,
QE)
HSM Agreement Key (HAK)
HSM Signature Key (HSK)
DRBG (CTR AES) V and AES key

Page 34 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     |     | t s      |     |
| --- | --- | -------- | ------ | --- | --- | -------- | --- |
|     | n   |  d       | o      |     |     | h P      |     |
|     | o   | s        | /      |     |     | g S      |     |
|     | it  | e  y   n | d      |     |     | ir S     | r o |
| e   | p   | v t o    | n      |     |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     |     | y o      | t a |
| iv  | c   | r p u c  |  s s   |     | s   | s e e /  | c   |
|     | s   | p c n    | y P    |     | e   | c K d    | id  |
| r e | e   | e u      | e S    |     | lo  | c  o n   |     |
| S   | D   | A S F    | K S    |     | R   | A a      | n   |
|     |     |          |        |     |     | t        | I   |
Initialize  Initializes the HSM  CTR DRBG  One or more Domain Tokens. Each Domain  All / unauthenti- Generate  “healthy”
|     | by generating the  |                 | Token contains:                           |     | cated  |       |     |
| --- | ------------------ | --------------- | ----------------------------------------- | --- | ------ | ----- | --- |
|     |                    | ECDSA (keygen,  |                                           |     |        | Read  |     |
|     | HSM Signature Key  | sign)           | • List of Operator Signature Public Keys  |     |        |       |     |
Execute
and HSM Agree-
|     |     | KAS (EC CDH)   | (QOS)  |     |     | Zeroize  |     |
| --- | --- | -------------- | ------ | --- | --- | -------- | --- |
ment Key and
• List of HSM Signature Public Keys (QHSK)
|     | configuring the  | (one-step KDF  |     |     |     |     |     |
| --- | ---------------- | -------------- | --- | --- | --- | --- | --- |
of all members of the domain
|     | HSM’s operator and  | SHA2)  |     |     |     |     |     |
| --- | ------------------- | ------ | --- | --- | --- | --- | --- |
• List of HSM Key Agreement Public Keys
|     | access control using  | AES GCM  |     |     |     |     |     |
| --- | --------------------- | -------- | --- | --- | --- | --- | --- |
(QHAK) of all members of the domain
a domain token
|     |     | CKG  | • Encrypted Domain Keys (DK | n )  |     |     |     |
| --- | --- | ---- | --------------------------- | ---- | --- | --- | --- |
from another HSM
•  Domain Key Encryption Key (DKEK)
|     |                        |     | • Encrypted Private Replication Signing  |     |     |     |     |
| --- | ---------------------- | --- | ---------------------------------------- | --- | --- | --- | --- |
|     | The Initialize API is  |     | Key (dRSK n )                            |     |     |     |     |
|     | only used during       |     | • Public Replication Signing Key (QRSK   | )   |     |     |     |
n
|     | the module setup  |     |     |     |     |     |     |
| --- | ----------------- | --- | --- | --- | --- | --- | --- |
and initialization
HSM Signature Key (HSK)
process If the HSM
HSM Agreement Key (HAK)
is already initialized
|     | by a call to either    |     | HSM Agreement HSKEK Shared Secret Z  |     |     |     |     |
| --- | ---------------------- | --- | ------------------------------------ | --- | --- | --- | --- |
|     | the Initialize or Ini- |     | (HHKZ)                               |     |     |     |     |
tializeAndCreateDo
|     | main API, the Ini- |     | HSM Session Key Encryption Key (HSKEK)  |     |     |     |     |
| --- | ------------------ | --- | --------------------------------------- | --- | --- | --- | --- |
Operator Signature Public Keys (QOS)
tialize API will
|     | return an error as  |     | DRBG (CTR AES) V and AES key  |     |     |     |     |
| --- | ------------------- | --- | ----------------------------- | --- | --- | --- | --- |
the HSM cannot be
|     | Initialized again  |     | DRBG (CTR AES) Seed  |     |     |     |     |
| --- | ------------------ | --- | -------------------- | --- | --- | --- | --- |
without a reboot
Entropy Input String

Page 35 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
InitializeAndCre- Initializes the HSM  CTR DRBG  List of Operator Signature Public Keys  All / unauthenti- Generate  “healthy”
| ateDomain  | by generating the  |                 | (QOS)                                | cated  |       |     |
| ---------- | ------------------ | --------------- | ------------------------------------ | ------ | ----- | --- |
|            |                    | ECDSA (keygen,  |                                      |        | Read  |     |
|            | HSM Signature Key  | sign)           | HSM Signature Key Pair (dHSK, QHSK)  |        |       |     |
Execute
and HSM Agree-
|     |     | KAS (EC-CDH)  | HSM Agreement Key Pair (dHAK, QHAK)  |     | Zeroize  |     |
| --- | --- | ------------- | ------------------------------------ | --- | -------- | --- |
ment Key,
|     | configuring the list  | (one-step KDF  | HSM Agreement DKEK Shared Secret Z  |     |     |     |
| --- | --------------------- | -------------- | ----------------------------------- | --- | --- | --- |
|     | of operators, roles   | SHA2)          |                                     |     |     |     |
(HDKZ)
|     | and the quorum-   | AES GCM  |                                  |     |     |     |
| --- | ----------------- | -------- | -------------------------------- | --- | --- | --- |
|     | based access con- |          | HSM Agreement DKEK Wrapping Key  |     |     |     |
CKG
trol ruleset for all
|     |     |     | (HDWK)  |     |     |     |
| --- | --- | --- | ------- | --- | --- | --- |
services / APIs
HSM Agreement HSKEK Shared Secret Z

(HHKZ)
The Initialize-
|     | AndCreateDomain  |     | HSM Session Key Encryption Key (HSKEK)  |     |     |     |
| --- | ---------------- | --- | --------------------------------------- | --- | --- | --- |
API is only used
Initial Domain Key (DK)  0
during the module
A Domain Token containing:
setup and initializa-
• List of Operator Signature Public Keys
tion process
(QOS)
If the HSM is al-
• List of HSM Signature Public Keys (QHSK)
ready initialized by
of all members of the domain
a call to either the
• List of HSM Key Agreement Public Keys
Initialize or Initializ-
|     | eAndCreateDomain     |     | (QHAK) of all members of the domain  |     |     |     |
| --- | -------------------- | --- | ------------------------------------ | --- | --- | --- |
|     |                      |     | • Encrypted Initial Domain Key (DK   | )   |     |     |
|     | API, the Initialize- |     |                                      | 0   |     |     |
•  Domain Key Encryption Key (DKEK)
AndCreateDomain
|     | API will return an  |     | • Encrypted Private Replication Signing  |     |     |     |
| --- | ------------------- | --- | ---------------------------------------- | --- | --- | --- |
|     | error as the HSM    |     | Key (dRSK n )                            |     |     |     |
|     | cannot be Initial-  |     | • Public Replication Signing Key (QRSK   | )   |     |     |
n

ized again without
|     | a reboot  |     | DRBG (CTR AES) V and AES key  |     |     |     |
| --- | --------- | --- | ----------------------------- | --- | --- | --- |

Page 36 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
Attest  The Attest API is  CTR DRBG  HSM Signature Public Key (QHSK)  KMS-FE,  Read  “healthy”
|     | used by operators     |                 |                                      | KMS-C,  |          |     |
| --- | --------------------- | --------------- | ------------------------------------ | ------- | -------- | --- |
|     |                       | ECDSA (verify)  | HSM Agreement Public Key (QHAK)      |         | Execute  |     |
|     | to attest an initial- |                 |                                      | Admin   | Zeroize  |     |
|     |                       | SHA2            | HSM Signature Key Pair (dHSK, QHSK)  |         |          |     |
ized HSM to ensure
|     | that the system is   | AES GCM  | Operator Signature Public Key(s) (QOS)  |     |     |     |
| --- | -------------------- | -------- | --------------------------------------- | --- | --- | --- |
|     | running the correct  |          | HSM Agreement HSKEK Shared Secret Z     |     |     |     |
|     | software, and to     |          | (HHKZ)                                  |     |     |     |
|     | obtain an authentic  |          | HSM Session Key Encryption Key (HSKEK)  |     |     |     |
copy of its creden-
HSM-to-Operator Session Key (HOSK)
tials prior to being
|     | added to a domain  |     | DRBG (CTR AES) V and AES key  |     |     |     |
| --- | ------------------ | --- | ----------------------------- | --- | --- | --- |

GetAttestationChal- The GetAttestation- AES GCM  Active or a recent iteration of Domain Key  KMS-FE,  Read  “healthy”
| lenge  | Challenge API is  |     | (DKn or DKn-1)  | KMS-C,  |     |     |
| ------ | ----------------- | --- | --------------- | ------- | --- | --- |
Execute
|     | used by operators  |     |                                      | Admin  |          |     |
| --- | ------------------ | --- | ------------------------------------ | ------ | -------- | --- |
|     |                    |     | HSM-to-Operator Session Key (HOSK)   |        | Zeroize  |     |
to retrieve a token
that can be used to
validate the identity
of another HSM
GetAttestationIden- The GetAttesta- AES GCM  Active or a recent iteration of Domain Key  KMS-FE,  Read  “healthy”
| tity  | tionIdentity API is  |     | (DKn or DKn-1)                       | KMS-C,  | Execute  |     |
| ----- | -------------------- | --- | ------------------------------------ | ------- | -------- | --- |
|       | used by operators    |     |                                      | Admin   |          |     |
|       |                      |     | HSM-to-Operator Session Key (HOSK)   |         | Zeroize  |     |
to retrieve infor-
mation to attest the
identity of the HSM
Page 37 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
Wipe  The Wipe API will  N/A  HSM Signature Key Pair (dHSK, QHSK)  All / unauthenti- Zeroize  “healthy”
|     | delete the HSM Sig- |     |     | cated  |     |     |
| --- | ------------------- | --- | --- | ------ | --- | --- |
HSM Agreement Key Pair (dHAK, QHAK)
nature Key and
HSM Session Key Encryption Key (HSKEK)
HSM Agreement
Key from volatile
memory
The Wipe API will
fail unless all previ-
ously created
domains in the
module have been
deleted using the
ForgetDomain API
GetInitialDomain- Retrieves the initial  N/A  N/A  All / unauthenti- N/A  “healthy”
| Name  | domain name from  |     |     | cated  |     |     |
| ----- | ----------------- | --- | --- | ------ | --- | --- |
an initialized HSM
that is used as part
of the domain crea-
tion bootstrap
process
Page 38 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
DeactivateAndRe- The Deactivate- N/A  N/A  All / unauthenti- N/A  “healthy”
| boot  | AndReboot API  |     |     | cated  |     |     |
| ----- | -------------- | --- | --- | ------ | --- | --- |
returns the HSM to
the factory state
and reboots after
verifying the HSM
Signature Key and
HSM Agreement
Key have been de-
leted by the Wipe
API

(The module will
perform self-tests
after during reboot
process)
Page 39 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
NegotiateSes- Uses a set of iden- CTR DRBG  Operator Ephemeral Agreement Public Key  One member from  Generate  “healthy”
| sionKey  | tity keys to securely  |                 | (QOEAK)  | any role  |          |     |
| -------- | ---------------------- | --------------- | -------- | --------- | -------- | --- |
|          |                        | RSA (verify)    |          |           | Read     |     |
|          | negotiate a session    |                 |          |           |          |     |
|          |                        | ECDSA (verify)  |          |           | Execute  |     |
key that can be
|     |                 |       | HSM Ephemeral Agreement Key Pair (dE,  |     | Zeroize  |     |
| --- | --------------- | ----- | -------------------------------------- | --- | -------- | --- |
|     | used between a  | SHA2  |                                        |     |          |     |
QE)
|     | KMS host and any    | KAS (ECCDH)  |                                   |     |     |     |
| --- | ------------------- | ------------ | --------------------------------- | --- | --- | --- |
|     | HSM in the domain   |              | HSM-Operator Session Key (HOSK)   |     |     |     |
(one-step KDF
|     | The NegotiateSes- | SHA2)  |     |     |     |     |
| --- | ----------------- | ------ | --- | --- | --- | --- |
sionKey API will
|     |                   | AES GCM  | Encrypted HSM-Operator Session Key    |     |     |     |
| --- | ----------------- | -------- | ------------------------------------- | --- | --- | --- |
|     | return encrypted  |          | (HOSK) encrypted with the Domain Key  |     |     |     |

|     | versions of the   |     | (DKn) or HSM Session Key Encryption Key  |     |     |     |
| --- | ----------------- | --- | ---------------------------------------- | --- | --- | --- |
|     | HSM-Operator Ses- |     | (HSKEK)                                  |     |     |     |
sion Key (HOSK) in
HSM-Operator Session Key (HOSK) en-
2 forms
crypted with a 256 bit key derived from
the shared secret established using elliptic
curve Diffie Hellman key exchange (NIST-
P384) using the HSM Ephemeral Agree-
ment Key (QE) and the Operator
Ephemeral Agreement Public Key (QOEAK)
HSM Ephemeral Agreement Public Key
(QE)
Operator Signature Public Key (QOS)
HSM Signature Key (dHSK)
DRBG (CTR AES) V and AES key

| UpdateHostConfig- | Allows updates of  |     |     | KMS-FE,  |     |     |
| ----------------- | ------------------ | --- | --- | -------- | --- | --- |
RSA (verify)  Operator Signature Public Key (QOS)  Execute  “healthy”
| uration  | non-security-rele- | ECDSA (verify)  |     | KMS-C,  |     |     |
| -------- | ------------------ | --------------- | --- | ------- | --- | --- |
|          | vant host          |                 |     | Admin   |     |     |
SHA2
configuration

Page 40 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
ListLogs   Returns a list of au- RSA (verify)  Operator Signature Public Key (QOS)  KMS-FE,  Execute  “healthy”
|     | dit log file names  |     |     | KMS-C,  |     |     |
| --- | ------------------- | --- | --- | ------- | --- | --- |
ECDSA (verify)
Admin
SHA2
GetLog  Retrieves specified  RSA (verify)  Operator Signature Public Key (QOS)  KMS-FE,  Execute  “healthy”
|     | audit log files  | ECDSA (verify)  |     | KMS-C,  |     |     |
| --- | ---------------- | --------------- | --- | ------- | --- | --- |
Admin
SHA2
DeleteLog  Deletes specified  RSA (verify)  Operator Signature Public Key (QOS)  KMS-FE,  Execute  “healthy”
|     | audit log file  | ECDSA (verify)  |     | KMS-C,  |     |     |
| --- | --------------- | --------------- | --- | ------- | --- | --- |
Admin
SHA2
Ping  Returns “healthy” if  N/A  N/A  All / unauthenti- None  “healthy”
|     | the module is ini- |     |     | cated  |     |     |
| --- | ------------------ | --- | --- | ------ | --- | --- |
tialized and has
ingested a domain
Returns “failure”
otherwise
Approved  Approved mode in- N/A  N/A  All / unauthenti- None  “healthy”
|     | dicator that apply  |     |     | cated  |     |     |
| --- | ------------------- | --- | --- | ------ | --- | --- |
to approved ser-

vices on the 25G
Ethernet port
Returns “healthy” if
the module is oper-
ating in Approved
mode
Returns “failure” if
the module is not
operating in Ap-
proved mode
Page 41 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
 s
|     |     |          |  r     |     | t s      |     |
| --- | --- | -------- | ------ | --- | -------- | --- |
|     | n   |  d       | o      |     | h P      |     |
|     | o   | s        | /      |     | g S      |     |
|     | it  | e  y   n | d      |     | ir S     | r o |
| e   | p   | v t o    | n      |     |  s  s  r |     |
| c   | ir  | o ir it  | a      |     | y o      | t a |
| iv  | c   | r p u c  |  s s   | s   | s e e /  | c   |
|     | s   | p c n    | y P    | e   | c K d    | id  |
| r e | e   | e u      | e S    | lo  | c  o n   |     |
| S   | D   | A S F    | K S    | R   | A a      | n   |
|     |     |          |        |     | t        | I   |
Version  Returns the module  N/A  N/A  All / unauthenti- None  N/A
|     | name, hardware  |     |     | cated  |     |     |
| --- | --------------- | --- | --- | ------ | --- | --- |
version and firm-
ware version
Hardware monitor- Provide access via  None  N/A  All / unauthenti- None  Successful comple-
| ing  | IPMI to hardware  |     |     | cated  |     | tion of service  |
| ---- | ----------------- | --- | --- | ------ | --- | ---------------- |
sensor data to

monitor tempera-
tures, fan speed,
etc
Power manage- Turns on and off  None  N/A  All / unauthenti- None  Successful comple-
| ment  | the module via  |     |     | cated  |     | tion of service  |
| ----- | --------------- | --- | --- | ------ | --- | ---------------- |
IPMI
Serial over LAN  Provides access to  None  N/A  All / unauthenti- None  Successful comple-
| (SOL)  | the module’s con- |     |     | cated  |     | tion of service  |
| ------ | ----------------- | --- | --- | ------ | --- | ---------------- |
sole before the
module enters Ap-
proved mode via
IPMI
In Approved mode,
the SOL link is ac-
tive but the module
firmware blocks all
input commands
and status output
to the console
Table 9 – Approved Services

G = Generate: The module generates or derives the SSP.
R = Read: The SSP is read from the module (e.g. the SSP is output).
Page 42 of 71
| Document Version 0.35  |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
W = Write: The SSP is updated, imported, or written to the module.
E = Execute: The module uses the SSP in performing a cryptographic operation.
Z = Zeroise: The module zeroises the SSP.
Document Version 0.35 Page 43 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
5. Software/Firmware Security
The module performs integrity check on all firmware components using a 256-bit error detection code (EDC) on all
module components. The integrity check is performed upon the initialization of the module and does not require
operator intervention to run. If the check fails, the module will enter into an error state. The module does not
support firmware loading.
The operator can run the integrity test on demand by rebooting the module using the DeactivateAndReboot API.
Document Version 0.35 Page 44 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
6. Operational Environment
The module has a non-modifiable operational environment and does not allow loading of any additional firmware
while the module is operating in Approved mode.
Document Version 0.35 Page 45 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
7. Physical Security
The module is a hardware module with a multiple-chip standalone embodiment and conforms to the Level 3 re-
quirements for physical security. The module’s production-grade enclosure is made of hard metal, and the
enclosure does not provide a removable cover. The baffles installed by AWS satisfy FIPS 140-3 requirements for
module opacity and probing.
Physical Security Mechanism  Recommended Frequency of Inspec- Inspection/Test Guidance Details
tion/Test
Tamper-evident physical enclosure  Inspect when the module unexpectedly re- Inspect the physical enclosure for evidence of
with no removable cover  boots or becomes unresponsive  tampering, such as dents, signs of drilling or
prying, cracks in the hard plastic portion of the
enclosure
Table 10 – Physical Security Inspection Guidelines
The module supports environments failure protection and shuts down if the temperature or voltage is outside of
the values described in Table 11.
  Temperature or voltage  Specify EFP or  Specify if this condition results in a shutdown or
|                   | measurement  | EFT  | zeroisation  |
| ----------------- | ------------ | ---- | ------------ |
| Low Temperature   | - 8 °C       | EFP  | Shutdown     |
| High Temperature  | 54 °C        | EFP  | Shutdown     |
| Low Voltage       | 10 V         | EFP  | Shutdown     |
| High Voltage      | 14 V         | EFP  | Shutdown     |
Table 11 – EFP/EFT
|                   | Hardness tested temperature measurement  |     |     |
| ----------------- | ---------------------------------------- | --- | --- |
| Low Temperature   | - 8 °C                                   |     |     |
| High Temperature  | 52 °C                                    |     |     |
Table 12 – Hardness Testing Temperature Ranges

Page 46 of 71
| Document Version 0.35  |     |     |     |
| ---------------------- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
8. Non-invasive Security
This section is not applicable. The module does not implement non-invasive attack mitigation techniques.
Document Version 0.35 Page 47 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
9.
Sensitive Security Parameters Management
Table 13 provides a complete list of Critical Security Parameters used within the module. All keys and SSPs are zeroized by powering off the module.

|       |     | - c  .t  |     |       | t n |     |     |  d     |
| ----- | --- | -------- | --- | ----- | --- | --- | --- | ------ |
|       |     | n r      |     |       | e   |     |     | e      |
| e     |     | u e      | n   |       | m   |     | n   | t      |
| p     |     | F C      | o   |       |     |     | o   | a      |
|  P y  | h   |  y  d    | it  |  /    | h   |     | it  | le     |
| T     | t   | r e      | a   |  t    | s   | e   | a   | r      |
| S / e | g   | t ir n b | r   | r t   | ilb | g   | s   |  &     |
| S / m | n   | a m      | e   | o r o |     | a   | io  |        |
| y     | e   | u  n     | n   | p p   | a   | r   |     |  e s y |
| e a   | r   | c e o u  | e   | m x   | t   | o   | r e | s e    |
| K N   | t S | S it N   | G   | E     | s E | t S | Z   | U k    |
I
HSM Backing  256 bits (AES)  AES GCM  Internally using  Input: En- N/A  Volatile memory  Overwrite with  Used as input to
Key (HBK)    RSA   DRBG or im- crypted with the  all zeros  a SP 800-108
CSP/PSP  160-256 bits  ECDSA  ported from  Domain Key us- KBKDF to derive
|     | (HMAC)          | HMAC     | another mem-     | ing AES GCM       |     |     |     | the DEK   |
| --- | --------------- | -------- | ---------------- | ----------------- | --- | --- | --- | --------- |
|     |                 | (A1908)  | ber of a Domain  | (electronically)  |     |     |     |           |
|     | 112 – 128 bits  | CKG      |                  | Output: En-       |     |     |     |           |
(RSA 2048, 3072
crypted with the
|     | or 4096 bits)   |     |     | Domain Key us-    |     |     |     |     |
| --- | --------------- | --- | --- | ----------------- | --- | --- | --- | --- |
|     | 128 – 256 bits  |     |     | ing AES GCM       |     |     |     |     |
|     | (ECDSA P-256,   |     |     | (electronically)  |     |     |     |     |
P-384, P-521, or
secp256k1)
Page 48 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Customer Data For symmetric AES Internally using Input: En- N/A Volatile memory Overwriting Used outside of
Key (CDK) keys, random RSA DRBG or im- crypted using with all zeros the module
bits length spec- ECDSA ported from AES GCM with
CSP/PSP
ified by (A1908) another mem- the DEK derived
customer (in the ber of a Domain from an HBK or
CKG
range of 8 bits CSK (electroni-
to 65536 bits) cally)
112 – 128 bits Output: En-
(RSA 2048, 3072 crypted in 2
or 4096 bits) forms by the
GenerateAndEn-
128 – 256 bits
cryptRandomBy
(ECDSA P-256,
tes and Gener-
P-384, P-521, or
ateDataKeyPair
secp256k1)
APIs:
1. Encrypted
with the DEK
derived from an
HBK or CSK; and
2. Encrypted
with the HOSK
to provide se-
cure transport
to the request-
ing service
operator/role
EncryptRan-
domBytes and
Generate-
DataKeyPairWit
houtPlaintext
APIs export the
CDK encrypted
with the DEK
from an HBK or
CSK (electroni-
cally)
Document Version 0.35 Page 49 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Data Encryption  256 bits (AES)  AES GCM  Derived inter- Input: N/A  N/A  Volatile memory  Overwriting  The DEK is de-
Key (DEK)  (A1908)  nally using SP  with all zeros  rived from either
|     |     |     |                | Output: N/A  |     |     |     |                 |
| --- | --- | --- | -------------- | ------------ | --- | --- | --- | --------------- |
|     |     |     | 800-108 KBKDF  |              |     |     |     | the HBK or CSK  |
CSP
and is used to
encrypt the CDK
HSM Agreement  192 bits   KAS  Internally using  Input: N/A  N/A  Volatile memory  Overwriting  The dHAK/QHAK
Key Pair   (ECDH P384)  (A1908)  DRBG  with all zeros  are used in key
Output: The
| (dHAK, QHAK)  |     |      |     |             |     |     |     | agreement oper- |
| ------------- | --- | ---- | --- | ----------- | --- | --- | --- | --------------- |
|               |     | CKG  |     | public key  |     |     |     |                 |
ations to encrypt
| CSP/PSP   |     |     |     | (QHAK) is ex- |     |     |     |     |
| --------- | --- | --- | --- | ------------- | --- | --- | --- | --- |
the DKEK
ported in
plaintext (elec-
tronically)
HSM Ephemeral  192 bits   KAS  Internally using  Input: N/A  N/A  Volatile memory  Overwriting  The dE/QE is
Agreement Key  (ECDH P384)  (A1908)  DRBG  with all zeros  used in key
Output: The
| Pair   |     |     |     |     |     |     |     | agreement oper- |
| ------ | --- | --- | --- | --- | --- | --- | --- | --------------- |
public key (QE)
| (dE, QE)   |     |     |     |     |     |     |     | ations to encrypt  |
| ---------- | --- | --- | --- | --- | --- | --- | --- | ------------------ |
is exported in
the DKEK
| CSP/PSP  |     |     |     | plaintext (elec- |     |     |     |     |
| -------- | --- | --- | --- | ---------------- | --- | --- | --- | --- |
tronically)

HSM Agreement  192 bits   KAS  N/A  N/A  KAS (SP 800- Volatile memory  Overwriting  The HDKZ is the
DKEK Shared Se- (ECDH P384)  (A1908)  56Arev3)  with all zeros  shared secret
| cret Z  |     |     |     |     |     |     |     | value Z com- |
| ------- | --- | --- | --- | --- | --- | --- | --- | ------------ |
(Cofactor) One-
puted using the
| (HDKZ)  |     |     |     |     | Pass Diffie-Hell- |     |     |     |
| ------- | --- | --- | --- | --- | ----------------- | --- | --- | --- |
HSM Agreement
man (ECC CDH)
| CSP  |     |     |     |     |     |     |     | Key (dHAK) and  |
| ---- | --- | --- | --- | --- | --- | --- | --- | --------------- |
scheme with
the HSM Ephem-
key confirma-
eral Agreement
tion
Key (QE)
The HDKZ is used
to derive the
HDWK
Page 50 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
HSM Agreement  256 bits   KDA  N/A  N/A  KAS (SP 800- Volatile memory  Overwriting  The HDWK is de-
DKEK Wrapping  (One-Step KDF  (A1908)  56Arev3)  with all zeros  rived from the
| Key  | SHA2-256)  |     |     |     |     |     |     | HDKZ and is used  |
| ---- | ---------- | --- | --- | --- | --- | --- | --- | ----------------- |
(Cofactor) One-
to wrap the
| (HDWK)  |     |     |     |     | Pass Diffie-Hell- |     |     |     |
| ------- | --- | --- | --- | --- | ----------------- | --- | --- | --- |
DKEK
man (ECC CDH)
CSP
scheme with
key confirma-
tion
Page 51 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Domain Key En- 256 bits (AES)  AES GCM  Internally using  Input: The DKEK  KAS (SP 800- Volatile memory  Overwriting  The DKEK is used
cryption Key  (A1908)  DRBG or im- is encrypted  56Arev3)  with all zeros  to encrypt the

|         |     |     | ported from  | with the HDWK  |                 |     |     | DKn when im-     |
| ------- | --- | --- | ------------ | -------------- | --------------- | --- | --- | ---------------- |
| (DKEK)  |     |     |              |                | (Cofactor) One- |     |     |                  |
|         |     |     | another mem- | derived using  |                 |     |     | ported to other  |
Pass Diffie-Hell-
| CSP  |     |     | ber of a Domain  | the shared se- |     |     |     | members of a  |
| ---- | --- | --- | ---------------- | -------------- | --- | --- | --- | ------------- |
man (ECC CDH)
|     |     |     |     | cret (HDKZ)  |     |     |     | Domain  |
| --- | --- | --- | --- | ------------ | --- | --- | --- | ------- |
scheme with
generated from
key confirma-
the HSM’s Key
tion
Agreement Key
|     |     |     |     | (QHAK) and an- | KTS (SP 800- |     |     |     |
| --- | --- | --- | --- | -------------- | ------------ | --- | --- | --- |
|     |     |     |     | other HSM’s    | 38F)         |     |     |     |
Ephemeral Key
Agreement Key
(dE) (electroni-
cally)
Output: The
DKEK is en-
crypted with the
HDWK derived
using the shared
secret (HDKZ)
generated from
the HSM’s Key
Agreement Key
(dHAK) and an-
other HSM’s
Ephemeral Key
Agreement Key
(QE) (electroni-
cally)
Page 52 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Domain Key  256 bits (AES)  AES GCM  Internally using  Input: DKn en- N/A  Volatile memory  Overwriting  Keys derived
|        |     |          | DRBG or im-      | crypted with the  |     |     | with all zeros  | from the DKn are  |
| ------ | --- | -------- | ---------------- | ----------------- | --- | --- | --------------- | ----------------- |
| (DKn)  |     | (A1908)  |                  |                   |     |     |                 |                   |
|        |     |          | ported from      | DKEK and may      |     |     |                 | used to encrypt   |
|        |     |          | another mem-     | be imported       |     |     |                 | HBKs and CSKs     |
| CSP    |     | KBKDF    |                  |                   |     |     |                 |                   |
|        |     |          | ber of a Domain  | from other        |     |     |                 |                   |
(A1910)
members of a
Domain (elec-
tronically)
Output: DKn en-
crypted with the
DKEK and may
be exported to
other members
of a Domain
(electronically)
HSM Agreement  192 bits   KAS  N/A  N/A  KAS (SP 800- Volatile memory  Overwriting  The HHKZ is the
HSKEK Shared  (ECDH P384)  (A1908)  56Arev3)  with all zeros  shared secret
| Secret Z (HHKZ)  |     |     |     |     |     |     |     | value Z com- |
| ---------------- | --- | --- | --- | --- | --- | --- | --- | ------------ |
(Cofactor) One-
puted using the
| CSP  |     |     |     |     | Pass Diffie-Hell- |     |     |     |
| ---- | --- | --- | --- | --- | ----------------- | --- | --- | --- |
HSM Agreement
man (ECC CDH)
Key (dHAK) and
scheme with
the Operator
key confirma-
Ephemeral
tion
Agreement Pub-
lic Key (QOEAK)
The HHKZ is used
to derive the
HSKEK
Page 53 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
HSM Session  256 bits (AES)  AES GCM  Internally using  Input:  N/A  KAS (SP 800- Volatile memory  Overwriting  The HSKEK en-
Key Encryption  (A1908)  DRBG  56Arev3)  with all zeros  crypts the HSM-
|              |     |     |     | Output: N/A  |     |     |     |                   |
| ------------ | --- | --- | --- | ------------ | --- | --- | --- | ----------------- |
| Key (HSKEK)  |     |     |     |              |     |     |     | Operator Session  |
(Cofactor) One-
Key (HOSK) for
| CSP  |     |     |     |     | Pass Diffie-Hell- |     |     |     |
| ---- | --- | --- | --- | --- | ----------------- | --- | --- | --- |
the following op-
man (ECC CDH)
erations:
scheme with
Initialize, Ini-
key confirma-
tializeAndCreate
tion
Domain, Attest,
GetAttesta-
tionIdentity, and
Wipe
HSM Signature  192 bits (ECDSA  ECDSA  Internally using  Input: N/A  N/A  Volatile memory  Overwriting  The dHSK is used
Key Pair (dHSK,  P384)  (A1908)  DRBG  with all zeros  to sign data cre-
Output: The
| QHSK)    |     |      |     |               |     |     |     | ated on the HSM  |
| -------- | --- | ---- | --- | ------------- | --- | --- | --- | ---------------- |
|          |     | CKG  |     | public key    |     |     |     |                  |
| CSP/PSP  |     |      |     | (QHSK) is ex- |     |     |     |                  |
ported in
plaintext (elec-
tronically)
Page 54 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
HSM-Operator 256 bits (AES) AES GCM Internally using Input: The HOSK KAS (SP 800- Volatile memory Overwriting The HOSK is
Session Key DRBG, or im- is input en- 56Arev3) with all zeros used to encrypt
(A1908)
(HOSK) ported from an crypted with the communications
(Cofactor) One-
HSM that is a domain key between a user
CSP Pass Diffie-Hell-
member of the (DKn) (electroni- and HSMs in the
man (ECC CDH)
same domain cally) same Domain
scheme with
Output: The key confirma-
HOSK is en- tion
crypted in two
KTS (SP 800-
forms to be out-
38F)
put
The first form is
encrypted with
either the Do-
main Key (DKn)
or the HSM Ses-
sion Key
Encryption Key
(HSKEK) using
AES GCM (elec-
tronically)
The second
form is en-
crypted using
AES GCM with a
256-bit key de-
rived from the
shared secret
established us-
ing elliptic curve
Diffie-Hellman
key exchange
(NIST-P384) us-
ing the HSM
Ephemeral
Agreement Key
Pair (dE,QE) and
the Operator
Ephemeral
Agreement Pub-
lic Key (dOEAK,
Document Version 0.35 Page 55 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
QOEAK) (elec-
tronically)
Import Wrap- 112 – 128 bits  KTS (RSA-OAEP)  Internally using  Input: The pri- N/A  Volatile memory  Overwriting  The public key is
ping Key Pair  (RSA 2048, 3072  DRBG or im- vate key (dIWK)  with all zeros  used by custom-
(A1908)
(dIWK, QIWK)  or 4096 bits)  ported from  is encrypted  ers of KMS to
|          |     |     | another mem-     | with the Do-     |     |     |     | wrap their CSK  |
| -------- | --- | --- | ---------------- | ---------------- | --- | --- | --- | --------------- |
| CSP/PSP  |     |     |                  |                  |     |     |     |                 |
|          |     |     | ber of a Domain  | main Key (DKn)   |     |     |     | for import via  |
|          |     |     |                  | using AES-GCM    |     |     |     | the public AWS  |
|          |     |     |                  | for input (elec- |     |     |     | KMS API         |
tronically)
Output: the pri-
vate key (dIWK)
is encrypted
with the Do-
main Key (DKn)
using AES-GCM.
The public key
(QIWK) is ex-
ported in
plaintext (elec-
tronically)
Page 56 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Import Wrap- 256 bits (AES)  AES KWP  Externally by  Input:  IWEK is  KTS-RSA  Volatile memory  Overwriting  This key is gener-
ping Envelope  (A1908)  AWS KMS cus- encrypted using  with all zeros  ated by a

| Key (IWEK)  |     |     | tomers  | the Import    |     |     |     | customer exter- |
| ----------- | --- | --- | ------- | ------------- | --- | --- | --- | --------------- |
|             |     |     |         | Wrapping Key  |     |     |     | nal to the AWS  |
CSP
|     |     |     |     | (QIWK) when      |     |     |     | KMS system and   |
| --- | --- | --- | --- | ---------------- | --- | --- | --- | ---------------- |
|     |     |     |     | used with the    |     |     |     | is used to en-   |
|     |     |     |     | ImportKey API    |     |     |     | crypt CSKs for   |
|     |     |     |     | when the cus-    |     |     |     | the ImportKey    |
|     |     |     |     | tomer imports a  |     |     |     | API when AES-    |
|     |     |     |     | CSK into the     |     |     |     | KWP is used per  |
|     |     |     |     | AWS KMS sys-     |     |     |     | SP 800-56B       |
tem
(electronically)
Output: N/A
Page 57 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Customer Sup- 256 bits (AES)  AES GCM  Externally by  Input: CSK is en- KTS-OAEP with- Volatile memory  Overwriting  This key is gener-
plied Key (CSK)  AWS KMS cus- crypted using  out key  with all zeros  ated by a
|          | 160-256 bits  | HMAC  |         |                  |               |     |     |                  |
| -------- | ------------- | ----- | ------- | ---------------- | ------------- | --- | --- | ---------------- |
|          |               |       | tomers  | Import Wrap-     | confirmation  |     |     | customer of KMS  |
| CSP/PSP  | (HMAC)        |       |         |                  |               |     |     |                  |
|          |               |       |         | ping Key (QIWK)  |               |     |     | outside the AWS  |
RSA
KTS-RSA Hybrid
|     | 112 – 128 bits   |        |     | (and, optionally,  |                |     |     | KMS system to    |
| --- | ---------------- | ------ | --- | ------------------ | -------------- | --- | --- | ---------------- |
|     |                  | ECDSA  |     |                    | Key-Transport  |     |     |                  |
|     | (RSA 2048, 3072  |        |     | the ephemeral      |                |     |     | sign or encrypt  |
scheme incorpo-
|     | or 4096 bits)  | (A1908)  |     | Import Wrap- |     |     |     | plaintext  |
| --- | -------------- | -------- | --- | ------------ | --- | --- | --- | ---------- |
rating KTS-OAEP
ping Envelope
|     |                 |     |     |              | and SP 800-38F  |     |     | It can also be   |
| --- | --------------- | --- | --- | ------------ | --------------- | --- | --- | ---------------- |
|     | 128 – 256 bits  |     |     | Key (IWEK))  |                 |     |     |                  |
|     | (ECDSA P-256,   |     |     |              |                 |     |     | used to encrypt  |
when used with
|     | P-384, P-521, or  |     |     |     |     |     |     | CDKs  |
| --- | ----------------- | --- | --- | --- | --- | --- | --- | ----- |
the ImportKey
secp256k1)
|     |     |     |     | API when the  |     |     |     |     |
| --- | --- | --- | --- | ------------- | --- | --- | --- | --- |
customer im-
ports the key
into the AWS
KMS system
After import,
the CSK is en-
crypted with the
Domain Key us-
ing AES GCM
(electronically)
Output: CSK en-
crypted by a
Domain Key
(DKn) (electroni-
cally)
Entropy Input  384 bits  Random Num- Internal entropy  Input: N/A  N/A  Volatile memory  Overwriting  Random Num-
String  ber Generation  source  with all zeros  ber Generation
Output: N/A
ENT (P)
CSP
Page 58 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
DRBG (CTR AES)   SP 800-90A CTR  DRBG   Internal entropy  Input:N/A  N/A  Volatile memory  Overwriting  Entropy input
|                | DRBG   |          | source  |              |     |     | with all zeros  | (length depend- |
| -------------- | ------ | -------- | ------- | ------------ | --- | --- | --------------- | --------------- |
| V and AES key  |        | AES CTR  |         | Output: N/A  |     |     |                 |                 |
ent on security
V (128 bits)
strength)
| CSP  |     | AES-ECB  |     |     |     |     |     |     |
| ---- | --- | -------- | --- | --- | --- | --- | --- | --- |
AES key (256
(A1908)
bits)
DRBG (CTR AES)  256 bits  DRBG   Internal entropy  Input: N/A  N/A  Volatile memory  Overwriting  Seeding mate-
| Seed  |     |          | source  |              |     |     | with all zeros  | rial for the  |
| ----- | --- | -------- | ------- | ------------ | --- | --- | --------------- | ------------- |
|       |     | AES CTR  |         | Output: N/A  |     |     |                 |               |
DRBG. Used to
CSP
|     |     | AES-ECB  |     |     |     |     |     | derive the DRBG  |
| --- | --- | -------- | --- | --- | --- | --- | --- | ---------------- |
(AES CTR) V and
(A1908)
AES key
Replication Sign- 192 bits (ECDSA  ECDSA  Internally using  Input: dRSK  en- N/A  Volatile memory  Overwriting  The private key
n
ing Key Pair  P384)  (A1908)  DRBG or im- crypted with the  with all zeros  (dRSK ) is used
n
| (dRSKn, QRSKn)  |     |     | ported from  | DKEK may be    |     |     |     | to sign the out- |
| --------------- | --- | --- | ------------ | -------------- | --- | --- | --- | ---------------- |
|                 |     |     | another mem- | imported from  |     |     |     | puts of          |
CSP/PSP
|     |     |     | ber of a Domain  | other members  |     |     |     | GetParameters-  |
| --- | --- | --- | ---------------- | -------------- | --- | --- | --- | --------------- |
|     |     |     |                  | of a Domain;   |     |     |     | ForReplication  |
|     |     |     |                  | QRSK  may be   |     |     |     | and Wrap-       |
n
|     |     |     |     | imported by an  |     |     |     | KeyForReplicatio |
| --- | --- | --- | --- | --------------- | --- | --- | --- | ---------------- |
|     |     |     |     | operator (elec- |     |     |     | n APIs           |
tronically)
The public key
|     |     |     |     | Output: dRKS    |     |     |     | (QRSK ) is used   |
| --- | --- | --- | --- | --------------- | --- | --- | --- | ----------------- |
|     |     |     |     |                 | n   |     |     | n                 |
|     |     |     |     | encrypted with  |     |     |     | to verify the in- |
|     |     |     |     | the DKEK may    |     |     |     | put of            |
|     |     |     |     | be exported to  |     |     |     | WrapKeyForRep-    |
|     |     |     |     | other members   |     |     |     | lication and      |
|     |     |     |     | of a Domain;    |     |     |     | ImportReplicat-   |
|     |     |     |     | QRSK  may be    |     |     |     | edKey APIs        |
n
exported in
plaintext (elec-
tronically)
Page 59 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Replication  192 bits (ECDH  ECDH  Internally using  Input: QRAK  k N/A  Volatile memory  Overwriting  Keys used for
Agreement Key  P384)  (A1908)  DRBG or im- may be im- with all zeros  key agreement
| (dRAK, QRAK)  |     |      | ported from a  | ported in       |     |     |     | to derive a Repli- |
| ------------- | --- | ---- | -------------- | --------------- | --- | --- | --- | ------------------ |
| k k           |     | CKG  |                |                 |     |     |     |                    |
|               |     |      | member of a    | plaintext from  |     |     |     | cation Wrapping    |
CSP/PSP
|     |     |     | different Do- | another HSM;   |     |     |     | Key (RWK)  |
| --- | --- | --- | ------------- | -------------- | --- | --- | --- | ---------- |
|     |     |     | main          | dRAK may be  k |     |     |     |            |
imported en-
crypted with the
domain key
(DK n ) from an-
other HSM
(electronically)
Output: QRAK
k
may be ex-
ported in
plaintext; dRAK
k
may be ex-
ported
encrypted with
the domain key
(DK ) (electroni-
n
cally)
Page 60 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Replication  192 bits   KAS  N/A  N/A  KAS (SP 800- Volatile memory  Overwriting  The RRZ is the
Agreement RWK  (ECDH P384)  (A1908)  56Arev3)  with all zeros  shared secret
| Shared Secret Z  |     |     |     |     |     |     |     | value Z com- |
| ---------------- | --- | --- | --- | --- | --- | --- | --- | ------------ |
(Cofactor) One-
puted using the
| (RRZ)  |     |     |     |     | Pass Diffie-Hell- |     |     |     |
| ------ | --- | --- | --- | --- | ----------------- | --- | --- | --- |
private portion
man (ECC CDH)
| CSP  |     |     |     |     |     |     |     | of a region’s  |
| ---- | --- | --- | --- | --- | --- | --- | --- | -------------- |
scheme with
Replication
key confirma-
Agreement Key
tion
(dRAK) and the
k
public portion of
another region’s
Replication
Agreement Key
(QRAK)
k
The RRZ is used
to derive the
RWK
Replication  256 bits (AES)  AES GCM  Internally de- Input: N/A   KAS (SP 800- Volatile memory  Overwriting  The RWK is used
Wrapping Key  (A1908)  rived from a  56Arev3)  with all zeros  to encrypt an
|        |     |     |                 | Output: N/A  |     |     |     |                     |
| ------ | --- | --- | --------------- | ------------ | --- | --- | --- | ------------------- |
| (RWK)  |     |     | Public Replica- |              |     |     |     | HBK. It is derived  |
(Cofactor) One-
|      |     |     | tion Agreement   |     |                   |     |     | from a key      |
| ---- | --- | --- | ---------------- | --- | ----------------- | --- | --- | --------------- |
| CSP  |     |     |                  |     | Pass Diffie-Hell- |     |     |                 |
|      |     |     | Key (QRAK ) and  |     |                   |     |     | agreement oper- |
|      |     |     | 1                |     | man (ECC CDH)     |     |     |                 |
|      |     |     | a Private Repli- |     |                   |     |     | ation between   |
scheme with
|     |     |     | cation  |     |     |     |     | the QRAK from  |
| --- | --- | --- | ------- | --- | --- | --- | --- | -------------- |
k
key confirma-
|     |     |     | Agreement Key  |     |     |     |     | an HSM in an- |
| --- | --- | --- | -------------- | --- | --- | --- | --- | ------------- |
tion
|     |     |     | (dRAK 2 )  |     |     |     |     | other security  |
| --- | --- | --- | ---------- | --- | --- | --- | --- | --------------- |
domain and the
dRAK in the lo-
k
cal HSM security
domain
Page 61 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Customer Repli- 256 bits (AES,  AES GCM  Internally from  Input: CRK may  KAS (SP 800- Volatile memory  Overwriting  The CRK is the
cation Key (CRK)  HMAC)  an HBK en- be imported by  56Arev3)  with all zeros  customer key
HMAC
|          |                  |     | crypted with a  | decrypting an   |                 |     |     | that is being   |
| -------- | ---------------- | --- | --------------- | --------------- | --------------- | --- | --- | --------------- |
| CSP/PSP  | 112 to 128 bits  |     |                 |                 | (Cofactor) One- |     |     |                 |
|          |                  |     | domain key      | HBK using a do- |                 |     |     | transmitted be- |
RSA
|     | (RSA: 2048,    |        |        |              | Pass Diffie-Hell- |     |     |                  |
| --- | -------------- | ------ | ------ | ------------ | ----------------- | --- | --- | ---------------- |
|     |                |        | (DKn)  | main key (DK | n )               |     |     | tween two HSMs   |
|     | 3072, or 4096  | ECDSA  |        |              | man (ECC CDH)     |     |     |                  |
and re-encrypt-
|     | bits)            |          |     |                 | scheme with   |     |     | CRKs are      |
| --- | ---------------- | -------- | --- | --------------- | ------------- | --- | --- | ------------- |
|     |                  | (A1908)  |     | ing it using a  |               |     |     |               |
|     |                  |          |     |                 | key confirma- |     |     | wrapped with  |
|     | 128 to 256 bits  |          |     | Replication     |               |     |     |               |
|     |                  |          |     |                 | tion          |     |     | the RWK       |
Wrapping Key
(ECDSA: P256,
|     | P384, P521, or  |     |     | (RWK) (elec- |     |     |     |     |
| --- | --------------- | --- | --- | ------------ | --- | --- | --- | --- |
|     | secp256k1)      |     |     | tronically)  |     |     |     |     |
Output: CRK is
exported en-
crypted with a
Replication
Wrapping Key
(RWK) (elec-
tronically)
Operator  192 bits (ECDH  ECDH (A1908)  Externally by  Input: When an  N/A  Volatile memory  Overwriting  The QOEAK is
Ephemeral  P384)  the module op- operator calls  with all zeros  provided by an
| Agreement Pub-    |     |     | erator  | the NegotiateS- |     |     |     | operator to es-    |
| ----------------- | --- | --- | ------- | --------------- | --- | --- | --- | ------------------ |
| lic Key (QOEAK)   |     |     |         | essionKey       |     |     |     | tablish a session  |
|                   |     |     |         | service (elec-  |     |     |     | key (HOSK)         |
PSP
tronically)
It is used with
|     |     |     |     | Output: N/A  |     |     |     | the HSM ephem- |
| --- | --- | --- | --- | ------------ | --- | --- | --- | -------------- |
eral agreement
key (dE) using
ECC CDH
Page 62 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Operator Signa- 192 bits (ECDSA  ECDSA   Externally by  Input: The pub- N/A  Volatile memory  Overwriting  The QOS is used
ture Public Key   P384)  the module op- lic key (QOS) is  with all zeros  by the HSM to
RSA
| (QOS)   |     |     | erator  | imported in  |     |     |     | authenticate op- |
| ------- | --- | --- | ------- | ------------ | --- | --- | --- | ---------------- |
112 to 128 bits
|     |     |     |     | plaintext when  |     |     |     | erators  |
| --- | --- | --- | --- | --------------- | --- | --- | --- | -------- |
(A1908)
| PSP  | (RSA: 2048,  |     |     |     |     |     |     |     |
| ---- | ------------ | --- | --- | --- | --- | --- | --- | --- |
an administra-
3072, or 4096
tor calls
bits)
InitializeAndCre-
ateDomain,
CreateDomain,
and ChangeDo-
main
They are also
imported by
APIs that accept
a Domain Token
(electronically)
Output: The
public keys are
exported from
the HSM in
plaintext by APIs
that export a
Domain Token
(electronically)
Page 63 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
|      |     | -  .t  |     |        | t   |     |      |  d     |
| ---- | --- | ------ | --- | ------ | --- | --- | ---- | ------ |
|      |     | c      |     |        | n   |     |      | e      |
| e    |     | n r e  | n   |        | e   |     | n    | t      |
| p    |     | u C    | o   |        | m   |     | o    | a      |
|  P y |     | F  d   | it  |  /     | h   |     |      | le     |
| T    | h   |  y r   |     |        | s   | e   | it   |        |
| S /  | t g | t n e  | a   |  t t   | ilb | g   | a    | r  &   |
| S e  | n   | ir a b | r e | r o r  |     | a   | s io |        |
| / m  | e   | u  n m | n   | o      | a   | r   |      |  e s   |
| y a  | r   | c o u  | e   | p p    | t   | o   | r    | y      |
| e N  | t   | e N    | G   | m x    | s   | t   | e    | s U e  |
| K    | S   | S it   |     | I E    | E   | S   | Z    | k      |
Customer Data  112 to 128 bits  RSA (A1908)  Externally by  Input: The pub- N/A  Volatile memory  Overwriting  The QCDEK is
Encryption Pub- (RSA: 2048,  the module op- lic key (QCDEK)  with all zeros  provided by an
lic Key (QCDEK)  3072, or 4096  erator  is optionally  operator or cus-
|     | bits)  |     |     | provided when  |     |     |     | tomer to encrypt  |
| --- | ------ | --- | --- | -------------- | --- | --- | --- | ----------------- |
PSP
|     |     |     |     | an operator  |     |     |     | the SCDEK,  |
| --- | --- | --- | --- | ------------ | --- | --- | --- | ----------- |

|     |     |     |     | calls Generate,  |     |     |     | which encrypts  |
| --- | --- | --- | --- | ---------------- | --- | --- | --- | --------------- |
|     |     |     |     | GenerateAndEn-   |     |     |     | customer data   |
cryptRandomBy
tes, Generate-
DataKeyPair,
and Decrypt
(electronically)
Output: N/A
Customer Data  128 bits, 256  AES GCM  Internally using  Input: N/A  N/A  Volatile memory  Overwriting  The SCDEK en-
Encryption Sym- bits (AES)  DRBG  with all zeros  crypts customer
|             |     | AES CBC  |     | Output: En- |     |     |     |                     |
| ----------- | --- | -------- | --- | ----------- | --- | --- | --- | ------------------- |
| metric Key  |     |          |     |             |     |     |     | plaintext data. If  |
crypted by
| (SCDEK)  |     | (A1908)  |     |     |     |     |     | a QCDEK is op- |
| -------- | --- | -------- | --- | --- | --- | --- | --- | -------------- |
QCDEK (elec-
tionally provided
| PSP  |     |     |     | tronically)  |     |     |     |     |
| ---- | --- | --- | --- | ------------ | --- | --- | --- | --- |
for Generate,
GenerateAndEn-
cryptRandomByt
es, Generate-
DataKeyPair, or
Decrypt, a SCDEK
will be gener-
ated within the
module to en-
crypt the
resulting cus-
tomer plaintext
data.
Table 13 – SSPs
Page 64 of 71
| Document Version 0.35  |     |     |     |     |     |     |     |     |
| ---------------------- | --- | --- | --- | --- | --- | --- | --- | --- |
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Entropy sources Minimum number of Details
bits of entropy
Intel Deterministic Random Number Generator 384 bits of seed material is Used only to seed the DRBG in the module. 512 bits of entropy data with 0.7 bits of min
requested from the entropy entropy per bit is provided to the vetted conditioning function, 128-bit AES-CBC-MAC.
source which provides full The conditioning function is called three times for the 384-bit entropy input into the
entropy DRBG.
Table 14 – Non-Deterministic Random Number Generator Specification
Document Version 0.35 Page 65 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
10. Self-Tests
FIPS 140-3 requires the module to perform self-tests to ensure the integrity of the module and the correctness of
the cryptographic functionality at start up. Some functions require conditional tests during normal operation of the
module. All of these tests are listed and described in this section. In the event of a self-test error, the module will
log the error and enter the error state. Once in the error state, all SSPs are zeroized and the module becomes
unusable.
Pre-Operational Self-Tests
Pre-operational self-tests are run upon the initialization of the module and do not require operator intervention to
run. If any of the tests fail, the module will not initialize. The module will enter an error state and no services can
be accessed by the operator. The module implements the following pre-operational self-tests:
Integrity Check
256-bit error detection code (EDC) on all module components
The module performs all pre-operational self-tests automatically when the module is initialized. All pre-opera-
tional self-tests must be passed before a Crypto Officer can perform services. The pre-operational self-tests can be
run on demand by rebooting the module.
Conditional Self-Tests
The module performs all conditional self-tests automatically when the module is initialized. All conditional self-tests
must be passed before a Crypto Officer can perform services.. If any of these tests fail, the module will enter an
error state, where no services can be accessed by the operators. The module can be re-initialized to clear the error
and resume Approved mode of operation. Each module performs the following conditional self-tests:
Cryptographic Algorithm Self Tests
• AES (Encryption in ECB mode with 128 bit key) KAT
• AES (Decryption in ECB mode with 128 bit key) KAT
• AES GCM (Generation with 128 bit key) KAT
• AES GCM (Verification with 128 bit key) KAT
• ECC KAS (ECDH) (Primitive Z test with EC P-256 parameter set) KAT
• ECDSA (Signature generation with P-256 curve) KAT
• ECDSA (signature verification with P-256 curve) KAT
• RSA (Signature generation, key transport SP800-56B per IG D.G with 2048 bit key) KAT
• RSA (Signature verification, key transport SP800-56B per IG D.G with 2048 bit key) KAT
• HMAC (Generation with SHA2-256, SHA2-512) KAT
• HMAC (Verification with SHA2-256, SHA2-512) KAT
• SHS (SHA-1, SHA2-256, SHA2-512) KAT
• SP 800-90 CTR_DRBG KAT
Document Version 0.35 Page 66 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
• DRBG Health Tests
Performed on DRBG, per SP 800-90A Section 11.3
• SP 800-108 KBKDF (HMAC-SHA2-256) KAT
• KDA (OneStep KDF) (SHA2-256) KAT
Pair-wise Consistency Tests
• RSA key pair generation
• ECDSA / ECDH key pair generation
SP 800-56A Assurances
• Performed per SP 800-56Arev3 Sections 5.5.2 and 5.6.2
SP 800-90B Health Tests (Critical function test)
• NIST SP 800-90B ENT Health Tests, per SP 800-90B Section 4.5
The module does not perform a firmware load test because no additional firmware can be loaded in the module
while operating in the Approved mode. Please see Section 3 for guidance on configuring and maintaining Approved
mode.
On-demand Self-Tests
On-demand self-tests can be performed by rebooting the module which will perform the pre-operational self-tests.
Periodic Self-Tests
All conditional self-tests are automatically run once a day. The specific time is randomly selected by the module
between 23 to 24 hours since the last run. The tests are executed in the background.
Document Version 0.35 Page 67 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
11. Life-cycle Assurance
Delivery and Operation
The AWS Key Management Service HSM is designed to be mounted in a rack only. Before mounting onto a rack, the
module should be inspected for signs of physical tampering. Connect the power interface to the power connector
in the rack.
Power up the module. The module will start up in the approved mode of operation. No other configuration is nec-
essary.
End of Life
To prepare a module for disposal:
1. Remove all domain information on the module using the ForgetDomain API
2. Delete the HSM Signature Key and HSM Agreement Key from the HSM using the Wipe API
3. Return the HSM to the factory state using the DeactivateAndReboot API. This step also zeroizes volatile
memory as part of the reboot process
4. Power down the module by disconnecting the module from the power source
To securely destroy a module:
1. To open the chassis, drill though all fasteners that secure the cover to the chassis and remove the cover.
2. Remove and destroy the solid state drive and memory modules in accordance with NIST SP 800-88rev1.
Document Version 0.35 Page 68 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
12. Mitigation of Other Attacks
Not Applicable.
Document Version 0.35 Page 69 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
Appendix A - Acronyms
AES Advanced Encryption Standard
ANSI American National Standards Institute
API Application Programming
Interface
AWS Amazon Web Services
CBC Cipher Block Chaining
CDK Customer Data Key
CMK Customer Managed Key
CMVP Cryptographic Module
Validation Program
CO Crypto Officer
CSE Communications Security
Establishment Canada
CSK Customer Supplied Key
CSP Critical Security Parameter
CTR Counter
DH Diffie-Hellman
DKn Domain Key
DKEK Domain Key Encryption Key
DRBG Deterministic Random Bit
Generator
ECB Electronic Codebook
EC Elliptic Curve
ECDSA Elliptic Curve Digital Signature Algorithm
EMC Electromagnetic Compatibility
EMI Electromagnetic Interference
FCC Federal Communications
Commission
FIPS Federal Information Processing Standard
GCM Galois/Counter Mode
HBK HSM Backing Key
HMAC (Keyed-) Hash Message
Authentication Code
HOSK HSM-to-Operator Session Key
HSK HSM Signature Key Pair
HSKEK HSM Session Key Encryption Key
HSM Hardware Security Module
IPMI Intelligent Platform
Management Interface
KAS Key Agreement Scheme
KAT Known Answer Test
KBKDF Key Based Key Derivation
Function
KDF Key Derivation Function
KMS Key Management Service
KTS Key Transport Scheme
Document Version 0.35 Page 70 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.

FIPS 140-3 Non-Proprietary Security Policy: AWS Key Management Service HSM
MAC Message Authentication Code
MD Message Digest
NIST National Institute of Standards and Technology
NMI Non-Maskable Interrupt
OAEP Optimal Asymmetric Encryption Padding
PKCS Public-Key Cryptography
Standards
PSS Probabilistic Signature Scheme
QOEAK Operator Ephemeral
Agreement Public Key
QOS Operator Signature Public Key
RNG Random Number Generator
RSA Rivest, Shamir, and Adleman
SHA Secure Hash Algorithm
SP Special Publication
SSP Sensitive Security Parameter
Document Version 0.35 Page 71 of 71
Copyright 2024 Amazon Web Services, Inc. All Rights Reserved
This non-proprietary security policy document may be freely reproduced and distributed in its entirety without modification.