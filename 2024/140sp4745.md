nShield 5s Hardware Security
Module
FIPS 140-3 Level 3 non-proprietary Security Policy

``

Version: 1.0.5

Date: 08/01/2025

Copyright © 2020 nCipher Security Limited. All rights reserved.

Copyright in this document is property of nCipher Security Limited. This document may be reproduced and
distributed in whole (i.e., without modification) provided that the copyright notice and Entrust branding has
not been removed or altered. Words and logos marked with ® or ™ are trademarks of nCipher Security Limited
or its affiliates in the EU and other countries.

Mac and OS X are trademarks of Apple Inc., registered in the U.S. and other countries.

Microsoft and Windows are either registered trademarks or trademarks of Microsoft Corporation in the United
States and/or other countries.

Linux® is the registered trademark of Linus Torvalds in the U.S. and other countries.

Information in this document is subject to change without notice.

nCipher Security Limited makes no warranty of any kind with regard to this information, including, but not
limited to, the implied warranties of merchantability and fitness for a particular purpose. nCipher Security
Limited shall not be liable for errors contained herein or for incidental or consequential damages concerned
with the furnishing, performance or use of this material.

Where translations have been made in this document English is the canonical language.

nCipher Security Limited
Registered Office: One Station Square,
Cambridge, CB1 2GA, United Kingdom
Registered in England No. 11673268

nCipher is an Entrust company.

Entrust, Datacard, and the Hexagon Logo are trademarks, registered trademarks, and/or service marks of
Entrust Corporation in the U.S. and/or other countries. All other brand or product names are the property of
their respective owners. Because we are continuously improving our products and services, Entrust
Corporation reserves the right to change specifications without prior notice. Entrust is an equal opportunity
employer.

2 of 47

nShield 5s Hardware Security Module

Contents

1  General............................................................................................................................................... 4

2  Cryptographic module specification .................................................................................................. 5

2.1  Scope .......................................................................................................................................... 5

2.2  Cryptographic module description ............................................................................................ 5

2.3  Supported cryptographic algorithms ......................................................................................... 6

3  Cryptographic module interfaces .................................................................................................... 12

4  Roles, services and authentication .................................................................................................. 13

4.1  Roles ......................................................................................................................................... 13

4.2  Services .................................................................................................................................... 17

5  Software/Firmware security ............................................................................................................ 28

6  Operational environment ................................................................................................................ 29

7  Physical security ............................................................................................................................... 30

8  Non-invasive security ....................................................................................................................... 31

9  Sensitive security parameters management ................................................................................... 32

9.1  Keys and Sensitive Security Parameters .................................................................................. 32

9.2  SSP zeroization methods .......................................................................................................... 38

9.3  Entropy sources ........................................................................................................................ 38

10 Self tests ........................................................................................................................................... 39

10.1 Pre-operational self tests ......................................................................................................... 39

10.2 Conditional self tests ................................................................................................................ 39

10.3 Periodic self tests ..................................................................................................................... 41

11 Life-cycle assurance ......................................................................................................................... 42

11.1 Delivery .................................................................................................................................... 42

11.2 Cryptographic module identification ....................................................................................... 42

11.3 Approved mode of operation .................................................................................................. 44

11.4 End of life ................................................................................................................................. 44

12 Mitigation of other attacks .............................................................................................................. 45

Contact Us ............................................................................................................................................. 46

nShield 5s Hardware Security Module

3 of 47

1  General

This  document  defines  the  non-proprietary  Security  Policy  enforced  by  the  nShield  5s  Hardware
Security Module, i.e. the Cryptographic Module, to meet with the security requirements in FIPS 140-
3 and ISO/IEC 19790.

The Cryptographic Module meets overall FIPS 140-3 Security Level 3. The following table specifies the
security level in detail.

ISO/IEC 24759 Section 6.

FIPS 140-3 Section Title

Security Level

[Number Below]

1

2

3

4

5

6

7

8

9

10

11

12

Table 1 Security levels

General

Cryptographic Module Specification

Cryptographic Module Interfaces

Roles, Services and Authentication

Software/Firmware security

Operational Environment

Physical Security

Non-invasive Security

Sensitive Security Parameter Management

Self-Tests

Life-cycle Assurance

Mitigation of Other Attacks

3

3

3

3

3

N/A

3

N/A

3

3

3

N/A

4 of 47

nShield 5s Hardware Security Module

2  Cryptographic module specification

2.1  Scope
The following product hardware variants and firmware version(s) are in scope of this Security Policy.

Model

Hardware

Firmware Version  Distinguishing Features

nShield 5s F3

model number nC5536E

nShield 5s for nShield 5c and for nShield
HSMi

model number nC5536N

[Part
Number
and
Version]

PCB
Assembly
Part
Number:
PCA10005-
01

PCB
Assembly
Revision:
03, 04

primary: 13.2.4

PCIe form factor

recovery: 13.2.4

uboot: 1.1.0, 1.4.1

PCIe  form  factor  identical  to  the  nShield  5s  F3  (nC5536E),
embedded inside the nShield 5c or the nShield HSMi network
appliances.

Table 2 Cryptographic Module Tested Configuration

2.2  Cryptographic module description

The nShield 5s Hardware Security Module (HSM) is a multi-chip embedded hardware Cryptographic
Module  as  defined  in  FIPS  140-3,  which  comes  in  a  PCI  express  board  form  factor  protected  by  a
tamper resistant enclosure, and performs encryption, digital signing, and key management on behalf
of an extensive range of commercial and custom-built applications including public key infrastructures
(PKIs),  identity  management  systems,  application-level  encryption  and  tokenization,  SSL/TLS,  and
code signing.

The nShield 5s HSM is also embedded inside the nShield 5c or the nShield HSMi, which are network-
attached appliances delivering cryptographic services as a shared network resource  for distributed
applications  and  virtual  machines,  giving  organizations  a  highly  secure  solution  for  establishing
physical and logical controls for server-based systems.

The table below shows the nShield 5s HSM (left, representative of the two hardware variants nC5536E,
nC5536N) and the nShield 5c appliance (right).

nShield 5s Hardware Security Module

5 of 47

Figure 1 nShield 5s (left) and nShield 5c (right)

The cryptographic boundary is delimited in red in the images in the table below. It is delimited by the
heat sink and the outer edge of the potting material on the top and bottom of the PCB.

Figure 2 Cryptographic module physical boundary

The module enforces that only approved services are available and plaintext import/export of secret
or private keys is not allowed. Refer to Approved mode of operation.

2.3  Supported cryptographic algorithms
This section describes the cryptographic mechanisms and security functions provided and used by the
cryptographic module.

2.3.1  Approved algorithms

The following tables describe the approved cryptographic algorithms supported by the Cryptographic
Module.

Note: All AES symmetric key sizes have equivalent strength.

2.3.1.1  nCore crypto

CAVP Cert  Algorithm
Standard

and

Mode/Method

Description  /  Key  Size(s)  /  Key
Strength(s)

Use / Function

A2513

AES

[FIPS  197]
800-38A]
800-38D]

[SP
[SP

A2513

KTS (AES)

[SP  800-38F]  [SP
800-38D]

ECB

CBC

GCM

KW

KWP

GCM

A2513

KTS-IFC

[SP 800-56Brev2]

KTS-IFC  (KTS-OAEP-basic)  with  SHA2-
224,  SHA2-256,  SHA2-384,  SHA2-512,
SHA3-224,
SHA3-384,
SHA3-256,
SHA3-512

Key sizes: 128, 192, 256 bits.

Data encryption/decryption

Key sizes: 128, 192, 256 bits.

Key wrapping/unwrapping

(Key
establishment
methodology provides between
128, 192, 256 bits of encryption
strength.)

Modulus
4096 bits.

length:  2048,  3072,

Key  transport  (encapsulation,  un-
encapsulation)

establishment
(Key
methodology provides between
112  and  150  bits  of  encryption
strength.)

Vendor
affirmed

CKG

[SP 800-133rev2]

Section  6.1  "Direct  Generation"  of
symmetric keys

n/a

Symmetric key generation

6 of 47

nShield 5s Hardware Security Module

CAVP Cert  Algorithm
Standard

and

Mode/Method

Description  /  Key  Size(s)  /  Key
Strength(s)

Use / Function

A2513

RSA keyGen

RSASSA-PKCS-v1_5, RSASSA-PSS

[FIPS 186-4]

A2513

RSA SigGen

[FIPS 186-4]

RSASSA-PKCS-v1_5,  RSASSA-PSS  with
SHA2-384,
SHA2-256,
SHA2-224,
SHA2-512

Modulus
4096 bits.

length:  2048,  3072,

Key generation

(Provides  112,  128,  150  bits  of
strength.)

Modulus
4096 bits.

length:  2048,  3072,

Signature generation

(Provides  112,  128,  150  bits  of
strength.)

A2513

RSA SigVer

[FIPS 186-4]

RSASSA-PKCS-v1_5,  RSASSA-PSS  with
SHA-1  (legacy  use  only),  SHA2-224,
SHA2-256, SHA2-384, SHA2-512

Modulus  length:  1024  (legacy
use only), 2048, 3072, 4096 bits.

Signature verification

A2513

ECDSA KeyGen

n/a

[FIPS 186-4]

A2513

ECDSA KeyVer

n/a

[FIPS 186-4]

A2513

ECDSA SigGen

n/a

[FIPS 186-4]

A2513

ECDSA SigVer

n/a

[FIPS 186-4]

A2513

DSA KeyGen

n/a

[FIPS 186-4]

A2513

DSA SigGen

[FIPS 186-4]

Uses SHA2-224, SHA2-256, SHA2-384,
SHA2-512

Curves:  P-224,  P-256,  P-384,  P-
521, K-233, K-283, K-409, K-571,
B-233, B-283, B-409, B-571

(Provides between 112 and 256
bits of encryption strength.)

Curves:  P-224,  P-256,  P-384,  P-
521, K-233, K-283, K-409, K-571,
B-233, B-283, B-409, B-571

(Provides between 112 and 256
bits of encryption strength.)

Curves:  P-224,  P-256,  P-384,  P-
521, K-233, K-283, K-409, K-571,
B-233, B-283, B-409, B-571

(Provides between 112 and 256
bits of encryption strength.)

Curves:  P-224,  P-256,  P-384,  P-
521, K-233, K-283, K-409, K-571,
B-233, B-283, B-409, B-571

Key generation

Key verification

Signature generation

Signature verification

L = 2048 bits, N = 224 bits

Key generation

L = 2048 bits, N = 256 bits

L = 3072 bits, N = 256 bits

(Provides between 112 and 128
bits of strength.)

L = 2048 bits, N = 224 bits

Signature generation

L = 2048 bits, N = 256 bits

L = 3072 bits, N = 256 bits

(Provides between 112 and 128
bits of strength.)

A2513

DSA SigVer

[FIPS 186-4]

Uses  SHA-1  (legacy  use  only),  SHA2-
224, SHA2-256, SHA2-384, SHA2-512

L = 1024 bits, N = 160 bits (legacy
use only)

Signature verification

L = 2048 bits, N = 224 bits

L = 2048 bits, N = 256 bits

L = 3072 bits, N = 256 bits

A2513

DSA PQGGen

n/a

L = 2048 bits, N = 224 bits

Domain parameter generation

nShield 5s Hardware Security Module

7 of 47

CAVP Cert  Algorithm
Standard

and

Mode/Method

Description  /  Key  Size(s)  /  Key
Strength(s)

Use / Function

[FIPS 186-4]

L = 2048 bits, N = 256 bits

L = 3072 bits, N = 256 bits

(Provides between 112 and 128
bits of strength.)

A2513

DSA PQGVer

n/a

[FIPS 186-4]

L = 1024 bits, N = 160 bits (legacy
use only)

Domain parameter verification

L = 2048 bits, N = 224 bits

L = 2048 bits, N = 256 bits

L = 3072 bits, N = 256 bits

A2513

HMAC

[FIPS 198]

HMAC-SHA1,
HMAC-SHA2-224,
HMAC-SHA2-256,  HMAC-SHA2-384,
HMAC-SHA2-512

Key sizes: 128 bits =< key size =<
2048 bits.

Output length: 10 to 64 bytes.

MAC generation and verification

(Provides between 128 and 256
bits of strength.)

A2513

AES

CMAC

Key sizes: 128, 192, 256 bits.  MAC generation and verification

[SP 800-38B]

A2513

KAS-FFC

DH

[SP 800-56Arev3]

A2513

KAS-FFC

DH

[SP 800-56Arev3]

A2513

Safe  Primes  Key
Generation

[SP 800-56Arev3]

KeyGen for KAS-FFC

A2513

Safe  Primes  Key
Verification

[SP 800-56Arev3]

KeyVer for KAS-FFC

Domain  params:  MODP-2048,
MODP-3072,
MODP-4096,
MODP-6144,  MODP-8192,  FB,
FC

KDF:  oneStep  with  auxiliary
functions  SHA2-224,  SHA2-256,
SHA2-384, SHA2-512

(Key
establishment
methodology provides between
112  and  200  bits  of  encryption
strength.)

Domain params: MODP-3072

KDF:  oneStep  with  auxiliary
function SHA2-256

(Key
establishment
methodology  provides  128  bits
of encryption strength.)

Safe prime groups: MODP-2048,
MODP-3072,
MODP-4096,
MODP-6144, MODP-8192

(Provides between 112 and 200
bits of encryption strength.)

Safe prime groups: MODP-2048,
MODP-3072,
MODP-4096,
MODP-6144, MODP-8192

Key  agreement,  compliant  with  IG
D.F. Scenario 2, path 2.

Key  agreement  used
Impath
channel,  compliant  with  IG  D.F.
Scenario 2, path 2.

in

KAS-FFC key generation

KAS-FFC key verification

A2513

KAS-ECC

ECDH

[SP 800-56Arev3]

ECMQV

Curves:  P-224,  P-256,  P-384,  P-
521, K-233, K-283, K-409, K-571,
B-233, B-283, B-409, B-571

Key  agreement,  compliant  with  IG
D.F. Scenario 2, path 2.

8 of 47

nShield 5s Hardware Security Module

CAVP Cert  Algorithm
Standard

and

Mode/Method

Description  /  Key  Size(s)  /  Key
Strength(s)

Use / Function

KDF:  oneStep  with  auxiliary
functions  SHA2-224,  SHA2-256,
SHA2-384, SHA2-512

(Key
establishment
methodology provides between
112  and  256  bits  of  encryption
strength.)

A2513

KAS-ECC

ECDH

Curves: P-521

[SP 800-56Arev3]

KDF:  twoStep  with  auxiliary
HMAC-SHA2-256

(Key
establishment
methodology  provides  256  bits
of encryption strength.)

Key  agreement
smartcard
channel,  compliant  with  IG  D.F.
Scenario 2, path 2.

for

A2513

KBKDF

counter mode

Key sizes: 128, 192, 256 bits.

Key derivation

[SP 800-108rev1]

CMAC-AES256

Output length: 128 bits.

(Provides between 128 and 256
bits of strength.)

A2513

SHS

[FIPS 180-4]

SHA-1,  SHA2-224,  SHA2-256,  SHA2-
384, SHA2-512

n/a

Message digest

A2513

SHA-3

[FIPS 202]

SHA3-224,
SHA3-512

SHA3-256,

SHA3-384,

n/a

Message digest

A2513

DRBG

Hash_DRBG

256 bits of security strength

Random bit generation

[SP 800-90Arev1]

Table 3 nCore - Approved Algorithms

Note: For AES GCM, the 96-bit IV is internally generated using the approved DRBG as per IG C.H.

Note: ECDSA SigVer with P-192 has been CAVP-tested but is not used by any approved service of the
module. Only the algorithms, modes/methods, and key lengths/curves/moduli shown in this table are
used by an approved service of the module.

2.3.1.2  Bootloader crypto

CAVP Cert  Algorithm and Standard  Mode/Method

Description  /  Key  Size(s)  /  Key
Strength(s)

Use / Function

A2404

RSA SigVer

RSASSA-PKCS-v1_5 with SHA2-256

Modulus length: 4096 bits

Signature verification

A6385

[FIPS 186-4]

(Provides 149 bits of strength)

A2404

SHS

SHA2-256

n/a

Message digest

A6385

[FIPS 180-4]

Table 4 Bootloader - Approved Algorithms

nShield 5s Hardware Security Module

9 of 47

2.3.1.3  SSH crypto

CAVP Cert  Algorithm  and

Mode/Method

Standard

Description  /  Key  Size(s)  /
Key
Strength(s)

Use / Function

A2512

AES

CTR

Key sizes: 128 bits

Data encryption/decryption

[FIPS  197]  [SP
800-38A]
[SP
800-38D]

GCM

ECB

Vendor
affirmed

CKG

[SP
133rev2]

800-

Section  6.1
Generation"
symmetric keys

n/a

"Direct
of

Symmetric key generation

A2512

ECDSA SigGen

n/a

Curves: P-256, P-521

Signature generation

[FIPS 186-4]

(Provides between 128  and
256 bits of strength.)

A2512

ECDSA SigVer

n/a

Curves: P-256, P-521

Signature verification

[FIPS 186-4]

(Provides between 128  and
256 bits of strength.)

A2512

HMAC

HMAC-SHA2-256

Key sizes: 256 bits

MAC generation and verification

[FIPS 198]

Output length: 32 bytes

A2512

KAS-ECC-SSC

ECDH

Curves: P-256

Key agreement

(Provides
strength.)

256  bits  of

A2512

[SP
56Arev3]

800-

-  Secure
(SSHv2)

n/a

CVL
Shell
KDF

[SP
135rev1]

800-

(Key
establishment
methodology  provides  128
bits of encryption strength)

n/a

Key derivation

A2512

KAS-ECC

ECDH

Curves: P-256

[SP
56Arev3]
800-135rev1]

800-
[SP

KDF (CVL): SSHv2

(Key
establishment
methodology  provides  128
bits of encryption strength)

Key  agreement,  KAS-ECC-SSC
in
conjunction  with  SSHv2  KDF  (CVL)  of  SP  800-135rev1
(Cert. #A2512), which is compliant with IG D.F. Scenario
2, path 2.

(Cert.  #A2512)

A2512

SHS

SHA2-256

n/a

Message digest

[FIPS 180-4]

SHA2-512

Table 5 SSH - Approved Algorithms

Note: As per IG D.C., no parts of this protocol, other than the approved cryptographic algorithms and
the KDFs, have been tested by the CAVP and CMVP.

Note: For AES GCM, the module is compliant with RFCs 4252, 4253 and 5647, and the IV is generated
according to the SSHv2 protocol IV generation, as per IG C.H. In case the module’s power is lost and
then restored, a new key for use with the AES-GCM encryption/decryption is established.

10 of 47

nShield 5s Hardware Security Module

2.3.2  Allowed algorithms

The following table describes the allowed cryptographic algorithms supported by the Cryptographic
Module.

2.3.2.1  nCore crypto

Algorithm

Caveat

ECDSA

[FIPS 186-4]

KAS-ECC

[SP 800-56Arev3]

•

•

•

•

•

•

•

•

•

•

brainpoolP224r1/P224t1 (112 bits of strength)

Key generation

brainpoolP256r1/P256t1 (128 bits of strength)

Signature generation and verification

Use/Function

brainpoolP320r1/P320t1 (160 bits of strength)

brainpoolP384r1/P384t1 (192 bits of strength)

brainpoolP512r1/P512t1 (256 bits of strength)

brainpoolP224r1/P224t1 (112 bits of strength)

Key agreement

brainpoolP256r1/P256t1 (128 bits of strength)

brainpoolP320r1/P320t1 (160 bits of strength)

brainpoolP384r1/P384t1 (192 bits of strength)

brainpoolP512r1/P512t1 (256 bits of strength)

Table 6 nCore - Non-Approved Algorithms Allowed in the Approved Mode of Operation

2.3.3  Non-approved algorithms

Only approved and non-approved but allowed cryptographic algorithms are supported.

nShield 5s Hardware Security Module

11 of 47

3  Cryptographic module interfaces

The Cryptographic Module provides the following physical ports:

•  Status LED

•  Recovery button

•  Smartcard reader serial port

•  Host interface PCIe bus

•  Battery (including external backup battery power supply)

The following table maps the FIPS logical interfaces and physical ports to the module´s services

Physical port

Logical interface

Data
port/interface

that

passes

over

PCIe bus

Data input

nCoreAPI, Updater, SSHAdmin

Data output

nCoreAPI, SSHAdmin

Control input

nCoreAPI, SSHAdmin, Setup, Monitor, Discovery

Status output

nCoreAPI, Updater, Setup, Monitor, Discovery

Power

n/a

Smartcard reader serial port

Data input

APDU commands

Status LED

Recovery button

Battery

Table 7 Ports and Interfaces

Data output

APDU commands

Status output

Control input

Power

n/a

n/a

n/a

Note: Control output is omitted because the module does not implement it.

The following figure shows the module’s physical ports:

Figure 3 Physical ports

12 of 47

nShield 5s Hardware Security Module

4  Roles, services and authentication

4.1  Roles
The Cryptographic Module supports the following roles:

•  Platform Crypto Officer (PCO)

•  nShield Security Officer (NSO)

•  User Client (UC)

Platform Crypto Officer (PCO)

This role is responsible of administration tasks of the HSM platform.

To  assume  this  role,  an  operator  needs  to  open  a  session  with  the  SSHAdmin,  Updater,  Setup  or
Monitor services, using its SSH private key for each service.

When the module is in factory state, the SSHAdmin client SSH keys are set to a default value. These
keys must be changed with the SSHAdmin set service before the module can be initialized and used.

nShield Security Officer (NSO)

This role is represented by Administrator Card holders, which have access to KNSO and are responsible
for the overall management of a Security World.

To  assume  this  role,  an  operator  or  group  of  operators  need  to  present  a  quorum m  of  N of
smartcards,  and  the  KNSO  Key  Blob.  Each  operator  is  identified  by  its  individual  smartcard,  which
contains a unique logical token share. NSO smartcard sets are initialized at Security World creation
time.

User Client (UC)

This role is authorised to use the general purpose cryptographic services offered by the cryptographic
module.

To assume this role, a client application needs to open a session with the nCoreAPI service, using its
SSH private key. The client application’s SSH public key must have been previously loaded into the
module by the PCO using the SSHAdmin service.

Role  Service

Input

Output

PCO  setup info

Input arguments

Versioning information, return status code

PCO  setup factorystate

Input arguments

return status code

PCO  setup gettime

Input arguments

Time, return status code

PCO  setup settime

Input arguments, time

return status code

PCO  sshadmin set

Input  arguments,  service,  SSH  client
public key

return status code

PCO  sshadmin list

Input arguments, service

SSH client public key, return status code

nShield 5s Hardware Security Module

13 of 47

Role  Service

Input

Output

PCO  sshadmin get-serverkey

Input arguments, service

SSH  server  public  key  (KSSH_UPDATER,  KSSH_SSHADMIN,
KSSH_MONITOR, KSSH_SETUP), return status code

PCO  updater info

Input arguments

Versioning information, return status code

PCO  updater receive

Input arguments, fw update file

fw update file info, return status code

PCO  updater load

Input arguments, fw update file info

return status code

PCO  monitor getlog

Input arguments

Logs, return status code

PCO  monitor clearlog

Input arguments

return status code

All  discovery python-zeroconf

Input arguments

IP address, return status code

UC  nCoreAPI
operation

Big

number

Input arguments

Operation result, return status code

UC  nCoreAPI Make Blob

Input arguments, key handle

Key blob, return status code

UC  nCoreAPI Bulk channel

Input arguments, data

Operation result, return status code

UC  nCoreAPI Check User Action  Input arguments, key handle

return status code

UC  nCoreAPI Clear Unit

Input arguments, module mode

return status code

NSO  nCoreAPI Set Module Key

Input arguments, key handle

return status code

NSO  nCoreAPI  Remove  Module

Input arguments, key hash

return status code

Key

UC  nCoreAPI  Duplicate

key

Input arguments, key handle

Key handle, return status code

handle

UC  nCoreAPI Enable feature

Input arguments, features

return status code

UC  nCoreAPI Encryption

Input  arguments,  mechanism,  key
handle, plaintext data, iv

Encrypted data, return status code

UC  nCoreAPI Decryption

Input  arguments,  mechanism,  key
handle, encrypted data

Decrypted data, return status code

UC  nCoreAPI

Erase
smartcard /softcard

from

Input arguments, slot, file info

return status code

UC  nCoreAPI Format Token

Input arguments, slot

return status code

UC  nCoreAPI File operations

Input arguments, file info, operation

return status code

UC  nCoreAPI  Force  module  to

Input arguments

return status code

fail

UC  nCoreAPI  Generate  prime

Input arguments, length

Bignumber, return status code

number

UC  nCoreAPI  Generate  random

Input arguments, length

Random bytes, return status code

number

UC  nCoreAPI Get ACL

Input arguments, key handle

acl, return status code

UC  nCoreAPI

Get

key

Input arguments, key handle

Application data, return status code

application data

UC  nCoreAPI Get challenge

Input arguments

Nonce, return status code

14 of 47

nShield 5s Hardware Security Module

Role  Service

Input

Output

UC  nCoreAPI Get KLF2

Input arguments

Key handle, return status code

UC  nCoreAPI

Get

Key

Input arguments, key handle

Key info, return status code

Information

UC  nCoreAPI

Get  module

Input arguments

Key handle, return status code

signing key

UC  nCoreAPI  Get  list  of  slot  in

Input arguments

Slots info, return status code

the module

UC  nCoreAPI  Get  Logical  Token

Input arguments, key handle

Logical token info, return status code

Info

UC  nCoreAPI Get list of module

Input arguments

hash of KNSO (HKNSO), hash of module keys, return status code

keys

UC  nCoreAPI Get module state

Input arguments

Module attributes, return status code

UC  nCoreAPI Get real time clock  Input arguments

time, return status code

UC  nCoreAPI  Get  share  access

Input arguments, slot

acl, return status code

control list

UC  nCoreAPI

Get

Slot

Input arguments, slot

smartcard info, return status code

Information

UC  nCoreAPI Get Ticket

Input arguments

Ticket, return status code

UC  nCoreAPI Initialize Unit

Input arguments

return status code

UC  nCoreAPI Insert a Softcard

Input arguments, slot

return status code

UC  nCoreAPI Remove a Softcard  Input arguments, slot

return status code

UC  nCoreAPI Impath channel

Input arguments, data

data, return status code

UC  nCoreAPI Key generation

Input arguments, key params, acl, app
data

Key handle, key generation cert, return status code

UC  nCoreAPI Key import

Input  arguments,  wrapped  key,  acl,
app data

Key handle, return status code

UC  nCoreAPI Derive Key

Input  arguments,  mechanism,  key
handles

Key handle, return status code

UC  nCoreAPI Load Blob

Input arguments, blob data

Key handle, return status code

UC  nCoreAPI
Token

Load

Logical

Input arguments, logical token hash

Key handle, return status code

UC  nCoreAPI  Generate  Logical

Input arguments

Logical token hash, key handle, return status code

Token

UC  nCoreAPI Message digest

Input  arguments,  mechanism,  data  to
be hashed

Hashed data, return status code

UC  nCoreAPI

Modular

Input arguments

Operation result, return status code

Exponentiation

UC  nCoreAPI Module hardware

Input arguments

Hw info, return status code

information

UC  nCoreAPI  No Operation

Input arguments

return status code

UC  nCoreAPI

  Change  Share

Input arguments, slot, old pin, new pin  return status code

Passphrase

nShield 5s Hardware Security Module

15 of 47

Role  Service

Input

Output

NSO  nCoreAPI NVRAM Allocate

Input arguments, file info, acl

return status code

UC  nCoreAPI NVRAM Free

Input arguments, file name

return status code

UC  nCoreAPI  Operation  on

Input arguments

Files info, return status code

NVM list

UC  nCoreAPI  Operation  on

Input arguments, file name, operation  Operation result, return status code

NVM files

UC  nCoreAPI Key export

Input arguments, key handle

Wrapped key, return status code

UC  nCoreAPI Read file

Input arguments, file info, slot

File data, return status code

UC  nCoreAPI Read share

Input arguments, slot, key handle

return status code

UC  nCoreAPI  Send  share  to

Input arguments

Encrypted share, return status code

remote slot

UC  nCoreAPI  Receive

share

Input arguments, encrypted share

return status code

from remote slot

UC  nCoreAPI Redeem Ticket

Input arguments, ticket

Key handle, return status code

UC  nCoreAPI

Remote

Input arguments, apdu payload

apdu payload, return status code

Administration

UC  nCoreAPI Destroy

Input arguments, key handle

return status code

UC  nCoreAPI Report statistics

Input arguments

Statistics, return status code

UC  nCoreAPI Show Status

Input arguments

Status and versioning info, return status code

UC  nCoreAPI Set ACL

Input arguments, key handle, acl

return status code

UC  nCoreAPI

Set

key

Input arguments, key handle, app data  return status code

application data

NSO  nCoreAPI

Set

NSO

Permissions

Input  arguments,  hash  of  KNSO
(KNSO),  permissions

return status code

UC  nCoreAPI

Signature

generation

Input arguments, mechanism, priv key
handle, data to be signed

Signed data, return status code

UC  nCoreAPI Sign Module State  Input arguments

Certificate, return status code

UC  nCoreAPI

Signature

verification

Input arguments, mechanism, pub key
handle, data to be verified

return status code

NSO  nCoreAPI Write file

Input arguments, file info, slot, data

return status code

UC  nCoreAPI Write share

Input arguments, file info, slot

Data, return status code

Table 8 Roles, Service Commands, Input and Output

Role  Authentication Method

Authentication Strength

PCO

UC

ECDSA P-256, P-521 client key
authentication  as  part  of
establishing  an  SSH  based
secure channel.

The ciphersuites used are:

ecdh-sha2-nistp256  ,  aes128-gcm@openssh.com,  aes128-ctr@openssh.com,  hmac-
sha2-256-etm@openssh.com

Identity-based and required.

This results in a security strength of 128 bits. A random authentication attempt gives is a probability
of success of 2-128, which is less than one in 1,000,000.

16 of 47

nShield 5s Hardware Security Module

Role  Authentication Method

Authentication Strength

NSO  smartcard authentication.

Identity-based and required.

The module can process around 220 commands per minute. This gives a probability of success in a one
minute period of 2-108, which is less than one in 100,000.

A logical token share stored in a Smartcard or Softcard is encrypted and MAC'ed. An attacker would
need to guess the encrypted share value and the associated MAC in order to be able to load a valid
Logical token share into the module. This requires, as a minimum, guessing a 256-bit HMAC-SHA256
value,  which  gives  a  security  strength  of  256  bits.  A  random  authentication  attempt  gives  is  a
probability of success of 2-256 , which is less than one in 1,000,000.

The module can process around 220 commands per minute. This gives a probability of success in a one
minute period of 2-236, which is less than 10-5, which is less than one in 100,000.

Table 9 Roles and Authentication

4.2  Services
The  following  table  describes  the  services  provided  by  the  Cryptographic  Module  and  the  access
policy.

The Access column presents the access level given to the SSP

G = Generate: The module generates or derives the SSP.
R = Read: The SSP is read from the module (e.g. the SSP is output).
W = Write: The SSP is updated, imported, or written to the module.
E = Execute: The module uses the SSP in performing a cryptographic operation.
Z = Zeroise: The module zeroises the SSP

4.2.1  Setup service

Service

Description

info

is

This
Versioning Information service.

a Show  Module's

This  command  prints  out  the
contents of the board-id rom file
and  a  number  of  flags  that
setup
indicate  which  other
been
have
subcommands
previously
as
executed
determined  by  the  existence  or
non-existence  of  the  relevant
files in long-term storage.  It also
prints out the tag and value pairs
of any options set with the setopt
subcommand.

factorystate  This  is  the  Perform  Zeroisation

service.

It zeroizes unprotected SSPs and
returns  the  module  to  factory
state.  It  then  initiates  a  module
reboot.

Approved
Functions

Security

Keys and/or SSPs

Roles  Access
to
and/or SSPs

Indicator

rights
Keys

KSESSION - SSH

PCO  E

Data
encryption/decryption
(Cert.  #A2512:  AES  CTR,
GCM)

return
status
code 0

generation

MAC
verification
#A2512: HMAC)

/
(Cert.

Data
encryption/decryption
(Cert.  #A2512:  AES  CTR,
GCM)

generation

MAC
verification
#A2512: HMAC)

/
(Cert.

KRESET  (note:  any  SSP
that
is  derived  from
KRESET, or protected by
an  SSP  derived  from
KRESET,  will  also  be
effectively zeroised.)

KSESSION - SSH

PCO  Z

E

G

return
status
code 0

(note:
server
SSH
authentication  keys
are only generated on
first  reboot  after  a

nShield 5s Hardware Security Module

17 of 47

Service

Description

Approved
Functions

Security

Keys and/or SSPs

Roles  Access
to
and/or SSPs

Indicator

rights
Keys

Key  generation
(Cert.
#A2513:  ECDSA  KeyGen,
vendor affirmed: CKG)

KSSH_SETUP,
KSSH_SSHADMIN,
KSSH_MONITOR,
KSSH_UPDATER, KRESET

setup
factorystate
command)

settime

subcommand

This
system date and time.

sets

the

Data
encryption/decryption
(Cert.  #A2512:  AES  CTR,
GCM)

KSESSION - SSH

PCO  E

generation

MAC
verification
#A2512: HMAC)

/
(Cert.

gettime

subcommand

This
the  system date and time.

returns

KSESSION - SSH

PCO  E

Data
encryption/decryption
(Cert.  #A2512:  AES  CTR,
GCM)

return
status
code 0

return
status
code 0

generation

MAC
verification
#A2512: HMAC)

/
(Cert.

Table 10 Approved Services

The approved service indicator is the successful completion of these services (return status code 0),
as they only use approved mechanisms.

4.2.2  SSHAdmin service

Service

Description

Approved Security Functions

Indicator

Keys and/or SSPs  Roles  Access
rights
to  Keys
and/or
SSPs

set

list

Loads the client public key in the module,
that  will  be  used  to  authenticate  the
requester of a particular service

Data
(Cert. #A2512: AES CTR, GCM)

encryption/decryption

KSSH_CLIENT pub

PCO  W

KSESSION - SSH

E

MAC  generation  /  verification
(Cert. #A2512: HMAC)

return
status  code
0

Obtains the client public key for the service
given by the 'role' parameter.

Data
(Cert. #A2512: AES CTR, GCM)

encryption/decryption

MAC  generation  /  verification
(Cert. #A2512: HMAC)

KSSH_CLIENT pub

PCO  R

KSESSION - SSH

E

return
status  code
0

get-
serverkey

Obtains  the  server  public  key  for  the
service given by the 'role' parameter.

Data
(Cert. #A2512: AES CTR, GCM)

encryption/decryption

MAC  generation  /  verification
(Cert. #A2512: HMAC)

return
status  code
0

KSSH_NCORE pub

PCO  R

R

R

E

KSSH_UPDATER
pub

KSSH_SETUP pub

KSSH_SSHADMIN
pub

KSSH_MONITOR
pub

KSESSION - SSH

Table 11 Approved Services

18 of 47

nShield 5s Hardware Security Module

The approved service indicator is the successful completion of these services (return status code 0),
as they only use approved mechanisms.

4.2.3  Updater service

Service  Description

Approved Security Functions

Indicator

Keys and/or
SSPs

Roles  Access
rights
to  Keys
and/or
SSPs

info

This is a Show Module's Versioning Information
service.

Data  encryption/decryption
#A2512: AES)

(Cert.

KSESSION  -
SSH

PCO  E

return status
code 0

Obtains  the  version  number  of  the  HSM
firmware.

MAC  generation  /  verification  (Cert.
#A2512: HMAC)

receive  Transmits  a file  (intended  to  be  an  npkg

upgrade file) to the HSM.

Data  encryption/decryption
#A2512: AES)

(Cert.

KSESSION  -
SSH

PCO  E

return status
code 0

load

Verifies that a file on the HSM filesystem is a
valid npkg upgrade file and, if so loads the file
onto its flash partition.

MAC  generation  /  verification  (Cert.
#A2512: HMAC)

Digital  signature  verification  (Cert.
#A2513: RSA SigVer, ECDSA SigVer)

Data  encryption/decryption
#A2512: AES)

(Cert.

MAC  generation  /  verification  (Cert.
#A2512: HMAC)

NSBIK pub

PCO  E

NPSK pub

NFIK pub

NLIK pub

KSESSION  -
SSH

E

E

E

E

return status
code 0

Table 12 Approved Services

The approved service indicator is the sucçcessful completion of these services (return status code 0),
as they only use approved mechanisms.

4.2.4  Monitor service

Service  Description

Approved Security Functions

and/or

Keys
SSPs

Indicator

Roles  Access
rights
to
and/or
SSPs

Keys

getlog  This  is  the  Show  Status

service.

Data  encryption/decryption  (Cert.  #A2512:  AES
CTR, GCM)

KSESSION - SSH  PCO  E

return
code 0

status

Obtains  the  log  of  the
system

MAC  generation  /  verification  (Cert.  #A2512:
HMAC)

clearlog  Clears  the

log  of  the

system

Data  encryption/decryption  (Cert.  #A2512:  AES
CTR, GCM)

KSESSION - SSH  PCO  E

return
code 0

status

MAC  generation  /  verification  (Cert.  #A2512:
HMAC)

Table 13 Approved Services

The approved service indicator is the successful completion of these services (return status code 0),
as they only use approved mechanisms.

nShield 5s Hardware Security Module

19 of 47

4.2.5  Discovery service

Service

Description

Approved
Security
Functions

Keys
and/or
SSPs

Roles

Indicator

Access
rights
to  Keys
and/or
SSPs

python-
zeroconf

The (logical) network connection between host and HSM uses
TCP/IP  protocols  over  the  PCIe  bus;  however,  for  ease  of
setup it needs to avoid requiring IP configuration by the user.

-

-

Unauthenticated  -

return
status code
0

Therefore  the  HSM  uses zeroconf:  each  end  of  the  virtual
'network  segment'  has  only  a  link-local  (IPv4  and  IPv6)
address.  The  HSM's  address  can  be  discovered  by  the  host
using multicast DNS, responding to mDNS queries.

Table 14 Approved Services

The approved service indicator is the successful completion of these services (return status code 0),
as they only use approved mechanisms.

4.2.6  nCoreAPI service

Service

Description

Approved
Functions

Security

Keys
SSPs

and/or

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

Big number operation

Cmd_BignumOp

Make Blob

Cmd_MakeBlob

Bulk channel

Cmd_ChannelOpen

Cmd_ChannelUpdate

Check User Action

Cmd_CheckUserAction

Clear Unit

Cmd_ClearUnit

Performs  an  operation  on  a
large integer.

-

-

UC

-

Creates a Key blob containing
the key. Note that the key ACL
needs
the
to
operation.

authorize

Key
derivation
#A2513: KBKDF)

(Cert.

Key  wrapping
(Cert.
#A2513:  AES  CBC  and
HMAC, KTS-IFC)

UC

KA,
KRE_BLOBKEY,
KR, KM,  KNSO,
LT

R

E

BLOBKE,
BLOBKM

return
status OK

return
status OK

Provides  a  bulk  processing
channel for crypto operations

Encryption
and
decryption (Cert. #A2513:
AES ECB, CBC, GCM)

KA

UC

E

return
status OK

MAC
and
generation
verification (Cert. #A2513:
HMAC, KMAC, AES CMAC)

signature
Digital
generation
and
verification (Cert. #A2513:
RSA, ECDSA, DSA)

Determines  whether  the  ACL
associated with a key allows a
specific  operator  defined
action.

-

This  is  the Perform  Self-tests
service.

-

Zeroises  all  keys,  tokens  and
shares  that  are
in
RAM.  Will  cause  the  module

loaded

KNSO, KA

UC

R

return
status OK

UC

Z

return
status OK

KR,

KA,
IMPATHKE,
IMPATHKM,
RAKME, RAKMA

20 of 47

nShield 5s Hardware Security Module

Service

Description

Approved
Functions

Security

Keys
SSPs

and/or

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

to  reboot  and  perform  self-
tests.

Allows  a  key  to  be  stored
internally  as  a  Module  key
(KM) value. The ACL needs to
authorize this operation.

Message  digest
#A2513: SHA-1)

(Cert.

KM

NSO  W

Set Module Key

Cmd_SetKM

Remove Module Key

Cmd_RemoveKM

Duplicate key handle

Cmd_Duplicate

Enable feature

Cmd_StaticFeatureEnable

Encryption

Cmd_Encrypt

Decryption

Cmd_Decrypt

Erase from smartcard /softcard

Cmd_EraseFile

Cmd_EraseShare

Format Token

Cmd_FormatToken

File operations

Cmd_FileCopy

Cmd_FileCreate

Cmd_FileErase

Cmd_FileOp

Force module to fail

Cmd_Fail

Deletes  the  KM  with  a  given
KM  hash  value  from  non-
volatile memory.

-

Creates a second instance of a
Key  with  the  same  ACL  and
returns  a  handle  to  the  new
instance.

-

Note that the source key ACL
needs
this
to
operation.

authorize

Enables
the  service.  This
service  requires  a  certificate
signed by the Master Feature
Enable key.

-

Encryption using the provided
key handle.

Data  encryption
(Cert.
#A2513:  AES  ECB,  CBC,
GCM)

KA

Decryption using the provided
key handle.

Data  decryption
(Cert.
#A2513:  AES  ECB,  CBC,
GCM)

KA

Removes a file or a share from
a smartcard or softcard

-

Formats  a  smartcard  or  a
softcard.

-

Performs file operations in the
module.

-

Causes the module to enter a
failure state.

-

-

-

-

-

return
status OK

return
status OK

return
status OK

KM

NSO  Z

KA

UC

R

-

UC

-

return
status OK

UC

E

return
status OK

UC

E

return
status OK

UC

-

return
status OK

UC

-

UC

-

return
status OK

return
status OK

UC

-

UC

E

return
status OK

return
status OK

Generate prime number

Generates a random prime.

Cmd_GeneratePrime

Random  bit  generation
(Cert. #A2513: DRBG)

entropy
DRBG
input,
seed,
internal state ('V'
and 'C')

Generate random number

Generates  a  random  number
from the Approved DRBG.

Random  bit  generation
(Cert. #A2513: DRBG)

DRBG
input,

entropy
seed,

UC

E

return
status OK

nShield 5s Hardware Security Module

21 of 47

Service

Description

Approved
Functions

Security

Keys
SSPs

and/or

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

Get the ACL of a given key.

-

Get  the  application data  field
from a key.

-

internal state ('V'
and 'C')

KA

KA

Get  a  random  challenge  that
can  be  used
fresh
certificates.

in

Random  bit  generation
(Cert. #A2513: DRBG)

entropy
DRBG
input,
seed,
internal state ('V'
and 'C')

UC

R

UC

R

UC

E

Get  a  handle  to  the  Module
Long Term (KLF2) public key.

-

-

UC

-

Get the type, length and hash
of a key.

Message  digest
#A2513: SHA-1)

(Cert.

KA

UC

R

Get a handle to the KML public
key.

-

Get  the  list  of  slots  that  are
available from the module.

-

KML

UC

R

-

UC

-

Get
information  about  a
Logical Token: hash, state and
number of shares.

Message  digest
#A2513: SHA-1)

(Cert.

LT

UC

R

Get the list of the hashes of all
module keys and the KNSO.

Message  digest
#A2513: SHA-1)

(Cert.

KM,
HKNSO

KNSO,

UC

R

Cmd_GenerateRandom

Get ACL

Cmd_GetACL

Get key application data

Cmd_GetAppData

Get challenge

Cmd_GetChallenge

Get KLF2

Cmd_GetKLF2

Get Key Information

Cmd_GetKeyInfo

Cmd_GetKeyInfoEx

Get module signing key

Cmd_GetKML

Get list of slot in the module

Cmd_GetSlotList

Get Logical Token Info

Cmd_GetLogicalTokenInfo

Cmd_GetLogicalTokenInfoEx

Get list of module keys

Cmd_GetKMList

Get module state

Cmd_GetModuleState

Get real time clock

Cmd_GetRTC

Returns  unsigned  data  about
the  current  state  of
the
module.

-

Get the current time from the
module Real Time Clock.

-

Get share access control list

Get the Share's ACL.

Cmd_GetShareACL

Get Slot Information

Cmd_GetSlotInfo

Get Ticket

Cmd_GetTicket

Get information about shares
and files  on a Smartcard that
has been inserted in a module
slot.

Get  a  ticket  (an
invariant
identifier)  for  a  key.  This  can
be passed to another client or
to  a  SEE  World  which  can
it  using  Redeem
redeem

-

-

-

-

-

UC

-

UC

-

SHAREKEY

UC

R

UC

-

-

-

UC

-

return
status OK

22 of 47

nShield 5s Hardware Security Module

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

Service

Description

Approved
Functions

Security

Keys
SSPs

and/or

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

Initialize Unit

Cmd_InitializeUnit

Cmd_InitializeUnitEx

Insert a Softcard

Cmd_InsertSoftToken

Remove a Softcard

Cmd_RemoveSoftToken

Impath channel

Cmd_ImpathGetInfo

Cmd_ImpathKXBegin

Cmd_ImpathKXFinish

Cmd_ImpathReceive

Cmd_ImpathSend

Key generation

Cmd_GenerateKey

Cmd_GenerateKeyPair

Key import

Cmd_Import

Derive Key

Cmd_DeriveKey

Ticket to obtain a new handle
to the object.

Causes  the  nCore  API  service
in  the  pre-initialization  state
to  enter
initialization
the
state.   When
the  module
enters  the  initialization  state,
it erases all Module keys (KM),
the  module's  signing  key
(KML),  and  the  hash  of  the
Security
keys,
HKNSO.  It  then  generates  a
new KML and KM.

Officer's

Key
generation
#A2513: CKG, RSA, DSA)

(Cert.

Message  digest
#A2513: SHA-1)

(Cert.

KA,
KRE_BLOBKEY,
KR,  KM,  KAL,
KML,
KNSO,
HKNSO, LT

UC

Z, G

return
status OK

-

-

UC

-

return
status OK

UC

-

return
status OK

KML, IMPATHKE,
IMPATHKM

UC  G, E

return
status OK

Allocates  memory  on  the
module  that  is  used  to  store
the  logical  token  share  and
other data objects.

-

It

returns

Removes a Softcard from  the
module.
the
updated  shares  and  deletes
the  module’s
them
memory.

from

Support  for  Impath  channel.
Requires Feature Enabled.

-

Key
(Cert.
agreement
#A2513:  KAS-FFC,  Safe
Primes  Generation,  Safe
Primes Verification)

Key
derivation
#A2513: KBKDF)

(Cert.

and
encryption
Data
decryption (Cert. #A2513:
AES CBC, GCM)

MAC
and
generation
verification (Cert. #A2513:
HMAC-SHA256)

Generates a cryptographic key
of a given type with a specified
ACL. It returns a handle to the
key.   Optionally,  it  returns  a
KML  signed  certificate  with
the hash of the key and its ACL
information.

Key
(Cert.
generation
#A2513: CKG, RSA, ECDSA,
DSA,  KAS-ECC,  KAS-FFC,
Safe Primes Generation)

KML,  KA,  DRBG
input,
entropy
internal
seed,
state ('V' and 'C')

UC  G

return
status OK

Digital
signature
generation (Cert. #A2513:
DSA)

-

If  the  module

Loads a plain text key into the
module.
is
initialized  in  approved  mode,
this  service  is  available  for
public keys only.

KA

UC  W

return
status OK

key  wrapping,
Performs
unwrapping,
transport,
exchange and derivation. The
ACL  needs  to  authorize  this
operation.

Key
derivation
#A2513: KBKDF)

(Cert.

KA

UC

R, W

return
status OK

nShield 5s Hardware Security Module

23 of 47

Service

Description

Approved
Functions

Security

Keys
SSPs

and/or

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

Key
wrapping/unwrapping
(Cert. #A2513: KTS-AES)

transport
Key
#A2513: KTS-IFC)

(Cert.

Key
(Cert.
agreement
#A2513:  KAS-FFC,  KAS-
ECC)

Key
derivation
#A2513: KBKDF)

(Cert.

Key  unwrapping
(Cert.
#A2513:  AES  CBC  and
HMAC, KTS-IFC)

KA,
KRE_BLOBKEY,
KR, KM, KNSO

UC  W

E

return
status OK

BLOBKE,
BLOBKM

Load Blob

Cmd_LoadBlob

Load  a  Key  blob
into  the
module. It returns a handle to
the  key  suitable  for  use  with
module services.

Load Logical Token

Cmd_LoadLogicalToken

loading  a  Logical
Initiates
Token from Shares, which can
be loaded with the Read Share
command.

-

-

UC

-

Generate Logical Token

Cmd_GenerateLogicalToken

Creates  a  new  Logical  Token
with  given  properties  and
secret sharing parameters.

generation

Key
#A2513: CKG)

(Cert.

KM, LT

UC  G, W

Computes  the  cryptographic
hash of a given message.

Message  digest
#A2513: SHS)

(Cert.

-

Performs
modular
a
exponentiation  (standard  or
CRT)  on  values  supplied  with
the command.

-

Reports  detailed  hardware
information.

-

No operation.

-

-

-

-

Message digest

Cmd_Hash

Modular Exponentiation

Cmd_ModExp

Cmd_ModExpCrt

Cmd_RSAImmedVerifyEncrypt

Cmd_RSAImmedSignDecrypt

Module hardware information

Cmd_ModuleInfo

No Operation

Cmd_NoOp

Change Share Passphrase

Cmd_ChangeSharePIN

Cmd_ChangeShareGroupPIN

Updates  the  passphrase  of  a
Share.

Key derivation (KBKDF)

Key
wrapping/unwrapping
(Cert.  #A2513:  AES  CBC
and HMAC, KTS-IFC)

SHAREKEY,
KM

LT,

UC  G, E, R,
W

return
status OK

NVRAM Allocate

Allocation in NVRAM.

-

Cmd_NVMemAllocate

NVRAM Free

Deallocation from NVRAM.

-

Cmd_NVMemFree

-

-

NSO

-

UC

-

return
status OK

return
status OK

24 of 47

nShield 5s Hardware Security Module

return
status OK

return
status OK

return
status OK

return
status OK

UC

-

UC

-

UC

-

UC

-

return
status OK

return
status OK

Indicator

return
status OK

return
status OK

return
status OK

return
status OK

Service

Description

Approved
Functions

Security

Keys
SSPs

and/or

Operation on NVM list

Cmd_NVMemList

Returns  a
NVRAM.

list  of  files

in

-

Operation on NVM files

Operation on an NVRAM file.  -

-

-

Roles  Access
rights
to Keys
and/or
SSPs

UC

-

UC

Cmd_NVMemOp

Key export

Cmd_Export

Read file

Cmd_ReadFile

Read share

Cmd_ReadShare

Exports a key in plain text.

-

KA

UC

R

Note: in approved mode, only
public keys can be exported.

Reads  data  from  a  file  on  a
Smartcard  or  Softcard.  The
ACL  needs  to  authorize  this
operation.

-

-

UC

-

Reads  a
from  a
share
Smartcard or Softcard. Once a
quorum  of  shares  have  been
loaded,
re-
assembles the Logical Token.

the  module

Key
derivation
#A2513: KBKDF)

(Cert.

SHAREKEY,
KM

LT,

UC  G, E, R  return

status OK

Key  unwrapping
(Cert.
#A2513:  AES  CBC  and
HMAC)

Send share to remote slot

Cmd_SendShare

Reads a Share and encrypts it
with  the  Impath  session  keys
for  transmission  to  the  peer
module.

Data
#A2513: AES CBC, GCM)

encryption(Cert.

MAC  generation
#A2513: HMAC-SHA256)

(Cert.

IMPATHKE,
IMPATHKM,
SHAREKEY

UC

R, E

return
status OK

Receive share from remote slot

Cmd_ReceiveShare

Receives  a  Share  encrypted
with  the  Impath  session  keys
by a remote module.

Data  decryption
#A2513: AES CBC, GCM)

(Cert.

MAC  verification
#A2513: HMAC-SHA256)

(Cert.

IMPATHKE,
IMPATHKM,
SHAREKEY

UC

R, E

return
status OK

Redeem Ticket

Cmd_RedeemTicket

Gets  a  handle  in  the  current
name  space  for  the  object
referred to by a ticket created
by Get Ticket.

-

-

UC

-

return
status OK

Remote Administration

Cmd_DynamicSlotCreateAssociation

Cmd_DynamicSlotExchangeAPDUs

Cmd_DynamicSlotsConfigure

Cmd_DynamicSlotsConfigureQuery

Cmd_VerifyCertificate

Provides remote presentation
of  Smartcards  using  a  secure
channel  between the  module
and the Smartcard.

Key
agreement
#A2513: KAS-ECC ECDH)

(Cert.

Key
derivation
#A2513: KBKDF)

(Cert.

RAKME, RAKMA,

UC  G, E

KWARN_pub

E

return
status OK

Data
and
encryption
decryption (Cert. #A2513:
AES CBC)

and
generation
MAC
verification (Cert. #A2513:
AES CMAC)

Digital
signature
verification (Cert. #A2513:
ECDSA)

Destroy

Cmd_Destroy

Remove handle to an object in
RAM.  If  the  current  handle  is

-

KA, KNSO, LT

UC

Z

return
status OK

nShield 5s Hardware Security Module

25 of 47

Service

Description

Approved
Functions

Security

Keys
SSPs

and/or

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

UC

-

return
status OK

UC

-

return
status OK

KA

UC

W

KA

UC  W

HKNSO

NSO  W

KA, KNSO

UC

E

return
status OK

return
status OK

return
status OK

return
status OK

-

-

Report statistics

Cmd StatGetValues

Cmd_StatEnumTree

Show Status

Cmd_NewEnquiry

Set ACL

Cmd_SetACL

Set key application data

Cmd_SetAppData

Set NSO Permissions

Cmd_SetNSOPerms

Signature generation

Cmd_Sign

the  only  one  remaining,  the
object is zeroised from RAM.

Reports  the  values  of  the
statistics tree.

-

This is a Show Status and Show
Versioning
Module's
Information service.

-

Report status information.

Replaces  the  ACL  of  a  given
key  with a  new  ACL.  The  ACL
needs
this
to
operation.

authorize

-

the
Writes
information field of a key.

application

-

Sets  the  NSO  key  hash  and
which  permissions  require  a
Delegation Certificate.

-

Generate a digital signature or
MAC value.

MAC  generation
(Cert.
#A2513:  HMAC,  KMAC,
AES CMAC)

Digital
signature
generation (Cert. #A2513:
RSA, ECDSA, DSA)

Sign Module State

Cmd_SignModuleState

Returns  a  signed  certificate
that  contains  data  about  the
current  configuration  of  the
module.

signature
Digital
generation (Cert. #A2513:
DSA)

KML

UC

E

return
status OK

Signature verification

Cmd_Verify

Verifies  a  digital  signature  or
MAC value.

MAC  verification
(Cert.
#A2513:  HMAC,  KMAC,
AES CMAC)

KA

UC

E

return
status OK

Digital
signature
verification (Cert. #A2513:
RSA, ECDSA, DSA)

Write file

Cmd_WriteFile

Write share

Cmd_WriteShare

Writes a file to a Smartcard or
Softcard.

-

-

NSO

-

return
status OK

Writes a Share to a Smartcard
or Softcard.

Key
derivation
#A2513: KBKDF)

(Cert.

SHAREKEY,
KM

LT,

UC  G, E, W  return

status OK

(Cert.
Key  wrapping
#A2513:  AES  CBC  and
HMAC)

Table 15 Approved Services

Non-approved services will fail with a return an error code indicator "StrictFIPS140".

26 of 47

nShield 5s Hardware Security Module

All  nCore  API  services  are  sent  through  the  SSH  channel,  performing  security  functions  Data
encryption/decryption,  MAC  generation  /  verification  and  access  E  (execute)  of  the  session  keys
KSESSION - SSH.

nShield 5s Hardware Security Module

27 of 47

5  Software/Firmware security

The  nShield  5s  cryptographic  module's  executable  code  is  delivered  by  Entrust  as  a  single  signed
firmware package (.npkg file). The bootloader and firmware integrity is verified at start up using RSA
with  4096  bit  key  and  SHA2-256.  The  Library  Partition  is  an  internal  storage  area  that  contains  a
number of auxiliary files required for operation of the module.  The integrity of the Library Partition is
verified using ECDSA with curve P-521 and SHA2-512.

Operators can initiate the integrity tests on demand by restarting the module.

28 of 47

nShield 5s Hardware Security Module

6  Operational environment

Not  applicable.  The  module  has  a  limited  operational  environment,  it  is  designed  to  accept  only
controlled firmware changes that successfully pass the software/firmware load test.

nShield 5s Hardware Security Module

29 of 47

7  Physical security

The product is a multi-chip embedded Cryptographic Module, as defined in FIPS 140-3. It is enclosed
in a hard and opaque epoxy resin which meets the physical security requirements of FIPS 140-3 level
3.

The cryptographic module implements Environmental Failure Protections (EFP) which detect out of
range voltage and temperature and shuts down the module.

Physical  Security
Mechanism

Recommended
Frequency
Inspection/Test

of

Inspection/Test Guidance Details

Hard and opaque
epoxy

Monthly

The  module  should  be  inspected  periodically  for  evidence  of  tamper  attempts,  including  the
entire enclosure including the epoxy resin security coating for obvious signs of damage.

Table 16 Physical Security Inspection Guidelines

Temperature
measurement

or

voltage

Specify EFP or EFT

Specify
results
zeroisation

in

if

this

a

shutdown

condition
or

Low Temperature

High Temperature

0ºC

95ºC

Low Voltage

2.463V (battery)

0V (PCIe)

High Voltage

3.553V (battery)

14.45V (PCIe)

Table 17 EFP/EFT

EFP

EFP

EFP

EFP

Shutdown

Shutdown

Shutdown

Shutdown

Hardness tested temperature measurement

Low Temperature

High Temperature

0ºC

95ºC

Table 18 Hardness testing temperature ranges

30 of 47

nShield 5s Hardware Security Module

8  Non-invasive security

Not applicable.

nShield 5s Hardware Security Module

31 of 47

9  Sensitive security parameters management

9.1  Keys and Sensitive Security Parameters
This section defines the Sensitive Security Parameters (SSPs) managed by the cryptographic module.

9.1.1  Platform SSPs

Key/SSP/Name/Type  Strength  Security
Function
Cert. Number

and

Generation

Import/Export  Establishment  Storage

Zeroisation  Use  &  related
keys

KRESET

(CSP)

256 bits  Re-settable key

DRBG

Never

n/a

A2513

factorystate  Key derivation

MSP430
FRAM,
plaintext

in

KUSER_SSH

256 bits  Global  SSH  key

(CSP)

encryption key

AES-256

A2513

at

Derived
start-up
using  KBKDF
from  KRESET
and
other
fixed
parameters

KSSH_SETUP

128 bits  Server

DRBG

(CSP)

authentication
SSH  key  for  the
Setup service

ECDSA P-256

A2513

A2512

KSSH_UPDATER

128 bits  Server

DRBG

(CSP)

key

authentication
SSH
the Updater
service

for

ECDSA P-256

A2513

A2512

KSSH_SSHADMIN

128 bits  Server

DRBG

(CSP)

authentication
SSH
for
key
the SSH  Admin
service

ECDSA P-256

A2513

A2512

KSSH_MONITOR

128 bits  Server

DRBG

(CSP)

key

authentication
SSH
the Monitor
service

for

Never

n/a

RAM,
plaintext

in

Power cycle

factorystate

Encryption  of
all the service's
server
authentication
SSH keys

Private
never

key:

n/a

key:
via

Public
output
SSHAdmin
service

Private
never

key:

n/a

key:
via

Public
output
SSHAdmin
service

Private
never

key:

n/a

key:
via

Public
output
SSHAdmin
service

factorystate  SSH

channel

session

Flash,

In
encrypted
with
KUSER_SSH

factorystate  SSH

channel

session

Flash,

In
encrypted
with
KUSER_SSH

factorystate  SSH

channel

session

Flash,

In
encrypted
with
KUSER_SSH

Private
never

Public
output

key:

n/a

key:
via

Flash,

In
encrypted
with
KUSER_SSH

factorystate  SSH

channel

session

32 of 47

nShield 5s Hardware Security Module

Key/SSP/Name/Type  Strength  Security
Function
Cert. Number

and

Generation

Import/Export  Establishment  Storage

Zeroisation  Use  &  related
keys

ECDSA P-256

A2513

A2512

SSHAdmin
service

KSESSION - SSH

128 bits  SSH

channel

n/a

Never

ECDH

(CSP)

session keys

AES GCM or

AES CTR, HMAC

A2513

RAM,
plaintext

in

Power  cycle
or  channel
closure

factorystate

channel

SSH
data
encryption  and
integrity

NSBIK pub

128 bits  Bootloader

Entrust

(not an SSP)

integrity

public
key

Import:
Firmware
update

n/a

Flash,
plaintext

in

n/a

Firmware
integrity test

RSA 4096 bit

Export: Never

A2404

A6385

NFIK pub

128 bits  Firmware public

Entrust

(not an SSP)

signature
verification key

Import:
Firmware
update

n/a

Flash,
plaintext

in

n/a

Firmware
integrity test

RSA 4096 bit

Export: Never

A2404

A6385

NLIK pub

256 bits  Library

public

Entrust

(not an SSP)

integrity key

ECDSA P-521

A2513

NPSK pub

256 bits  Package  public

Entrust

(PSP)

signature
verification key

n/a

n/a

Import:
Firmware
update

Export: Never

Import:
Firmware
update

ECDSA P-521

Export: Never

A2513

Flash,
plaintext

in

n/a

Firmware
integrity test

Flash,
plaintext

in

n/a

Firmware
loading test

n/a

Through
SSHAdmin
service

Flash,
plaintext

in

factorystate  SSH

authentication
credentials

KSSH_CLIENT pub

128 bits  Client

Client side

(PSP)

authentication
SSH key for each
of  the  services
(Updater,
Setup,
SSHAdmin,
nCoreAPI)

ECDSA P-256

A2513

DRBG entropy input

(CSP)

>
bits

256

Platform DRBG

A2513

520 bits from
the
approved
Entropy
Source.

Never

n/a

RAM,
plaintext

in

Power cycle

factorystate

Random
number
generation

nShield 5s Hardware Security Module

33 of 47

Generation

Import/Export  Establishment  Storage

Zeroisation  Use  &  related
keys

Generated
as  per  SP
800-90Arev1
with 696 bits
from
the
approved
Entropy
Source:

bits

bits

520
entropy
input

176
random
nonce

Generated
as  per  SP
800-
90Arev1.

Never

n/a

RAM,
plaintext

in

Power cycle

factorystate

Random
number
generation

Never

n/a

RAM,
plaintext

in

Power cycle

factorystate

Random
number
generation

Key/SSP/Name/Type  Strength  Security
Function
Cert. Number

and

DRBG seed

256 bits  Platform DRBG

(CSP)

A2513

internal  state

DRBG
('V' and 'C' values)

(CSP)

256 bits  Platform DRBG

A2513

Table 19 Platform SSP table

nCore API service SSPs

9.1.1.1  Service SSPs

The following SSPs are related to the nCore API service.

Key/SSP/Name/Type  Strength  Security

Generation

Import/Export  Establishment  Storage

Zeroisation  Use

&

Function  and
Cert. Number

KCONTAINER

256 bits  Master  key  for

(CSP)

container

A2513

KCONTAINERSSH

256 bits  Encryption  key

(CSP)

for
KSSH_NCORE

AES-256

A2513

Derived
at
start-up  using
KBKDF
from
KRESET,
container-id
and
fixed value.

other

Derived
at
start-up  using
KBKDF
from
KCONTAINER,
and
other
fixed value.

KSSH_NCORE

128 bits  Server

DRBG

(CSP)

authentication
ssh
for
key
the   nCore  API
service

ECDSA P-256

A2513

A2512

Table 20 nCoreAPI SSP table

Never

n/a

RAM, in plaintext  Power cycle

factorystate

related
keys

Key
derivation

Never

n/a

RAM, in plaintext  Power cycle

Encryption

factorystate

Private
Never

key:

n/a

Public
key
output  via  SSH
Admin service

In
Flash,
encrypted  with
KCONTAINERSSH

factorystate  SSH

channel
session

34 of 47

nShield 5s Hardware Security Module

9.1.1.2  Security World SSPs

The following SSPs are related to the Security World in which the cryptographic module is enrolled
into.

Key/SSP/Name/Typ
e

Strengt
h

Security
Function  and
Cert. Number

Generatio
n

Import/Expor
t

Establishmen
t

Storage  Zeroisation  Use & related keys

KRE_BLOBKEY

128 bits  Recovery

DRBG

(CSP)

KR

(CSP)

IMPATHKE

IMPATHKM

(CSP)

KA

(CSP)

confidentialit
y key

RSA 3072 bit

A2513

256 bits  Recovery key

DRBG

AES 256

A2513

n/a

RAM,
in
plaintext

n/a

RAM,
in
plaintext

Power cycle

Cmd_Destro
y

factorystate

Power cycle

Cmd_Destro
y

factorystate

Import:  From
key
blob,
decrypted
with LTRE

Export:  in  key
blob,
encrypted
with LTRE

Import:  From
key
blob,
decrypted
with
KRE_BLOBKEY

Export:  in  key
blob,
encrypted
with
KRE_BLOBKEY

256 bits  Session  keys
for
impath
channel

A2513

≥
bits

112

Application
keys

DRBG

A2513

n/a

Never

DH

RAM,
in
plaintext

Power  cycle
or
channel
closure

n/a

in
RAM,
plaintext

factorystate

Power cycle

Cmd_Destro
y

factorystate

Import:  From
key
blob,
decrypted
with LTA or KR

Export:  in  key
blob,
encrypted
with LTA or KR

Key  used  to  protect
recovery keys (KR).

Key
to
used
derive (using  SP  800-
in  counter
108 KDF
mode) the keys
Ke
(AES  256-bit)  and  Km
(HMAC-SHA256) that
protect  an  archive
copy of an application
key.

Encryption
decryption

and

MAC  generation  and
verification

Application  keys  used
for  general  purpose
cryptographic
services:

•

•

Encryption
and
decryption

Digital
signature
generation
and
verification

•  MAC

•

generation
and
verification

Key
derivation,
key
agreement
.

nShield 5s Hardware Security Module

35 of 47

KM

(CSP)

KML

(CSP)

KNSO

(CSP)

HKNSO

(PSP)

BLOBKE

BLOBKM

(CSP)

LTx

(CSP)

Key/SSP/Name/Typ
e

Strengt
h

Security
Function  and
Cert. Number

Generatio
n

Import/Expor
t

Establishmen
t

Storage  Zeroisation  Use & related keys

256 bits  Security

DRBG

World module
key

AES 256

A2513

n/a

Import:  From
blob,
key
decrypted
with LTM

Export:  in  key
blob,
encrypted
with LTM

128 bits  Module

DRBG

Never

n/a

Signing key

DSA 3072 bit

A2513

128 bits  NSO key

DRBG

DSA 3072 bit

A2513

Flash,
in
plaintext

factorystate
or
Unit

Initialize

Key  used
for  key
derivation  to  protect
logical
tokens and
associated  module
Key Blobs.

Flash,
in
plaintext

factorystate
or
Unit

Initialize

signature
Digital
for  key
generation
generation certificates
and  module
state
certificates.

n/a

in
RAM,
plaintext

Power cycle

Cmd_Destro
y

factorystate

Security
nShield
Officer  key  used  for
NSO authorisation and
Security
World
integrity

Import:  From
key
blob,
decrypted
with LTNSO

Export:  in  key
blob,
encrypted
with LTNSO

160 bits  Hash of public
KNSO

n/a

Never

A2513

Security
World
creation

in
Flash,
plaintext

factorystate
or
Unit

Initialize

Security
nShield
Officer  key  used  for
NSO authorisation and
Security
World
integrity

256 bits  Key

blob

n/a

Never

Derived  from
LTx

RAM,
in
plaintext

Power cycle

Key wrapping

factorystate

encryption
and MAC key

AES 256

HMAC-
SHA256

A2513

256 bits  Logical  token

DRBG

for key x

AES 256

A2513

From  Shares
using  Shamir
Secret Schee

RAM,
in
plaintext

Power cycle

Key derivation

Cmd_Destro
y

factorystate

Import:  From
quorum
of
encrypted
Shares  using
Shamir  Secret
Scheme

To

Export:
encrypted
Shares  using
Shamir  Secret
Scheme

SHAREKEY

256 bits  Share

n/a

Never

(CSP)

encryption
and MAC keys

AES 256

HMAC-
SHA256

A2513

Derived  from
KM  and  other
additional
data

RAM,
in
plaintext

Power cycle

factorystate

Protects a share when
written to a smartcard
or softcard. This key is
used  to  derive  using
KBKDF the
keys
Ke   and  Km  used  to
wrap the share.

36 of 47

nShield 5s Hardware Security Module

RAKME

RAKMA

(CSP)

KAL

(CSP)

Key/SSP/Name/Typ
e

Strengt
h

Security
Function  and
Cert. Number

Generatio
n

Import/Expor
t

Establishmen
t

Storage  Zeroisation  Use & related keys

n/a

Never

ECDH

RAM,
in
plaintext

Power  cycle
  channel
or
closure

factorystate

Encryption
decryption

and

MAC  generation  and
verification

256 bits  Session  keys
remote
for
admin
channel

AES 256

A2513

128 bits  Audit

logging

DRBG

Never

n/a

key

DSA 3072-bit

A2513

Import:
update

fw

n/a

Export: never

KWARN pub

256 bits  Entrust

root

Entrust

(PSP)

warranting
public  key  for
Administrator
Cards
and
Operator
Cards

ECDSA P-521

A2513

Flash,
in
plaintext

factorystate
or
Unit

Initialize

Digital
generation  of
audit trail.

signature
the

factorystate

n/a

protected

Flash,
in
plaintext
,  as  part
of
the
firmware
image

Digital
verification
authenticate
cards.

signature
to
remote

DRBG entropy input

256 bits  nCoreAPI

(CSP)

DRBG

A2513

DRBG seed

256 bits  nCoreAPI

(CSP)

DRBG

A2513

DRBG  internal  state
('V' and 'C' values)

(CSP)

256 bits  nCoreAPI

DRBG

A2513

bits

520
from
Platform
DRBG

Generated
as  per  SP
800-
90Arev1
with
bits
Platform
DRBG:

696
from

bits

520
entropy
input

bits

176
random
nonce

Generated
as  per  SP
800-
90Arev1.

Never

n/a

in
RAM,
plaintext

Power cycle

factorystate

Random
generation

number

Never

n/a

in
RAM,
plaintext

Power cycle

factorystate

Random
generation

number

Never

n/a

RAM,
in
plaintext

Power cycle

factorystate

Random
generation

number

Table 21 Security World SSP table

As per IG 9.7.B, the zeroisation of SSPs is explicitly indicated by the successful return code of the setup
factorystate command. Temporary SSPs are zeroised implicitly.

nShield 5s Hardware Security Module

37 of 47

9.2  SSP zeroization methods

Zeroization of all unprotected SSPs keys occurs immediately when the module is reset to the factory
state with the setup factorystate command.

9.3  Entropy sources

The cryptographic module has a hardware based true random number generator used to seed the
DRBGs.

Entropy sources

Minimum  number  of  bits
of entropy

Details

nShield  5s  Physical  True  Random
Number Generator

ESV Cert. #E38

0.89 bits per output bit

Hardware entropy source compliant with SP 800-90B.

520 output bits are used for the entropy input of the DRBG, this is more
than 256 bits of min-entropy.

Table 22 Random Bit Generator Entropy Source Specification

38 of 47

nShield 5s Hardware Security Module

10  Self tests

The  Cryptographic  Module  performs  pre-operational,  conditional  and  periodic  self-tests.  It  also
supports pre-operational self-tests on demand by resetting the module.

In the event of a self-test failure, the module enters the error state. While in this state, the module
does not process any commands, and will indicate the error on the status LED and the error log, which
can be retrieved with the command monitor getlog.

10.1 Pre-operational self tests

10.1.1  Integrity tests

At start up, the following integrity tests are performed:

•  The bootloader integrity is verified using RSA with 4096 bit key and SHA2-256 (Cert. #A2404,

#A6385), using NSBIK public key.

•  The firmware integrity is verified using RSA with 4096 bit key and SHA2-256 (Cert. #A2404,

#A6385), using NFIK public key.

•  The library partition integrity is verified using ECDSA with curve P-521 and SHA2-512 (Cert.

#A2513), using NLIK public key.

10.2 Conditional self tests

10.2.1  Crypto self tests

The  following  cryptographic  algorithm  self  tests  (CASTs)  are  run  before  the  first  use  of  any
cryptographic mechanism.

Algorithm

Description

SHA2-256

RSA

AES ECB encrypt

AES ECB decrypt

AES CMAC

SHA-1

SHA-3

Bootloader crypto (Cert. #A2404, #A6385)

Known Answer Test

Known Answer Test: verification RSASSA-PKCS-v1_5 with 4096 bit key and SHA2-256

nCore crypto (Cert. #A2513)

Known Answer Test: encryption with 128, 192 and 256-bit keys

Known Answer Test: decryption with 128, 192 and 256-bit keys

Known Answer Test: MAC generation/verification with 128-bit key

Known Answer Test: SHA-1, other sizes are tested along with KAT HMAC

Known Answer Test: SHA3-224, SHA3-256, SHA3-384, SHA3-512

HMAC with SHA-1, SHA2-224, SHA2-256, SHA2-
384, SHA2-512

Known Answer Test

nShield 5s Hardware Security Module

39 of 47

Algorithm

RSA

DSA

ECDSA

KAS-FFC

KAS-ECC

One-step KDF

Two-step KDF

KBKDF

DRBG

AES GCM encrypt

AES GCM decrypt

AES CTR encrypt

AES CTR decrypt

Description

Known  Answer  Test:  sign/verify  RSASSA-PKCS-v1_5  (SHA2-224,  SHA2-256,  SHA2-384,
SHA2-512) with 2048-bit key

Known Answer Test: encrypt/decrypt RSA-OAEP with 2048-bit key

Known Answer Test: sign/verify with 2048-bit key and SHA2-224

Known Answer Test: sign/verify with curves P-224 and B-233

Known Answer Test: DH Shared Secret Computation with MODP-2048, MODP-3072

Known Answer Test: ECDH Shared Secret Computation with curves P-256 and B-233

Known Answer Test: with SHA2-256 auxiliary function

Known Answer Test: with HMAC-SHA256 auxiliary function

Known Answer Test: Counter KDF with CMAC-AES256

Known Answer Test: instantiate, reseed, generate as per SP 800-90Arev1 section 11.3

SSH crypto (Cert. #A2512)

Known Answer Test: encryption with 128 bit key

Known Answer Test: decryption with 128 bit key

Known Answer Test: encryption with 128 bit key

Known Answer Test: decryption with 128 bit key

HMAC with SHA2-256 and SHA2-512

Known Answer Test

KAS-ECC

ECDSA

SSH KDF

Known Answer Test: ECDH Shared Secret Computation with curve P-256

Known Answer Test: sign/verify with curves P-256 and P-521

Known Answer Test: with SHA2-256

10.2.2  SP 800-90B health tests

At start up, the SP 800-90B Adaptive Proportion Test and Repetition Count Test are run on the output
bits of the entropy source.

These tests are also run continuously during operation of the entropy source.

10.2.3  Pair-wise consistency tests

The  module  performs  a  pair-wise  consistency  test  when  RSA  (Cert.  #A2513),  DSA  (Cert.  #A2513),
ECDSA  (Cert.  #A2513),  DH  (Cert.  #A2513)  and  ECDH  (Cert.  #A2513  and  Cert.  #A2512)  keys  are
generated.

10.2.4  Firmware load test

Prior to updating the firmware, the cryptographic module validates the integrity and authenticity of
the image update package.

The module performs the following actions before replacing the current image:

40 of 47

nShield 5s Hardware Security Module

•  Code signature verification with NPSK pub. The signature algorithm is ECDSA with SHA2-512

using the P-521 curve (Cert. #A2513).

•  Verification that the Version Security Number (VSN) of the new image is not less than the VSN

of the current image. This check is done for roll-back protection.

Note: A firmware image version loaded into this module that is not shown on the module certificate
is out of the scope of this validation and requires a separate FIPS 140-3 validation.

10.3 Periodic self tests

The following self tests are run periodically every 24 hours:

•  nCore crypto (Cert. #A2513) and SSH crypto (Cert. #A2512) self tests

•  SP 800-90B health tests

As per IG 10.3E Resolution #3 c), the bootloader is designed exclusively to launch the main firmware
for the module. In this architecture, as the module isn’t complete until the main firmware is launched
(replacing the bootloader in executable memory), it is redundant that the bootloader itself implement
a mechanism to run periodic tests.

nShield 5s Hardware Security Module

41 of 47

11  Life-cycle assurance

This section provides specific FIPS-related guidance to Administrators and Operators. This guidance is
aimed  to  complement  the  product  user  and  installation  guides  which  are  delivered  with  the
cryptographic module.

11.1 Delivery

The  nShield  cryptographic  module  is  sent  to  the  customers  using  a  standard  carrier  service.  After
accepting the delivery of the module, a physical inspection of the module shall be performed (refer to
Physical Security section). This inspection is done to ensure that the module has not been tampered
with during transit. If the inspection results indicate that the module has not been tampered with, the
Administrator can then proceed with installation and configuration of the module.

The cryptographic module supports firmware upgrades in the field, which are provided by Entrust as
a single signed firmware package (.npkg file).

11.2 Cryptographic module identification
This  section  provides  instructions  to  inspect  the  cryptographic  module´s  fw  and  hw  version
information and ensure they correspond with the FIPS 140-3 validated versions.

11.2.1  FW identification

The  cryptographic  module  provides  the  service  updater  info which  provides  firmware  version
information in JSON format.

Entrust provides the hsmadmin status command-line utility which calls the service updater info
internally.

hsmadmin status --json

{
    "D5DE-E1F8-D6E7": {
        "succeeded": true,
        "data": {
            "mode": "primary",
            "primary-version": "13.2.4-280-7f4f0c24",
            "recovery-version": "13.2.4-280-7f4f0c24",
            "uboot-version": "1.1.0-1245-b9bedfa"
        }
    }
}

The following fields in the output must be checked:

Field

Expected value

primary-version

13.2.4-280-7f4f0c24

42 of 47

nShield 5s Hardware Security Module

Field

Expected value

recovery-version

13.2.4-280-7f4f0c24

uboot-version

1.1.0-1245-b9bedfa or 1.4.1-0-edb84d6e

11.2.2  HW identification

The cryptographic module provides the command Cmd_NewEnquiry which reports hardware version
information.

Entrust provides the enquiry command-line utility which calls Cmd_NewEnquiry internally.

product name        nC5536E
hardware part no    PCA10005-01 revision 03

The following fields in the output must be checked:

Field

Expected value

product name

nC5536E or nC5536N

hardware part no

PCA10005-01 revision 03 or revision 04

Alternatively,  the  cryptographic  module  also  provides  the  service  setup  info which  provides
hardware version information in JSON format.

Entrust  provides  the  hsmadmin  info  command-line  utility  which  calls  the  service  setup  info
internally.

hsmadmin info --json

{
"15C8-4387-C748": {
"eeprom": {
...
,
"buildpart":
{ "value": "PCA10005-01", "crc": xxxxx }
,
"buildrev":
{ "value": "03", "crc": xxxxx }

...
}
}

The following fields in the output must be checked:

nShield 5s Hardware Security Module

43 of 47

Field

buildpart

buildrev

Expected value

"value": "PCA10005-01"

"value": "03" or "value": "04"

11.3 Approved mode of operation
To configure the cryptographic module in approved mode, the following steps are performed:

1.  When  the  cryptographic  module  is  in  factory  state,  it  first  needs  to  be  initialized  with  the

Entrust supplied utility hsmadmin enroll.

2.  Create a FIPS 140-3 level 3 compliant Security World using the Entrust supplied utility new-
world, setting the mode to fips-140-level-3, e.g. new-world --mode=fips-140-level-3

An operator can verify that the module is configured in approved mode with the command line utility
enquiry, which reports the following active modes:

 active  modes                  UseFIPSApprovedInternalMechanisms  FIPSLevel3Enforcedv2
StrictSP80056Ar3

Once a FIPS 140-3 level 3 Security World is created, it is not possible to switch into a non-compliant
mode without first zeroising the unprotected SSPs.

11.4 End of life
Per  FIPS  140-3  section 7.11.8,  in the  event  that the module  is  no  longer  deployed  or  intended  for
further use, the Crypto Officer shall zeroize and destroy the module. The module shall be taken to an
electronics recycling facility that offers (and assures) the physical destruction of e-waste.

44 of 47

nShield 5s Hardware Security Module

12  Mitigation of other attacks

Not applicable.

nShield 5s Hardware Security Module

45 of 47

Contact Us

Web site

Support

Email Support

https://www.entrust.com

https://nshieldsupport.entrust.com

nShield.support@entrust.com

Online documentation:

Available from the Support site listed above.

You can also contact our Support teams by telephone, using the following numbers:

Europe, Middle East, and Africa

United Kingdom:

Americas

Toll Free:

Fort Lauderdale:

Asia Pacific

Australia:

Japan:

Hong Kong:

+44 1223 622 444

One Station Square
Cambridge
CB1 2GA
UK

+1 833 425 1990

+1 954 953 5229

Sawgrass Commerce Center – A
Suite 130,
13800 NW 14 Street
Sunrise
FL 33323 USA

+61 9126 9070

World Trade Centre Northbank Wharf
Siddeley St
Melbourne VIC 3005
Australia

+81 50 3196 4994

+852 3008 4994

31/F, Hysan Place
500 Hennessy Road
Causeway Bay
Hong Kong

46 of 47

nShield 5s Hardware Security Module

To get help with
Entrust nShield HSMs

nShield.support@entrust.com

nshieldsupport.entrust.com

ABOUT ENTRUST CORPORATION

Entrust keeps the world moving safely by enabling trusted identities, payments
and data protection. Today more than ever, people demand seamless, secure
experiences, whether they’re crossing borders, making a purchase, accessing e-
government  services  or  logging  into  corporate  networks.  Entrust  offers  an
unmatched breadth of digital security and credential issuance solutions at the
very heart of all these interactions. With more than 2,500 colleagues, a network
of  global  partners,  and  customers  in  over  150  countries,  it’s  no  wonder  the
world’s most entrusted organizations trust us.

