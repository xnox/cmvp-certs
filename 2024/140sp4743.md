Legion of the Bouncy Castle Inc.
BC-FJA (Bouncy Castle FIPS Java API)

Non-Proprietary FIPS 140-3 Cryptographic Module Security
Policy

Software Version: 2.0.0
Date: 06/13/24

Legion of the Bouncy Castle Inc.
(ABN 84 166 338 567)
https://www.bouncycastle.org

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 1 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Table of Contents

1  General .......................................................................................................................................... 4

1.1

Confirming the Module Checksum, Functionality, and Versioning ..................................... 4

2  Cryptographic Module Specification ............................................................................................ 5

2.1

2.2

2.3

2.4

2.5

2.6

Basic Enforcement ............................................................................................................. 18

Enforcement and Guidance for GCM IVs ......................................................................... 19

Enforcement and Guidance for use of the Approved PBKDF ........................................... 20

Rules for setting the N and the S String in cSHAKE......................................................... 21

Guidance for the use of Format-Preserving Encryption .................................................... 21

Cryptographic Key Generation .......................................................................................... 21

3  Cryptographic Module Interfaces ............................................................................................... 21

4  Roles, Services, and Authentication ........................................................................................... 22

4.1

4.2

4.3

Basic Guidance .................................................................................................................. 22

Assumption of Roles .......................................................................................................... 23

Services .............................................................................................................................. 24

5  Software/Firmware Security ....................................................................................................... 32

6  Operational Environment ............................................................................................................ 33

6.1

6.2

6.3

6.4

Use of External RNG ......................................................................................................... 33

Additional Enforcement with a Java SecurityManager ..................................................... 33

Approved Mode Configuration .......................................................................................... 33

Guidance for the use of DRBGs and Configuring the JVM's Entropy Source .................. 35

7  Physical Security ........................................................................................................................ 35

8  Non-Invasive Security ................................................................................................................ 35

9  Sensitive Security Parameter Management ................................................................................ 35

9.1

RBG Entropy Sources ........................................................................................................ 46

10  Self-Tests .................................................................................................................................... 46

10.1  Pre-Operational Self-Tests ................................................................................................. 46

10.2  Conditional Self-Tests ........................................................................................................ 46

10.3  Error Handling ................................................................................................................... 47

11  Life-Cycle Assurance .................................................................................................................. 48

12  Mitigation of Other Attacks ........................................................................................................ 48

Appendix: References and Definitions .............................................................................................. 50

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 2 of 52
Public Material – May be reproduced only in its original entirety (without revision).

List of Tables

Table 1 - Security Levels ..................................................................................................................... 4
Table 2 - Tested Operational Environments ......................................................................................... 6
Table 3 - Vendor Affirmed Operational Environments ........................................................................ 9
Table 4 - Approved Algorithms .......................................................................................................... 16
Table 5 - Non-Approved Algorithms Allowed in the Approved Mode of Operation with No Security
Claimed .............................................................................................................................................. 16
Table 6 - Non-Approved Algorithms Not Allowed in the Approved Mode of Operation ................. 18
Table 7 - Ports and Interfaces ............................................................................................................. 22
Table 8 - Roles, Service Commands, Input and Output ..................................................................... 23
Table 9 - Roles and Authentication .................................................................................................... 24
Table 10 - Approved Services ............................................................................................................ 31
Table 11 - Non-Approved Services .................................................................................................... 32
Table 12 - SSPs .................................................................................................................................. 45
Table 13 - Non-Deterministic Random Number Generation Specification ....................................... 46

List of Figures
Figure 1- Cryptographic boundary ....................................................................................................... 5

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 3 of 52
Public Material – May be reproduced only in its original entirety (without revision).

General

1
This document defines the Security Policy for the Legion of the Bouncy Castle Inc.’s BC-FJA
(Bouncy Castle FIPS Java API) Module, hereafter denoted as the Module. The Module is a
cryptographic library and has a Multi-Chip Stand Alone embodiment. The Module meets FIPS 140-
3 overall Level 1 requirements. The SW version is 2.0.0.

The FIPS 140-3 security levels for the Module are given in Table 1 as follows:

ISO/IEC 24759
Section 6. Number

FIPS 140-3 Section Title

Security
Level

1

2

3

4

5

6

7

8

9

10

11

12

General

Cryptographic Module
Specification

Cryptographic Module
Interfaces

Roles, Services, and
Authentication

1

1

1

1

Software/Firmware Security  1

Operational Environment

1

Physical Security

Non-Invasive Security

Sensitive Security
Parameter Management

Self-Tests

Life-Cycle Assurance

Mitigation of Other Attacks

Table 1 - Security Levels

N/A

N/A

1

1

1

1

1.1

Confirming the Module Checksum, Functionality, and Versioning

The module checksum, functionality, and versioning can be confirmed by executing the command:

java -cp bc-fips-2.0.0.jar org.bouncycastle.util.DumpInfo

which should display:

Version Info: BouncyCastle Security Provider (FIPS edition) v2.0.0
FIPS Ready Status: READY
Module SHA-256 HMAC: 164c8ae41945cb85fdc65666fc4de7301a65d29659ecd455ee5199c7d42d107e

Indicating the jar represents the software release BC-FJA 2.0.0, that it has successfully passed all its
startup tests, and that the software release is confirmed to have a HMAC of:

164c8ae41945cb85fdc65666fc4de7301a65d29659ecd455ee5199c7d42d107e

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 4 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Cryptographic Module Specification

2
The Module is intended for use by US Federal agencies and other markets that require a FIPS 140-3
validated Cryptographic Library. The Module is of type software and the module has a Multi-Chip
Stand Alone embodiment; the cryptographic boundary is the Java Archive (JAR) file, bc-fips-
2.0.0.jar.

This module is the only software component within the Cryptographic Boundary and the only
software component that carries out cryptographic functions covered by FIPS 140-3.  Figure 1
shows the logical relationship of the cryptographic module to the other software and hardware
components of the computer. The BC classes are executed on the Java Virtual Machine (JVM) using
the classes of the Java Runtime Environment (JRE). The JVM is the interface to the computer’s
Operating System (OS) that is the interface to the various physical components of the computer.

Figure 1- Cryptographic boundary

The cryptographic module was tested on the following operational environments on the general-
purpose computer (GPC) platforms detailed in Table 2, which is also the TOEPP (Tested
Operational Environment’s Physical Perimeter) of the module.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 5 of 52
Public Material – May be reproduced only in its original entirety (without revision).

 #

Operating System
1  VMware Photon OS 4.0
with JRE 8 on VMware
ESXi 8.0

2  VMware Photon OS 4.0
with JRE 11 on VMware
ESXi 8.0

3  VMware Photon OS 4.0
with JRE 17 on VMware
ESXi 8.0

4  VMware Photon OS 5.0
with JRE 21 on VMware
ESXi 8.0

Hardware Platform  Processor
Dell PowerEdge
R650

Intel Xeon Gold
6330

PAA/Acceleration
Without PAA

Dell PowerEdge
R650

Intel Xeon Gold
6330

Without PAA

Dell PowerEdge
R650

Intel Xeon Gold
6330

Without PAA

Dell PowerEdge
R650

Intel Xeon Gold
6330

Without PAA

Table 2 - Tested Operational Environments

The cryptographic module will remain compliant with the FIPS 140-3 validation when operating on
any general-purpose computer (GPC) provided that:

1)  No source code has been modified.
2)  The GPC uses the specified single-user platform, or another compatible single-user platform

such as one of the Java SE Runtime Environments listed on any of the following:

  #

1

2

3

4

5

6

7

8

9

10

11

12

  Operating System
 Java SE Runtime Environment v8 (1.8)
with HP-UX
 Java SE Runtime Environment v11 (1.11)
with HP-UX
 Java SE Runtime Environment v17 (1.17)
with HP-UX
 Java SE Runtime Environment v21 (21)
with HP-UX
  Java SE Runtime Environment v8 (1.8)
with Linux Centos
 Java SE Runtime Environment v11 (1.11)
with Linux Centos
 Java SE Runtime Environment v17 (1.17)
with Linux Centos
 Java SE Runtime Environment v21 (21)
with Linux Centos
  Java SE Runtime Environment v8 (1.8)
with Red Hat Enterprise Linux
 Java SE Runtime Environment v11 (1.11)
with Red Hat Enterprise Linux
 Java SE Runtime Environment v17 (1.17)
with Red Hat Enterprise Linux
 Java SE Runtime Environment v21 (21)
with Red Hat Enterprise Linux

  Hardware Platform
 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 6 of 52
Public Material – May be reproduced only in its original entirety (without revision).

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

36

37

  Java SE Runtime Environment v8 (1.8)
with Linux Debian
 Java SE Runtime Environment v11 (1.11)
with Linux Debian
 Java SE Runtime Environment v17 (1.17)
with Linux Debian
 Java SE Runtime Environment v21 (21)
with Linux Debian
 Java SE Runtime Environment v8 (1.8)
with Linux Fedora
 Java SE Runtime Environment v11 (1.11)
with Linux Fedora
 Java SE Runtime Environment v17 (1.17)
with Linux Fedora
 Java SE Runtime Environment v21 (21)
with Linux Fedora
  Java SE Runtime Environment v8 (1.8)
with Linux Oracle RHC
 Java SE Runtime Environment v11 (1.11)
with Linux Oracle RHC
 Java SE Runtime Environment v17 (1.17)
with Linux Oracle RHC
 Java SE Runtime Environment v21 (21)
with Linux Oracle RHC
  Java SE Runtime Environment v8 (1.8)
with Linux Oracle UEK
 Java SE Runtime Environment v11 (1.11)
with Linux Oracle UEK
 Java SE Runtime Environment v17 (1.17)
with Linux Oracle UEK
 Java SE Runtime Environment v21 (21)
with Linux Oracle UEK
 Java SE Runtime Environment v17 (1.8)
with Linux Photon
 Java SE Runtime Environment v17 (1.11)
with Linux Photon
 Java SE Runtime Environment v17 (1.17)
with Linux Photon
 Java SE Runtime Environment v21 (21)
with Linux Photon
  Java SE Runtime Environment v8 (1.8)
with Linux SUSE
 Java SE Runtime Environment v11 (1.11)
with Linux SUSE
 Java SE Runtime Environment v17 (1.17)
with Linux SUSE
 Java SE Runtime Environment v21 (21)
with Linux SUSE
  Java SE Runtime Environment v8 (1.8)
with Linux Ubuntu

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 7 of 52
Public Material – May be reproduced only in its original entirety (without revision).

38

39

40

41

42

43

44

45

46

47

48

49

50

51

52

53

54

55

56

57

58

59

60

61

62

 Java SE Runtime Environment v11 (1.11)
with Linux Ubuntu
 Java SE Runtime Environment v17 (1.17)
with Linux Ubuntu
 Java SE Runtime Environment v21 (21)
with Linux Ubuntu
  Java SE Runtime Environment v8 (1.8)
with Mac OS X
 Java SE Runtime Environment v11 (1.11)
with Mac OS X
  Java SE Runtime Environment v8 (1.8)
with Microsoft Windows
 Java SE Runtime Environment v11 (1.11)
with Microsoft Windows
 Java SE Runtime Environment v17 (1.17)
with Microsoft Windows
 Java SE Runtime Environment v21 (21)
with Microsoft Windows
  Java SE Runtime Environment v8 (1.8)
with Microsoft Windows Server
 Java SE Runtime Environment v11 (1.11)
with Microsoft Windows Server
 Java SE Runtime Environment v17 (1.17)
with Microsoft Windows Server
 Java SE Runtime Environment v21 (21)
with Microsoft Windows Server
  Java SE Runtime Environment v8 (1.8)
with Microsoft Windows XP
 Java SE Runtime Environment v11 (1.11)
with Microsoft Windows XP
 Java SE Runtime Environment v17 (1.17)
with Microsoft Windows XP
 Java SE Runtime Environment v21 (21)
with Microsoft Windows XP
  Java SE Runtime Environment v8 (1.8)
with Solaris
 Java SE Runtime Environment v11 (1.11)
with Solaris
 Java SE Runtime Environment v17 (1.17)
with Solaris
 Java SE Runtime Environment v21 (21)
with Solaris
  Java SE Runtime Environment v8 (1.8)
with AIX
 Java SE Runtime Environment v11 (1.11)
with AIX
 Java SE Runtime Environment v17 (1.17)
with AIX
 Java SE Runtime Environment v21 (21)
with AIX

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

 Generic Hardware Platform

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 8 of 52
Public Material – May be reproduced only in its original entirety (without revision).

63

64

65

66

67

68

69

70

71

72

73

74

75

76

77

78

Java SE Runtime Environment v17 (1.17)
with Red Hat Enterprise Linux
Java SE Runtime Environment v21 (21)
with Red Hat Enterprise Linux
Java SE Runtime Environment v17 (1.17)
with Red Hat Enterprise Linux
Java SE Runtime Environment v21 (21)
with Red Hat Enterprise Linux
Java SE Runtime Environment v17 (1.17)
with Ubuntu
Java SE Runtime Environment v21 (21)
with Ubuntu
Java SE Runtime Environment v17 (1.17)
with Ubuntu
Java SE Runtime Environment v21 (21)
with Ubuntu
Java SE Runtime Environment v17 (1.17)
with ClevOS
Java SE Runtime Environment v21 (21)
with ClevOS
Java SE Runtime Environment v17 (1.17)
with ClevOS
Java SE Runtime Environment v21 (21)
with ClevOS
Java SE Runtime Environment v17 (1.17)
with ClevOS
Java SE Runtime Environment v21 (21)
with ClevOS
Java SE Runtime Environment v17 (1.17)
with ClevOS
Java SE Runtime Environment v21 (21)
with ClevOS

Generic hardware platform with Intel Cascade
Lakes
Generic hardware platform with Intel Cascade
Lakes
Generic hardware platform with Intel Sapphire
Rapids
Generic hardware platform with Intel Sapphire
Rapids
Generic hardware platform with Intel Cascade
Lakes
Generic hardware platform with Intel Cascade
Lakes
Generic hardware platform with Intel Sapphire
Rapids
Generic hardware platform with Intel Sapphire
Rapids
Generic hardware platform with Intel Cascade
Lake
Generic hardware platform with Intel Cascade
Lake
Generic hardware platform with Intel Sapphire
Rapids
Generic hardware platform with Intel Sapphire
Rapids
Generic hardware platform with Intel Haswell

Generic hardware platform with Intel Haswell

Generic hardware platform with Intel
Broadwell
Generic hardware platform with Intel
Broadwell

Table 3 - Vendor Affirmed Operational Environments

For the avoidance of doubt, it is hereby stated that the CMVP makes no statement as to the correct
operation of the module or the security strengths of the generated keys when so ported if the specific
operational environment is not listed on the validation certificate.

The Module implements the Approved and Non-Approved but Allowed cryptographic functions
with no security claimed listed in Tables 4 and 5 below. There are algorithms, modes, and keys that
have been CAVP tested but not used by the module. Only the algorithms, modes/methods, and key
lengths/curves/moduli shown in this table are used by the module. The Module supports both
Approved and Non-Approved mode of operation. Please see Section 6.3 for configuration of the
Module in Approved mode of operation. Please see Section 11 for initialization steps.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 9 of 52
Public Material – May be reproduced only in its original entirety (without revision).

CAVP
Cert

A4399

A4399

A4399

A4399

A4399

A4399

Algorithm
and Standard

AES
[FIPS 197, SP
800-38A], AES-
FF1 Format
Preserving
Encryption
[SP 800-38G]

AES-CBC
Ciphertext
Stealing (CS)
[Addendum to
SP 800-38A,
Oct 2010]

CCM
[SP 800-38C]

CMAC
[SP 800-38B]
GCM/GMAC1
[SP 800-38D]

Counter DRBG
[SP 800-90Ar1]

N/A

AES

N/A

N/A

A4399

Hash DRBG
[SP 800-90Ar1]

N/A

A4399

HMAC DRBG
[SP 800-90Ar1]

N/A

Mode/Method  Description / Key Sizes(s) /

Use / Function

Key Strength(s)

ECB, CBC,
OFB, CFB8,
CFB128, CTR,
FF1

Key sizes: 128, 192, 256 bits  Encryption,
Decryption

CBC-CS1,
CBC-CS2,
CBC-CS3

Key sizes: 128, 192, 256 bits  Encryption,
Decryption

Key sizes: 128, 192, 256 bits  Generation,

Authentication

Key sizes: AES with 128,
192, 256 bits

Generation,
Authentication

Key sizes: 128, 192, 256 bits  Generation,

Authentication

AES-CTR
DRBG.

Hash DRBG

HMAC DRBG

AES-128, AES-192, AES-
256

SHA sizes: SHA-1, SHA2-
224, SHA2-256, SHA2-384,
SHA2-512, SHA2-512/224,
SHA2-512/256

SHA sizes: SHA-1, SHA2-
224, SHA2-256, SHA2-384,
SHA2-512, SHA2-512/224,
SHA2-512/256

1 GCM encryption with an internally generated IV, see section 2.2 concerning external IVs. IV generation is compliant

with IG C.H.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 10 of 52
Public Material – May be reproduced only in its original entirety (without revision).

CAVP
Cert

A4399

Algorithm
and Standard
DSA2
[FIPS 186-4]

Mode/Method  Description / Key Sizes(s) /

Use / Function

Key Strength(s)

N/A

Key sizes: 1024, 2048, 3072
bits (1024 only for SigVer)

 PQG
Generation, PQG
Verification, Key
Pair Generation,
Signature
Generation,
Signature
Verification

Public Key
Generation,
Signature
Generation,
Signature
Verification,
Public Key
Validation

Key Derivation

Generation,
Authentication

A4399

ECDSA
[FIPS 186-4]

N/A

A4399

N/A

KDA-HKDF
[SP 800-56C-
rev2]

A4399

HMAC
[FIPS 198-1]

N/A

Curves/Key sizes: P-192*, P-
224, P-256, P-384, P-521, K-
163*, K-233, K-283, K-409,
K-571, B-163*, B-233, B-
283, B-409, B-571

* Curves only used for Signature
Verification and Public Key
Validation

PRFs: HMAC SHA-1,
HMAC SHA-224, HMAC
SHA-256, HMAC SHA-384,
HMAC SHA-512, HMAC
SHA-512/224, HMAC SHA-
512/256, HMAC SHA3-224,
HMAC SHA3-256, HMAC
SHA3-384, HMAC SHA3-
512

SHA sizes: SHA-1, SHA-
224, SHA-256, SHA-384,
SHA-512, SHA-512/224,
SHA-512/256, SHA3-224,
SHA3-256, SHA3-384,
SHA3-512

2 DSA signature generation with SHA-1 is only for use with protocols.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 11 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Mode/Method  Description / Key Sizes(s) /

Use / Function

CAVP
Cert

A4399

Algorithm
and Standard
KAS-FFC3
[SP 800-56A-
rev3]

N/A

Key Agreement

Key Agreement

Key Derivation

Key Strength(s)

Domain Parameter
Generation
Methods/Scheme: ffdhe2048,
ffdhe3072, ffdhe4096,
ffdhe6144, ffdhe8192,
MODP-2048, MODP-3072,
MODP-4096, MODP-6144,
MODP-8192
dhHybrid1, MQV2,
dhEphem, dhHybrid,
OneFlow, MQV1,
dhOneFlow, dhStatic
Groups specified above
providing between 112 and
200 bits of encryption
strength

Domain Parameter
Generation
Methods/Scheme: P-224, P-
256, P-384, P-521,K-233, K-
283, K-409, K-571, B-233,
B-283, B-409, B-571
ephemeralUnified, fullMqv,
fullUnified, onePassDh,
onePassMqv,
onePassUnified,
staticUnified
Curves specified above
providing between 112 and
256 bits of encryption
strength

PRFs: SHA-1, SHA-224,
SHA-256, SHA-384, SHA-
512, SHA-512/224, SHA-
512/256, SHA3-224, SHA3-
256, SHA3-384, SHA3-512,
HMAC SHA-1, HMAC
SHA-224, HMAC SHA-256,
HMAC SHA-384, HMAC
SHA-512, HMAC SHA-
512/224, HMAC SHA-
512/256, HMAC SHA3-224,
HMAC SHA3-256, HMAC
SHA3-384, HMAC SHA3-
512, KMAC-128, KMAC-
256

A4399

KAS-ECC3
[SP 800-56A-
rev3]

N/A

A4399

N/A

KDA, One Step
[SP 800-56C-
rev2]

3 Keys are not established directly into the module using the key agreement algorithms.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 12 of 52
Public Material – May be reproduced only in its original entirety (without revision).

CAVP
Cert

A4399

Algorithm
and Standard

KDA, Two Step
[SP 800-56C-
rev2]

Mode/Method  Description / Key Sizes(s) /

Use / Function

N/A

Key Derivation

Key Strength(s)

PRFs: HMAC SHA-1,
HMAC SHA-224, HMAC
SHA-256, HMAC SHA-384,
HMAC SHA-512, HMAC
SHA-512/224, HMAC SHA-
512/256, HMAC SHA3-224,
HMAC SHA3-256, HMAC
SHA3-384, HMAC SHA3-
512, KMAC-128, KMAC-
256

CVL
A4399

CVL
A4399

CVL
A4399

CVL
A4399

CVL
A4399

CVL
A4399

KDF, Existing
Application-
Specific4
[SP 800-135-
rev1]

KDF, Existing
Application-
Specific4
[SP 800-135-
rev1]

KDF, Existing
Application-
Specific4
[SP 800-135-
rev1]

KDF, Existing
Application-
Specific4
[SP 800-135-
rev1]

KDF, Existing
Application-
Specific4
[SP 800-135-
rev1]

KDF, Existing
Application-
Specific4
[SP 800-135-
rev1]

N/A

TLS v1.0/1.1 KDF

Key Derivation

SHA sizes: SHA2-256 ,
SHA2-384, SHA2-512

N/A

TLS 1.2 KDF

Key Derivation

SHA sizes: SHA2-256,
SHA2-384, SHA2-512

N/A

SNMP KDF

Key Derivation

Password Length: 64, 8192

N/A

SSH KDF

Key Derivation

SHA sizes: SHA2-224

N/A

X9.63 KDF

N/A

SHA sizes: SHA2-224,
SHA2-256, SHA2-384,
SHA2-512

IKEv2 KDF
SHA sizes:SHA-1, SHA2-
224, SHA2-256, SHA2-384,
SHA2-512

Key Derivation
Can be used
along with KAS-
SSC

Key Derivation

4 No parts of the protocols (TLS, SSHv2, X9.63, IKEv2, SRTP, SNMPv3), other than the approved cryptographic

algorithms and the KDFs, have been reviewed or tested by the CAVP and CMVP.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 13 of 52
Public Material – May be reproduced only in its original entirety (without revision).

CAVP
Cert

CVL
A4399

A4399

A4399

Mode/Method  Description / Key Sizes(s) /

Use / Function

Key Strength(s)

N/A

SRTP KDF

Key Derivation

Algorithm
and Standard

KDF, Existing
Application-
Specific4
[SP 800-135-
rev1]

N/A

KDF, Password-
Based
[SP 800-132]

KDF, using
Pseudorandom
Functions5
[SP 800-108-
rev1]

Counter Mode,
Feedback
Mode, Double-
Pipeline
Iteration Mode

A4399

AES KW,
KWP

Key Wrapping
Using Block
Ciphers6
[SP 800-38F]

Key Derivation

Key Derivation

Key Wrapping

Options: PBKDF with
Option 1a
Types: HMAC-based KDF
using SHA-1, SHA-224,
SHA-256, SHA-384, SHA-
512

Types: CMAC-based
KBKDF with AES, HMAC-
based KBKDF with SHA-1,
SHA-224, SHA-256, SHA-
384, SHA-512, SHA3-224,
SHA3-256, SHA3-384,
SHA3-512

Key sizes: 128, 192, 256 bits
(Key establishment
methodology providing 128,
192 or 256 bits of encryption
strength)

N/A

Key sizes: 2048, 3072, 4096  Key Pair

Generation

N/A

Key sizes: 2048, 3072, 4096  Signature

Generation

A4399

A4399

RSA
[FIPS 186-4,
ANSI X9.31-
1998 and PKCS
#1 v2.1 (PSS
and PKCS1.5)]

RSA
[FIPS 186-4,
ANSI X9.31-
1998 and PKCS
#1 v2.1 (PSS
and PKCS1.5)]

5 Note: CAVP testing is not provided for use of the PRFs SHA-512/224 and SHA-512/256. These must not be used
in approved mode.
6 Keys are not established directly into the module using key unwrapping.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 14 of 52
Public Material – May be reproduced only in its original entirety (without revision).

CAVP
Cert

A4399

A4399

CVL
A4399

CVL
A4399

A4399

Algorithm
and Standard

RSA
[FIPS 186-4,
ANSI X9.31-
1998 and PKCS
#1 v2.1 (PSS
and PKCS1.5)]

RSA [FIPS 186-
2, ANSI X9.31-
1998 and PKCS
#1 v2.1 (PSS
and PKCS1.5)]

RSA Decryption
Primitive

RSA Signature
Primitive

KTS-IFC
[SP 800-56B-
rev2, Section
7.2.2]

N/A

N/A

N/A

N/A

N/A

A4399

N/A

KAS-IFC
[SP 800-56B-
rev2, Section
7.2.1]

A4399

N/A

Safe Primes
[SP 800-56A-
rev3]

A4399

SHS
[FIPS 180-4]

N/A

Mode/Method  Description / Key Sizes(s) /

Use / Function

Key Strength(s)

Key sizes: 1024, 2048, 3072,
4096

Signature
Verification

Key sizes: 1024, 1536, 2048,
3072, 4096

Signature
Verification

2048

2048

RSA-OAEP with, and
without, key confirmation.
Key sizes:  2048, 3072, 4096
providing between 112 and
152 bits of encryption
strength
Key Generation Method:
rsakpg2-crt

RSASVE with, and without,
key confirmation.
Key sizes: 2048, 3072, 4096
providing between 112 and
152 bits of encryption
strength

Parameter sets: ffdhe2048,
ffdhe3072, ffdhe4096,
ffdhe6144, ffdhe8192,
MODP-2048, MODP-3072,
MODP-4096, MODP-6144,
MODP-8192

SHA sizes: SHA-1, SHA-
224, SHA-256, SHA-384,
SHA-512, SHA-512/224,
SHA-512/256

Component Test

Component Test

Key Transport

Key Agreement

Key Generation,
Key Verification

Digital Signature
Generation,
Digital Signature
Verification, non-
Digital Signature
Applications

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 15 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Mode/Method  Description / Key Sizes(s) /

Use / Function

CAVP
Cert

A4399

Algorithm
and Standard

SHA-3,
SHAKE
[FIPS 202]

N/A

Key Strength(s)

SHA3-224, SHA3-256,
SHA3-384, SHA3-512,
SHAKE128, SHAKE256

A4399

N/A

SHA-3 Derived
Functions
[SP 800-185]

N/A

Vendor
Affirmed
IG D.H

CKG using
output from
DRBG7
[SP 800-133-
rev2]

Types: cSHAKE-128,
KMAC-128, TupleHash-128,
ParallelHash-128, cSHAKE-
256, KMAC-256,
TupleHash-256,
ParallelHash-256

Section 5.1 (Asymmetric
from DRBG)
Section 6.1 (Symmetric from
DRBG)

Table 4 - Approved Algorithms

Digital Signature
Generation,
Digital Signature
Verification, non-
Digital Signature
Applications

Digital Signature
Generation,
Digital Signature
Verification, non-
Digital Signature
Applications

Key Generation

Algorithm

Caveat

Use / Function

MD5 within TLS  Allowed per IG 2.4.A, no

MD5 used within a TLS handshake

security claimed

Table 5 - Non-Approved Algorithms Allowed in the Approved Mode of Operation with No
Security Claimed

Algorithm/Function
AES (non-compliant8)

ARC4 (RC4)

Blowfish

Camellia

CAST5

ChaCha20

ChaCha20-Poly1305

DES

Diffie-Hellman KAS (non-
compliant9)

Use/Function

Non-approved modes for AES

ARC4/RC4 stream cipher

Blowfish block cipher

Camellia block cipher

CAST5 block cipher

ChaCha20 stream cipher

AEAD ChaCha20 using Poly1305 as the MAC

DES block cipher

non-compliant key agreement methods

7 The resulting key or a generated seed is an unmodified output from a DRBG.
8 Support for additional modes of operation.
9 Support for additional key sizes and the establishment of keys of less than 112 bits of security strength.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 16 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Algorithm/Function
DSA (non-compliant10)

DSTU4145
ECDSA (non-compliant10)

EdDSA

ElGamal

FF3-1

GOST28147

GOST3410-1994

GOST3410-2001

GOST3410-2012

GOST3411

GOST3411-2012-256

GOST3411-2012-512

HMAC-GOST3411

HMAC-MD5

HMAC-RIPEMD128

HMAC-RIPEMD160

HMAC-RIPEMD256

HMAC-RIPEMD320

HMAC-TIGER

Use/Function

non-approved digest signatures using DSA

DSTU4145 EC algorithm

non-approved digest signatures using ECDSA

Ed25519 and Ed448 signature algorithms

ElGamal key transport algorithm

Format Preserving Encryption – AES FF3-1

GOST-28147 block cipher

GOST-3410-1994 algorithm

GOST-3410-2001 EC algorithm

GOST-3410-2012 EC algorithm

GOST-3411-1994 message digest

GOST-3411-2012 256-bit message digest

GOST-3411-2012 512-bit message digest

GOST-3411 HMAC

MD5 HMAC

RIPEMD128 HMAC

RIPEMD160 HMAC

RIPEMD256HMAC

RIPEMD320 HMAC

TIGER HMAC

HMAC-WHIRLPOOL

WHIRLPOOL HMAC

HSS

IDEA
KAS11 using SHA-512/224 or
SHA-512/256

KBKDF using SHA-512/224 or
SHA-512/256 (non-compliant)

HSS signature scheme (RFC 8708)

IDEA block cipher

Key Agreement using SHA-512/224 and SHA-512/256
based KDFs

PBKDF2 using the PRFs SHA-512/224 and SHA-
512/256

LMS

MD5

OpenSSL PBKDF (non-
compliant)
PKCS#12 PBKDF (non-
compliant)
PKCS#5 Scheme 1 PBKDF (non-
compliant)

LMS signature scheme (RFC 8708)

MD5 message digest

OpenSSL PBE key derivation scheme

PKCS#12 PBE key derivation scheme

PKCS#5 PBE key derivation scheme

10 Deterministic signature calculation, support for additional digests, and key sizes.
11 Keys are not directly established into the module using key agreement or transport techniques.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 17 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Algorithm/Function
Poly1305

PRNG X9.31

RC2

RIPEMD128

RIPEMD160

RIPEMD256

RIPEMD320
RSA (non-compliant12)
RSA KTS (non-compliant13)

SCrypt (non-compliant)

Use/Function

Poly1305 message MAC

X9.31 PRNG

RC2 block cipher

RIPEMD128 message digest

RIPEMD160 message digest

RIPEMD256 message digest

RIPEMD320 message digest

Non-compliant RSA signature schemes

Non-compliant RSA key transport schemes

Scrypt using non-compliant PBKDF2

SEED

Serpent

SipHash

SHACAL-2

TIGER

Triple-DES

Twofish

WHIRLPOOL

XDH

SEED block cipher

Serpent block cipher

SipHash MAC

SHACAL2 block cipher

TIGER message digest

Triple-DES cipher

Twofish block cipher

WHIRLPOOL message digest

X25519 and X448 key agreement algorithms

Table 6 - Non-Approved Algorithms Not Allowed in the Approved Mode of Operation

2.1

Basic Enforcement

The module design corresponds to the Module security rules. This section documents the security
rules enforced by the cryptographic module to implement the security requirements of this FIPS
140-3 Level 1 module:

1.  The module shall provide two distinct operator roles: User and Cryptographic Officer.
2.  The module does not provide authentication.
3.  The operator shall be capable of commanding the module to perform the power up self-tests

by cycling power or resetting the module.

4.  Power up self-tests do not require any operator action.
5.  Data output shall be inhibited during self-tests, zeroization, and error states. Output related

to keys and their use is inhibited until the key concerned has been fully generated.

6.  Status information does not contain CSPs or sensitive data that if misused could lead to a

compromise of the module.

7.  There are no restrictions on which keys or CSPs are zeroized by the zeroization service.
8.  The module does not support concurrent operators.
9.  The module does not have any external input/output devices used for entry/output of data.
10. The module does not enter or output plaintext CSPs from the module’s physical perimeter.

12 Support for additional digests and signature formats, PKCS#1 1.5 key wrapping, support for additional key sizes.
13 Support for additional key sizes and the establishment of keys of less than 112 bits of security strength.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 18 of 52
Public Material – May be reproduced only in its original entirety (without revision).

11. The module does not output intermediate key values.

HMAC algorithms specified in the Approved Algorithms table produce truncated versions of the
HMAC in question. The right most bits are truncated as per the NIST SP 800-107 rev1.

When the module is used within the context of Java Security Manager or the system/security
property org.bouncycastle.fips.approved_only is set to true, the module will start in approved mode
and non-approved services are not accessible in this mode.

When the module is not used within the context of Java Security Manager, the module will start in a
non-approved mode by default.

From non-approved mode to approved mode:
It is a combination of granted permission (a) and request to change mode (b):
a.
b.

org.bouncycastle.crypto.CryptoServicesPermission “changeToApprovedModeEnabled”
CryptoServicesRegistrar.setApprovedMode(true)

The CSPs made available in non-approved mode will not be accessible, once the thread transitions
into approved mode. The CSPs generated using the non-approved mode cannot be passed or shared
with algorithms operating in approved mode, and vice-versa. This is done by indicating within the
class (object), instantiating the key, as being created in an approved mode or non-approved mode.
Any attempt by a thread within the execution of the module to use the key in an opposite mode will
result in an exception being generated by the module. For example, if an RSA private key has been
created in either approved or non-approved mode, then any request to access that key will first need
to see if the thread making the request is in the same mode.

From approved mode to non-approved mode:
The module cannot transition from approved mode to non-approved mode. To initiate the module in
non-approved mode, either it should not be used in the context of Java Security Manager, or the
module should have the permission “org.bouncycastle.crypto.CryptoServicesPermission
unapprovedModeEnabled” granted by the Java Security Manager.

2.2

Enforcement and Guidance for GCM IVs

IVs for GCM can be generated randomly, or via a FipsNonceGenerator. Where an IV is not
generated within the module the module supports the importing of GCM IVs.

In approved mode, when a GCM IV is generated randomly, the module enforces the use of an
approved DRBG in line with Section 8.2.2 of SP 800-38D.

In approved mode, when a GCM IV is generated using the FipsNonceGenerator a counter is used as
the basis for the nonce and the IV is generated in accordance with TLS protocol. Rollover of the
counter in the FipsNonceGenerator will result in an IllegalStateException indicating the
FipsNonceGenerator is exhausted and, as per IG C.H, where used for TLS 1.2, rollover will
terminate any TLS session in process using the current key and the exception can only be recovered
from by using a new handshake and creating a new FipsNonceGenerator.

In approved mode, importing a GCM IV for encryption that originates from outside the module is
non-conformant. A service indicator for IV usage is provided in the module through Java logging.
Setting the logging level to Level.FINE for the named logger
“org.bouncycastle.jcajce.provider.BaseCipher” will produce a log message when an IV which may
have been produced outside the module and/or not from a compliant source is detected. The log
message will be of the standard form including the detail:
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 19 of 52
Public Material – May be reproduced only in its original entirety (without revision).

FINE: Passed in GCM nonce detected: <IV value>

where <IV value> is a HEX representation of the IV in use.

Setting the logging level to Level.FINER will produce an additional log message for any GCM IV
which is used if the previous Level.FINE message is not activated. Log messages in this case will
show the detail as:

FINER: GCM nonce detected: <IV value>

where <IV value> is a HEX representation of the IV in use.

Per IG C.H, in the event module power is lost and restored the consuming application must ensure
that any of its AES-GCM keys used for encryption or decryption are re-distributed.

The AES-GCM Mode falls under:

•

•

IG C.H scenario 2: GCM IV is generated randomly, and the module uses an Approved
DRBG that is internal to the module’s boundary. The IV length is 96 bits.

IG C.H scenario 1 for TLSv1.2 protocol: The module is compatible with TLSv1.2 protocol
and supports acceptable AES-GCM ciphersuites from Section 3.3.1 of the SP800-52rev2.

2.3

Enforcement and Guidance for use of the Approved PBKDF

In line with the requirements for SP 800-132, keys generated using the approved PBKDF must only
be used for storage applications. Any other use of the approved PBKDF is non-conformant.

In approved mode the module enforces that any password used must encode to at least 14 bytes
(112 bits) and that the salt is at least 16 bytes (128 bits) long. The iteration count associated with the
PBKDF should be as large as practical.

As the module is a general-purpose software module, it is not possible to anticipate all the levels of
use for the PBKDF, however a user of the module should also note that a password should at least
contain enough entropy to be unguessable and also contain enough entropy to reflect the security
strength required for the key being generated. In the event a password encoding is simply based on
ASCII a 14 byte password is unlikely to contain sufficient entropy for most purposes as the standard
set of printable characters only allows for as much as 6 bits of entropy per byte, giving a password
which for the case of 14 bytes, yields a key that has been generated using 14 * 6 bits, giving only 84
bits of security, well below what is required for a key with the same level of hardness as a 112 bit
one. Users are referred to Appendix A, “Security Considerations” of SP 800-132 for further
information on password, salt, and iteration count selection.

The iteration count value is provided by the user – and should be appropriate to the way the
algorithm is being used (the memory hard augmentation of PBKDF provided by SCRYPT uses an
iteration count of 1), for straight PBKDF with no memory hard support, the iteration count provided
by the user should be at point where the maximum cost bearable by the user carrying out the key
derivation in the normal course of usage. To ensure sufficient whitening of the password in both
cases, the module enforces a salt size of 128 bits in approved-only mode.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 20 of 52
Public Material – May be reproduced only in its original entirety (without revision).

For users interested in introducing memory hardness as a layer on top of the PBKDF the scrypt
augmentation to PBDKF based on HMAC SHA-256 (as described in RFC 7914) is also available.

2.4

Rules for setting the N and the S String in cSHAKE

The cSHAKE algorithm offers to input string for customizing the output of the cSHAKE function,
the Function-Name input (N) and the Customization String (S).

The Function-Name input (N) is reserved for values specified by NIST and should only be set to the
appropriate NIST specified value. Any other use of N is non-conformant.

The Customization String (S) is available to allow users to customize the cSHAKE function as they
wish. The length of S is limited to the available size of a byte array in the JVM running the module.

2.5

Guidance for the use of Format-Preserving Encryption

The module supports both FF1 and, in non-approved mode, FF3-1 format preserving encryption. Below
shows the parameter constraints applicable to the module’s implementation.

SP800-38G Format-Preserving Encryption Constraints

FF1

FF3-1

 in range of 2..216

 in range of 2..216

 >= 1000000

 >= 2 octets

 < 232 octets

 >= 0 octets

 >= 1000000

 2 octets

 2 * floor(logradix(296)) octets

 8 octets (fixed)

radix

radixminlen

minlen

maxlen

maxTlen

An attempt to use the FF1 or FF3-1 without meeting the radixminlen constraint or by exceeding maxlen will
result in an IllegalArgumentException. Note: only FF1 should be used in approved mode.

2.6

Cryptographic Key Generation

The module performs Cryptographic Key Generation in conformance to FIPS 140-3 IG D.H. The
CKG for symmetric keys and seeds used for generating asymmetric keys is performed as per
Section 4 of the SP800-133r2 and compliant with FIPS 186-4 and SP800-90Arev1 for DRBG. The
seed used in asymmetric key generation is the direct output of SP800-90Arev1 DRBG.

3

Cryptographic Module Interfaces

The BC-FJA (Bouncy Castle FIPS Java API) Module is a software module, and, therefore, control
of the physical ports is outside of the module’s scope. The module does provide a set of logical
interfaces which are mapped to the following FIPS 140-3 defined logical interfaces: data input, data
output, control input, status output, and power. When the module performs self-tests, is in an error
state, is generating keys, or performing zeroization, the module prevents all output on the logical
data output interface as only the thread performing the operation has access to the data. The module

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 21 of 52
Public Material – May be reproduced only in its original entirety (without revision).

is single-threaded, and in an error state, the module does not return any output data, only an error
value. The module does not implement control output interface.

The mapping of the FIPS 140-3 logical interfaces to the module is described in Table 7.

Logical Interface

Data that passes over port/interface

Data Input

Data Output

Control Input

Status Output

API input parameters – plaintext and/or ciphertext data.

API output parameters and return values – plaintext and/or ciphertext
data.

API method calls – method calls, or input parameters, that specify
commands and/or control data used to control the operation of the
module.

API output parameters and return/error codes that provide status
information used to indicate the state of the module.
Table 7 - Ports and Interfaces

4

Roles, Services, and Authentication

4.1

Basic Guidance

The jar file representing the module needs to be installed in a JVM’s class path in a manner
appropriate to its use in applications running on the JVM.

Functionality in the module is provided in two ways. At the lowest level there are distinct classes
that provide access to the approved and non-approved services provided by the module. A more
abstract level of access can also be gained using strings providing operation names passed into the
module’s Java cryptography provider through the APIs described in the Java Cryptography
Architecture (JCA) and the Java Cryptography Extension (JCE).

When the module is being used in approved mode, classes providing implementations of algorithms
which are not approved, or allowed, are explicitly disabled.
SSPs such as private and secret keys implement the Destroyable interface. Where appropriate these
SSPs can be zeroized on demand by invoking the destroy() method. The return of the destroy()
method indicates that the zeroization is complete.

Roles, with corresponding service with input and output is specified in Table 8 below:

Role

Service

CO/User

Initialize Module and Run
Self-Tests on Demand

CO/User  Show Status

CO/User

Info Service

CO/User  Zeroize / Power-off

  Input

N/A

N/A

N/A

N/A

Output

Exception in case of failure

Boolean

Module name and version

Shutdown indication

CO/User  Data Encryption

Key, Plaintext

Ciphertext

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 22 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Role

Service

  Input

CO/User  Data Decryption

Key, Ciphertext

CO/User  MAC Calculation

Key, Message

CO/User  Signature Authentication  Key, Message

Output

Plaintext

MAC

Signature

CO/User  Signature Verification

Key, Message, Signature

Boolean

CO/User  DRBG (SP800-90Arev1)

N/A

Output

CO/User  Message Hashing

Message

CO/User  Keyed Message Hashing  Key, Message

CO/User  TLS Key Derivation
Function

TLS Parameters

CO/User  SP 800-108-rev1 KDF

KDF Parameters

CO/User  SSH Derivation Function

SSH Parameters

CO/User  X9.63 Derivation Function  X9.63 Parameters

CO/User  SP 800-56C-rev2

KDM Parameters

OneStep/TwoStep Key
Derivation Function
(KDM)

CO/User

IKEv2 Derivation Function  IKEv2 Parameters

CO/User  SRTP Derivation Function  SRTP Parameters

CO/User  PBKDF

Password, PBKDF
Parameters

Data

Hash

Hash

Data

Data

Data

Data

Data

Data

Data

Data

CO/User  Key Agreement Schemes  Key Agreement keys,

Data

parameters

CO/User  Key Wrapping

Wrapping key, Key

Wrapped key

CO/User  Key Unwrapping

Unwrapping Key, Wrapped
key

Key

CO/User  Key Generation

Key Generation Parameters  Key Pair

CO/User  Key Verification

Key Pair

CO/User  Entropy Callback

CO/User  DRBG Health-Tests

CO/User  SSP Export Operation

CO/User  Utility

N/A

N/A

SSP

N/A

Boolean

Random bits

N/A

Data

N/A

Table 8 - Roles, Service Commands, Input and Output

4.2

Assumption of Roles

The module supports two distinct operator roles, User and Cryptographic Officer (CO). The
cryptographic module implicitly maps the two roles to the services. A user is considered the owner
of the thread that instantiates the module and, therefore, only one concurrent user is allowed.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 23 of 52
Public Material – May be reproduced only in its original entirety (without revision).

 Table 9 lists all operator roles supported by the module. The module does not support a
maintenance role and/or bypass capability. The module does not support authentication.

Role

CO

User

Authentication Method

Authentication Strength

N/A – Authentication not
required for Level 1

N/A – Authentication not
required for Level 1

N/A

N/A

Table 9 - Roles and Authentication

4.3

Services

Table 10 lists the services and a description of each service with the usage and roles.

Services in the module are accessed via the public APIs of the jar file. The ability of a thread to
invoke non-approved services depends on whether it has been registered with the module as
approved mode only. In approved only mode no non-approved services are accessible. In the
presence of a Java SecurityManager approved mode services specific to a context, such as DSA and
ECDSA for use in TLS, require specific permissions to be configured in the JVM configuration by
the Cryptographic Officer or User.

In the absence of a Java SecurityManager specific services related to protocols such as TLS are
available, however must only be used in relation to those protocols.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 24 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Service

  Description

Initialize Module
and Run Self-
Tests on Demand

The JRE will call the static
constructor for self-tests on
module initialization

Show Status

Info Service

Zeroize / Power-
off

A user can call
FipsStatus.IsReady() at any
time to determine if the
module is ready.
CryptoServicesRegistrar.IsIn
ApprovedOnlyMode() can be
called to determine the
approved mode of operation

A user can call
DumpInfo.main() at any time
to display the module
version, checksum, and status
information

SSPs can be zeroized on
demand by invoking the
destroy() method or power
cycle the module.

Approved
Security
Functions

N/A

N/A

Keys and/or SSPs

Roles

Access rights
to Keys and/or
SSPs

Indicator14

N/A

N/A

CO/User  N/A

Flag

CO/User  N/A

Flag

N/A

N/A

CO/User  N/A

Flag

N/A

All SSPs

CO/User

Z

Flag

14Flag is accessed by calling the method CryptoServicesRegistrar.isInApprovedOnlyMode() - this method will return true if the thread is running in approved mode, false otherwise.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 25 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Keys and/or SSPs

Roles

Access rights
to Keys and/or
SSPs

Indicator14

AES Encryption Key

CO/User

E

Flag

AES Decryption Key

CO/User

E

Flag

AES Authentication Key, HMAC
Authentication Key, KMAC
Authentication Key

DSA Signing Key, EC Signing
Key, RSA Signing Key

DSA Verification Key, EC
Verification Key, RSA Verification
Key

CO/User

E

CO/User

E

CO/User

E

Flag

Flag

Flag

Service

  Description

Data Encryption  Used to encrypt data

Data Decryption  Used to decrypt data

MAC Calculation  Used to calculate data

integrity codes with CMAC

Approved
Security
Functions

AES-ECB, AES-
CBC, AES-OFB,
AES-CFB8,
AES-CFB128,
AES-CTR, AES-
CBC-CS, CCM,
GCM, FF1

AES-ECB, AES-
CBC, AES-OFB,
AES-CFB8,
AES-CFB128,
AES-CTR, AES-
CBC-CS, CCM,
GCM, FF1
CMAC, GMAC

Signature
Authentication

Signature
Verification

Used to generate signatures
(DSA, ECDSA, RSA)

Used to verify digital
signatures

DSA, ECDSA,
RSA

DSA, ECDSA,
RSA

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 26 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Keys and/or SSPs

Roles

Access rights
to Keys and/or
SSPs

Indicator14

CO/User  G

Flag

AES Encryption Key, AES
Decryption Key, AES
Authentication Key, AES
Wrapping Key, DH Agreement
Private Key, DH Agreement
Public Key, DRBG Seed, Internal
State V and C value, and DRBG
Key, DSA Signing Key, DSA
Verification Key, EC Agreement
Private Key, EC Agreement Public
Key, EC Signing Key, EC
Verification Key, HMAC
Authentication Key, KMAC
Authentication Key, RSA Signing
Key, RSA Verification Key, RSA
Key Transport Private Key, RSA
Key Transport Public Key

DRBG Seed, Internal State V and
C value, and DRBG Key

CO/User

E

N/A

CO/User  N/A

Flag

Service

  Description

DRBG (SP800-
90Arev1) output

Used for random number, IV
and key generation

Approved
Security
Functions

Counter DRBG,
Hash DRBG,
HMAC DRBG

Message Hashing  Used to generate message

digest, SHAKE output

SHS, SHA-3,
SHAKE, SHA-3
Derived
Functions
(cSHAKE,
TupleHash,
ParallelHash)

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 27 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Service

  Description

Keyed Message
Hashing

Used to calculate data
integrity codes with HMAC
and KMAC

TLS Key
Derivation
Function

Used to calculate a value
suitable to be used for a
master secret in TLS

SP 800-108-rev1
KDF

Used to calculate a value
suitable to be used for a
secret key

SSH Derivation
Function

Used to calculate a value
suitable to be used for a
secret key

X9.63 Derivation
Function

Used to calculate a value
suitable to be used for a
secret key

Approved
Security
Functions
HMAC,
SHA-3 Derived
Functions
(KMAC)
HKDF, KDF,
Existing
Application-
Specific (TLS
KDF)

KBKDF,
using
Pseudorandom
Functions

Existing
Application-
Specific (SSH
KDF)

Existing
Application-
Specific (X9.63
KDF)

Keys and/or SSPs

Roles

Access rights
to Keys and/or
SSPs

Indicator14

HMAC Authentication Key,
KMAC Authentication Key

CO/User

E

Flag

TLS KDF Secret Value

CO/User

E

Flag

SP800-108-rev1 KDF Secret
Value

CO/User

E

Flag

SSH KDF Secret Value

CO/User

E

Flag

DH Agreement Private Key, EC
Agreement Private Key, RSA
Signing Key

CO/User  G

Flag

X9.63 KDF Secret Value

CO/User

E

SP 800-56C-rev2
OneStep/TwoStep
Key Derivation
Function (KDM)

Used to calculate a value
suitable to be used for a
secret key

HKDF, KDF One
Step, KDF Two
Step.

DH Agreement Private Key, EC
Agreement Private Key, RSA
Signing Key

CO/User  G

Flag

SP800-56C-rev2 KDF Secret
Value

CO/User

E

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 28 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Service

  Description

IKEv2 Derivation
Function

SRTP Derivation
Function

Used to calculate a value
suitable to be used for a
secret key

Used to calculate a value
suitable to be used for a
secret key

Approved
Security
Functions

Existing
Application-
Specific (IKEv2)

Existing
Application-
Specific (SRTP)

Keys and/or SSPs

Roles

Access rights
to Keys and/or
SSPs

Indicator14

IKEv2 KDF Secret Value

CO/User

E

SRTP KDF Secret Value

CO/User

E

Flag

Flag

Flag

PBKDF

Used to generate a key using
an encoding of a password
and message hash

KDF,
Password-
Based

HMAC Authentication Key,
KMAC Authentication Key

CO/User  G

Key Agreement
Schemes

Used to calculate key
agreement values (SP800-
56A-rev3, Diffie-Hellman)

KAS-FFC, KAS-
ECC, KAS-IFC,
SafePrimes

CO/User

E

CO/User  G

Flag

HMAC Authentication Key,
KMAC Authentication Key,
PBDKF Secret

AES Encryption Key, AES
Decryption Key, AES
Authentication Key, AES
Wrapping Key, HMAC
Authentication Key, KMAC
Authentication Key

DH Agreement Private Key, EC
Agreement Private Key, RSA Key
Transport Private Key

CO/User

E

Key Wrapping

Used to encrypt a key value
(RSA, AES)

AES KW, AES
KWP, KTS-IFC

AES Wrapping Key, HMAC
Authentication Key, KMAC
Authentication Key, RSA Key
Transport Private Key

CO/User

E

Flag

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 29 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Service

  Description

Key Unwrapping  Used to decrypt a key value

(RSA, AES)

Key Generation  Used to generate key pair

Approved
Security
Functions

AES KW, AES
KWP, KTS-IFC

RSA KeyGen,
DSA KeyGen,
ECDSA KeyGen,
CKG

Key Verification  Used to verify key pair

ECDSA KeyVer

Entropy Callback  Gathers entropy in a passive
manner from a user-provided
function

DRBG, CKG

Keys and/or SSPs

Roles

Access rights
to Keys and/or
SSPs

Indicator14

AES Wrapping Key, HMAC
Authentication Key, KMAC
Authentication Key, RSA Key
Transport Public Key

DRBG Output, DSA Signing Key,
EC Signing Key, RSA Signing
Key, DSA Verification Key, EC
Verification Key, RSA Verification
Key

EC Signing Key, EC Verification
Key

DRBG Seed, Internal State V and
C value, and DRBG Key

CO/User

E

Flag

CO/User

E

Flag

CO/User

E

CO/User  G

Flag

Flag

DRBG Health-
Tests

Used to perform checks of
incoming entropy against
Section 4.4 of SP800-90B

DRBG

N/A

CO/User  N/A

Flag

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 30 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Service

  Description

Approved
Security
Functions

Keys and/or SSPs

Roles

Access rights
to Keys and/or
SSPs

Indicator14

SSP Export
Operation

Returns a CSP as data that
can be used for later output

N/A

CO/User  R

Flag

AES Encryption Key, AES
Decryption Key, AES
Authentication Key, AES
Wrapping Key, DH Agreement
Private Key, DH Agreement
Public Key, DSA Signing Key,
DSA Verification Key, EC
Agreement Private Key, EC
Agreement Public Key, EC
Signing Key, EC Verification Key,
HMAC Authentication Key,
KMAC Authentication Key, RSA
Signing Key, RSA Verification
Key, RSA Key Transport Private
Key, RSA Key Transport Public
Key

Utility

Miscellaneous utility
functions, does not access
CSPs

N/A

N/A

CO/User  N/A

Flag

The modes of access shown in the table above are defined as:

•  G = Generate: The module generates or derives the SSP.

Table 10 - Approved Services

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 31 of 52
Public Material – May be reproduced only in its original entirety (without revision).

•  R = Read: The SSP is read from the module (e.g. the SSP is output).
•  E = Execute: The module uses the SSP in performing a cryptographic operation.
•  W = Write: The SSP is updated, imported, or written to the module.
•  Z = Zeroize: The module zeroizes the SSP.

Service

Description

Data Encryption

Data Decryption

MAC Calculation

DRBG (SP800-
90Arev1) output

Key Agreement
Schemes

Key Wrapping

Key Unwrapping

Used to encrypt
data

Used to decrypt
data

Used to calculate
data integrity
codes with
CMAC

Used for random
number, IV and
key generation

Used to calculate
key agreement
values

Used to encrypt a
key value (Triple-
DES)

Used to decrypt a
key value (Triple-
DES)

Algorithms
Accessed

Triple-DES

Role

Indicator15

CO/User

Flag

Triple-DES

CO/User

Flag

Triple-DES CMAC

CO/User

Flag

ctrDRBG-Triple-DES  CO/User

Flag

Triple-DES

CO/User

Flag

Triple-DES KW

CO/User

Flag

Triple-DES KW

CO/User

Flag

Table 11 - Non-Approved Services

Software/Firmware Security

5
The Module type is software. The module has a Multi-Chip Stand Alone embodiment; the
cryptographic boundary is the Java Archive (JAR) file, bc-fips-2.0.0.jar.

Each time the module is powered up, it runs the pre-operational tests to ensure that the integrity of
the module has been maintained. Self–tests are available on demand by power cycling the module.

The integrity is verified using HMAC-SHA2-256. The HMAC of the module JAR file excluding
directories and metadata is calculated and compared to the expected value embedded within the
module’s properties. If the calculated value does not match the expected value, the module raises an
error and fails to load. The integrity test can be performed on demand by power cycling the host
platform.

15Flag is accessed by calling the method CryptoServicesRegistrar.isInApprovedOnlyMode() - this method will return true if

the thread is running in approved mode, false otherwise.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 32 of 52
Public Material – May be reproduced only in its original entirety (without revision).

CASTs are preformed prior to the first use of services related to the test target. CASTs also run
periodically on service invocation. Initial CAST self–tests are available on demand by power
cycling the module and then invoking the service related to the test target.

Operational Environment

6
The module operates in a modifiable operational environment under the FIPS 140-3 definitions.
The module runs on a GPC running one of the operating systems specified in the approved
operational environment list in Table 2. Each approved operating system manages processes and
threads in a logically separated manner. The Module’s user is considered the owner of the calling
application that instantiates the Module within the process space of the Java Virtual Machine.
The module optionally uses the Java Security Manager and starts in approved mode by default
when used with the Java Security Manager.

6.1

Use of External RNG

The module makes use of the JVM's configured SecureRandom entropy source to provide entropy
when required. The module will request entropy as appropriate to the security strength and seeding
configuration for the DRBG that is using it and for the default DRBG will request a minimum of
256 bits of entropy. In approved mode the minimum amount of entropy that can be requested by a
DRBG is 112 bits. The module will wait until the SecureRandom.generateSeed() returns the
requested amount of entropy, blocking if necessary.

The JVMs entropy source can be configured through setting the security property:

securerandom.strongAlgorithms

in the JVM's java.security file.

6.2

Additional Enforcement with a Java SecurityManager

In the presence of a Java SecurityManager approved mode services specific to a context, such as
DSA and ECDSA for use in TLS, require specific policy permissions to be configured in the JVM
configuration by the Cryptographic Officer or User. The SecurityManager can also be used to
restrict the ability of particular code bases to examine CSPs. See Section 6.3 for further advice.

In the absence of a Java SecurityManager, specific services related to protocols such as TLS are
available, however must only be used in relation to those protocols.

6.3

Approved Mode Configuration

In default operation the module will start with all algorithms and services enabled.

If the module detects that the system property org.bouncycastle.fips.approved_only is set to true the
module will start in approved mode and non-approved mode functionality will not be available.

If the underlying JVM is running with a Java Security Manager installed the module will be running
in approved mode with secret and private key export disabled. When the module is not used within
the context of the Java Security Manager, it will start by default in the non-approved mode.

Use of the module with a Java Security manager requires the setting of some basic permissions to
allow the module HMAC-SHA-256 software integrity test to take place as well as to allow the

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 33 of 52
Public Material – May be reproduced only in its original entirety (without revision).

module itself to examine secret and private keys. The basic permissions required for the module to
operate correctly with a Java Security manager are indicated by a Y:

Available Java Permissions

Permission

Settings

Req  Usage

RuntimePermission

“getProtectionDomain”

RuntimePermission

“accessDeclaredMembers”

PropertyPermission

“java.runtime.name”, “read”

SecurityPermission

"putProviderProperty.BCFIPS"

CryptoServicesPermission

“unapprovedModeEnabled”

CryptoServicesPermission

“changeToApprovedModeEnabled”

CryptoServicesPermission

“exportSecretKey”

CryptoServicesPermission

“exportPrivateKey”

CryptoServicesPermission

“exportKeys”

CryptoServicesPermission

“tlsNullDigestEnabled”

CryptoServicesPermission

“tlsPKCS15KeyWrapEnabled”

CryptoServicesPermission

“tlsAlgorithmsEnabled”

CryptoServicesPermission

“defaultRandomConfig”

CryptoServicesPermission

“threadLocalConfig”

CryptoServicesPermission

“globalConfig”

Y

Y

N

N

N

N

N

N

Y

N

N

N

N

N

N

 Allows checksum to be
carried out on jar.

 Allows use of reflection
API within the provider.

 Only if configuration
properties are used.

 Only if provider installed
during execution.

 Only if non-approved
mode algorithms required.

Only if threads allowed to
change modes.

To allow export of secret
keys only.

To allow export of private
keys only.

Required to be applied for
the module itself. Optional
for any other codebase.

Only required for TLS
digest calculations.

Only required if TLS is
used with RSA encryption.

Enables both NullDigest
and PKCS15KeyWrap.

Allows setting of default
SecureRandom.

Required to set a thread
local property in the
CryptoServicesRegistrar

Required to set a global
property in the
CryptoServicesRegistrar.

The JVM's entropy source is checked according to SP 800-90B, Section 4.4 using the suggest C
values for the Repetition Count Test (Section 4.4.1) and the Adaptive Proportion Test (Section
4.4.2) by default. These values can also be configured by the Cryptographic Officer using the security
property: “org.bouncycastle.entropy.factors” which takes a comma separated list of C values, one
for 4.4.1 and one for 4.4.2, and a value of H.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 34 of 52
Public Material – May be reproduced only in its original entirety (without revision).

6.4

Guidance for the use of DRBGs and Configuring the JVM's Entropy Source

A user can instantiate the default Approved DRBG for the module explicitly by using
SecureRandom.getInstance("DEFAULT", "BCFIPS"), or by using a BouncyCastleFipsProvider
object instead of the provider name as appropriate. This will seed the Approved DRBG from the
live entropy source of the JVM with a number of bits of entropy appropriate to the security strength
of the default Approved DRBG configured for the module.

The JVM's entropy source is checked according to SP 800-90B, Section 4.4 using the suggest C
values for the Repetition Count Test (Section 4.4.1) and the Adaptive Proportion Test (Section
4.4.2). These values can also be configured by the user using the security property:
 “org.bouncycastle.entropy.factors” which takes a comma separated list of C values, one for 4.4.1
and one for 4.4.2, and a value of H. For the default the property would be set as:

org.bouncycastle.entropy.factors: 4, 13, 8.0

in the java.security property file.

An additional option is available using the Approved Hash_DRBG and the process outlined in SP-
800 90A, Section 8.6.5. This can be turned on by following the instructions in Section 2.3 of the
User Guide. The two DRBGs are instantiated in a chain as a "Source DRBG" to seed the "Target
DRBG" in accordance with Section 7 of Draft NIST SP 800-90C, where the Target DRBG is the
default Approved DRBG used by the module.

The initial seed and the subsequent reseeds for the DRBG chain come from the live entropy source
configured for the JVM. The DRBG chain will reseed automatically by pausing for 20 requests
(which will usually equate to 5120 bytes). An entropy gathering thread reseeds the DRBG chain
when it has gathered sufficient entropy (currently 256 bits) from the live entropy source. Once
reseeded, the request counter is reset and the reseed process begins again.

The “Source DRBG” in the chain is internal to the module and inaccessible to the user to ensure it
is only used for generating seeds for the default Approved DRBG of the module.

The user shall ensure that the entropy source is configured per Section 6.1 of this Security Policy
and will block, or fail, if it is unable to provide the amount of entropy requested.

Physical Security

7
This section is not applicable as the module is a software module.

Non-Invasive Security
8
This section is not applicable to this module.

Sensitive Security Parameter Management

9
All Sensitive Security Parameters (SSPs) used by the Module are described in this section in Table
12. All usage of these SSPs by the Module (including all SSP lifecycle states) is described in the
services detailed in Section 24. Please note that the module does not perform automatic SSP
establishment, it only provides the components to the calling application which can be used in SSP
establishment.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 35 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Key/SSP
Name/Type

Strength

AES
Encryption
Key

128, 192, 256
bits

AES
Decryption
Key

128, 192, 256
bits

Security
Function and
Cert. Number

AES ECB,
CBC, OFB,
CFB8,
CFB128, CTR,
FF1, CBC-
CS1, CBC-
CS2, CBC-
CS3, GCM,
CKG
A4399

AES ECB,
CBC, OFB,
CFB8,
CFB128, CTR,
FF1, CBC-
CS1, CBC-
CS2, CBC-
CS3, GCM,
CKG
A4399

Generation

Import/
Export

Establishment  Storage

Zeroisation

DRBG16

Import17,
Export18

N/A

DRBG16

Import17,
Export18

N/A

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

Use & related
keys

AES
encryption19

destroy() service
call or host
platform power
cycle

AES decryption

destroy() service
call or host
platform power
cycle

16 Key generator used in conjunction with an approved DRBG.
17Import done via key constructor and/or factory (Electronic Entry).
18Export done via key recovery using getEncoded() method and followed by separate step to export key details as either plaintext or encrypted (Electronic Entry).
19The AES-GCM key and IV is generated randomly per IG C.H, and the Initialization Vector (IV) is a minimum of 96 bits. In the event module power is lost and restored, the

consuming application must ensure that any of its AES-GCM keys used for encryption or decryption are re-distributed.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 36 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Key/SSP
Name/Type

Strength

AES
Authentication
Key

128, 192, 256
bits

Security
Function and
Cert. Number
AES CMAC,
GMAC, CKG
A4399

DRBG16

Import17,
Export18

N/A

Generation

Import/
Export

Establishment  Storage

Zeroisation

AES Wrapping
Key

128, 192, 256
bits

AES KW,
KWP, CKG
A4399

DRBG16

Import17,
Export18

N/A

DH Agreement
Private Key

112, 128, 152,
176, 200 bits

DH Agreement
Public Key

112, 128, 152,
176, 200 bits

KAS-FFC,
CKG
A4399

KAS-FFC,
CKG
A4399

DRBG16

Import17,
Export18

N/A

DRBG16

Import17,
Export18

N/A

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 37 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Use & related
keys

 AES
CMAC/GMAC

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

 AES
(128/192/256)
key wrapping
key for KTS

destroy() service
call or host
platform power
cycle

Diffie-Hellman
key agreement

Not zeroized,
public key value
known outside of
module

Diffie-Hellman
key agreement

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

Generation

Import/
Export

Establishment  Storage

Zeroisation

Key/SSP
Name/Type

Strength

DSA Signing
Key

112, 128 bits

DSA
Verification
Key

80, 112, 128
bits

Security
Function and
Cert. Number

DSA Signature
Generation,
CKG
A4399

DSA Signature
Verification,
CKG
A4399

DRBG16

Import17,
Export18

N/A

DRBG16

Import17,
Export18

N/A

EC Agreement
Private Key

112, 128, 192,
256 bits

KAS-ECC,
CKG
A4399

DRBG16

Import17,
Export18

N/A

EC Agreement
Public Key

112, 128, 192,
256 bits

KAS-ECC,
CKG
A4399

DRBG16

Import17,
Export18

N/A

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 38 of 52
Public Material – May be reproduced only in its original entirety (without revision).

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

Use & related
keys

DSA signature
generation

destroy() service
call or host
platform power
cycle

Not zeroized,
public key value
known outside of
module

DSA signature
verification

destroy() service
call or host
platform power
cycle

Not zeroized,
public key value
known outside of
module

EC (P-224, P-
256, P-384, P-
521, K-233, K-
283, K-409, K-
571, B-233, B-
283, B-409 and
B-571) key
agreement

EC (P-224, P-
256, P-384, P-
521, K-233, K-
283, K-409, K-
571, B-233, B-
283, B-409 and
B-571) key
agreement

Generation

Import/
Export

Establishment  Storage

Zeroisation

Key/SSP
Name/Type

Strength

EC Signing
Key

112, 128, 192,
256 bits

EC
Verification
Key

80, 112, 128,
192, 256 bits

Security
Function and
Cert. Number

ECDSA
Signature
Generation,
CKG
A4399

ECDSA
Signature
Verification,
CKG
A4399

DRBG16

Import17,
Export18

N/A

DRBG16

Import17,
Export18

N/A

112-256 bits

HMAC/KMA
C
Authentication
Key

SHA-1, SHA2,
SHA3,
KMAC, CKG
A4399

DRBG16

Import17,
Export18

N/A

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 39 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Use & related
keys

ECDSA (P-224,
P-256, P-384,
P-521, K-233,
K-283, K-409,
K-571, B-233,
B-283, B-409
and B-571)
signature
generation.

ECDSA (P-192,
P-224, P-256,
P-384, P-521,
K-163, K-233,
K-283, K-409,
K-571, B-163,
B-233, B-283,
B-409 and B-
571) signature
verification.

 Keyed-Hash
calculation
(SHA-1, SHA-
2, SHA-3,
KMAC).

destroy() service
call or host
platform power
cycle

Not zeroized,
public key value
known outside of
module

destroy() service
call or host
platform power
cycle

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage

Generation

Import/
Export

Establishment  Storage

Zeroisation

Key/SSP
Name/Type

Strength

RSA Signing
Key

112, 128, 152
bits

RSA
Verification
Key

80, 112, 128,
152 bits

Security
Function and
Cert. Number
RSA Signature
Generation,
CKG
A4399

RSA Signature
Verification,
CKG
A4399

DRBG16

Import17,
Export18

N/A

DRBG16

Import17,
Export18

N/A

RSA Key
Transport
Private Key20

112, 128, 152
bits

KTS-IFC,
CKG
A4399

DRBG16

Import17,
Export18

N/A

RSA Key
Transport
Public Key20

112, 128, 152
bits

KTS-IFC,
CKG
A4399

DRBG16

Import17,
Export18

N/A

20RSA key transport using PKCS#1 1.5 padding is deprecated through 2023 and disallowed after 2023.
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 40 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Use & related
keys

RSA signature
generation

RSA signature
verification

destroy() service
call or host
platform power
cycle

Not zeroized,
public key value
known outside of
module

destroy() service
call or host
platform power
cycle

 RSA key
transport and
decryption

 RSA key
transport

Not zeroized,
public key value
known outside of
module

N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage

Key/SSP
Name/Type

Strength

IKEv2 KDF
Secret Value

112, 128, 192,
256 bits

Security
Function and
Cert. Number
KDF IKEv2
A4399

PBKDF Secret
Value

112-256 bits

PBKDF
A4399

SP 800-56C-
rev2
OneStep/TwoS
tep KDF
Secret Value

SP 800-108-
rev1 KDF
Secret Value

112, 128, 192,
256 bits

112, 128, 192,
256 bits

KDA OneStep
SP800-56Cr2
KDA TwoStep
SP800-56Cr2
A4399

KDF SP800-
108
A4399

SRTP KDF
Secret Value

128, 192, 256
bits

KDF SRTP
A4399

Generation

Import/
Export

Establishment  Storage

Zeroisation

N/A

N/A

N/A

N/A

N/A

N/A

N/A

N/A

N/A

N/A

Generated
as output of
an IKEv2
agreement
scheme

Generated
as output of
a PBE key
and a PRF

Generated
as output of
an
agreement
scheme

Generated
as output of
an
agreement
scheme

Generated
as output of
an SRTP
agreement
scheme

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage

Use & related
keys

Key Derivation

Key Derivation

Key Derivation

Key Derivation

Key Derivation

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 41 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Key/SSP
Name/Type

Strength

SSH KDF
Secret Value

80, 112, 128,
192, 256 bits

Security
Function and
Cert. Number
KDF SSH
A4399

TLS Premaster
Secret Value

384 bits

KDF TLS
A4399

TLS KDF
Secret Value

112, 128, 192,
256 bits

KDF TLS
A4399

X9.63 KDF
Secret Value

112, 128, 192,
256 bits

KDF ANS 9.63
A4399

Entropy Input
String

>128 bits

N/A

N/A

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 42 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Generation

Import/
Export

Establishment  Storage

Zeroisation

Generated
as output of
an SSH
agreement
scheme

Protocol
version (2
bytes) and
46 bytes
from a
DRBG16

Generated
as output of
TLS
agreement
scheme

Generated
as output of
an
agreement
scheme

N/A

N/A

Import17,
Export18

N/A

N/A

N/A

N/A

N/A

N/A

Obtained
from the
entropy
source

N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage

N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage

Use & related
keys

Key Derivation

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

Used to derive
keys using TLS
KDF

Key Derivation

Key Derivation

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

Random
Number
Generation

Key/SSP
Name/Type

Strength

CTR DRBG
Seed

128, 192, 256
bits

Security
Function and
Cert. Number
N/A

N/A

N/A

Obtained
from the
entropy
source

Generation

Import/
Export

Establishment  Storage

Zeroisation

CTR DRBG V
Value

128 bits

N/A

From seed
value

N/A

N/A

CTR DRBG
Key

128, 192, 256
bits

N/A

N/A

N/A

From
DRBG V
value

Hash DRBG
Seed

112, 128, 192,
256 bits

N/A

N/A

N/A

From
external
entropy
source

Hash DRBG V
Value

112, 128, 192,
256 bits

N/A

From seed
value

N/A

N/A

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 43 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Use & related
keys

Internal use

Internal use

Internal use

Internal use

Internal use

Immediately
after use or host
platform power
cycle

reseed() service
call or host
platform power
cycle

reseed() service
call or host
platform power
cycle

Immediately
after use or host
platform power
cycle

reseed() service
call or host
platform power
cycle

N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage

Key/SSP
Name/Type

Strength

Hash DRBG C
Value

112, 128, 192,
256 bits

Security
Function and
Cert. Number
N/A

N/A

N/A

From
DRBG V
value

Generation

Import/
Export

Establishment  Storage

Zeroisation

HMAC DRBG
Seed

112, 128, 192,
256 bits

N/A

N/A

N/A

From
external
entropy
source

HMAC DRBG
V Value

112, 128, 192,
256 bits

N/A

From seed
value

N/A

N/A

HMAC DRBG
Key

112, 128, 192,
256 bits

N/A

N/A

N/A

From
DRBG V
value

DRBG Output

128, 192, 256
bits

N/A

DRBG

N/A

N/A

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 44 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Use & related
keys

Internal use

Internal use

Internal use

Internal use

reseed() service
call or host
platform power
cycle

Immediately
after use or host
platform power
cycle

reseed() service
call or host
platform power
cycle

reseed() service
call or host
platform power
cycle

destroy() service
call or host
platform power
cycle

Used as seed
for asymmetric
key generation
or for
symmetric key
generation

N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage
N/A, the
module
does not
provide
persistent
storage

Table 12 - SSPs

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 45 of 52
Public Material – May be reproduced only in its original entirety (without revision).

9.1

RBG Entropy Sources

The module’s use of Non-Deterministic Random Number Generators is determined by the settings
described in Section 6.1.

Entropy sources

Minimum number of bits of
entropy

Details

Passive Entropy

128

As per FIPS 140-3 IG 9.3.A Section 2b, a
minimum of 16 bytes is required from the
source configured for seed generation for the
JVM. The entropy reader will block until the
seed generator has provided the minimum
number of bytes.

Table 13 - Non-Deterministic Random Number Generation Specification

10  Self-Tests
CASTs are performed prior to the first use of services related to the test target. CASTs also run
periodically on service invocation. Initial CAST self–tests are available on demand by power
cycling the module and then invoking the service related to the test target.

10.1  Pre-Operational Self-Tests

Each time the module is powered up, it performs the pre-operational self-tests to confirm that
sensitive data have not been damaged. The pre-operational tests include the Software Integrity test,
which verifies the module using HMAC-SHA2-256, and the HMAC and SHS Conditional
Cryptographic Algorithm Self-Tests (CAST) which are run prior to the Software Integrity test to
ensure the correctness of the HMAC used. Pre-operational self–tests are available on demand by
power cycling the module.

10.2  Conditional Self-Tests

The module performs conditional self-tests when the conditions specified for cryptographic
algorithm self-test and pair-wise consistency tests occur. Below are the self-tests implemented:

Conditional Cryptographic Algorithm Self-Test:
•  AES-ECB Encryption KAT (128 bits)
•  AES-ECB Decryption KAT (128 bits)
•  AES-CCM Encryption KAT (128 bits)
•  AES-CCM Decryption KAT (128 bits)
•  AES-CMAC Generation KAT (128 bits)
•  AES-CMAC Verification KAT (128 bits)
•  KAS-ECC Primitive “Z” Computation KAT (P-256, B-233)
•  KAS-FFC Primitive “Z” Computation KAT (ffdhe2048)
•  HASH_DRBG SHA2-256 KAT (Health Tests: Generate, Reseed, Instantiate functions per

Section 11.3 of SP800-90Arev1)

•  HMAC-DRBG HMAC-SHA2-256 KAT (Health Tests: Generate, Reseed, Instantiate

functions per Section 11.3 of SP800-90Arev1)

•  CTR_DRBG AES-CTR 256 bits KAT (Health Tests: Generate, Reseed, Instantiate functions

per Section 11.3 of SP800-90Arev1)

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 46 of 52
Public Material – May be reproduced only in its original entirety (without revision).

•  DSA Signature Generation KAT (2048 bits)
•  DSA Signature Verification KAT (2048 bits)
•  ECDSA Signature Generation KAT (P-256)
•  ECSDA Signature Verification KAT (P-256)
•  AES-GCM Encrypt KAT (128 bits)
•  AES-GCM Decrypt KAT (128 bits)
•  HMAC-SHA2-256 KAT
•  HMAC-SHA2-512 KAT
•  HMAC-SHA3-256 KAT
•  KDA OneStep KAT
•  KDA TwoStep KAT
•  KBKDF KAT (Counter, Feedback, Double Pipeline)
•  PBKDF KAT (HMAC-SHA2-256)
•  SHA-3 KAT (cSHAKE-128)
•  RSA Signature Generation KAT (2048 bits)
•  RSA Signature Verification KAT (2048 bits)
•  RSA Encryption KAT SP800-56Brev2 (2048 bits)
•  RSA Decryption KAT SP800-56Brev2 (2048 bits)
•  SHA-1 KAT
•  SHA2-256 KAT
•  SHA2-512 KAT
•  SHAKE256 KAT
•  ANS 9.63 KDF KAT
•
IKEv2 KDF KAT
•  SNMP KDF KAT
•  SRTP KDF KAT
•  SSH KDF KAT
•  TLS 1.0 KDF KAT
•  TLS 1.1 KDF KAT
•  TLS 1.2 KDF KAT

Conditional Pair-wise Consistency Tests:
•  DH pair-wise consistency test
•  DSA pair-wise consistency test
•  EC DH pair-wise consistency test
•  ECDSA pair-wise consistency test
•  RSA pair-wise consistency test

10.3  Error Handling

If any of the above-mentioned self-tests fail, the module enters an error state called “Hard Error”
state. Upon entering the error state, the module outputs status by way of an exception. An example
exception for AES Encryption failure is mentioned below:

“Failed self-test on encryption: AES”

The module can be recovered by power cycling the module which results in execution of pre-
operational self-tests and conditional cryptographic algorithm self-tests. If the tests pass, then the
module will be available for use.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 47 of 52
Public Material – May be reproduced only in its original entirety (without revision).

11  Life-Cycle Assurance
Vulnerabilities found in the module will be reported on the National Vulnerability Database, located
at https://nvd.nist.gov/.

Researchers and users are encouraged to report any security related concerns to feedback-
crypto@bouncycastle.org. A PGP public key can be provided if confidentiality is required around
the report.

Please find the procedures for secure installation, initialization, startup and operation of the module:

The module exists as part of the running JVM as such:

•  Secure installation of the module requires the use of the unchanged jar to loaded into a JVM

via either the class-path or the module-path as appropriate to the JVM and its usage.

•

Initialization of the module will occur on startup of the module by the JVM. The user can
trigger initialization by attempting to invoke any service in the module or simply calling
FipsStatus.isReady() which will only return true if the module has been successfully
initialized.

•  Once the JVM has loaded the module and the module has been initialized, the startup phase

can be over, and the module is able to provide services.

•  Operation of the module consists of calling the various APIs providing services, the module
code will make use of the current thread for doing any required CASTs and health tests and
then provide a service object to the user capable of performing the requested service.

BC-FJA 2.0.0 User guide can be downloaded here: https://downloads.bouncycastle.org/fips-
java/BC-FJA-UserGuide-2.0.0.pdf

12  Mitigation of Other Attacks
The Module implements basic protections to mitigate against timing-based attacks against its
internal implementations. There are two countermeasures used.

The first is Constant Time Comparisons, which protect the digest and integrity algorithms by
strictly avoiding “fast fail” comparison of MACs, signatures, and digests so the time taken to
compare a MAC, signature, or digest is constant regardless of whether the comparison passes or
fails.

The second is made up of Numeric Blinding and decryption/signing verification which both protect
the RSA algorithm.

Numeric Blinding prevents timing attacks against RSA decryption and signing by providing a
random input into the operation which is subsequently eliminated when the result is produced. The
random input makes it impossible for a third party observing the private key operation to attempt a
timing attack on the operation as they do not have knowledge of the random input and consequently
the time taken for the operation tells them nothing about the private value of the RSA key.

Decryption/signing verification is carried out by calculating a primitive encryption or signature
verification operation after a corresponding decryption or signing operation before the result of the
decryption or signing operation is returned. The purpose of this is to protect against Lenstra's CRT
attack by verifying the correctness the private key calculations involved. Lenstra's CRT attack takes
Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 48 of 52
Public Material – May be reproduced only in its original entirety (without revision).

advantage of undetected errors in the use of RSA private keys with CRT values and, if exploitable,
can be used to discover the private value of the RSA key.

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 49 of 52
Public Material – May be reproduced only in its original entirety (without revision).

Appendix: References and Definitions

The following standards are referred to in this Security Policy.

ANSI X9.31

FIPS 140-3

FIPS 180-4

FIPS 186-3

FIPS 186-4

FIPS 197

FIPS 198-1

FIPS 202

IG

X9.31-1998, Digital Signatures using Reversible Public Key Cryptography for the
Financial Services Industry (rDSA), September 9, 1998

Security Requirements for Cryptographic modules, March 22, 2019

Secure Hash Standard (SHS)

Digital Signature Standard (DSS)

Digital Signature Standard (DSS)

Advanced Encryption Standard

The Keyed-Hash Message Authentication Code (HMAC)

SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions

Implementation Guidance for FIPS PUB 140-3 and the Cryptographic Module
Validation Program

PKCS#1 v2.1

RSA Cryptography Standard

PKCS#5

Password-Based Cryptography Standard

PKCS#12

SP 800-38A

SP 800-38B

SP 800-38C

SP 800-38D

Personal Information Exchange Syntax StandardRecommendation for the Triple Data
Encryption Algorithm (TDEA) Block Cipher

Recommendation for Block Cipher Modes of Operation: Three Variants of Ciphertext
Stealing for CBC Mode

Recommendation for Block Cipher Modes of Operation: The CMAC Mode for
Authentication

Recommendation for Block Cipher Modes of Operation: The CCM Mode for
Authentication and Confidentiality

Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode
(GCM) and GMAC

SP 800-38F

Recommendation for Block Cipher Modes of Operation: Methods for Key Wrapping

SP 800-38G

Recommendation for Block Cipher Modes of Operation: Methods for Format-
Preserving Encryption

SP 800-56A-rev3

Recommendation for Pair-Wise Key Establishment Schemes Using Discrete
Logarithm Cryptography

SP 800-56B-rev2

Recommendation for Pair-Wise Key Establishment Schemes Using Integer
Factorization Cryptography

SP 800-56C-rev2

Recommendation for Key Derivation through Extraction-then-Expansion

SP 800-67-rev2

Recommendation for the Triple Data Encryption Algorithm (TDEA) Block Cipher

SP 800-89

Recommendation for Obtaining Assurances for Digital Signature Applications

SP 800-90A

SP 800-90B

Recommendation for Random Number Generation Using Deterministic Random Bit
Generators

Recommendation for the Entropy Sources Used for Random Bit Generation

SP 800-108-rev1

Recommendation for Key Derivation Using Pseudorandom Functions

SP 800-132

Recommendation for Password-Based Key Derivation

SP 800-133-rev2

Recommendation for Cryptographic Key Generation

SP 800-135-rev1

Recommendation for Existing Application – Specific Key Derivation Functions

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 50 of 52
Public Material – May be reproduced only in its original entirety (without revision).

The following are acronyms used in this Security Policy:

AES

API

BC

Advanced Encryption Standard

Application Programming Interface

Bouncy Castle

BC-FJA

Bouncy Castle FIPS Java API

CBC

CCM

CDH

CFB

CMAC

CMVP

CO

CPU

CS

CSP

CTR

CVL

DES

DH

DRAM

DRBG

DSA

Cipher-Block Chaining

Counter with CBC-MAC

Computational Diffie-Hellman

Cipher Feedback Mode

Cipher-based Message Authentication Code

Crypto Module Validation Program

Cryptographic Officer

Central Processing Unit

Ciphertext Stealing

Critical Security Parameter

Counter-mode

Component Validation List

Data Encryption Standard

Diffie-Hellman

Dynamic Random Access Memory

Deterministic Random Bit Generator

Digital Signature Authority

DSTU4145

Ukrainian DSTU-4145-2002 Elliptic Curve Scheme

EC

ECB

ECC

ECDSA

EdDSA

EMC

EMI

FIPS

GCM

GMAC

GOST

GPC

HMAC

IG

JAR

JCA

JCE

Elliptic Curve

Electronic Code Book

Elliptic Curve Cryptography

Elliptic Curve Digital Signature Authority

Edwards Curve DSA using Ed25519, Ed448

Electromagnetic Compatibility

Electromagnetic Interference

Federal Information Processing Standards

Galois/Counter Mode

Galois Message Authentication Code

Gosudarstvennyi Standard Soyuza SSR/Government Standard of the Union of Soviet Socialist
Republics

General Purpose Computer

key-Hashed Message Authentication Code

See References

Java ARchive

Java Cryptography Architecture

Java Cryptography Extension

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 51 of 52
Public Material – May be reproduced only in its original entirety (without revision).

JDK

JRE

JVM

IV

KAS

KAT

KDF

KW

KWP

KMAC

MAC

MD5

N/A

OCB

OFB

OS

PBKDF

PKCS

PQG

RC

Java Development Kit

Java Runtime Environment

Java Virtual Machine
Initialization Vector
Key Agreement Scheme

Known Answer Test

Key Derivation Function

Key Wrap

Key Wrap with Padding

KECCAK Message  Authentication  Code

Message Authentication Code

Message Digest algorithm MD5

Non Applicable

Offset Codebook Mode

Output Feedback

Operating System

Password-Based Key Derivation Function

Public Key Cryptography Standards

Diffie-Hellman Parameters P, Q and G

Rivest Cipher, Ron’s Code

RIPEMD

RACE Integrity Primitives Evaluation Message Digest

RSA

SHA

SSP

TCBC

TCFB

TDEA

TDES

TECB

TOFB

TLS

USB

XDH

XOF

Rivest Shamir Adleman

Secure Hash Algorithm

Sensitive Security Parameter

TDEA Cipher-Block Chaining

TDEA Cipher Feedback Mode

Triple Data Encryption Algorithm

Triple Data Encryption Standard

TDEA Electronic Codebook

TDEA Output Feedback

Transport Layer Security

Universal Serial Bus

Edwards Curve Diffie-Hellman using X25519, X448

Extendable-Output Function

Copyright Legion of the Bouncy Castle Inc. 2024, Date 13th June 2024 l Page 52 of 52
Public Material – May be reproduced only in its original entirety (without revision).

