nShield 5s Hardware Security
Module
FIPS 140-3 Level 3 non-proprietary Security Policy

``

Version: 2.0.4

Date: 17/12/2024

Copyright © 2020 nCipher Security Limited. All rights reserved.

Copyright in this document is property of nCipher Security Limited. This document may be reproduced and
distributed in whole (i.e., without modification) provided that the copyright notice and Entrust branding has
not been removed or altered. Words and logos marked with ® or ™ are trademarks of nCipher Security Limited
or its affiliates in the EU and other countries.

Mac and OS X are trademarks of Apple Inc., registered in the U.S. and other countries.

Microsoft and Windows are either registered trademarks or trademarks of Microsoft Corporation in the United
States and/or other countries.

Linux® is the registered trademark of Linus Torvalds in the U.S. and other countries.

Information in this document is subject to change without notice.

nCipher Security Limited makes no warranty of any kind with regard to this information, including, but not
limited to, the implied warranties of merchantability and fitness for a particular purpose. nCipher Security
Limited shall not be liable for errors contained herein or for incidental or consequential damages concerned
with the furnishing, performance or use of this material.

Where translations have been made in this document English is the canonical language.

nCipher Security Limited
Registered Office: One Station Square,
Cambridge, CB1 2GA, United Kingdom
Registered in England No. 11673268

nCipher is an Entrust company.

Entrust, Datacard, and the Hexagon Logo are trademarks, registered trademarks, and/or service marks of
Entrust Corporation in the U.S. and/or other countries. All other brand or product names are the property of
their respective owners. Because we are continuously improving our products and services, Entrust
Corporation reserves the right to change specifications without prior notice. Entrust is an equal opportunity
employer.

2 of 44

nShield 5s Hardware Security Module

Contents

1  General............................................................................................................................................... 4

2  Cryptographic module specification .................................................................................................. 5

2.1  Scope .......................................................................................................................................... 5

2.2  Cryptographic module description ............................................................................................ 5

2.3  Supported cryptographic algorithms ......................................................................................... 6

3  Cryptographic module interfaces .................................................................................................... 11

4  Roles, services and authentication .................................................................................................. 12

4.1  Roles ......................................................................................................................................... 12

4.2  Services .................................................................................................................................... 13

5  Software/Firmware security ............................................................................................................ 25

6  Operational environment ................................................................................................................ 26

7  Physical security ............................................................................................................................... 27

8  Non-invasive security ....................................................................................................................... 28

9  Sensitive security parameters management ................................................................................... 29

9.1  Keys and Sensitive Security Parameters .................................................................................. 29

9.2  SSP zeroization methods .......................................................................................................... 35

9.3  Entropy sources ........................................................................................................................ 35

10 Self tests ........................................................................................................................................... 36

10.1 Pre-operational self tests ......................................................................................................... 36

10.2 Conditional self tests ................................................................................................................ 36

10.3 Periodic self tests ..................................................................................................................... 38

11 Life-cycle assurance ......................................................................................................................... 39

11.1 Delivery .................................................................................................................................... 39

11.2 Cryptographic module identification ....................................................................................... 39

11.3 Approved mode of operation .................................................................................................. 41

11.4 End of life ................................................................................................................................. 41

12 Mitigation of other attacks .............................................................................................................. 42

Contact Us ............................................................................................................................................. 43

nShield 5s Hardware Security Module

3 of 44

1  General

This document defines the non-proprietary Security Policy enforced by the nShield 5s Hardware
Security Module, i.e. the Cryptographic Module, to meet with the security requirements in FIPS 140-
3 and ISO/IEC 19790.

The Cryptographic Module meets overall FIPS 140-3 Security Level 3. The following table specifies
the security level in detail.

ISO/IEC 24759 Section 6.

FIPS 140-3 Section Title

Security Level

[Number Below]

1

2

3

4

5

6

7

8

9

10

11

12

Table 1 Security levels

General

Cryptographic Module Specification

Cryptographic Module Interfaces

Roles, Services and Authentication

Software/Firmware security

Operational Environment

Physical Security

Non-invasive Security

Sensitive Security Parameter Management

Self-Tests

Life-cycle Assurance

Mitigation of Other Attacks

3

3

3

3

3

N/A

3

N/A

3

3

3

N/A

4 of 44

nShield 5s Hardware Security Module

2  Cryptographic module specification

2.1  Scope
The following product hardware variants and firmware version(s) are in scope of this Security Policy.

Model

Hardware

Firmware Version  Distinguishing Features

[Part Number and
Version]

PCB Assembly Part
Number: PCA10005-01

PCB Assembly Revision:
03, 04

nShield 5s F3

model number nC5536E

nShield 5s for nShield 5c
and for nShield HSMi

model number nC5536N

primary: 13.4.5

PCIe form factor

recovery: 13.2.4

uboot: 1.1.0, 1.4.1

PCIe form factor identical to the nShield 5s F3 (nC5536E),
embedded inside the nShield 5c or the nShield HSMi network
appliances.

Table 2 Cryptographic Module Tested Configuration

2.2  Cryptographic module description
The nShield 5s Hardware Security Module (HSM) is a multi-chip embedded hardware Cryptographic
Module as defined in FIPS 140-3, which comes in a PCI express board form factor protected by a
tamper resistant enclosure, and performs encryption, digital signing, and key management on behalf
of an extensive range of commercial and custom-built applications including public key
infrastructures (PKIs), identity management systems, application-level encryption and tokenization,
SSL/TLS, and code signing.

The nShield 5s HSM is also embedded inside the nShield 5c or the nShield HSMi, which are network-
attached appliances delivering cryptographic services as a shared network resource for distributed
applications and virtual machines, giving organizations a highly secure solution for establishing
physical and logical controls for server-based systems.

The table below shows the nShield 5s HSM (left, representative of the two hardware variants
nC5536E, nC5536N) and the nShield 5c appliance (right).

Table 3 nShield 5s (left) and nShield 5c (right)

The cryptographic boundary is delimited in red in the images in the table below. It is delimited by
the heat sink and the outer edge of the potting material on the top and bottom of the PCB.

nShield 5s Hardware Security Module

5 of 44

Table 4 Cryptographic module boundary

The module enforces that only approved services are available and plaintext import/export of secret
or private keys is not allowed. Refer to Approved mode of operation.

2.3  Supported cryptographic algorithms

This section describes the cryptographic mechanisms and security functions provided and used by
the cryptographic module.

2.3.1  Approved algorithms

The following tables describe the approved cryptographic algorithms supported by the
Cryptographic Module.

2.3.1.1  nCore crypto

CAVP
Cert

Algorithm and
Standard

Mode/Method

Description / Key Size(s) / Key
Strength(s)

Use / Function

A3707

AES

[FIPS 197] [SP
800-38A] [SP
800-38D]

A3707

KTS (AES)

[SP 800-38F] [SP
800-38D]

ECB

CBC

GCM

KW

KWP

GCM

A3707

KTS-IFC

KTS-OAEP-basic with

SHA2-224, SHA2-256, SHA2-384, SHA2-512,
SHA3-224, SHA3-256, SHA3-384, SHA3-512

Data encryption/decryption

Key wrapping/unwrapping

Key transport
(encapsulation, un-
encapsulation)

128 bits

192 bits

256 bits

128 bits

192 bits

256 bits

(Key establishment
methodology provides
between 128 and 256 bits of
encryption strength)

2048 bits

3072 bits

4096 bits

(Key establishment
methodology provides
between 112 and 152 bits of
encryption strength)

Vendor
affirmed

CKG

[SP 800-133rev2]

Section 4 “Using the Output of a Random Bit
Generator “

n/a

Key generation

A3707

RSA

RSASSA-PKCS-v1_5

1024 bits (verification only)

Key generation

6 of 44

nShield 5s Hardware Security Module

CAVP
Cert

Algorithm and
Standard

Mode/Method

Description / Key Size(s) / Key
Strength(s)

Use / Function

[FIPS 186-4]

RSASSA-PSS

A3707

ECDSA

n/a

[FIPS 186-4]

A3707

DSA

n/a

[FIPS 186-4]

A3707

HMAC

[FIPS 198]

HMAC-SHA1, HMAC-SHA2-224, HMAC-SHA2-
256, HMAC-SHA2-384, HMAC-SHA2-512,
HMAC-SHA3-224, HMAC-SHA3-256, HMAC-
SHA3-384, HMAC-SHA3-512

A3707

AES

CMAC

[SP 800-38B]

A3707

KMAC

KMAC-128

[SP 800-185]

KMAC-256

A3707

KAS-FFC

DH

[SP 800-
56Arev3]

A3707

Safe Primes Key
Generation

KeyGen for KAS-FFC

[SP 800-
56Arev3]

A3707

Safe Primes Key
Verification

KeyVer for KAS-FFC

2048 bits

3072 bits

4096 bits

NIST P-224, P-256, P-384, P-
521

NIST K-233, K-283, K-409, K-
571

NIST B-233, B-283, B-409, B-
571

L = 1024 bits, N = 160 bits
(verification only)

L = 2048 bits, N = 224 bits

L = 2048 bits, N = 256 bits

L = 3072 bits, N = 256 bits

≥ 112 bits

Signature generation and
verification

Key generation

Key verification

Signature generation and
verification

Key generation

Signature generation and
verification

Domain parameter
generation and verification

MAC generation and
verification

MAC generation and
verification

MAC generation and
verification

Key agreement

128 bits

192 bits

256 bits

≥ 112 bits

MODP-2048

MODP-3072

MODP-4096

MODP-6144

MODP-8192

FB

FC

(Key establishment
methodology provides
between 112 and 200 bits of
encryption strength)

Safe prime groups: MODP-
2048, MODP-3072, MODP-
4096, MODP-6144, MODP-
8192

(Provides between 112 and
200 bits of encryption
strength.)

Safe prime groups: MODP-
2048, MODP-3072, MODP-
4096, MODP-6144, MODP-
8192

KAS-FFC key generation

KAS-FFC key verification

nShield 5s Hardware Security Module

7 of 44

CAVP
Cert

Algorithm and
Standard

Mode/Method

Description / Key Size(s) / Key
Strength(s)

Use / Function

[SP 800-
56Arev3]

A3707

KAS-ECC

ECDH

[SP 800-
56Arev3]

ECMQV

A3707

KBKDF

counter mode

[SP 800-108rev1]

CMAC-AES256

A3707

SHS

SHA-1

[FIPS 180-4]

SHA2-224

SHA2-256

SHA2-384

SHA2-512

Key agreement

NIST P-224, P-256, P-384, P-
521

NIST K-233, K-283, K-409, K-
571

NIST B-233, B-283, B-409, B-
571

(Key establishment
methodology provides
between 112 and 256 bits of
encryption strength)

n/a

n/a

Key derivation

Message digest

A3707

SHA-3

SHA3-224

n/a

Message digest

[FIPS 202]

SHA3-256

SHA3-384

SHA3-512

A3707

DRBG

Hash_DRBG

256 bits of security strength

Random bit generation

[SP 800-
90Arev1]

Table 5 nCore - Approved Algorithms

Note: For AES GCM, the 96-bit IV is internally generated using the approved DRBG as per IG C.H.

2.3.1.2  Bootloader crypto

CAVP Cert

Algorithm and Standard

Mode/Method

Description / Key Size(s) / Key
Strength(s)

Use / Function

A2404

RSA

RSASSA-PKCS-v1_5

4096 bits

Signature verification

A6385

[FIPS 186-4]

A2404

SHS

SHA2-256

n/a

Message digest

A6385

[FIPS 180-4]

Table 6 Bootloader - Approved Algorithms

8 of 44

nShield 5s Hardware Security Module

2.3.1.3  SSH crypto

CAVP
Cert

Algorithm and
Standard

Mode/Method

A3706

AES

[FIPS 197] [SP
800-38A] [SP
800-38D]

CTR

GCM

ECB

Description / Key Size(s) /
Key
Strength(s)

Use / Function

128 bits

Data encryption/decryption

Vendor
affirmed

CKG

[SP 800-
133rev2]

Section 4 “Using the
Output of a Random Bit
Generator “

n/a

A3706

ECDSA

n/a

[FIPS 186-4]

NIST P-256

NIST P-521

Key generation

Signature generation and verification

A3706

HMAC

HMAC-SHA2-256

≥ 112 bits

MAC generation and verification

[FIPS 198]

A3706

KAS-ECC-SSC

ECDH

NIST P-256

Key agreement

(Key establishment
methodology provides
between 128 bits of
encryption strength)

n/a

n/a

Key derivation

A3706

[SP 800-
56Arev3]

CVL - Secure
Shell (SSHv2)
KDF

[SP 800-
135rev1]

A3706

KAS-ECC

ECDH

NIST P-256

[SP 800-
56Arev3 [SP
800-135rev1]

(Key establishment
methodology provides
between 128 bits of
encryption strength)

Key agreement, KAS-ECC-SSC (cert# A3707) in
conjunction with SSHv2 KDF of SP 800-135rev1
(cert# A3707), which is compliant with IG D.F.
Scenario 2, path 2.

A3706

SHS

SHA2-256

n/a

Message digest

[FIPS 180-4]

SHA2-512

Table 7 SSH - Approved Algorithms

Note: As per IG D.C., no parts of this protocol, other than the approved cryptographic algorithms and
the KDFs, have been tested by the CAVP and CMVP.

Note: For AES GCM, the module is compliant with RFCs 4252, 4253 and 5647, and the IV is generated
according to the SSHv2 protocol IV generation, as per IG C.H. In case the module’s power is lost and
then restored, a new key for use with the AES-GCM encryption/decryption is established.

2.3.2  Allowed algorithms

The following table describes the allowed cryptographic algorithms supported by the Cryptographic
Module.

nShield 5s Hardware Security Module

9 of 44

2.3.2.1  nCore crypto

Algorithm

Caveat

ECDSA

[FIPS 186-4]

KAS-ECC

[SP 800-56Arev3]

•

•

•

•

•

•

•

•

•

•

brainpoolP224r1/P224t1 (112 bits of strength)

Key generation

brainpoolP256r1/P256t1 (128 bits of strength)

Signature generation and verification

Use/Function

brainpoolP320r1/P320t1 (160 bits of strength)

brainpoolP384r1/P384t1 (192 bits of strength)

brainpoolP512r1/P512t1 (256 bits of strength)

brainpoolP224r1/P224t1 (112 bits of strength)

Key agreement

brainpoolP256r1/P256t1 (128 bits of strength)

brainpoolP320r1/P320t1 (160 bits of strength)

brainpoolP384r1/P384t1 (192 bits of strength)

brainpoolP512r1/P512t1 (256 bits of strength)

Table 8 nCore - Non-Approved Algorithms Allowed in the Approved Mode of Operation

2.3.3  Non-approved algorithms

Only approved and non-approved but allowed cryptographic algorithms are supported.

10 of 44

nShield 5s Hardware Security Module

3  Cryptographic module interfaces

The Cryptographic Module provides the following physical ports:

•  Status LED

•  Recovery button

•  Smartcard reader serial port

•  Host interface PCIe bus

•  Battery (including external backup battery power supply)

The following table maps the FIPS logical interfaces and physical ports to the module´s services

Physical port

Logical interface

Data that passes over
port/interface

PCIe bus

Data input

nCoreAPI, Updater, SSHAdmin, Launcher

Data output

nCoreAPI, SSHAdmin, Launcher

Control input

nCoreAPI, SSHAdmin, Setup, Monitor, Launcher, Discovery

Status output

nCoreAPI, Updater, Setup, Monitor, Launcher, Discovery

Power

n/a

Smartcard reader serial port

Data input

APDU commands

Data output

APDU commands

Status LED

Recovery button

Battery

Status output

Control input

Power

n/a

n/a

n/a

Table 9 Ports and Interfaces

Note: Control output is omitted because the module does not implement it.

nShield 5s Hardware Security Module

11 of 44

4  Roles, services and authentication

4.1  Roles
The Cryptographic Module supports the following roles:

•  Platform Crypto Officer (PCO)

•  nShield Security Officer (NSO)

•  User Client (UC)

Platform Crypto Officer (PCO)

This role is responsible of administration tasks of the HSM platform.

To assume this role, an operator needs to open a session with the SSHAdmin, Updater, Setup,
Monitor or Launcher services, using its SSH private key for each service.

When the module is in factory state, the SSHAdmin client SSH keys are set to a default value. These
keys must be changed with the SSHAdmin set service before the module can be initialised and
used.

nShield Security Officer (NSO)

This role is represented by Administrator Card holders, which have access to KNSO and are
responsible for the overall management of a Security World.

To assume this role, an operator or group of operators need to present a quorum m of N of
smartcards, and the KNSO Key Blob. Each operator is identified by its individual smartcard, which
contains a unique logical token share.

User Client (UC)

This role is authorised to use the general purpose cryptographic services offered by the
cryptographic module.

To assume this role, a client application needs to open a session with the nCoreAPI service, using its
SSH private key.

Role

PCO

UC

Service

SSHAdmin

Updater

Setup

Monitor

Launcher

nCoreAPI

NSO

nCoreAPI

Input

Data

Control

Data

Control

Data

Control

Output

Data

Status

Data

Status

Data

Status

12 of 44

nShield 5s Hardware Security Module

Table 10 Roles, Service Commands, Input and Output

Role  Authentication Method

Authentication Strength

PCO

UC

ECDSA P-256, P-521 client key
authentication as part of
establishing an SSH based
secure channel.

The ciphersuites used are:

ecdh-sha2-nistp256 , ecdh-sha2-nistp521, aes128-gcm@openssh.com, aes128-
ctr@openssh.com, hmac-sha2-256-etm@openssh.com

Identity-based and required.

This results in a security strength of 128 bits. A random authentication attempt gives is a probability
of success of 2-128, which is less than one in 1,000,000.

NSO  smartcard authentication.

Identity-based and required.

The module can process around 220 commands per minute. This gives a probability of success in a
one minute period of 2-108, which is less than one in 100,000.

A logical token share stored in a Smartcard or Softcard is encrypted and MAC'ed. An attacker would
need to guess the encrypted share value and the associated MAC in order to be able to load a valid
Logical token share into the module. This requires, as a minimum, guessing a 256-bit HMAC-SHA256
value, which gives a security strength of 256 bits. A random authentication attempt gives is a
probability of success of 2-256 , which is less than one in 1,000,000.

The module can process around 220 commands per minute. This gives a probability of success in a
one minute period of 2-236, which is less than 10-5, which is less than one in 100,000.

Table 11 Roles and Authentication

4.2  Services

The following table describes the services provided by the Cryptographic Module and the access
policy.

The Access column presents the access level given to the SSP

G = Generate: The module generates or derives the SSP.
R = Read: The SSP is read from the module (e.g. the SSP is output).
W = Write: The SSP is updated, imported, or written to the module.
E = Execute: The module uses the SSP in performing a cryptographic operation.
Z = Zeroise: The module zeroises the SSP

4.2.1  Setup service

Service

Description

info

This is a Show Module's
Versioning Information service.

This command prints out the
contents of the board-id rom file
and a number of flags that
indicate which other setup
subcommands have been
previously executed as
determined by the existence or
non-existence of the relevant files
in long-term storage.  It also
prints out the tag and value pairs

Approved Security
Functions

Keys and/or SSPs

Roles  Access rights
to Keys
and/or SSPs

KSESSION - SSH

PCO  E

Data
encryption/decryption
(AES CTR, GCM)

MAC generation /
verification (HMAC)

Indicator

return
value 0

nShield 5s Hardware Security Module

13 of 44

Service

Description

Approved Security
Functions

Keys and/or SSPs

Roles  Access rights
to Keys
and/or SSPs

Indicator

of any options set with the setopt
subcommand.

factorystate  This is the Perform Zeroisation

service.

It zeroizes unprotected SSPs and
returns the module to factory
state. It then initiates a module
reboot.

Data
encryption/decryption
(AES CTR, GCM)

MAC generation /
verification (HMAC)

KRESET (note: any SSP
that is derived from
KRESET, or protected by
an SSP derived from
KRESET, will also be
effectively zeroised.)

KSESSION - SSH

KUSER_SSH,
KSSH_SETUP,
KSSH_SSHADMIN,
KSSH_MONITOR,
KSSH_UPDATER,
KCONTAINER,
KCONTAINERSSH,
KSSH_NCORE

PCO  Z

E

G

return
value 0

(note: SSH server
authentication keys
are only generated on
first reboot after a
setup
factorystate
command)

settime

This subcommand sets the system
date and time.

gettime

This subcommand returns
the  system date and time.

Table 12 Approved Services

KSESSION - SSH

PCO  E

KSESSION - SSH

PCO  E

Data
encryption/decryption
(AES CTR, GCM)

MAC generation /
verification (HMAC)

Data
encryption/decryption
(AES CTR, GCM)

MAC generation /
verification (HMAC)

return
value 0

return
value 0

The approved service indicator is the successful completion of these services (return value 0), as
they only use approved mechanisms.

4.2.2  SSHAdmin service

Service

Description

Loads the client public key in the module, that
will be used to authenticate the requester of a
particular service

set

list

Approved Security Functions  Keys and/or SSPs  Roles  Access
rights
to Keys
and/or
SSPs

Indicator

Data encryption/decryption
(AES CTR, GCM)

KSSH_CLIENT pub

PCO  W

KSESSION - SSH

E

return
value 0

MAC generation / verification
(HMAC)

Obtains the client public key for the service
given by the 'role' parameter.

Data encryption/decryption
(AES CTR, GCM)

KSSH_CLIENT pub

PCO  R

KSESSION - SSH

E

return
value 0

MAC generation / verification
(HMAC)

get-
serverkey

Obtains the server public key for the service
given by the 'role' parameter.

Data encryption/decryption
(AES CTR, GCM)

KSSH_NCORE pub  PCO  R

R

return
value 0

14 of 44

nShield 5s Hardware Security Module

Service

Description

Approved Security Functions  Keys and/or SSPs  Roles  Access
rights
to Keys
and/or
SSPs

Indicator

MAC generation / verification
(HMAC)

KSSH_UPDATER
pub

R

E

KSSH_SETUP pub

KSSH_SSHADMIN
pub

KSSH_MONITOR
pub

KSESSION - SSH

Table 13 Approved Services

The approved service indicator is the successful completion of these services (return value 0), as
they only use approved mechanisms.

4.2.3  Updater service

Service

Description

Approved Security
Functions

Indicator

Keys
and/or
SSPs

Roles  Access
rights
to Keys
and/or
SSPs

info

This is a Show Module's Versioning Information service.

Obtains the version number of the HSM firmware.

Data encryption/decryption
(AES)

KSESSION -
SSH

PCO  E

return
value 0

MAC generation /
verification (HMAC)

receive

Transmits a file (intended to be an npkg upgrade file) to
the HSM.

Data encryption/decryption
(AES)

KSESSION -
SSH

PCO  E

return
value 0

load

Verifies that a file on the HSM filesystem is a valid npkg
upgrade file and, if so loads the file onto its flash
partition.

MAC generation /
verification (HMAC)

Digital signature verification
(RSA, ECDSA)

Data encryption/decryption
(AES)

MAC generation /
verification (HMAC)

NSBIK pub

PCO  E

NPSK pub

NFIK pub

NLIK pub

KSESSION -
SSH

E

E

E

E

return
value 0

setminvsn  Sets the minimum VSN that the module will use to

check, when the 'load' command above is run, that the
firmware specified can be validly loaded onto this
module.

Data encryption/decryption
(AES)

KSESSION -
SSH

PCO  E

return
value 0

MAC generation /
verification (HMAC)

Table 14 Approved Services

The approved service indicator is the successful completion of these services (return value 0), as
they only use approved mechanisms.

nShield 5s Hardware Security Module

15 of 44

4.2.4  Monitor service

Service

Description

Approved Security Functions

Indicator

Keys and/or
SSPs

Roles  Access
rights
to Keys
and/or
SSPs

getlog

This is the Show Status service.

Obtains the log of the system

Data encryption/decryption (AES
CTR, GCM)

KSESSION -
SSH

PCO  E

return value
0

MAC generation / verification
(HMAC)

clearlog

Clears the log of the system

Data encryption/decryption (AES
CTR, GCM)

KSESSION -
SSH

PCO  E

return value
0

MAC generation / verification
(HMAC)

getenvstats  Obtains the environmental stats from

the system

Data encryption/decryption (AES
CTR, GCM)

KSESSION -
SSH

PCO  E

return value
0

MAC generation / verification
(HMAC)

Table 15 Approved Services

The approved service indicator is the successful completion of these services (return value 0), as
they only use approved mechanisms.

4.2.5  Launcher service

Service

Description

Approved Security Functions  Keys and/or

SSPs

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

receive

Uploads a file to the launcher service
for temporary storage.

Data encryption/decryption
(AES CTR, GCM)

KSESSION -
SSH

PCO  E

return
value 0

machine
create

Creates a SEE machine container from a
received file, after successfully being  validated.

Digital signature verification
(ECDSA)

MAC generation / verification
(HMAC)

Data encryption/decryption
(AES CTR, GCM)

MAC generation / verification
(HMAC)

DSK pub

PCO  E

KSESSION -
SSH

E

return
value 0

machine list

Lists SEE machines along with their current
states.

Data encryption/decryption
(AES CTR, GCM)

KSESSION -
SSH

PCO  E

return
value 0

start

Starts a SEE machine after successfully being
validated.

Digital signature verification
(ECDSA)

MAC generation / verification
(HMAC)

Data encryption/decryption
(AES CTR, GCM)

MAC generation / verification
(HMAC)

DSK pub

PCO  E

KSESSION -
SSH

E

return
value 0

16 of 44

nShield 5s Hardware Security Module

Service

Description

Approved Security Functions  Keys and/or

SSPs

Indicator

Roles  Access
rights
to Keys
and/or
SSPs

stop

Stops a SEE machine.

Data encryption/decryption
(AES CTR, GCM)

KSESSION -
SSH

PCO  E

return
value 0

MAC generation / verification
(HMAC)

destroy

Deletes a SEE machine.

Data encryption/decryption
(AES CTR, GCM)

KSESSION -
SSH

PCO  E

return
value 0

ids
commands

Management of the SEE machine signing
certificates.

Digital signature verification
(ECDSA)

MAC generation / verification
(HMAC)

Data encryption/decryption
(AES)

MAC generation / verification
(HMAC)

DSK pub

PCO  R, W, E

ESK pub

KSESSION -
SSH

E

E

return
value 0

see-log
commands

Management of the SEE machine logs.

Data encryption/decryption
(AES)

KSESSION -
SSH

PCO  E

return
value 0

MAC generation / verification
(HMAC)

Table 16 Approved Services

The approved service indicator is the successful completion of these services (return value 0), as
they only use approved mechanisms.

4.2.6  Discovery service

Service

Description

Approved
Security
Functions

Keys
and/or
SSPs

Roles

Indicator

Access
rights
to Keys
and/or
SSPs

python-
zeroconf

The (logical) network connection between host and HSM uses
TCP/IP protocols over the PCIe bus; however, for ease of
setup it needs to avoid requiring IP configuration by the user.

-

-

Unauthenticated  -

return
value 0

Therefore the HSM uses zeroconf: each end of the virtual
'network segment' has only a link-local (IPv4 and IPv6)
address. The HSM's address can be discovered by the host
using multicast DNS, responding to mDNS queries.

Table 17 Approved Services

The approved service indicator is the successful completion of these services (return value 0), as
they only use approved mechanisms.

nShield 5s Hardware Security Module

17 of 44

4.2.7  nCoreAPI service

Service

Description

Approved Security
Functions

Keys and/or
SSPs

Indicator

Roles  Access
rights
to
Keys
and/or
SSPs

Big number operation

Cmd_BignumOp

Make Blob

Cmd_MakeBlob

Bulk channel

Cmd_ChannelOpen

Cmd_ChannelUpdate

Check User Action

Cmd_CheckUserAction

Clear Unit

Cmd_ClearUnit

Set Module Key

Cmd_SetKM

Remove Module Key

Cmd_RemoveKM

Duplicate key handle

Cmd_Duplicate

Performs an operation on a
large integer.

-

-

UC

-

Creates a Key blob containing
the key. Note that the key ACL
needs to authorize the
operation.

Key derivation (KBKDF)

Key wrapping (AES CBC
and HMAC, KTS-IFC)

KA,
KRE_BLOBKEY,
KR, KM, KNSO,
LTx

UC

R

E

return
status OK

return
status OK

Provides a bulk processing
channel for crypto operations

Encryption and
decryption (AES ECB,
CBC, GCM)

MAC generation and
verification (HMAC,
KMAC, AES CMAC)

Digital signature
generation and
verification (RSA,
ECDSA, DSA)

-

-

Determines whether the ACL
associated with a key allows a
specific operator defined
action.

This is the Perform Self-tests
service.

Zeroises all keys, tokens and
shares that are loaded in RAM.
Will cause the module to
reboot and perform self-tests.

BLOBKE,
BLOBKM

KA

UC

E

return
status OK

KNSO, KA

UC

R

return
status OK

UC

Z

return
status OK

KA, KR,
IMPATHKE,
IMPATHKM,
RAKME, RAKMA

Message digest (SHA-1)  KM

NSO  W

-

-

KM

NSO  Z

KA

UC

R

return
status OK

return
status OK

return
status OK

Allows a key to be stored
internally as a Module key
(KM) value. The ACL needs to
authorize this operation.

Deletes the KM with a given
KM hash value from non-
volatile memory.

Creates a second instance of a
Key with the same ACL and
returns a handle to the new
instance.

Note that the source key ACL
needs to authorize this
operation.

Enable feature

Cmd_StaticFeatureEnable

Enables the service. This
service requires a certificate

-

-

UC

-

return
status OK

18 of 44

nShield 5s Hardware Security Module

Service

Description

Approved Security
Functions

Keys and/or
SSPs

Indicator

Roles  Access
rights
to
Keys
and/or
SSPs

signed by the Master Feature
Enable key.

Encryption and decryption
using the provided key handle.

Data encryption and
decryption (AES ECB,
CBC, GCM)

KA

UC

E

return
status OK

Encryption / decryption

Cmd_Encrypt

Cmd_Decrypt

Erase from smartcard /softcard

Cmd_EraseFile

Cmd_EraseShare

Format Token

Cmd_FormatToken

File operations

Cmd_FileCopy

Cmd_FileCreate

Cmd_FileErase

Cmd_FileOp

Force module to fail

Cmd_Fail

Removes a file or a share from
a smartcard or softcard

-

Formats a smartcard or a
softcard.

Performs file operations in the
module.

-

-

Causes the module to enter a
failure state.

-

Generate prime number

Generates a random prime.

Cmd_GeneratePrime

Random bit generation
(DRBG)

Generate random number

Cmd_GenerateRandom

Generates a random number
from the Approved DRBG.

Random bit generation
(DRBG)

Get ACL

Cmd_GetACL

Get key application data

Cmd_GetAppData

Get challenge

Cmd_GetChallenge

Get KLF2

Cmd_GetKLF2

Get Key Information

Cmd_GetKeyInfo

Cmd_GetKeyInfoEx

Get the ACL of a given key.

Get the application data field
from a key.

-

-

Get a random challenge that
can be used in fresh
certificates.

Random bit generation
(DRBG)

DRBG entropy
input, seed,
internal state ('V'
and 'C')

Get a handle to the Module
Long Term (KLF2) public key.

-

-

UC

-

Get the type, length and hash
of a key.

Message digest (SHA-1)  KA

UC

R

-

-

-

-

DRBG entropy
input, seed,
internal state ('V'
and 'C')

DRBG entropy
input, seed,
internal state ('V'
and 'C')

KA

KA

UC

-

return
status OK

UC

-

UC

-

return
status OK

return
status OK

UC

-

UC

E

return
status OK

return
status OK

UC

E

return
status OK

UC

R

UC

R

UC

E

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

nShield 5s Hardware Security Module

19 of 44

Service

Description

Approved Security
Functions

Keys and/or
SSPs

Indicator

Roles  Access
rights
to
Keys
and/or
SSPs

Get module signing key

Cmd_GetKML

Get list of slot in the module

Cmd_GetSlotList

Get Logical Token Info

Cmd_GetLogicalTokenInfo

Cmd_GetLogicalTokenInfoEx

Get list of module keys

Cmd_GetKMList

Get module state

Cmd_GetModuleState

Get real time clock

Cmd_GetRTC

Get a handle to the KML public
key.

-

Get the list of slots that are
available from the module.

-

KML

UC

R

-

UC

-

Message digest (SHA-1)  LTx

UC

R

Message digest (SHA-1)  KM, KNSO

UC

R

Get information about a
Logical Token: hash, state and
number of shares.

Get the list of the hashes of all
module keys and the KNSO.

Returns unsigned data about
the current state of the
module.

Get the current time from the
module Real Time Clock.

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

-

-

UC

-

UC

-

SHAREKEY

UC

R

UC

-

-

-

UC

-

return
status OK

-

-

-

-

-

Get share access control list

Get the Share's ACL.

Cmd_GetShareACL

Get Slot Information

Cmd_GetSlotInfo

Get Ticket

Cmd_GetTicket

Initialize Unit

Cmd_InitializeUnit

Cmd_InitializeUnitEx

Get information about shares
and files on a Smartcard that
has been inserted in a module
slot.

Get a ticket (an invariant
identifier) for a key. This can
be passed to another client or
to a SEE World which can
redeem it using Redeem Ticket
to obtain a new handle to the
object.

Causes the nCore API service in
the pre-initialization state to
enter the initialization
state.  When the module
enters the initialization state, it
erases all Module keys (KM),
the module's signing key
(KML), and the hash of the
Security Officer's keys, HKNSO.
It then generates a new KML
and KM.

Key generation (CKG,
RSA, DSA)

Message digest (SHA-1)

return
status OK

HKNSO

UC

Z, G

KA,
KRE_BLOBKEY,
KR, KM, KAL,
KML, KNSO,
HKNSO, LTx

Insert a Softcard

Cmd_InsertSoftToken

Remove a Softcard

Cmd_RemoveSoftToken

Allocates memory on the
module that is used to store
the logical token share and
other data objects.

-

Removes a Softcard from the
module. It returns the updated

-

-

-

UC

-

return
status OK

UC

-

return
status OK

20 of 44

nShield 5s Hardware Security Module

Service

Description

Approved Security
Functions

Keys and/or
SSPs

Indicator

Roles  Access
rights
to
Keys
and/or
SSPs

Key agreement (KAS-
FFC)

KML, IMPATHKE,
IMPATHKM

UC  G, E

return
status OK

shares and deletes them from
the module’s memory.

Support for Impath secure
channel. Requires Feature
Enabled.

Generates a cryptographic key
of a given type with a specified
ACL. It returns a handle to the
key.  Optionally, it returns a
KML signed certificate with the
hash of the key and its ACL
information.

-

Loads a plain text key into the
module. If the module is
initialized in approved mode,
this service is available for
public keys only.

Key derivation (KBKDF)

Data encryption and
decryption (AES CBC,
GCM)

MAC generation and
verification (HMAC-
SHA256)

Key generation (CKG,
RSA, ECDSA, DSA)

Digital signature
generation (DSA)

Impath secure channel

Cmd_ImpathGetInfo

Cmd_ImpathKXBegin

Cmd_ImpathKXFinish

Cmd_ImpathReceive

Cmd_ImpathSend

Key generation

Cmd_GenerateKey

Cmd_GenerateKeyPair

Key import

Cmd_Import

1Derive Key

Cmd_DeriveKey

UC  G

return
status OK

KML, KA, DRBG
entropy input,
seed, internal
state ('V' and 'C')

KA

UC  W

return
status OK

Performs key wrapping,
unwrapping, transport,
exchange and derivation. The
ACL needs to authorize this
operation.

return
status OK

Key derivation (KBKDF)

KA

UC

R, W

Key
wrapping/unwrapping
(KTS-AES)

Key transport (KTS-IFC)

Key agreement (KAS-
FFC, KAS-ECC)

Load Blob

Cmd_LoadBlob

Load a Key blob into the
module. It returns a handle to
the key suitable for use with
module services.

Key derivation (KBKDF)

Key unwrapping (AES
CBC and HMAC, KTS-IFC)

KA,
KRE_BLOBKEY,
KR, KM, KNSO

UC  W

E

return
status OK

BLOBKE,
BLOBKM

Load Logical Token

Cmd_LoadLogicalToken

Initiates loading a Logical
Token from Shares, which can
be loaded with the Read Share
command.

Key unwrapping

-

UC

-

Key derivation

Generate Logical Token

Cmd_GenerateLogicalToken

Creates a new Logical Token
with given properties and
secret sharing parameters.

Key generation (CKG)

KM, LTx

UC  G, W

Message digest

Cmd_Hash

Computes the cryptographic
hash of a given message.

Message digest (SHS,
SHA-3)

Modular Exponentiation

Performs a modular
exponentiation (standard or

-

-

-

UC

-

UC

-

nShield 5s Hardware Security Module

return
status OK

return
status OK

return
status OK

return
status OK

21 of 44

Service

Description

Approved Security
Functions

Keys and/or
SSPs

Indicator

Roles  Access
rights
to
Keys
and/or
SSPs

Cmd_ModExp

Cmd_ModExpCrt

Cmd_RSAImmedVerifyEncrypt

Cmd_RSAImmedSignDecrypt

Module hardware information

Cmd_ModuleInfo

No Operation

Cmd_NoOp

Change Share Passphrase

Cmd_ChangeSharePIN

Cmd_ChangeShareGroupPIN

CRT) on values supplied with
the command.

Reports detailed hardware
information.

No operation.

-

-

Updates the passphrase of a
Share.

Key derivation (KBKDF)

Key
wrapping/unwrapping
(AES CBC and HMAC,
KTS-IFC)

-

-

UC

-

UC

-

return
status OK

return
status OK

SHAREKEY, LTx,
KM

UC  G, E, R,
W

return
status OK

NVRAM Allocate

Allocation in NVRAM.

Cmd_NVMemAllocate

NVRAM Free

Deallocation from NVRAM.

Cmd_NVMemFree

Operation on NVM list

Cmd_NVMemList

Returns a list of files in
NVRAM.

-

-

-

Operation on NVM files

Operation on an NVRAM file.

-

-

-

-

-

NSO

-

UC

-

UC

-

UC

Cmd_NVMemOp

Key export

Cmd_Export

Read file

Cmd_ReadFile

Read share

Cmd_ReadShare

Send share to remote slot

Cmd_SendShare

Exports a key in plain text.

-

KA

UC

R

Note: in approved mode, only
public keys can be exported.

Reads data from a file on a
Smartcard or Softcard. The ACL
needs to authorize this
operation.

-

-

UC

-

Reads a share from a
Smartcard or Softcard. Once a
quorum of shares have been
loaded, the module re-
assembles the Logical Token.

Reads a Share and encrypts it
with the Impath session keys
for transmission to the peer
module.

Key derivation (KBKDF)

Key unwrapping (AES
CBC and HMAC)

SHAREKEY, LTx,
KM

UC  G, E, R  return

status OK

Data encryption(AES
CBC, GCM)

MAC generation
(HMAC-SHA256)

Data decryption (AES
CBC, GCM)

IMPATHKE,
IMPATHKM,
SHAREKEY

IMPATHKE,
IMPATHKM,
SHAREKEY

UC

R, E

return
status OK

UC

R, E

return
status OK

Receive share from remote slot

Cmd_ReceiveShare

Receives a Share encrypted
with the Impath session keys
by a remote module.

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

return
status OK

22 of 44

nShield 5s Hardware Security Module

Service

Description

Approved Security
Functions

Keys and/or
SSPs

Indicator

Roles  Access
rights
to
Keys
and/or
SSPs

MAC verification
(HMAC-SHA256)

Redeem Ticket

Cmd_RedeemTicket

Gets a handle in the current
name space for the object
referred to by a ticket created
by Get Ticket.

-

-

UC

-

return
status OK

Provides remote presentation
of Smartcards using a secure
channel between the module
and the Smartcard.

Remote Administration

Cmd_DynamicSlotCreateAssociation

Cmd_DynamicSlotExchangeAPDUs

Cmd_DynamicSlotsConfigure

Cmd_DynamicSlotsConfigureQuery

Cmd_VerifyCertificate

Key agreement (KAS-
ECC ECDH)

RAKME, RAKMA,

UC  G, E

KWARN_pub

E

return
status OK

Key derivation (KBKDF)

Data encryption and
decryption (AES CBC)

MAC generation and
verification (AES CMAC)

Digital signature
verification (ECDSA)

Destroy

Cmd_Destroy

Report statistics

Cmd StatGetValues

Cmd_StatEnumTree

Show Status

Cmd_NewEnquiry

Remove handle to an object in
RAM. If the current handle is
the only one remaining, the
object is zeroised from RAM.

Reports the values of the
statistics tree.

-

-

This is a Show Status and Show
Module's Versioning
Information service.

-

Report status information.

Set ACL

Cmd_SetACL

Replaces the ACL of a given key
with a new ACL. The ACL needs
to authorize this operation.

Set key application data

Cmd_SetAppData

Writes the application
information field of a key.

Set NSO Permissions

Cmd_SetNSOPerms

Signature generation

Cmd_Sign

Sets the NSO key hash and
which permissions require a
Delegation Certificate.

Generate a digital signature or
MAC value.

-

-

-

KA, KNSO, LTx

UC

Z

return
status OK

-

-

KA

KA

-

UC

-

return
status OK

UC

-

return
status OK

UC

W

return
status OK

UC  W

NSO

-

return
status OK

return
status OK

return
status OK

KA, KNSO

UC

E

MAC generation
(HMAC, KMAC, AES
CMAC)

Digital signature
generation (RSA, ECDSA,
DSA)

Sign Module State

Cmd_SignModuleState

Returns a signed certificate
that contains data about the

Digital signature
generation (DSA)

KML

UC

E

return
status OK

nShield 5s Hardware Security Module

23 of 44

Service

Description

Approved Security
Functions

Keys and/or
SSPs

Indicator

Roles  Access
rights
to
Keys
and/or
SSPs

Signature verification

Cmd_Verify

Write file

Cmd_WriteFile

Write share

Cmd_WriteShare

current configuration of the
module.

Verifies a digital signature or
MAC value.

MAC verification
(HMAC, KMAC, AES
CMAC)

Digital signature
verification (RSA,
ECDSA, DSA)

KA

UC

E

return
status OK

Writes a file to a Smartcard or
Softcard.

-

-

NSO

-

return
status OK

Writes a Share to a Smartcard
or Softcard.

Key derivation (KBKDF)

Key wrapping (AES CBC
and HMAC)

SHAREKEY, LTx,
KM

UC  G, E, W  return

status OK

SEE connection

Cmd_CreateSEEConnection

Opens a connection from the
nCoreAPI service to the SEE
machine

-

-

UC

-

return
status OK

Table 18 Approved Services

Non-approved services will fail with a return an error code indicator "StrictFIPS140".

All nCore API services are sent through the SSH channel, performing security functions Data
encryption/decryption, MAC generation / verification and access E (execute) of the session keys
KSESSION - SSH.

24 of 44

nShield 5s Hardware Security Module

5  Software/Firmware security

The nShield 5s cryptographic module's executable code is delivered by Entrust as a single signed
firmware package (.npkg file). The firmware integrity is verified at start up using RSA with 4096 bit
key and SHA2-256. The Library Partition is an internal storage area that contains a number of
auxiliary files required for operation of the module.  The integrity of the Library Partition is verified
using ECDSA with curve P-521 and SHA2-512.

Operators can initiate the integrity tests on demand by restarting the module.

nShield 5s Hardware Security Module

25 of 44

6  Operational environment

Not applicable. The module has a limited operational environment, it is designed to accept only
controlled firmware changes that successfully pass the software/firmware load test.

26 of 44

nShield 5s Hardware Security Module

7  Physical security

The product is a multi-chip embedded Cryptographic Module, as defined in FIPS 140-3. It is enclosed
in a hard and opaque epoxy resin which meets the physical security requirements of FIPS 140-3 level
3.

The cryptographic module implements Environmental Failure Protections (EFP) which detect out of
range voltage and temperature and shuts down the module.

Physical Security
Mechanism

Recommended
Frequency of
Inspection/Test

Inspection/Test Guidance Details

Hard and opaque
epoxy

Monthly

The module should be inspected periodically for evidence of tamper attempts, including the
entire enclosure including the epoxy resin security coating for obvious signs of damage.

Table 19 Physical Security Inspection Guidelines

Temperature or voltage
measurement

Specify EFP or EFT

Specify if this condition
results in a shutdown or
zeroisation

Low Temperature

High Temperature

Low Voltage

2ºC

95ºC

8V

High Voltage

14.08V

Table 20 EFP/EFT

EFP

EFP

EFP

EFP

Shutdown

Shutdown

Shutdown

Shutdown

Hardness tested temperature measurement

Low Temperature

High Temperature

0ºC

95ºC

Table 21 Hardness testing temperature ranges

nShield 5s Hardware Security Module

27 of 44

8  Non-invasive security

Not applicable.

28 of 44

nShield 5s Hardware Security Module

9  Sensitive security parameters management

9.1  Keys and Sensitive Security Parameters
This section defines the Sensitive Security Parameters (SSPs) managed by the cryptographic module.

9.1.1  Platform SSPs

Key/SSP/Name/Type  Strength  Security

Generation

Import/Export  Establishment  Storage

Zeroisation  Use & related

Function and
Cert. Number

256 bits  Re-settable key

DRBG

Never

n/a

KRESET

(CSP)

KUSER_SSH

(CSP)

A3707

256 bits  Global SSH key
encryption key

AES-256

A3707

Derived at
start-up
using KBKDF
from KRESET
and other
fixed
parameters

MSP430
FRAM, in
plaintext

RAM, in
plaintext

keys

factorystate  Key derivation

Power cycle  Encryption of

all the service's
server
authentication
SSH keys

n/a

protected

SSH channel
session

In Flash,
encrypted
with
KUSER_SSH

n/a

protected

SSH channel
session

In Flash,
encrypted
with
KUSER_SSH

n/a

protected

SSH channel
session

In Flash,
encrypted
with
KUSER_SSH

Never

n/a

Private key:
never

n/a

Public key:
output via
SSHAdmin
service

Private key:
never

n/a

Public key:
output via
SSHAdmin
service

Private key:
never

n/a

Public key:
output via
SSHAdmin
service

KSSH_SETUP

128 bits  Server

DRBG

(CSP)

authentication
SSH key for the
Setup service

ECDSA P-256

A3707

A3706

KSSH_UPDATER

128 bits  Server

DRBG

(CSP)

authentication
SSH key for
the Updater
service

ECDSA P-256

A3707

A3706

KSSH_SSHADMIN

128 bits  Server

DRBG

(CSP)

authentication
SSH key for
the SSH Admin
service

ECDSA P-256

A3707

A3706

KSSH_MONITOR

128 bits  Server

DRBG

(CSP)

authentication
SSH key for the
Monitor service

ECDSA P-256

Private key:
never

n/a

Public key:
output via

n/a

protected

SSH channel
session

In Flash,
encrypted
with
KUSER_SSH

nShield 5s Hardware Security Module

29 of 44

Key/SSP/Name/Type  Strength  Security

Generation

Import/Export  Establishment  Storage

Zeroisation  Use & related

Function and
Cert. Number

A3707

A3706

KSSH_LAUNCHER

128 bits  Server

DRBG

(CSP)

authentication
SSH key for the
Launcher
service

ECDSA P-256

A3707

A3706

SSHAdmin
service

Private key:
never

n/a

Public key:
output via
SSHAdmin
service

KSESSION - SSH

(CSP)

128 bits  SSH channel
session keys

n/a

Never

ECDH

AES GCM or

AES CTR, HMAC

A3707

keys

n/a

protected

SSH channel
session

In Flash,
encrypted
with
KUSER_SSH

RAM, in
plaintext

Power cycle
or channel
closure

SSH channel
data
encryption and
integrity

NSBIK pub

128 bits  Bootloader

Entrust

(not an SSP)

public integrity
key

Import:
Firmware
update

n/a

Flash, in
plaintext

n/a

Firmware
integrity test

RSA 4096 bit

Export: Never

A2404

A6385

NFIK pub

128 bits  Firmware public

Entrust

(not an SSP)

signature
verification key

Import:
Firmware
update

n/a

Flash, in
plaintext

n/a

Firmware
integrity test

RSA 4096 bit

Export: Never

A2404

A6385

NLIK pub

(not an SSP)

256 bits  Library public
integrity key

Entrust

ECDSA P-521

A3707

NPSK pub

256 bits  Package public

Entrust

signature
verification key

n/a

n/a

Import:
Firmware
update

Export: Never

Import:
Firmware
update

Flash, in
plaintext

n/a

Firmware
integrity test

Flash, in
plaintext

n/a

Firmware
loading test

ECDSA P-521

Export: Never

A3707

256 bits  Root Entrust

Entrust

SEE public
signing key

Import:
Firmware
update

ECDSA P-521

Export: Never

A3707

n/a

Flash

n/a

Signature
verification

(PSP)

ESK pub

(PSP)

30 of 44

nShield 5s Hardware Security Module

Key/SSP/Name/Type  Strength  Security

Generation

Import/Export  Establishment  Storage

Zeroisation  Use & related

DSK pub

(PSP)

Function and
Cert. Number

256 bits  Developer

n/a

public signing
key

ECDSA P-521

A3707

KSSH_CLIENT pub

128 bits  Client

Client side

(PSP)

authentication
SSH key for
each of the
services
(Updater,
Setup,
SSHAdmin,
Launcher,
nCoreAPI)

ECDSA P-256, P-
521

A3707

DRBG entropy input

(CSP)

> 256
bits

Platform DRBG

A3707

DRBG seed

256 bits  Platform DRBG

(CSP)

A3707

DRBG internal state
('V' and 'C' values)

(CSP)

256 bits  Platform DRBG

A3707

Table 22 Platform SSP table

520 bits
from the
approved
Entropy
Source.

Generated
as per SP
800-90Arev1
with 696 bits
from the
approved
Entropy
Source:

520 bits
entropy
input

176 bits
random
nonce

Generated
as per SP
800-
90Arev1.

n/a

Flash

n/a

Launcher
service ids
commands

keys

Signature
verification

n/a

Through
SSHAdmin
service

Flash, in
plaintext

factorystate  SSH

authentication
credentials

Never

n/a

RAM, in
plaintext

Power cycle  Random
number
generation

Never

n/a

RAM, in
plaintext

Power cycle  Random
number
generation

Never

n/a

RAM, in
plaintext

Power cycle  Random
number
generation

nShield 5s Hardware Security Module

31 of 44

nCore API service SSPs

9.1.1.1  Service SSPs

The following SSPs are related to the nCore API service.

Key/SSP/Name/Type  Strength  Security

Generation

Import/Export  Establishment  Storage

Zeroisation  Use &
related
keys

Never

n/a

RAM, in plaintext  Power

cycle

Key
derivation

Never

n/a

RAM, in plaintext  Power

Encryption

cycle

Private key:
Never

n/a

Public key
output via SSH
Admin service

In Flash,
encrypted with
KCONTAINERSSH

n/a

protected

SSH
channel
session

Function and
Cert. Number

KCONTAINER

256 bits  Master key for

(CSP)

container

A3707

KCONTAINERSSH

(CSP)

256 bits  Encryption key
for
KSSH_NCORE

AES-256

A3707

Derived at
start-up using
KBKDF from
KRESET,
container-id
and other
fixed value.

Derived at
start-up using
KBKDF from
KCONTAINER,
and other
fixed value.

KSSH_NCORE

128 bits  Server

DRBG

(CSP)

authentication
ssh key for
the  nCore API
service

ECDSA P-256

A3707

A3706

Table 23 nCoreAPI SSP table

9.1.1.2  Security World SSPs

The following SSPs are related to the Security World in which the cryptographic module is enrolled
into.

Key/SSP/Name/Typ
e

Strengt
h

Security
Function and
Cert. Number

Generatio
n

Import/Expor
t

Establishmen
t

Storage  Zeroisation  Use & related keys

KRE_BLOBKEY

128 bits  Recovery

DRBG

(CSP)

KR

(CSP)

confidentialit
y key

RSA 3072 bit

A3707

256 bits  Recovery key

DRBG

AES 256

A3707

n/a

n/a

Import: From
key blob,
decrypted
with LTRE

Export: in key
blob,
encrypted
with LTRE

Import: From
key blob,
decrypted
with
KRE_BLOBKEY

RAM, in
plaintext

Power cycle
or
Cmd_Destro
y

Key used to protect
recovery keys (KR).

RAM, in
plaintext

Power cycle
or
Cmd_Destro
y

Key used to
derive (using SP 800-
108 KDF in counter
mode) the keys Ke
(AES 256-bit) and Km
(HMAC-SHA256) that
protect an archive

32 of 44

nShield 5s Hardware Security Module

Key/SSP/Name/Typ
e

Strengt
h

Security
Function and
Cert. Number

Generatio
n

Import/Expor
t

Establishmen
t

Storage  Zeroisation  Use & related keys

Export: in key
blob,
encrypted
with
KRE_BLOBKEY

IMPATHKE

256 bits  Session keys

n/a

Never

DH

IMPATHKM

(CSP)

KA

(CSP)

for impath
channel

A3707

≥ 112
bits

Application
keys

DRBG

A3707

n/a

Import: From
key blob,
decrypted
with LTA or KR

Export: in key
blob,
encrypted
with LTA or KR

copy of an application
key.

RAM, in
plaintext

Power cycle
or channel
closure

Encryption and
decryption

MAC generation and
verification

RAM, in
plaintext

Power cycle
or
Cmd_Destro
y

Application keys used
for general purpose
cryptographic
services:

•

•

Encryption
and
decryption

Digital
signature
generation
and
verification

•  MAC

•

generation
and
verification

Key
derivation,
key
agreement
.

KM

(CSP)

KML

(CSP)

KNSO

(CSP)

256 bits  Security

DRBG

World
module key

AES 256

A3707

Import: From
key blob,
decrypted
with LTM

Export: in key
blob,
encrypted
with LTM

n/a

Flash, in
plaintext

factorystate
or Initialize
Unit

Key used for key
derivation to protect
logical tokens and
associated module
Key Blobs.

128 bits  Module

DRBG

Never

n/a

Signing key

DSA 3072 bit

A3707

Flash, in
plaintext

factorystate
or Initialize
Unit

Digital signature
generation for key
generation
certificates and
module state
certificates.

128 bits  NSO key

DRBG

DSA 3072 bit

A3707

Import: From
key blob,
decrypted
with LTNSO

Export: in key
blob,

n/a

RAM, in
plaintext

Power cycle
or
Cmd_Destro
y

nShield Security
Officer key used for
NSO authorisation
and Security World
integrity

nShield 5s Hardware Security Module

33 of 44

Key/SSP/Name/Typ
e

Strengt
h

Security
Function and
Cert. Number

Generatio
n

Import/Expor
t

Establishmen
t

Storage  Zeroisation  Use & related keys

HKNSO

(PSP)

BLOBKE

BLOBKM

(CSP)

LTx

(CSP)

(CSP)

RAKME

RAKMA

(CSP)

KAL

(CSP)

KWARN pub

(PSP)

Security
World
creation

Flash, in
plaintext

factorystate
or Initialize
Unit

nShield Security
Officer key used for
NSO authorisation
and Security World
integrity

Derived from
LTx

RAM, in
plaintext

Power cycle  Key wrapping

encrypted
with LTNSO

Never

160 bits  Hash of public
KNSO

n/a

A3707

256 bits  Key blob

n/a

Never

encryption
and MAC key

AES 256

HMAC-
SHA256

A3707

256 bits  Logical token

DRBG

for key x

AES 256

A3707

SHAREKEY

256 bits  Share

n/a

Never

From Shares
using Shamir
Secret Schee

RAM, in
plaintext

Power cycle
or
Cmd_Destro
y

Key derivation

Import: From
quorum of
encrypted
Shares using
Shamir Secret
Scheme

Export: To
encrypted
Shares using
Shamir Secret
Scheme

RAM, in
plaintext

Power cycle

Derived from
KM and other
additional
data

Protects a share when
written to a smartcard
or softcard. This key is
used to derive using
KBKDF the keys
Ke  and Km used to
wrap the share.

encryption
and MAC keys

AES 256

HMAC-
SHA256

A3707

DSA 3072-bit

A3707

256 bits  Entrust root
warranting
public key for
Administrator
Cards and
Operator
Cards

256 bits  Session keys

n/a

Never

ECDH

for remote
admin
channel

AES 256

A3707

128 bits  Audit logging
key

DRBG

Never

n/a

RAM, in
plaintext

Power cycle
or channel
closure

Encryption and
decryption

MAC generation and
verification

Flash, in
plaintext

factorystate
or Initialize
Unit

Digital signature
generation of the
audit trail.

Entrust

Import: fw
update

n/a

Export: never

n/a

protected

Digital signature
verification to
authenticate remote
cards.

Flash, in
plaintext
, as part
of the
firmware
image

34 of 44

nShield 5s Hardware Security Module

Key/SSP/Name/Typ
e

Strengt
h

Security
Function and
Cert. Number

ECDSA P-521

A3707

DRBG entropy input

256 bits  nCoreAPI

(CSP)

DRBG

A3707

DRBG seed

256 bits  nCoreAPI

(CSP)

DRBG

A3707

DRBG internal state
('V' and 'C' values)

(CSP)

256 bits  nCoreAPI

DRBG

A3707

Generatio
n

Import/Expor
t

Establishmen
t

Storage  Zeroisation  Use & related keys

Never

n/a

RAM, in
plaintext

Power cycle  Random number

generation

Never

n/a

RAM, in
plaintext

Power cycle  Random number

generation

Never

n/a

RAM, in
plaintext

Power cycle  Random number

generation

520 bits
from
Platform
DRBG

Generated
as per SP
800-
90Arev1
with 696
bits from
Platform
DRBG:

520 bits
entropy
input

176 bits
random
nonce

Generated
as per SP
800-
90Arev1.

Table 24 Security World SSP table

As per IG 9.7.B, the zeroisation of SSPs is explicitly indicated by the successful return code of the
setup factorystate command. Temporary SSPs are zeroised implicitly.

9.2  SSP zeroization methods
Zeroization of all unprotected SSPs keys occurs immediately when the module is reset to the factory
state with the setup factorystate command.

9.3  Entropy sources
The cryptographic module has a hardware based true random number generator used to seed the
DRBGs.

Entropy sources

Minimum number of bits of
entropy

Details

nShield 5s Physical True Random
Number Generator

ESV cert#38

0.89 bits per output bit

Hardware entropy source compliant with SP 800-90B.

Minimum of 256 bits of entropy
for DRBG seed

As per the Public Use Document, no configuration of the
entropy source is required.

Table 25 Non-Deterministic Random Number Generation Specification

(total seed size of 512 bits)

nShield 5s Hardware Security Module

35 of 44

10  Self tests

The Cryptographic Module performs pre-operational, conditional and periodic self-tests. It also
supports pre-operational self-tests on demand by resetting the module.

In the event of a self-test failure, the module enters the error state. While in this state, the module
does not process any commands, and will indicate the error on the status LED and the error log,
which can be retrieved with the command monitor getlog.

10.1 Pre-operational self tests

10.1.1  Integrity tests

At start up, the following integrity tests are performed:

•  Firmware integrity is verified using RSA with 4096 bit key and SHA2-256.

•

Library partition integrity, is verified using ECDSA with curve P-521 and SHA2-512.

10.2 Conditional self tests

10.2.1  Crypto self tests

The following cryptographic algorithm self tests (CASTs) are run before the first use of any
cryptographic mechanism.

Algorithm

SHA2-256

RSA

AES ECB encrypt

AES ECB decrypt

AES CMAC

SHA-1

SHA-3

Description

Bootloader crypto

Known Answer Test

Known Answer Test (verification only) with 4096 bit key

nCore crypto

AES ECB Known Answer Test encryption with 128, 192 and 256-bit keys

AES ECB Known Answer Test decryption with 128, 192 and 256-bit keys

Known Answer Test: 128-bit key

SHA-1 Known Answer Test, other size are tested along with KAT HMAC

SHA3-224, SHA3-256, SHA3-384, SHA3-512 Known Answer Test

HMAC with SHA-1, SHA2-224, SHA2-256, SHA2-384,
SHA2-512

Known Answer Test

RSA

DSA

Known Answer Test: sign/verify, encrypt/decrypt with 2048-bit key

Pair-Wise consistency test: sign/verify

Known Answer Test: sign/verify with 2048-bit key

Pair-Wise consistency test: sign/verify

36 of 44

nShield 5s Hardware Security Module

Algorithm

ECDSA

KAS-FFC

KAS-ECC

One-step KDF

Two-step KDF

KBKDF

DRBG

SSH crypto

AES GCM encrypt

AES GCM decrypt

AES CTR encrypt

AES CTR decrypt

Description

KAT test: sign/verify with curves P-224 and B-233

Pair-Wise consistency test: sign/verify

Shared Secret Computation Known Answer Test DH

Shared Secret Computation Known Answer Test for ECDH with curves P-384
and B-233

Known Answer Test with SHA2-256 auxiliary function

Known Answer Test with HMAC-SHA256 auxiliary function

Known Answer Test

Health Tests according to SP 800-90Arev1 section 11.3

Known Answer Test encryption with 128 bit key

Known Answer Test decryption with 128 bit key

Known Answer Test encryption with 128 bit key

Known Answer Test decryption with 128 bit key

HMAC with SHA2-256 and SHA2-512

Known Answer Test

KAS-ECC

ECDSA

SSH KDF

Shared Secret Computation Known Answer Test for ECDH with curve P-256

KAT test: sign/verify with curves P-256 and P-521

SSH KDF Known Answer Test

10.2.2  SP 800-90B health tests

At start up, the SP 800-90B Adaptive Proportion Test and Repetition Count Test are run on the
output bits of the entropy source.

These tests are also run continuously during operation of the entropy source.

10.2.3  Pair-wise consistency tests

The module performs a pair-wise consistency test when RSA, DSA, ECDSA, DH and ECDH keys are
generated.

10.2.4  Firmware load test

Prior to updating the firmware, the cryptographic module validates the integrity and authenticity of
the image update package.

The module performs the following actions before replacing the current image:

•  Code signature verification with NPSK pub. The signature algorithm is ECDSA with SHA2-512

using the P-521 curve.

•  Verification that the Version Security Number (VSN) of the new image is not less than the

VSN of the current image. This check is done for roll-back protection.

nShield 5s Hardware Security Module

37 of 44

Note: A firmware image version loaded into this module that is not shown on the module certificate
is out of the scope of this validation and requires a separate FIPS 140-3 validation.

10.3 Periodic self tests
The following self tests are run periodically every 24 hours:

•  nCore crypto and SSH crypto self tests

•  SP 800-90B health tests

As per IG 10.3E Resolution #3 c), the bootloader is designed exclusively to launch the main firmware
for the module. In this architecture, as the module isn’t complete until the main firmware is
launched (replacing the bootloader in executable memory), it is redundant that the bootloader itself
implement a mechanism to run periodic tests.

38 of 44

nShield 5s Hardware Security Module

11  Life-cycle assurance

This section provides specific FIPS-related guidance to Administrators and Operators. This guidance
is aimed to complement the product user and installation guides which are delivered with the
cryptographic module.

11.1 Delivery

The nShield cryptographic module is sent to the customers using a standard carrier service. After
accepting the delivery of the module, a physical inspection of the module shall be performed (refer
to Physical Security section). This inspection is done to ensure that the module has not been
tampered with during transit. If the inspection results indicate that the module has not been
tampered with, the Administrator can then proceed with installation and configuration of the
module.

The cryptographic module supports firmware upgrades in the field, which are provided by Entrust as
a single signed firmware package (.npkg file).

11.2 Cryptographic module identification
This section provides instructions to inspect the cryptographic module´s fw and hw version
information and ensure they correspond with the FIPS 140-3 validated versions.

11.2.1  FW identification

The cryptographic module provides the service updater info which provides firmware version
information in JSON format.

Entrust provides the hsmadmin status command-line utility which calls the service updater info
internally.

hsmadmin status --json

{
    "D5DE-E1F8-D6E7": {
        "succeeded": true,
        "data": {
            "mode": "primary",
            "primary-version": "13.4.5-751-56c6f1db",
            "recovery-version": "13.2.4-280-7f4f0c24",
            "uboot-version": "1.1.0-1245-b9bedfa"
        }
    }
}

The following fields in the output must be checked:

nShield 5s Hardware Security Module

39 of 44

Field

Expected value

primary-version

13.4.5-751-56c6f1db

recovery-version

13.2.4-280-7f4f0c24

uboot-version

1.1.0-1245-b9bedfa or 1.4.1-0-edb84d6e

11.2.2  HW identification

The cryptographic module provides the command Cmd_NewEnquiry which reports hardware version
information.

Entrust provides the enquiry command-line utility which calls Cmd_NewEnquiry internally.

product name        nC5536E
hardware part no    PCA10005-01 revision 03

The following fields in the output must be checked:

Field

Expected value

product name

nC5536E or nC5536N

hardware part no

PCA10005-01 revision 03 or revision 04

Alternatively, the cryptographic module also provides the service setup info which provides
hardware version information in JSON format.

Entrust provides the hsmadmin info command-line utility which calls the service setup info
internally.

hsmadmin info --json

{
"15C8-4387-C748": {
"eeprom": {
...
,
"buildpart":
{ "value": "PCA10005-01", "crc": xxxxx }
,
"buildrev":
{ "value": "03", "crc": xxxxx }

...
}
}

The following fields in the output must be checked:

40 of 44

nShield 5s Hardware Security Module

Field

buildpart

buildrev

Expected value

"value": "PCA10005-01"

"value": "03" or "value": "04"

11.3 Approved mode of operation
When the cryptographic module is in factory state, it first needs to be initialized with the command
line utility hsmadmin enroll.

To configure the cryptographic module in approved mode, create a FIPS 140-3 level 3 compliant
Security World using Entrust supplied utility new-world and setting the mode to fips-140-level-3.

An operator can verify that the module is configured in approved mode with the command line
utility enquiry, which reports the following active modes:

 active modes         UseFIPSApprovedInternalMechanisms AlwaysUseStrongPrimes
FIPSLevel3Enforcedv2 StrictSP80056Ar3

or

 active modes         UseFIPSApprovedInternalMechanisms FIPSLevel3Enforcedv2
StrictSP80056Ar3

Once a FIPS 140-3 level 3 Security World is created, it is not possible to switch into a non-compliant
mode without first zeroising the unprotected SSPs.

11.4 End of life

Per FIPS 140-3 section 7.11.8, in the event that the module is no longer deployed or intended for
further use, the Crypto Officer shall zeroize and destroy the module. The module shall be taken to an
electronics recycling facility that offers (and assures) the physical destruction of e-waste.

nShield 5s Hardware Security Module

41 of 44

12  Mitigation of other attacks

Not applicable.

42 of 44

nShield 5s Hardware Security Module

Contact Us

Web site

Support

Email Support

https://www.entrust.com

https://nshieldsupport.entrust.com

nShield.support@entrust.com

Online documentation:

Available from the Support site listed above.

You can also contact our Support teams by telephone, using the following numbers:

Europe, Middle East, and Africa

United Kingdom:

Americas

Toll Free:

Fort Lauderdale:

Asia Pacific

Australia:

Japan:

Hong Kong:

+44 1223 622 444

One Station Square
Cambridge
CB1 2GA
UK

+1 833 425 1990

+1 954 953 5229

Sawgrass Commerce Center – A
Suite 130,
13800 NW 14 Street
Sunrise
FL 33323 USA

+61 9126 9070

World Trade Centre Northbank Wharf
Siddeley St
Melbourne VIC 3005
Australia

+81 50 3196 4994

+852 3008 4994

31/F, Hysan Place
500 Hennessy Road
Causeway Bay
Hong Kong

nShield 5s Hardware Security Module

43 of 44

To get help with
Entrust nShield HSMs

nShield.support@entrust.com

nshieldsupport.entrust.com

ABOUT ENTRUST CORPORATION

Entrust keeps the world moving safely by enabling trusted identities, payments
and data protection. Today more than ever, people demand seamless, secure
experiences, whether they’re crossing borders, making a purchase, accessing e-
government services or logging into corporate networks. Entrust offers an
unmatched breadth of digital security and credential issuance solutions at the
very heart of all these interactions. With more than 2,500 colleagues, a
network of global partners, and customers in over 150 countries, it’s no
wonder the world’s most entrusted organizations trust us.

