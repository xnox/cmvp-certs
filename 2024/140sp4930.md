Seagate SecureTM

Self-Encrypting Drive
Non-Proprietary FIPS 140-3 Module Security Policy
Security Level 2
Revision 0.8

Seagate Technology, LLC
This document may be reproduced and distributed in its original entirety without revision

Page 1

2.3.1
2.3.2

Contents
1
Introduction ..................................................................................................................................................... 4
1.1  Scope ............................................................................................................................................................ 4
1.2  Overview....................................................................................................................................................... 4
1.3  General ......................................................................................................................................................... 4
1.4  Terms and Acronyms ..................................................................................................................................... 4
2  Cryptographic Module Specification .................................................................................................................. 6
2.1  Cryptographic Module Information ................................................................................................................. 6
2.2  Cryptographic Module Tested Configurations................................................................................................... 8
2.3  Algorithms .................................................................................................................................................. 10
Approved Algorithms ...................................................................................................................... 10
Non-Approved, Not Allowed Algorithms .......................................................................................... 13
2.4  Cryptographic Boundary ............................................................................................................................... 14
2.5  Keys, Authentication, and Other Protected Information ................................................................................... 14
2.6  Degraded Mode of Operation ........................................................................................................................ 14
2.7  Requirements from International Standards .................................................................................................... 14
3  Cryptographic Module Interfaces ....................................................................................................................15
4  Roles, Services, and Authentication .................................................................................................................16
4.1  Roles, Service Command, Input and Output – TCG Security Mode .................................................................. 16
4.2  Roles, Service Command, Input and Output – ATA Security Mode (if ATA Security supported) ........................ 17
4.3  Roles and Authentication – TCG Security Mode ............................................................................................. 17
4.4  Roles and Authentication – ATA Security Mode (if ATA Security supported) .................................................. 18
4.5  Approved Services, SSPs, Roles, and Access Rights ....................................................................................... 18
Approved Services – TCG Security Mode ......................................................................................... 18
Approved Services – ATA Security Mode (if ATA Security supported) ............................................... 22
4.6  Non-Approved Services ................................................................................................................................ 24
5
Software / Firmware Security ..........................................................................................................................25
6  Operational Environment ................................................................................................................................26
Physical Security ...........................................................................................................................................27
7
8  Non-Invasive Security ....................................................................................................................................29
9
Sensitive Security Parameter Management .......................................................................................................30
9.1  SSP Storage Areas ....................................................................................................................................... 30
9.2  SSPs ........................................................................................................................................................... 31
9.3  Entropy Sources ........................................................................................................................................... 34
9.4  Zeroization Methods..................................................................................................................................... 34
10  Self-Tests ......................................................................................................................................................36
10.1  Pre-Operational Self-Tests ............................................................................................................................ 36
10.2  Conditional Self-Tests .................................................................................................................................. 36
11  Life-Cycle Assurance .....................................................................................................................................38
11.1  Delivery and Operation ................................................................................................................................. 38
11.1.1  TCG Enterprise Secure Initialization................................................................................................. 38
11.1.2  TCG Enterprise Ongoing Policy Restrictions ..................................................................................... 38
11.1.3  ATA Security Secure Initialization ................................................................................................... 38
11.1.4  ATA Security Ongoing policy Restrictions ........................................................................................ 38
11.2  End of Life .................................................................................................................................................. 39
12  Mitigation of Other Attacks ............................................................................................................................40

4.5.1
4.5.2

Page 2

Table 1-1: Security Levels ....................................................................................................................................... 4
Table 1-2: Terms and Acronyms ............................................................................................................................... 5
Table 2-1: Cryptographic Module Tested Configurations ............................................................................................ 9
Table 2-2: Hardware Substitute Configurations ........................................................................................................10
Table 2-3: Approved Algorithms (HW) ...................................................................................................................11
Table 2-4: Approved Algorithms (FW) ...................................................................................................................13
Table 2-5: Non-Approved Algorithms Not Allowed in the Approved Mode of Operation ............................................13
Table 3-1: Ports and Interfaces ...............................................................................................................................15
Table 4-1: Roles, Service Commands, Input and Output – TCG Security Mode ..........................................................17
Table 4-2: Roles, Service Commands, Input and Output - ATA Security Mode ..........................................................17
Table 4-3: Roles and Authentication - TCG Security Mode .......................................................................................18
Table 4-4: Roles and Authentication - ATA Security Mode ......................................................................................18
Table 4-5: Approved Services - TCG Security Mode ................................................................................................22
Table 4-6: Approved Services – ATA Security Mode ...............................................................................................23
Table 4-7 Non-Approved Services ..........................................................................................................................24
Table 7-1: Physical Security Inspection Guidelines ..................................................................................................28
Table 9-1: SSP Storage Areas .................................................................................................................................30
Table 9-2: SSPs .....................................................................................................................................................33
Table 9-3: Non-Deterministic Random Number Generation Specification ..................................................................34
Table 10-1: Pre-Operational Self-Tests....................................................................................................................36
Table 10-2: Conditional Self-Tests ..........................................................................................................................37

Figure 1: Seagate Self-Encrypting Drive ................................................................................................................... 7
Figure 2: Hardware Block Diagram ........................................................................................................................14
Figure 3: Module 1 Seal Application Locations ........................................................................................................27

Page 3

1  Introduction

1.1  Scope

This  security  policy  applies  to  the  FIPS  140-3  Cryptographic  Module  (CM)  embedded  in  Seagate
Secure® Self-Encrypting Drive products.

This document meets the requirements of the FIPS 140-3 standard. It does not provide interface details
needed to develop a compliant application.

This document is non-proprietary and may be reproduced in its original entirety.

1.2  Overview

The Seagate Secure® Self-Encrypting Drive FIPS 140-3 Module is embodied in Seagate Exos™
Enterprise SED model devices. These products meet the performance requirements of the most
demanding Enterprise applications. The Cryptographic Module (CM) provides a wide range of
cryptographic services including:

•  Hardware based data encryption (AES-XTS)
•
•
•  Authenticated FW download.

Instantaneous user data disposal with cryptographic erase
Independently controlled and protected user data LBA bands

These services are provided through industry standard TCG Enterprise SSC, SATA, or SCSI
protocols.

1.3  General

ISO/IEC 24759:2017 Section 6
[Number Below]
1
2
3
4
5
6
7
8
9
10
11
12

FIPS 140-3 Section Title

Security Level

General
Cryptographic Module Specification
Cryptographic Module Interfaces
Roles, Services, and Authentication
Software / Firmware Security
Operational Environment
Physical Security
Non-Invasive Security
Sensitive Security Parameter Management
Self-Tests
Life-Cycle Assurance
Mitigation of Other Attacks

Table 1-1: Security Levels

2
2
2
2
2
N/A
2
N/A
2
2
2
N/A

The overall security level pursued for the CM (Cryptographic Module) is Security Level 2.

1.4  Terms and Acronyms

Term / Acronym
AES
CBC
CKG
CM
CMAC
CO

Definition
Advanced Encryption Standard (FIPS 197)
Cipher Block Chaining
Cryptographic Key Generation
Cryptographic Module
Cipher-based Message Authentication Code
Crypto-Officer

Page 4

Term / Acronym
CSP
CSPSK
DRBG
ECB
FW
GCM
HDD
HMAC
IID
IV
KAT
KAS SSC FFC

KDF
LBA
MEK
MEKEK
PCBA
PBKDF
POR
PSP
PSK
PSID
RSA
SAK
SAS
SATA
SCSI
SED
SHA
SSC
SSP
TCG
XTS

Definition
Critical Security Parameter
Critical Security Parameter Sanitization Key
Deterministic Random Bit Generator
Electronic Codebook Mode
Firmware
Galois Counter Mode
Hard Disk Drive
Hash-based Message Authentication Code
Independent and Identically Distributed
Initialization Vector
Known Answer Test
Key Agreement Schemes Shared Secret Computation Finite Field
Cryptography
Key Derivation Function
Logical Block Address
Media Encryption Key
Media Encryption Key Encryption Key
Printed Circuit Board Assembly
Password-Based Key Derivation Function
Power-On Reset
Public Security Parameter
Pre-Shared Key (for TLS handshake)
Physical Security ID
Rivest-Shamir-Adleman public-key cryptosystem
Signing Authority Key
Serial Attached SCSI
Serial ATA (AT Attachment)
Small Computer System Interface
Self-Encrypting Drive
Secure Hash Algorithm
Security Subsystem Class
Sensitive Security Parameter
Trusted Computing Group
XEX-based tweaked-codebook mode with ciphertext stealing

Table 1-2: Terms and Acronyms

Page 5

2  Cryptographic Module Specification

2.1  Cryptographic Module Information

The Cryptographic Module (CM) is defined as a hardware module. It is a multi-chip embedded
physical embodiment contained in a full drive enclosure. No part of the enclosure is excluded from the
security requirements. A photo of an example module is provided in Figure 1.

The physical interface to the CM is a SATA or SAS connector. The data carried over the SATA and
SAS connectors conform to the industry-standard SCSI, SATA, or TCG Enterprise SSC.

The primary function of the module is to provide data encryption access control and cryptographic
erase of the data stored on the drive media. The human operator of the drive interfaces with the CM
through a “host” application on a host system. There is also an LED status indicator on the CM.

The CM may operate in one of two mutually exclusive security modes:

•  TCG Security Mode – In the Security mode, access control for User Data is managed by the

Locking SP. In TCG mode the CM can support multiple independent User Data bands/ranges via
the TCG Enterprise SSC protocol. To operate the CM in TCG Security Mode, the host must follow
the steps described in 11.1.1 and 11.1.2.

•  ATA Security Mode – In ATA mode, access control for User Data is managed by the ATA Security
State. In ATA mode, the CM only supports a single User Data LBA band/range that includes all
LBAs on the CM. To operate the CM in ATA Security Mode, the host must follow the steps
described in 11.1.3 and 11.1.4.

Note: ATA Security mode is only supported on CMs that support the ATA Security feature set.

When the CM is in the TCG Security Mode or ATA Security Mode, the CM is in a Compliant state
if the steps described in 11.1 are followed. If the CM is in a Compliant state, whether or not the
CM is in an Approved mode or a Non-Approved mode is dependent on what types of services the
host invokes. If the host invokes an Approved service, then the CM is an Approved mode. If the
host invokes a Non-Approved service, then the CM is in a Non-Approved mode.

Page 6

Figure 1: Seagate Self-Encrypting Drive

Page 7

Distinguishing Features
Self-Encrypting Drive SAS
(Enterprise SSC)

Self-Encrypting Drive SAS
(Enterprise SSC)

2.2  Cryptographic Module Tested Configurations

Model
Exos X18 3.5”
SAS HDD

Hardware [Part Number
and Version]
ST18000NM007J

ST16000NM007J

ST14000NM007J

ST12000NM007J

ST10000NM016G

Exos 7E10 3.5”
SAS HDD

ST10000NM022B

ST10000NM011B

ST8000NM022B

ST8000NM011B

ST6000NM024B

ST6000NM013B

ST4000NM013B

Page 8

Firmware
Version
EP7U
EF07
EP7U
EF07
P705
PSFG
FQD4
HPD5
EP7U
EF07
EP7U
EF07
P705
PJ07
FQD4
EP7U
EF07
EF34
EF04
EF34
KF04
EF34
EF04
GCN6
LT0E
FRD6
FCE7
FCL7
3P01
HPD5
EF34
KF04
L708
EF34
EF04
FCE7
FCL7
EF34
KF04
EF34

Distinguishing Features

Self-Encrypting Drive SATA
(Enterprise SSC)

Model

Hardware [Part Number
and Version]

ST4000NM029B

ST4000NM017B

Exos 7E10 3.5”
SATA HDD

ST10000NM021B

ST8000NM021B

ST6000NM023B

ST4000NM012B

ST4000NM028B

Firmware
Version
NF04
FRB5
FKE8
FKL8
HPD6
EF34
EF04
3P01
EF34
KF04
L708
SZFP
SF04
SZFP
SF04
HPG4
SZFP
SF04
SZFP
TF04
HPG4
SZFP
SF04

Table 2-1: Cryptographic Module Tested Configurations

Select Hardware and Firmware Version combinations will output a different hardware version
identification during the “Compliance Indicator Service” as detailed in the table below. There has
been no change to the hardware itself.

Hardware [Part
Number and
Version]

Firmware Version

Show Version
Output

ST8000NM022B

3P01

SCBP8000S5xeF7.2

ST4000NM029B

3P01

SCBP4000S5xeF7.2

ST8000NM022B

HPD5

MB008000MYDUD

ST4000NM013B

HPD6

MB004000MYDUB

ST8000NM021B

HPG4

MB008000SYDUC

ST4000NM012B

HPG4

MB004000SYDUA

ST16000NM007J

HPD5

MB016000MYDKC

ST12000NM007J

PJ07

STEPSKF4CLAR12T0

Page 9

Table 2-2: Hardware Substitute Configurations

2.3  Algorithms

This section describes the algorithms used by the CM. The Approved algorithms are described in
section 2.3.1 and the Non-Approved Not Allowed algorithms are described in section 2.3.2. The CM
does not implement any of the following categories of cryptographic algorithms:
•  Non-Approved Algorithms Allowed in the Approved Mode of Operation
•  Non-Approved Algorithms Allowed in the Approved Mode of Operation with No Security

Claimed

Note: Not all algorithms, modes, and key sizes that appear in the module’s ACVP certificates are
utilized by the module.

2.3.1  Approved Algorithms

The Approved algorithms used by the CM are shown in Table 2-3: Approved Algorithms (HW) and
Table 2-4: Approved Algorithms (FW).

Mode / Method  Description / Key Size(s) /

Use / Function

CAVP
Cert

Algorithm &
Standard

Key Strength(s)

Prediction Resistance: Yes
Mode: AES-256
Derivation Function Enabled:
Yes
Additional Input: 0 bits, 256 bits
Entropy Input: 256 bits
Nonce: 128 bits
Personalization String Length:
0 bits, 256 bits
Returned Bits: 256 bits
Key Size: 256 bits
Key Strength: 256 bits

MAC: 256 bits
Key Length: 8-512 bits,
Increment 8
Message Length: 0-65528 bits,
Increment 8 bits
Signature Type: PKCS 1.5
Modulo: 2048, 3072
Key Strength: 112-bit, 128-bit
Hash Algorithm: SHA2-256
(#A1092)
Public Exponent Mode:
Random
Direction: Generation
Key Length: 256 bits
Key Strength: 256 bits
MAC Length: 8-128 bits,
Increment 8 bits
Message Length: 128-512 bits
Increment 128 bits
N/A

Random-bit generation

Encryption / decryption

Pseudo random function
for PBKDF

Cryptographic hashing

Signature verification

Conditioner for the raw
entropy from the Ring
Oscillator entropy source

Used as a part of the
DRBG

Used as a part of the
DRBG

#A1082  Counter DRBG [SP
800-90A]

AES-256

#A1090

AES-XTS [SP 800-38E]  XTS

#A1091

HMAC-SHA2-256 [FIPS
198-1]

SHA2-256

#A1092

SHA2-256 [FIPS 180-4]  SHA2-256

#A1093

RSA SigVer (FIPS186-
4) [FIPS 186-4]

PKCS 1.5

#A3515

AES-CMAC [SP 800-
38B]

CMAC

N/A

ENT (P) [SP 800-90B]

Ring Oscillators
Entropy Source

N/A

ENT (P) [SP 800-90B]

PES Entropy
Source

N/A

Page 10

Table 2-3: Approved Algorithms (HW)

Page 11

CAVP
Cert
#A1080

Algorithm & Standard

Mode / Method

AES-GCM [SP 800-38D]1  GCM

#A1081  AES-CMAC [SP 800-38B]  CMAC

#A1083

HMAC-SHA2-256 [FIPS
198-1]

SHA2-256

#A1084

KAS-FFC-SSC Sp800-
56Ar3 [SP 800-56A rev3]

dhEphem

KAS [SP 800-56A rev3]

SP 800-56A
rev3. KAS-FFC
per IG D.F
Scenario 2 path
(2)

#A1084
(KAS-
FFC-
SSC
Cert.),
#A1089
(KDF
TLS
Cert)

#A1085  PBKDF [SP 800-132 rev1]  Option 2a2

#A1087  Safe Primes Key

ffdhe2048

Generation [SP 800-56A
rev3]
SHA2-256 [FIPS 180-4]

#A1088

SHA2-256

SHA2-384 [FIPS 180-4]

SHA2-384

Description / Key Size(s) / Key
Strength(s)
Direction: Encrypt, Decrypt
IV Generation: Internal
IV Generation Mode: 8.2.2
Key Length: 128 bits, 256 bits
Tag Length: 128 bits
IV Length: 96 bits
Payload Length: 128 bits, 256
bits
AAD Length: 0 bits, 256 bits
Direction: Generation,
Verification
Key Length: 128 bits, 256 bits
MAC Length: 128 bits
Message Length: 0-65536 bits
Increment 8 bits
MAC: 256 bits
Key Length: 8-512 bits Increment
8 bits
Domain Parameter Generation
Methods: ffdhe2048
Key Strength: 112 bits
Scheme:
dhEphem:
KAS Role: initiator, responder
Key Size: 2048 bits
Key Strength: 112 bits

Use / Function

Key wrapping
(encryption /
decryption)

Conditioner for the
raw entropy

Key derivation for
Secure Messaging

Key Agreement for
Secure Messaging

Key Agreement and
Derivation for Secure
Messaging

Iteration Count: 1-10000000,
Increment 1
HMAC Algorithm: HMAC-SHA2-
256 (#A1091)
Password Length: 8-64 bytes
Increment 1
Salt Length: 128-512 bits,
Increment 8 bits
Key Data Length: 112-4096 bits
Increment 8 bits
Safe Prime Groups: ffdhe2048
Key Strength: 112 bits

Key derivation3

Key Generation for
dhEphem

Message Length: 0-65528 bits
Increment 8 bits
Message Length: 0-65528 bits
Increment 8 bits

Cryptographic
hashing
Cryptographic
hashing

1 The 96-bit IV used for AES GCM is generated by the module randomly by the DRBG.
2 The value of the Iteration Count used is 1000 which meets the requirements in [SP 800-132 rev1] and
customer performance requirements.
3 All keys derived used PBKDF are only used for storage applications.

Page 12

#A1089

KDF TLS (CVL) [SP 800-
135 rev1]

TLS v1.2

TLS Version: v1.2
Hash Algorithm: SHA2-256
(#A1088), SHA2-384 (#A1088)

#A1094

AES-KW [SP 800-38F]

KW

#A1095  AES-CBC [SP 800-38A]

CBC

Vendor
Affirmed

CKG [SP 800-133 rev2]

Sections 4, 5.2
and 6.1

Direction: Decrypt, Encrypt
Cipher: Cipher
Key Length: 256 bits
Key Strength: 256bits
Payload Length: 128 bits, 192
bits, 256 bits, 320 bits, 4096 bits
Key Length: 128 bits, 256 bits
Key Strength: 128bits, 256 bits
Cryptographic Key Generation;
SP 800-133 rev2 and IG D.H

Key derivation for
Secure Messaging.
No parts of the TLS
protocol, other than
the approved
cryptographic
algorithms and TLS
KDF, have been
tested by the CAVP
and CMVP.
Key wrapping

Encryption /
decryption
Key Generation

Note: Symmetric keys
and seeds used for
asymmetric key pairs
are produced using
the unmodified/direct
output of the DRBG.

Table 2-4: Approved Algorithms (FW)

2.3.2  Non-Approved, Not Allowed Algorithms

The Non-Approved, Not Allowed algorithms used by the CM are shown in Table 2-5: Non-Approved
Algorithms Not Allowed in the Approved Mode of Operation.

Algorithm / Function

AES-CMAC (non-compliant)

Use / Function

Message authentication

AES-GCM (non-compliant)

Key wrapping (encryption / decryption)

AES-KW (non-compliant)

Key wrapping (encryption / decryption)

AES-XTS (non-compliant)
PBKDF (non-compliant)

Encryption / decryption
Password-based key derivation

RSA SigGen (non-compliant)

Signature generation

Table 2-5: Non-Approved Algorithms Not Allowed in the Approved Mode of Operation

Page 13

2.4  Cryptographic Boundary

The cryptographic boundary is the enclosure of the drive. The only accessible interfaces to the CM
are the SAS/SATA interface and the Power connector. A block diagram of the CM is provided in
Figure 2.

2.5  Keys, Authentication, and Other Protected Information

Figure 2: Hardware Block Diagram

Keys and Protected Information are listed in Section 9 of this document. Authentication is listed in
Section 4 of this document.

2.6  Degraded Mode of Operation

The CM does not support a degraded mode of operation.

2.7  Requirements from International Standards

The CM follows many standards including:

•  SAS: http://en.wikipedia.org/wiki/Serial_attached_SCSI
•  SATA: https://en.wikipedia.org/wiki/Serial_ATA
•  TCG Enterprise: https://trustedcomputinggroup.org/work-groups/storage/

Page 14

3  Cryptographic Module Interfaces

Physical Port
SAS Connector

SATA Connector

LED
Power Connector
Serial Port

Logical Interface
•  Data input
•  Data output
•  Control input
•  Status output
•  Data input
•  Data output
•  Control input
•  Status output
Status output
Power input
Disabled

Data that Passes Over Port / Interface
•  TCG Packets
•  SCSI Packets

•  TCG Packets
•  SATA Packets

N/A
N/A
N/A

The CM does not support a control output interface.

Table 3-1: Ports and Interfaces

Page 15

4  Roles, Services, and Authentication

This section describes the roles, services, and authentications supported by the CM.

Some services in this section are identified as aligning with the “lock-based authentication model”. The
“lock-based authentication model” is described in IG 4.1.A. The primary purpose of the CM is data-at-
rest protection for User Data and the “lock-based authentication model” is sufficient to meet this use
case. Assuming the CM has been correctly initialized (see section 11.1), when the CM is powered
cycled, the CM will be in a locked state and will require authentication and unlocking prior to the
Approved service being available.

4.1  Roles, Service Command, Input and Output – TCG Security Mode

Role
Drive Owner (Crypto Officer)

Service
Set PIN
Set FW Ports
Set TLS PSK
Create TLS
Session
Send/Receive TLS
Message
FW Download4

EraseMaster (Crypto Officer)  Set PIN

Cryptographic
Erase
Certified Erase
Enable/Disable
BandMasters
Set TLS PSK
Create TLS
Session
Send/Receive TLS
Message
Set PIN
Set Range
Attributes
Lock / Unlock User
Data for Read
and/or Write
Set TLS PSK
Create TLS
Session
User Data Read /
Write (Locking
Enabled)5
Send/Receive TLS
Message
Show Status

BandMaster (0-31) (Crypto
Officer)

Unauthenticated

Output
TCG Return
Status

Interface Return
Status

TCG Return
Status

Interface Return
Status
TCG Return
Status

Input
TCG Set Method
TCG Set Method
TCG Set Method
TCG StartTLS Method

IF-Send/IF-Receive

Interface FW Download
Command
TCG Set Method
TCG Erase Method

TCG Erase Method
TCG Set Method

TCG Set Method
TCG StartTLS Method

IF-Send/IF-Receive

TCG Set Method
TCG Set Method

TCG Set Method

TCG Set Method
TCG StartTLS Method

Interface Read / Write
Command

Interface Return
Status

IF-Send/IF-Receive

TCG Level 0 Discovery,
TCG Get Method

4 No operator authentication is enforced for the FW Download service that was unlocked by the
Set FW Ports service. If the new FW violates device FW rollback policy both the FW Download
and Rollback FW Download ports must be unlocked. This service aligns with the “lock-based
authentication model” (see section 4).
5 No operator authentication is enforced for the User Data Read / Write service that was unlocked
by the Lock / Unlock User Data for Read and/or Write service. This service aligns with the “lock-
based authentication model” (see section 4).

Page 16

Role

Service
Reset Module
Unblock PIN
DRBG Generate
Bytes
Exit FIPS Mode
Compliance
Indicator

Input
POR
POR
TCG Random Method

TCG RevertSP Method
TCG Level 0 Discovery

Output
TCG Return
Status

Table 4-1: Roles, Service Commands, Input and Output – TCG Security Mode

4.2  Roles, Service Command, Input and Output – ATA Security Mode (if ATA Security

supported)

Role
Drive Owner (Crypto Officer)

Service
Set PIN/Password
Set FW Ports
FW Download6

Input
TCG Set Method
TCG Set Method
Interface FW Download
Command

Master, User (Crypto Officer)  Set PIN/Password  ATA Security Set

Unauthenticated

Lock / Unlock User
Data for Read
and/or Write
Cryptographic
Erase
User Data Read /
Write7
Show Status
Reset Module
Unblock PIN
Disable Services
Exit FIPS Mode
Compliance
Indicator

Password
ATA Authenticate

ATA Erase

Interface Read / Write
Command
TCG Level 0 Discovery
POR
POR
ATA Freeze Lock
TCG RevertSP Method
TCG Level 0 Discovery

Output
TCG Return
Status
Interface Return
Status
Interface Return
Status

TCG Return
Status

Table 4-2: Roles, Service Commands, Input and Output - ATA Security Mode

4.3  Roles and Authentication – TCG Security Mode

Role
Drive Owner (Crypto Officer)

EraseMaster (TCG Security
Mode) (Crypto Officer)

Authentication Method
Role-based authentication.
Memorized Secret
Authenticator type from SP
800-63B.

Role-based authentication.
Memorized Secret
Authenticator type from SP
800-63B.

Authentication Strength
Min PIN length is 8 bytes (64 bits)
and each failed authentication takes
a minimum of 15ms which calculates
into a probability to guess the PIN in
one minute to 4000/264
Min PIN length is 8 bytes (64 bits),
and each failed authentication takes
a minimum of 15ms which calculates
into a probability to guess the PIN in
one minute to 4000/264

6 No operator authentication is enforced for the FW Download service that was unlocked by the
Set FW Ports service. If the new FW violates device FW rollback policy both the FW Download
and Rollback FW Download ports must be unlocked. This service aligns with the “lock-based
authentication model” (see section 4).
7 No operator authentication is enforced for the User Data Read / Write (Locking Enabled) service
that was unlocked by the Lock / Unlock User Data for Read and/or Write service. This service
aligns with the “lock-based authentication model” (see section 4).

Page 17

Role
BandMaster (0-31) (TCG
Security Mode) (Crypto Officer)

Authentication Method
Role-based authentication.
Memorized Secret
Authenticator type from SP
800-63B.

Authentication Strength
Min PIN length is 8 bytes (64 bits),
and each failed authentication takes
a minimum of 15ms which calculates
into a probability to guess the PIN in
one minute to 4000/264

Table 4-3: Roles and Authentication - TCG Security Mode

4.4  Roles and Authentication – ATA Security Mode (if ATA Security supported)

Role
Drive Owner (Crypto Officer)

User (ATA Security Mode)
(Crypto Officer)

Master (ATA Security Mode
(Crypto Officer)

Authentication Method
Role-based authentication.
Memorized Secret
Authenticator type from SP
800-63B.

Role-based authentication.
Memorized Secret
Authenticator type from SP
800-63B.

Role-based authentication.
Memorized Secret
Authenticator type from SP
800-63B.

Authentication Strength
Min PIN length is 32 bytes (256
bits), and each failed authentication
takes a minimum of 15ms which
calculates into a probability to guess
the PIN in one minute to 4000/2256
Min PIN length is 32 bytes (256
bits), and each failed authentication
takes a minimum of 15ms which
calculates into a probability to guess
the PIN in one minute to 4000/2256
Min PIN length is 32 bytes (256
bits), and each failed authentication
takes a minimum of 15ms which
calculates into a probability to guess
the PIN in one minute to 4000/2256

Table 4-4: Roles and Authentication - ATA Security Mode

4.5  Approved Services, SSPs, Roles, and Access Rights

If the CM is operating in TCG Security Mode, the Approved services provided by the CM are described in
section 4.5.1. If the CM is operating in ATA Security Mode, the Approved services provided by the CM are
described in 4.5.2.

4.5.1  Approved Services – TCG Security Mode

Service

Description  Approved

Security
Functions

Roles

Keys
and/or
SSPs

Set PIN

Change
operator
authentication
data

PBKDF
(#A1085), AES-
GCM (#A1080),
HMAC-SHA2-256
(#A1091), SHA2-
256 (#A1092)

EraseMaster
Password,
BandMaster
Password,
SID

EraseMaster,
BandMaster,
Drive Owner

Access
rights
to
Keys
and/or
SSPs8
W

Indicator

TCG Return
Status

8 Definitions for Roles SSP Access column values:

•  G = Generate: The module generates or derives the SSP
•  R = Read: The SSP is read from the module (e.g., the SSP is an output)
•  W = Write: The SSP is updated, imported, or written to the module
•  E = Execute: The module uses the SSP in performing a cryptographic operation
•  Z = Zeroize: The module zeroizes the SSP

Page 18

Access
rights
to
Keys
and/or
SSPs8
E

Indicator

ATA/SCSI
Status

Service

Description  Approved

Security
Functions

Roles

Keys
and/or
SSPs

FW Download  Load complete

FW image. If
code self-test
passes with a
valid key,
device runs
new code.
Enable /
disable a user
authority

Enable /
Disable
BandMasters

Set FW Ports  Set

PortLocked
and
LockOnReset
attributes on
the FW
Download port
or Rollback
FW Download
port
Set location,
size, and
locking
attributes of an
LBA range
Block or allow
read (decrypt)
or write
(encrypt) of
user data in a
range
Encrypt /
decrypt user
data from an
LBA range
where Locking
is enabled10
Erase user
data in LBA
range and
place the
range in the
uninitialized
state.

Set Range
Attributes

Lock / Unlock
User Data
Range for
Read and/or
Write

User Data
Read / Write
(Locking
Enabled)

Cryptographic
Erase

RSA SigVer
(#A1093, 3072-
bit), SHA2-256
(#A1092)

Firmware
Update Key,
Platform
Key, SAK

Drive Owner9

PBKDF
(#A1085),
HMAC-SHA2-256
(#A1091), SHA2-
256 (#A1092)
None

BandMaster
Password

EraseMaster

E

TCG Return
Status

None

Drive Owner

E

TCG Return
Status

None

None

BandMasters

None

TCG Return
Status

AES-KW
(#A1094)

MEK,
MEKEK,
CSPSK

BandMasters

E

TCG Return
Status

AES-XTS
(#A1090)

None

MEK

BandMasters11

E

ATA/SCSI
Status

EraseMaster

Z

TCG Return
Status

MEKEK,
MEK,
Master Key,
CSPSK,
Bandmaster
Password

9 FW download port must be unlocked.
10 Locking is enabled for an LBA range if the ReadLockEnabled and WriteLockEnabled values are set to
“True” and the LockOnReset value includes “Power Cycle”. The current values of these attributes can be
determined using the Show Status Approved Service (i.e., the TCG Get Method on the associated LBA range
locking object).
11 User Data range must be unlocked.

Page 19

Service

Description  Approved

Security
Functions

Roles

Keys
and/or
SSPs

None

None

Drive Owner

Access
rights
to
Keys
and/or
SSPs8
None

Indicator

ATA/SCSI
Status

FW Rollback

Create TLS
Session

Prevents
downgrading
FW to a
release that
violates the
device FW
rollback policy
Support host-
initiated TLS
Session

Set TLS PSK

Set Pre-
Shared key
used for TLS

None

Send/Receive
TLS Message

Send or
receive a TLS
message

Certified
Erase

Show Status

 Erase user
data in LBA
range and
place the
range in the
uninitialized
state.

Provides
information on
the current
configuration
of the CM and
reports
whether FIPS
service is
operational
and operating
in a Compliant
state.

Safe Primes Key
Generation (#
A1087), KAS
(#A1084), KDF
TLS (#A1089),
HMAC-SHA2-256
(#A1083)

AES-CBC
(#A1095), AES-
GCM (#A1080),
SHA2-256
(#A1088), SHA2-
384, (#A1088)

None

Drive Owner,
EraseMaster,
BandMaster

E

TCG Return
Status

Drive Owner,
EraseMaster,
BandMaster

Drive Owner,
EraseMaster,
BandMaster

W

E

TCG Return
Status

ATA/SCSI
Status

EraseMaster

Z

TCG Return
Status

Secure
Messaging
Session
Key, Secure
Messaging
Key Pair,
Bandmaster
PSKs,
EraseMaster
PSK, Drive
Owner PSK

BandMaster
PSKs,
EraseMaster
PSK, Drive
Owner PSK

Secure
Messaging
Session
Key, Secure
Messaging
Key Pair

MEKEK,
MEK,
Master Key,
CSPSK,
Bandmaster
Password

None

None

None

None

TCG Return
Status,
ATA/SCSI
Status

Page 20

Service

Description  Approved

Security
Functions

Roles

Keys
and/or
SSPs

Access
rights
to
Keys
and/or
SSPs8
Z

Indicator

N/A

RSA SigVer
(#A1093, 3072-
bit), SHA2-256
(#A1092)

None

SID,
EraseMaster
Password,
BandMaster
Password

Reset Module  Runs Pre-

Operational
Self- Tests
and zeroizes
keys and
CSPs in RAM
and complete
the Secure
Boot process
by validating
the FW on the
drive.

Resets
password
attempt
counters

Returns
SP800-90A
rev1 DRBG
random
number

Unblock PIN

DRBG
Generate
Bytes

Exit FIPS
Mode

Exit a
Compliant
state12

None

None

None

None

N/A

Counter DRBG
(#A1082), AES-
CMAC (#A1081)
AES-CMAC
(#A3515), ENT
(P)

None

None

None

None

TCG Return
Status

None (using
PSID)

Z

TCG Return
Status

SID
Password,
EraseMaster
Password,
BandMaster
Password,
MEKs,
MEKEKs,
Master
Keys,
CSPSKs,
EraseMaster
PSK,
BandMaster
PSKs, Drive
Owner PSK

None

None

None

None

TCG Return
Status

Compliance
Indicator

Reports FIPS
140 revision,
overall security
level, HW and
FW revisions,
and module
name

12 CM will enter Uninitialized State.

Page 21

4.5.2  Approved Services – ATA Security Mode (if ATA Security supported)

Table 4-5: Approved Services - TCG Security Mode

Service

Description

Approved
Security
Functions

Keys
and/or
SSPs

Roles

Access
rights to
Keys
and/or
SSPs13
W

Indicator

TCG Return
Status, ATA
Status

Master,
User
Passwords

Master,
User, Drive
Owner

Drive
Owner14

E

TCG Return
Status, ATA
Status

Firmware
Update
Key,
Platform
Key, SAK

PBKDF
(#A1085), AES-
GCM (#A1080),
HMAC-SHA2-
256 (#A1091),
SHA2-256
(#A1092)
RSA SigVer
(#A1093, 3072-
bit), SHA2-256
(#A1092)

None

None

AES-KW
(#A1094)

AES-XTS
(#A1090)

None

None

MEK

MEK

MEKEK,
MEK,
Master
Keys,
CSPSK,
User
Password
None

Drive
Owner

User
(optional,
Master)

User
(optional,
Master)15
Master,
User

None

ATA Status

E

E

Z

ATA Status

ATA Status

ATA Status

None

None

N/A

None

None

Drive
Owner

E

TCG Return
Status

Set
PIN/Password

FW Download

FW Rollback

Lock / Unlock
User Data
Range for Read
and/or Write
User Data
Read / Write

Cryptographic
Erase

Unblock PIN

Set FW Ports

Change operator
authentication data.
Note: Setting the
User PIN may also
set the Drive Owner
PIN

Enable / disable FW
download port and
load complete FW
image. If code self-
test passes with a
valid key, device
runs new code
Prevents
downgrading FW to
a release that
violates the device
FW rollback policy
Enable user data
read/write and Set
PIN services

Encryption /
decryption of user
data
Erase user data on
CM and place the
CM in the
uninitialized state.

Reset Master and
User password
attempt counter
Set PortLocked and
LockOnReset
attributes on the
FW Download port
or Rollback FW
Download port

13 Definitions for Roles SSP Access column values:

•  G = Generate: The module generates or derives the SSP
•  R = Read: The SSP is read from the module (e.g., the SSP is an output)
•  W = Write: The SSP is updated, imported, or written to the module
•  E = Execute: The module uses the SSP in performing a cryptographic operation
•  Z = Zeroize: The module zeroizes the SSP

14 FW download port must be unlocked.
15 User Data must be unlocked.

Page 22

Service

Description

Approved
Security
Functions

Keys
and/or
SSPs

Roles

None

None

None

Access
rights to
Keys
and/or
SSPs13
None

Indicator

ATA Status
/ TCG
Return
Status

Show Status

Reset Module

Disable
Services

Provides
information on the
current
configuration of the
CM and reports
whether FIPS
service is
operational and
operating in a
Compliant state.
Runs Pre-
Operational Self-
Tests and zeroizes
keys and CSPs in
RAM and complete
the Secure Boot
process by
validating the FW
on the drive.
Disables ATA
Security commands
until POR

RSA SigVer
(#A1093, 3072-
bit), SHA2-256
(#A1092)

Master
Password,
User
Password

None

Z

N/A

None

None

None

None

ATA Status

Exit FIPS Mode  Exit a Compliant

None

state16

Compliance
Indicator

None

Reports FIPS 140
revision, overall
security level, HW
and FW revisions,
and module name

Master
Password,
User
Password,
MEK,
MEKEK,
Master
Keys,
CSPSK
None

None
(using
PSID)

Z

TCG Return
Status

None

None

TCG Return
Status

Table 4-6: Approved Services – ATA Security Mode

16 CM will enter Uninitialized State.

Page 23

4.6  Non-Approved Services

The Non-Approved services provided by the CM are described in Table 4-7.

Service

Description

User Data Read /
Write (Locking
Disabled)
Cryptographic Erase  Generates new range key
following sanitization of the
electronic media.

Encrypt / decrypt user data
from an LBA range where
Locking is disabled17

Certified Erase

Generates new range key
and provides certificate of
media disposition for each
piece of the electronic media
following sanitization.

Algorithms
Accessed
AES-XTS (non-
compliant)

Roles

None

Indicator

ATA/SCSI Status

EraseMaster

ATA/SCSI Status

EraseMaster

ATA/SCSI Status

Counter DRBG
(#A1082)18,
AES-CMAC (non-
compliant), AES-
KW (non-
compliant), AES-
GCM (non-
compliant), PBKDF
(non-compliant)
Counter DRBG
(#A1082)18
AES-CMAC (non-
compliant), AES-
KW (non-
compliant), AES-
GCM (non-
compliant), PBKDF
(non-compliant),
RSA SigGen (non-
compliant)

Table 4-7 Non-Approved Services

17 Locking is disabled for an LBA range if the ReadLockEnabled or WriteLockEnabled values are
set to “False”, or the LockOnReset value does not include “Power Cycle”. The current values of
these attributes can be determined using the Show Status Approved Service (i.e., the TCG Get
Method on the associated LBA range locking object),
18 Allowed per FIPS 140-3 IG 4.1.A, Exception b.

Page 24

5  Software / Firmware Security

During the power-on boot process, the CM will verify the authenticity and integrity of the CM firmware
using RSA Signature Verification (certificate #A1093) with the following parameters:

•  The key is the Signing Authority Key i.e., SAK (see section 9.2).
•  The modulus size is 3072 bits.
•  The hash function is SHA2-256 (#A1092).

The operator can invoke the boot firmware integrity test on demand by performing a power-on reset
operation on the CM.

Page 25

6  Operational Environment

The CM operates in a limited operational environment where the CM firmware (FW) may be updated
by an external source via the FW download operation. Prior to accepting new FW provided by the FW
download operation, the CM will verify the signature of the new FW (see section 10.2).

Note: The ability to download FW to the device is restricted based on the state of the FW Download
and Rollback Download logical ports (see section 4.5). All FW downloads require the FW Download
port to be unlocked. Rollback FW downloads (i.e., downgrading FW to a release that violates the
device FW rollback policy) require both the FW Download and Rollback FW Download ports to be
unlocked,

Page 26

7  Physical Security

The CM is a multi-chip embedded module of product grade components with standard passivation.
The CM is surrounded in a metal enclosure that is opaque within the visible spectrum. To meet the
level 2 physical security requirements, the CM employs a single factory installed tamper-evident
labels to prevent physical tampering. Refer to Table 7-1 for actions required by the operator to ensure
that physical security is maintained.

Figure 3: Module 1 Seal Application Locations

Physical Security Mechanism  Recommended

Inspection / Test Guidance Details

Opaque, tamper-evident
security label (TEL) on exposed
(back) side of PCBA

Frequency of
Inspection / Test
The frequency of
the physical
inspection should
be determined by
the Crypto Officer.
It is recommended
that the TEL be
inspected monthly.

Periodic inspection of TEL to detect
evidence of tampering:
•  Checkerboard pattern on TEL
•  Security label cutouts do not match

original

•  Security label over PCBA screws not

penetrated

Upon discovery of tamper evidence, the
module should be removed from service.
Refer to the End-of-Life section of this
document for more information on
removing the module from service.

Page 27

Table 7-1: Physical Security Inspection Guidelines

Page 28

8  Non-Invasive Security

The CM does not provide mitigation against any non-invasive attacks.

Page 29

9  Sensitive Security Parameter Management

9.1  SSP Storage Areas

The storage areas on the CM where SSPs may be present are described in Table 9-1.

Table 9-1: SSP Storage Areas

Name

DRAM

Temporary, volatile memory

Description

Persistence Type

Dynamic

Dynamic

Static

Static

Static

HW Registers

Temporary, volatile memory

ROM

Media

Persistent, non-modifiable, non-volatile memory

Persistent, non-volatile memory

Serial Flash

Persistent, non-volatile memory

Page 30

9.2  SSPs

The SSPs (Sensitive Security Parameters) used by the device are different depending on which security mode the CM is operating. The SSPs
used by the CM are described in Table 9-2.

Generation

Import /
Export

Establishment

Storage

Zeroization

Use & Related Keys

Key / SSP Name /
Type

Strength

SID19 / CSP

256 bits

Master, User
Passwords (ATA
Security Mode only)
/ CSP
Master/User MEK
(ATA Security Mode
only) / CSP

256 bits

256 bits

Security
Function &
Cert.
Number
PBKDF
(#A1085)
PBKDF
(#A1085)

N/A

N/A

AES-XTS
(#A1090),
CKG

Internally
generated

EraseMaster
Password (TCG
Security Mode) /
CSP
BandMaster (0-31)
Passwords (TCG
Security Mode) /
CSP
MEKs / CSP

64-256 bits

PBKDF
(#A1085)

64-256 bits

PBKDF
(#A1085)

N/A

N/A

256 bits

AES-XTS
(#A1090),
CKG

Internally
generated

Import: sent
from host
Import: sent
from host

N/A

N/A

N/A

N/A

Import: sent
from host

N/A

Import: sent
from host

N/A

N/A

N/A

Entropy Input String
/ CSP

448 bits

Counter
DRBG
(#A1082)

Internally
generated

N/A

N/A

19 Drive Owner PIN

Page 31

DRAM,
plaintext
DRAM,
plaintext

Reset Module, Set
PIN
Reset Module, Set
PIN

Set PIN

Set PIN
Unlock user data

HW
Registers,
plaintext

Exit FIPS Mode,
Cryptographic
Erase

Unlock user data
Cryptographic erase

Encrypted by MEKEKs
and CSPSKs

Media,
AES-KW
encrypted
DRAM,
plaintext

DRAM,
plaintext

HW
Registers,
plaintext

Media,
AES-KW
encrypted
DRAM,
plaintext

Reset Module

Set PIN
Cryptographic erase

Reset Module, Set
PIN,
Cryptographic
Erase
Exit FIPS Mode,
Cryptographic
Erase

N/A

Set PIN
Lock / unlock user data

Lock / Unlock User Data
Range for Read and/or
Write

Encrypted by MEKEKs
and CSPSKs

Services using DRBG
(cryptographic erase)

Generation

Import /
Export

Establishment

Storage

Zeroization

Use & Related Keys

Key / SSP Name /
Type

Strength

DRBG Seed / CSP

384 bits

DRBG Key / CSP

256 bits

DRBG Internal State
V / CSP

128 bits

Platform Key21 /
PSP

Firmware Update
Key / PSP

SAK22 / PSP

3072 bits /
128 bits
(strength)
3072 bits /
128 bits
(strength)
3072 bits /
128 bits
(strength)

Security
Function &
Cert.
Number
Counter
DRBG
(#A1082)

Counter
DRBG
(#A1082)

Counter
DRBG
(#A1082)

Internally
generated

N/A

N/A

Internally
generated20

N/A

N/A

Internally
generated20

N/A

N/A

RSA SigVer
(#A1093)

Pre-loaded
at factory

N/A

N/A

RSA SigVer
(#A1093)

Pre-loaded
at factory

N/A

N/A

RSA SigVer
(#A1093)

Pre-loaded
at factory

Import:
Embedded
in Firmware
Download
Image
N/A

N/Al

N/A

MEKEK / CSP

256 bits

AES-KW
(#A1094),
CKG

Internally
generated

Master Key / CSP

256 bits

Derived

N/A

N/A

AES-GCM
(#A1080),
PBKDF
(#A1085)

HW
Registers,
plaintext

HW
Registers,
plaintext

HW
Registers,
plaintext

ROM,
plaintext

ROM,
plaintext

Serial
Flash,
plaintext

DRAM,
plaintext

Media,
AES-GCM
encrypted
DRAM,
plaintext

N/A

N/A

N/A

N/A

N/A

N/A

Services using DRBG
(cryptographic erase, Set
PIN)

Services using DRBG
(cryptographic erase, Set
PIN)

Services using DRBG
(cryptographic erase, Set
PIN)

Reset module

FW download

Reset module

Exit FIPS Mode

Exit FIPS Mode

Lock / Unlock User Data
Range for Read and/or
Write Cryptographic erase
Set PIN

Encrypted by Master Keys
Lock / Unlock User Data
Range for Read and/or
Write Cryptographic erase
Set PIN

20 Source: section 4 Terms and Definitions of NIST Special Publication 800-90A.  Values of V and the AES key are the critical values of the
internal state on which the security of this DRBG mechanism depends (i.e., V and the AES key are the “secret values” of the internal state).
21 PK is used for pre-operational FW integrity test and is not an SSP but included in this table for completeness.
22 SAK is used for pre-operational FW integrity test and are not SSPs but included in this table for completeness.

Page 32

Key / SSP Name /
Type

Strength

CSPSKs / CSP

256 bits

Drive Owner PSKs /
CSP

32-512 bits

EraseMaster PSK
(TCG Security
Mode) / CSP

32-512 bits

BandMaster PSKs
(TCG Security
Mode) / CSP

32-512 bits

Secure Messaging
Session Key / CSP

128-256 bits

Secure Messaging
Key Pair / CSP

2048 bits /
112 bits
(strength) &
256 bits

Security
Function &
Cert.
Number
AES-KW
(#A1094),
CKG

KAS-FFC-
SSC Sp800-
56Ar3
(#A1084)

KAS-FFC-
SSC Sp800-
56Ar3
(#A1084)

KAS-FFC-
SSC Sp800-
56Ar3
(#A1084)

AES-GCM
(#A1080).
KDF TLS
(#A1089)
KAS-FFC-
SSC Sp800-
56Ar3
(#A1084)
Safe Primes
Key
Generation
(#A1087)
CKG
KDF TLS
(#A1089)

Page 33

Generation

Import /
Export

Establishment

Storage

Zeroization

Use & Related Keys

Internally
generated

N/A

N/A

N/A

N/A

N/A

Import: sent
from host

N/A

Import: sent
from host

N/A

Import: sent
from host

N/A

Derived

N/A

N/A

DRAM,
plaintext

Media,
plain text
DRAM,
plaintext

Media,
plaintext
DRAM,
plaintext

Media,
plaintext
DRAM,
plaintext

Media,
plaintext
DRAM,
plaintext

Exit FIPS Mode

Lock / Unlock User Data
Range for Read and/or
Write Cryptographic erase
Set PIN

Exit FIPS Mode

Set TLS PSK

Exit FIPS Mode

Set TLS PSK

Exit FIPS Mode

Set TLS PSK

Reset Module

Send/Receive TLS
Message

Internally
generated

N/A

N/A

DRAM,
plaintext

N/A

Send/Receive TLS
Message

Table 9-2: SSPs

9.3  Entropy Sources

The Entropy sub-system uses a Non-Deterministic Random Bit Generator (NRBG) to generate
random data. The NRBG is supplied with conditioned entropy via two Entropy sources. Each
conditioned output of an entropy source is a 128-bit full entropy output. The NRBG used by the device
is the XOR-NRBG construction described in SP 800-90C and the DRBG construction is based on SP
800-90A rev 1.

The DRBG seed used for instantiation is constructed by concatenating the following values:

•  Entropy Input (256 bits of conditioned entropy)
•  Nonce (128 bits of conditioned entropy)
•  Personalization String (64 bits of device unique data such as the device serial number

padded to 256 bits)

The concatenated value is passed to the derivation function Block_Ciper_df as described in SP 800-
90A rev. 1 which outputs 384 bits of seed material.

The design of the entropy sources is based on the recommendations in SP 800-90B. The entropy
sub-system has two independent entropy sources:

•  Ring Oscillator entropy source
•  PES entropy source

The Entropy sources generate entropy samples when required by the Entropy sub-system. The raw
samples from each entropy source are stored in independent entropy pools. The raw entropy samples
from each source are concatenated into 128-bit blocks. When there are greater than 256 bits of
entropy in an entropy pool23, based on the minimum entropy of the sources, the Entropy subsystem
concatenates sufficient 128-bit blocks for 256 bits of entropy and passes the concatenation of these
blocks to the CMAC conditioner (#A1081 (PES) and #A3515 (Ring Oscillator)).

The entropy sources used by the CM are described in Table 9-3.

Entropy Sources

Position Error Signal (PES)
Ring Oscillators

Minimum Number
of Bits of Entropy
3 out of 4-bits
6 out of 8-bits

Details

Met IID requirements
Met IID requirements

Table 9-3: Non-Deterministic Random Number Generation Specification

9.4  Zeroization Methods

The method used by the CM to zeroize SSPs is different depending on where the SSP is stored:

•

If a SSP is stored in volatile memory, the CM will zeroize the SSP (when required) by writing the
memory where the SSP is stored with a pattern of all bytes set to 0x00.

Note: When the CM is powered down all SSPs stored in volatile memory are zeroized
automatically as the volatile memory can only store data when powered.

•

If a SSP is stored unprotected (i.e., plaintext) in non-volatile memory, the CM will zeroize the SSP
(when required) by writing the memory where the SSP is stored with a pattern of all bytes set to
0x00 and then writing the new SSP value.

23 The combined entropy is calculated using Method 2 as described in IG D.O Combining Entropy from
Multiple Sources.

Page 34

•

If a SSP is stored protected (i.e., encrypted using another SSP) in non-volatile memory, the CM
will zeroize the SSP (when required) by writing the memory where the SSP is stored with a new
SSP value.24

24 As indicated in Table 9-2 some keys are stored encrypted on the CM using an approved algorithm.
Per IG 9.6.A, they are considered “protected” thus not requiring zeroization when unprotected SSPs
are zeroized.

Page 35

10  Self-Tests

The sections below list all self-tests performed by the module, along with the failure behavior when
any of the self-tests fail. While in an error state, the module outputs an error indicator, disables
cryptographic operations and the data output interface is inhibited. All pre-operational and conditional
self-tests can be executed on-demand by power-cycling the module.

10.1  Pre-Operational Self-Tests

Function
Tested
Firmware
Integrity

Self-Test Type

Implementation

Failure Behavior

Integrity Test25

RSA PKCS#1 3072/SHA-256
signature verification on signed
FW stored on the CM (#A1093
and #A1092)26. The keys used
are the Platform Key and one of
the SAKs (see section 9.2).

Table 10-1: Pre-Operational Self-Tests

Enters FW Integrity Error State.

10.2  Conditional Self-Tests

Function
Tested
Hardware Self-Tests
AES-XTS
(#A1090)
AES-XTS
(#A1090)
AES-XTS
(#A1090)

SHA2-256
(#A1092)
HMAC-SHA2-
256 (#A1091)
RSA SigVer
(#A1093)
AES-CMAC
(#A3515)
Counter
DRBG
(#A1082)
Counter
DRBG
(#A1082)

Self-Test Type

Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Critical Functions
Test: When an AES
XTS Key is
generated
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test

Implementation

Failure Behavior

XTS encrypt KAT / 256-bit key

Enters FIPS Self-Test Error State

XTS decrypt KAT / 256-bit key

Enters FIPS Self-Test Error State

Generated XTS Key_1 and
Key_2 are compared, as per IG
C.I, before being used.

Keys are discarded

Digest KAT

Enters FIPS Self-Test Error State

HMAC SHA-256 KAT / 256-bit
key
Signature Verification KAT /
3072-bit key
CMAC KAT / 256-bit bit key

Enters FIPS Self-Test Error State

Enters FIPS Self-Test Error State

Enters FIPS Self-Test Error State

KAT

Enters FIPS Self-Test Error State

Critical Functions
Test: When a
random number is
generated

Instantiate, generate, reseed and
un-instantiate health tests as per
section 11.3 of SP 800-90A

Enters FIPS Self-Test Error State

Firmware Self-Tests
AES-CBC
(#A1095)
AES-CBC
(#A1095)
AES-GCM
(#A1080)

Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test

CBC encrypt KAT / 256 bit key

Enters FIPS Self-Test Error State

CBC decrypt KAT / 256-bit key

Enters FIPS Self-Test Error State

GCM encrypt KAT / 256-bit key

Enters FIPS Self-Test Error State

25 The algorithm used for the Firmware Integrity Test (RSA) is conditionally tested before it is used
in the execution of Firmware Integrity Test.
26 The SAKs are used as the keys for pre-operational FW integrity test.

Page 36

Function
Tested
AES-GCM
(#A1080)
AES-CMAC
(#A1081)
SHA2-384
(#A1088)
HMAC-SHA2-
256 (#A1083)
KAS-FFC-
SSC Sp800-
56Ar3
(#A1084)
AES-KW
(#A1094)
AES-KW
(#A1094)
KDF TLS
(#A1089)
PBKDF
(#A1085)
Firmware
Loading

ENT

Safe Primes
Key
Generation
(#A1087)

Self-Test Type

Implementation

Failure Behavior

Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test

GCM decrypt KAT / 256-bit key

Enters FIPS Self-Test Error State

CMAC KAT / 256-bit key

Enters FIPS Self-Test Error State

Digest KAT

Enters FIPS Self-Test Error State

HMAC SHA-256 KAT / 256-bit
key
Diffie-Hellman Primitive Z KAT /
2048-bit key

Enters FIPS Self-Test Error State

Enters FIPS Self-Test Error State

KW decrypt KAT / 256-bit key

KW encrypt KAT / 256-bit key

Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Cryptographic
Algorithm Self-Test
Firmware Load Test  RSA PKCS#1 3072 / SHA-256

KAT / 256-bit key

KAT / 384-bit key

signature verification of new FW
image performed before FW can
be loaded (#A1093 and #A1092)
Repetition Count and Adaptive
Proportion tests as per SP 800-
90B

Critical Functions
Test: When a seed
for DRBG is
requested
Critical Functions
Test: When a key is
generated

Enters FIPS Self-Test Error State

Enters FIPS Self-Test Error State

Enters FIPS Self-Test Error State

Enters FIPS Self-Test Error State

Incoming FW package is not
loaded and is discarded

Enters FIPS Self-Test Error State

Assurances as per sections 5.5
and 5.6 of SP 800-56A rev3

Keys are discarded

Table 10-2: Conditional Self-Tests

Page 37

11 Life-Cycle Assurance

11.1  Delivery and Operation

To initialize the CM into the Compliant state, one of the following procedures must be followed: TCG
Enterprise or ATA Security. Upon receiving the CM, the authorized operator must inspect the physical
security mechanisms for tamper evidence and verify that the drive boots up in an uninitialized Security
Mode.

The “FIPS Operating Mode” Indicator designates whether the drive has been configured to operate in
the Compliant state. The “FIPS Operating Mode” Indicator is a bit (byte 30, bit 0) in the Vendor Unique
fields in Level 0 Device Discovery. If byte 30, bit 0 of the Vendor Unique fields is set to one (1), then
the device is operating in a Compliant state. If the bit is set to zero (0), then the device is operating in
a Non-Compliant state and is not considered a FIPS 140 validated CM.

11.1.1  TCG Enterprise Secure Initialization

1.  Upon receipt of the product examine the shipping packaging and the product packaging to ensure it

has not been accessed during shipping by the trusted courier.

2.  At initialization and periodically thereafter, examine the physical security mechanisms for tamper

evidence.

3.  At initialization, set all enabled operator PINs applicable for the Compliant state to private values of at

least 8 bytes (64 bits) in length: Drive Owner, EraseMaster, and BandMasters27.

4.  Set ReadLockEnabled and WriteLockEnabled to “True” and the LockOnReset column to include

“Power Cycle”, on at least one (1) User Data range.

5.  At initialization, disable the “Makers” authority.
6.  At initialization, the value of LockOnReset for FW Download port must be set to include “Power

Cycle”.

11.1.2  TCG Enterprise Ongoing Policy Restrictions

1.  The ReadLockEnabled and WriteLockEnabled values must be set to “True” and the LockOnReset

value must include “Power Cycle”, for at least one (1) User Data range.

2.  The “Makers” Authority must be disabled.
3.  The LockOnReset value for the FW Download port must include “Power Cycle”.

11.1.3  ATA Security Secure Initialization

1.  Upon receipt of the product examine the shipping packaging and the product packaging to ensure it

has not been accessed during shipping by the trusted courier.

2.  At initialization and periodically thereafter, examine the physical security mechanisms for tamper

evidence.

3.  Transition the CM to ATA Security Mode by setting the User Password to a private value of 32 bytes

(256 bits) in length.

4.  At initialization, set the remaining operator Passwords/PINs applicable for the Compliant state to

private values of at least 8 bytes (64 bits) in length: Master and Drive Owner (optional).

5.  At initialization, the value of LockOnReset for FW Download port must be set to “Power Cycle”.

11.1.4  ATA Security Ongoing policy Restrictions

1.  The “Makers” Authority must be disabled.
2.  The LockOnReset value for the FW Download port must include “Power Cycle”.

27 A subset of the operator authority/PINs are enabled by default. If use of any other
authority/PINs not enabled by default is required in the Compliant state, the Crypto Officer will
need to enable them as part of the initialization steps.

Page 38

11.2  End of Life

When the CM reaches end-of-life, the Crypto Officer must zeroize all SSPs prior to discarding the CM.
The Crypto Officer shall perform the following steps when the CM is at end-of-life:

1.  The Crypto Officer shall revert the CM to the factory default state by invoking the Revert or RevertSP

2.

methods28 on the Admin SP.
If step 1 fails, all SSPs on the device may not have been sanitized. If this occurs, the Crypto Officer
should handle the CM per organizational policies.

28 The Revert/RevertSP methods will cause the CM to zeroize all the SSPs and exit the Compliant
state.

Page 39

12 Mitigation of Other Attacks

The CM does not make claims to mitigate against other attacks beyond the scope of FIPS 140-3.

Page 40

