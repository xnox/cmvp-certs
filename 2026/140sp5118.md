Juniper Networks, Inc.

FIPS 140-3 Non-Proprietary Security Policy

Juniper Networks MX304 and EX4100 with MACsec

Version: Junos OS 22.4R2

Prepared for:

Juniper Networks, Inc.
1133 Innovation Way
Sunnyvale, California 94089
USA
408.745.2000
1.888 JUNIPER
www.juniper.net

Prepared by:

www.teronlabs.com

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 1 of 35

Table of Contents

1 General ......................................................................................................................................................................... 6

1.1 Overview .............................................................................................................................................................. 6

1.2 Security Levels..................................................................................................................................................... 6

2 Cryptographic Module Specification ...................................................................................................................... 6

2.1 Description ........................................................................................................................................................... 6

2.2 Tested and Vendor Affirmed Module Version and Identification............................................................. 9

2.3 Excluded Components ..................................................................................................................................... 10

2.4 Modes of Operation ......................................................................................................................................... 10

2.5 Algorithms .......................................................................................................................................................... 11

2.6 Security Function Implementations .............................................................................................................. 13

2.7 Algorithm Specific Information ...................................................................................................................... 15

2.8 RBG and Entropy .............................................................................................................................................. 16

2.9 Key Generation ................................................................................................................................................. 16

2.10 Key Establishment .......................................................................................................................................... 16

2.11 Industry Protocols .......................................................................................................................................... 16

3 Cryptographic Module Interfaces ......................................................................................................................... 17

3.1 Ports and Interfaces ......................................................................................................................................... 17

4 Roles, Services, and Authentication ..................................................................................................................... 18

4.1 Authentication Methods ................................................................................................................................. 18

4.2 Roles .................................................................................................................................................................... 18

4.3 Approved Services ............................................................................................................................................ 18

4.4 Non-Approved Services .................................................................................................................................. 22

4.5 External Software/Firmware Loaded ........................................................................................................... 22

5 Software/Firmware Security .................................................................................................................................. 22

5.1 Integrity Techniques ........................................................................................................................................ 22

5.2 Initiate on Demand ........................................................................................................................................... 22

6 Operational Environment ....................................................................................................................................... 22

6.1 Operational Environment Type and Requirements ................................................................................... 22

6.2 Configuration Settings and Restrictions....................................................................................................... 22

7 Physical Security ....................................................................................................................................................... 23

8 Non-Invasive Security ............................................................................................................................................. 23

9 Sensitive Security Parameters Management ...................................................................................................... 23

9.1 Storage Areas .................................................................................................................................................... 23

9.2 SSP Input-Output Methods ............................................................................................................................ 23

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 2 of 35

9.3 SSP Zeroization Methods ................................................................................................................................ 24

9.4 SSPs ..................................................................................................................................................................... 24

9.5 Transitions .......................................................................................................................................................... 28

10 Self-Tests ................................................................................................................................................................. 28

10.1 Pre-Operational Self-Tests ........................................................................................................................... 28

10.2 Conditional Self-Tests ................................................................................................................................... 28

10.3 Periodic Self-Test Information ..................................................................................................................... 30

10.4 Error States ...................................................................................................................................................... 31

10.5 Operator Initiation of Self-Tests ................................................................................................................. 32

11 Life-Cycle Assurance ............................................................................................................................................. 32

11.1 Installation, Initialization, and Startup Procedures .................................................................................. 32

11.2 Administrator Guidance ................................................................................................................................ 32

11.2.1 Installing the Junos OS firmware image ............................................................................................. 32

11.2.2 Configure the device for the Approved mode .................................................................................. 33

11.2.3  Zeroizing the System .......................................................................................................................... 33

11.3 Non-Administrator Guidance ....................................................................................................................... 34

11.4 Design and Rules ............................................................................................................................................ 34

11.4.1 Module Design Rules ............................................................................................................................. 34

11.4.2  Module Operation Rules ................................................................................................................... 34

11.5 Maintenance Requirements ......................................................................................................................... 35

11.6 End of Life ........................................................................................................................................................ 35

12 Mitigation of Other Attacks ................................................................................................................................. 35

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 3 of 35

List of Tables

Table 1: Security Levels ................................................................................................................................................ 6
Table 2: Tested Module Identification – Hardware .............................................................................................. 10
Table 3: Modes List and Description ....................................................................................................................... 10
Table 4: Approved Algorithms - OpenSSL 1.0.2 .................................................................................................... 11
Table 5: Approved Algorithms - MACsec ............................................................................................................... 12
Table 6: Approved Algorithms - MACsec PHY ...................................................................................................... 12
Table 7: Approved Algorithms - OpenSSL 1.1.1 .................................................................................................... 12
Table 8: Approved Algorithms - Kernel ................................................................................................................... 12
Table 9: Approved Algorithms - LibMD .................................................................................................................. 12
Table 10: Vendor-Affirmed Algorithms ................................................................................................................... 13
Table 11: Security Function Implementations ....................................................................................................... 15
Table 12: Entropy Certificates .................................................................................................................................. 16
Table 13: Entropy Sources ......................................................................................................................................... 16
Table 14: Ports and Interfaces .................................................................................................................................. 18
Table 15: Authentication Methods .......................................................................................................................... 18
Table 16: Roles ............................................................................................................................................................. 18
Table 17: Approved Services ..................................................................................................................................... 21
Table 18: Mechanisms and Actions Required ........................................................................................................ 23
Table 19: Storage Areas ............................................................................................................................................. 23
Table 20: SSP Input-Output Methods ..................................................................................................................... 24
Table 21: SSP Zeroization Methods ......................................................................................................................... 24
Table 22: SSP Table 1 ................................................................................................................................................. 26
Table 23: SSP Table 2 ................................................................................................................................................. 28
Table 24: Pre-Operational Self-Tests ...................................................................................................................... 28
Table 25: Conditional Self-Tests ............................................................................................................................... 30
Table 26: Pre-Operational Periodic Information ................................................................................................... 30
Table 27: Conditional Periodic Information ........................................................................................................... 31
Table 28: Error States ................................................................................................................................................. 32

List of Figures

Figure 1 – MX304 Universal Routing Platform (front) ........................................................................................... 7
Figure 2 – MX304 Universal Routing Platform (rear) ............................................................................................. 7
Figure 3 – EX4100-48MP Switch (front) .................................................................................................................. 8
Figure 4 – EX4100-48MP Switch (rear) .................................................................................................................... 8
Figure 5 – EX4100-24MP Switch (front) .................................................................................................................. 8
Figure 6 – EX4100-24MP Switch (rear) .................................................................................................................... 8
Figure 7 – EX4100-24P Ethernet Switch (front) ..................................................................................................... 8
Figure 8 – EX4100-24P Ethernet Switch (rear) ....................................................................................................... 8
Figure 9 – EX4100-24T Ethernet Switch (front) ..................................................................................................... 8
Figure 10 – EX4100-24T Ethernet Switch (rear) .................................................................................................... 8
Figure 11 – EX4100-48P Ethernet Switch (front) .................................................................................................. 9
Figure 12 – EX4100-48P Ethernet Switch (rear) .................................................................................................... 9
Figure 13 – EX4100-48T Ethernet Switch (front)................................................................................................... 9
Figure 14 – EX4100-48T Ethernet Switch (rear) .................................................................................................... 9

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 4 of 35

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 5 of 35

1 General

1.1 Overview

This is a non-proprietary Cryptographic Module Security Policy for the Juniper Networks MX304
Universal Router Platform and EX4100-48MP, EX4100-24MP, EX4100-24P, EX4100-24T, EX4100-
48P, EX4100-48T Ethernet Switches, hereafter referred to as the cryptographic module.

1.2 Security Levels

The cryptographic module is designed to meet FIPS 140-3 Level 1 overall. The table below shows the
security levels claimed for each section of the security requirements.

Section
1
2
3
4
5
6
7
8
9
10
11
12

Title
General
Cryptographic module specification
Cryptographic module interfaces
Roles, services, and authentication
Software/Firmware security
Operational environment
Physical security
Non-invasive security
Sensitive security parameter management
Self-tests
Life-cycle assurance
Mitigation of other attacks
Overall Level

Table 1: Security Levels

2 Cryptographic Module Specification

2.1 Description

Purpose and Use:

Security Level
1
1
1
2
1
1
1
N/A
1
1
1
N/A
1

Juniper Networks MX304 Universal Routing Platform is a cloud-era platform that cost
effectively addresses the evolutionary edge and metro Ethernet needs of service providers,
mobile operators, web-scale operators, and multiple-service operators (MSOs).
The Juniper Networks EX4100 line of Ethernet Switches offers a secure, cloud-ready
portfolio of access switches ideal for enterprise branch, campus, and data center networks.

This FIPS 140-3 validation includes the MX series router model MX304, and the following EX series
switch models: EX4100-48MP, EX4100-24MP, EX4100-24P, EX4100-24T, EX4100-48P and EX4100-
48T.

The cryptographic module runs Junos OS, Juniper’s reliable, high-performance, modular network
operating system that is supported across all of Juniper’s physical and virtual routing, switching, and
security platforms.

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 6 of 35

The cryptographic module provides for an encrypted connection, using SSH, between the management
station and the module. The cryptographic modules also provide for an encrypted connection, using
MACsec, between devices. All other data input or output from the modules are considered plaintext for
this FIPS 140-3 validation.

Module Type:
The cryptographic module is a Hardware cryptographic module.

Module Embodiment:
The cryptographic module is defined as a MultiChipStand module that executes Junos OS 22.4R2
firmware on any of the identified Juniper Networks devices.

Module Characteristics:
There are no additional characteristics relevant to this module.

Cryptographic Boundary:

The Tested Operational Environment Physical Perimeter (TOEPP) is defined as the outer edge of the
chassis. The chassis is a rigid sheet-metal structure that houses all components of the device. The
cryptographic boundary encompasses the entire TOEPP.

The cryptographic module is FIPS-compliant when installed and configured with Junos OS 22.4R2
validated firmware as specified in section 11.1.

The physical form of the module is depicted in Figures 1 to 14.

Figure 1 – MX304 Universal Routing Platform (front)

Figure 2 – MX304 Universal Routing Platform (rear)

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 7 of 35

Figure 3 – EX4100-48MP Switch (front)

Figure 4 – EX4100-48MP Switch (rear)

Figure 5 – EX4100-24MP Switch (front)

Figure 6 – EX4100-24MP Switch (rear)

Figure 7 – EX4100-24P Ethernet Switch (front)

Figure 8 – EX4100-24P Ethernet Switch (rear)

Figure 9 – EX4100-24T Ethernet Switch (front)

Figure 10 – EX4100-24T Ethernet Switch (rear)

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 8 of 35

Figure 11 – EX4100-48P Ethernet Switch (front)

Figure 12 – EX4100-48P Ethernet Switch (rear)

Figure 13 – EX4100-48T Ethernet Switch (front)

Figure 14 – EX4100-48T Ethernet Switch (rear)

2.2 Tested and Vendor Affirmed Module Version and Identification

Tested Module Identification – Hardware:

The following models of the module were tested.

Model
and/or
Part
Number
MX304

EX4100-
48MP
EX4100-
24MP
EX4100-
24T
EX4100-
24P
EX4100-
48T

Hardware
Version

Firmware
Version

Processors

Features

MX304

Junos OS
22.4R2.8

Intel Xeon D1735-
TR

EX4100-
48MP
EX4100-
24MP
EX4100-
24T
EX4100-
24P
EX4100-
48T

Junos OS
22.4R2.8
Junos OS
22.4R2.8
Junos OS
22.4R2.8
Junos OS
22.4R2.8
Junos OS
22.4R2

ARM-cortex A72
64-bit, single core
ARM-cortex A72
64-bit, single core
ARM-cortex A72
64-bit, single core
ARM-cortex A72
64-bit, single core
ARM-cortex A72
64-bit, single core

Dual redundant REs; Up to 3 LMIC (LMIC16-BASE) each
with 4x400 Gbps ports, 16x100 Gbps ports, or
combination
16 x 100 MB/1GbE/2.5GbE and 32 x 10 MB/100
MB/1GbE PoE++ access ports
8 x 100 MB/1GbE/2.5GbE/5GbE/10GbE and 16 x 10
MB/100 MB/1GbE PoE++ access ports
24 x 1GbE non-PoE ports

24 x 1GbE PoE+ access ports

48 x 1GbE non PoE-access ports

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 9 of 35

Model
and/or
Part
Number
EX4100-
48P

Hardware
Version

Firmware
Version

Processors

Features

EX4100-
48P

Junos OS
22.4R2.8

ARM-cortex A72
64-bit, single core

48 x 1GbE PoE+ access ports

Table 2: Tested Module Identification – Hardware

Tested Module Identification – Software, Firmware, Hybrid (Executable Code Sets): N/A

The module is not classified as software, firmware, or hybrid; thus, this section is not applicable.

N/A for this module.

Tested Module Identification – Hybrid Disjoint Hardware: N/A

The module is not classified as hybrid disjoint hardware; thus, this section is not applicable.

N/A for this module.

Tested Operational Environments - Software, Firmware, Hybrid: N/A

The module is not classified as software, firmware, or hybrid; thus, this section is not applicable.
N/A for this module.

Vendor-Affirmed Operational Environments - Software, Firmware, Hybrid: N/A

There are no vendor-affirmed operational environments claimed.

N/A for this module.

2.3 Excluded Components

No components are excluded from the requirements of FIPS PUB 140-3.

2.4 Modes of Operation

The module supports an Approved mode only. The module enters Approved mode as a result of
successful installation, initialization and configuration steps described in section 11. Until these
procedures have been followed, the module is non-compliant.

Description

Mode
Name
Approved  Approved mode of operation.  Approved  Suffix string ":fips" in the cli prompt

Status Indicator

Type

Table 3: Modes List and Description

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 10 of 35

2.5 Algorithms

Approved Algorithms:

Although the module may have been tested for additional algorithms or modes, only those listed below
are utilized by the module.

OpenSSL 1.0.2

Algorithm
AES-CBC

AES-CTR

ECDSA KeyGen
(FIPS186-4)
ECDSA KeyVer (FIPS186-
4)
ECDSA SigGen (FIPS186-
4)

CAVP Cert
A4301

A4301

A4301

A4301

A4301

ECDSA SigVer (FIPS186-
4)

A4301

HMAC-SHA-1
HMAC-SHA2-256
HMAC-SHA2-512
KAS-ECC-SSC Sp800-
56Ar3

A4301
A4301
A4301
A4301

KDF SSH (CVL)

A4301

RSA KeyGen (FIPS186-5)

A4301

RSA SigGen (FIPS186-5)

A4301

RSA SigVer (FIPS186-5)

A4301

SHA-1

SHA2-256

SHA2-384

SHA2-512

A4301

A4301

A4301

A4301

Properties
Direction - Decrypt, Encrypt
Key Length - 128, 192, 256
Direction - Decrypt, Encrypt
Key Length - 128, 192, 256
Curve - P-256, P-384, P-521
Secret Generation Mode - Testing Candidates
Curve - P-256, P-384, P-521

Component - No
Curve - P-256, P-384, P-521
Hash Algorithm - SHA2-256, SHA2-384, SHA2-512
Component - No
Curve - P-256, P-384, P-521
Hash Algorithm - SHA2-256, SHA2-384, SHA2-512
Key Length - Key Length: 160
Key Length - Key Length: 256
Key Length - Key Length: 512
Domain Parameter Generation Methods - P-256, P-384,
P-521
Scheme -
ephemeralUnified -
KAS Role - initiator, responder
Cipher - AES-128, AES-192, AES-256
Hash Algorithm - SHA-1, SHA2-256, SHA2-384, SHA2-
512
Key Generation Mode - probable
Modulo - 2048, 3072, 4096
Primality Tests - 2powSecStr
Private Key Format - standard
Modulo - 2048, 3072, 4096
Signature Type - pkcs1v1.5
Modulo - 2048, 3072, 4096
Signature Type - pkcs1v1.5
Message Length - Message Length: 0-65536 Increment
8
Message Length - Message Length: 0-65536 Increment
8
Message Length - Message Length: 0-65536 Increment
8
Message Length - Message Length: 0-65536 Increment
8

Reference
SP 800-38A

SP 800-38A

FIPS 186-4

FIPS 186-4

FIPS 186-4

FIPS 186-4

FIPS 198-1
FIPS 198-1
FIPS 198-1
SP 800-56A Rev.
3

SP 800-135 Rev.
1

FIPS 186-5

FIPS 186-5

FIPS 186-5

FIPS 180-4

FIPS 180-4

FIPS 180-4

FIPS 180-4

Table 4: Approved Algorithms - OpenSSL 1.0.2

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 11 of 35

MACsec

Algorithm
AES-CBC

CAVP Cert
A4304

AES-CMAC

A4304

AES-KW

A4304

KDF SP800-108  A4304

Properties
Direction - Decrypt, Encrypt
Key Length - 128, 256
Direction - Generation, Verification
Key Length - 128, 256
Direction - Decrypt, Encrypt
Key Length - 128
KDF Mode - Counter
Supported Lengths - Supported Lengths: 128, 256

Reference
SP 800-38A

SP 800-38B

SP 800-38F

SP 800-108 Rev. 1

Table 5: Approved Algorithms - MACsec

MACsec PHY

Algorithm  CAVP Cert
AES-GCM

A4664

AES-GCM

AES 4550

AES-GCM

C1869

Properties
Direction - Decrypt, Encrypt
IV Generation - External
IV Generation Mode - 8.2.2
Key Length - 128, 256
Direction - Decrypt, Encrypt
Key Length - 128, 256
Direction - Decrypt, Encrypt
IV Generation - External
Key Length - 128, 256

Reference
SP 800-38D

SP 800-38D

SP 800-38D

Table 6: Approved Algorithms - MACsec PHY

OpenSSL 1.1.1

CAVP Cert
A4302

Algorithm
ECDSA SigVer (FIPS186-
4)

Properties
Component - No
Curve - P-256, P-384, P-521
Hash Algorithm - SHA2-256, SHA2-384, SHA2-512
Message Length - Message Length: 0-65536 Increment
8
Table 7: Approved Algorithms - OpenSSL 1.1.1

SHA2-256

A4302

Reference
FIPS 186-4

FIPS 180-4

Kernel

Algorithm
HMAC DRBG

CAVP Cert
A4303

HMAC-SHA2-256  A4303
A4303
SHA2-256
A4303
SHA2-512

Properties
Prediction Resistance - Yes
Mode - SHA2-256
FIPS 198-1
Key Length - Key Length: 256
Message Length - Message Length: 0-51200 Increment 8  FIPS 180-4
Message Length - Message Length: 0-51200 Increment 8  FIPS 180-4

Reference
SP 800-90A Rev. 1

Table 8: Approved Algorithms - Kernel

LibMD

CAVP Cert
Algorithm
HMAC-SHA-1
A4306
HMAC-SHA2-256  A4306
A4306
SHA-1
A4306
SHA2-256
A4306
SHA2-512

Properties
Reference
Key Length - Key Length: 112, 160
FIPS 198-1
FIPS 198-1
Key Length - Key Length: 160, 256
Message Length - Message Length: 0-51200 Increment 8  FIPS 180-4
Message Length - Message Length: 0-51200 Increment 8  FIPS 180-4
Message Length - Message Length: 0-65536 Increment 8  FIPS 180-4

Table 9: Approved Algorithms - LibMD

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 12 of 35

Vendor-Affirmed Algorithms:

Name  Properties
CKG

Key type:Asymmetric  N/A

Implementation  Reference

SP 800-133 Rev.2 Section 4, example 1 direct output from DRBG.

Table 10: Vendor-Affirmed Algorithms

Non-Approved, Allowed Algorithms:

N/A for this module.

Non-Approved, Allowed Algorithms with No Security Claimed:

N/A for this module.

Non-Approved, Not Allowed Algorithms:

N/A for this module.

2.6 Security Function Implementations

The module implements the security functions listed in the following table.

Name
Enc/Dec (SSH)

Type
BC-UnAuth

KAS-SSC (SSH)

KAS-SSC

KeyGen (SSH)

AsymKeyPair-KeyGen
CKG

Properties

Description
Unauthenticated
encryption for SSH
Key Agreement
Scheme Shared Secret
Computation for SSH
Key Generation used
for SSH
authentication keys

SigGen (SSH)

DigSig-SigGen

Signature Generation
for peer
authentication in SSH

SigVer (SSH)

DigSig-SigVer

Signature Verification
for peer
authentication in SSH

Algorithms
AES-CBC: (A4301)
AES-CTR: (A4301)
KAS-ECC-SSC Sp800-
56Ar3: (A4301)

ECDSA KeyGen
(FIPS186-4): (A4301)
ECDSA KeyVer
(FIPS186-4): (A4301)
RSA KeyGen
(FIPS186-5): (A4301)
HMAC DRBG:
(A4303)
CKG: ()
HMAC DRBG:
(A4303)
ECDSA SigGen
(FIPS186-4): (A4301)
RSA SigGen (FIPS186-
5): (A4301)
SHA2-256: (A4301)
SHA2-384: (A4301)
SHA2-512: (A4301)
ECDSA SigVer
(FIPS186-4): (A4301)
RSA SigVer (FIPS186-
5): (A4301)
SHA2-256: (A4301)

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 13 of 35

Name

Type

Description

Properties

MAC (SSH)

MAC

KAS KeyGen (SSH)

KAS-KeyGen
CKG

Message
authentication for
SSH

Key Generation for
Key Agreement in
SSH

KDF (SSH)

KAS-135KDF

Key derivation
function for SSH

Full KAS (SSH)

KAS-Full
CKG

Full Key Agreement
for SSH

KTS (SSH)

KTS-Wrap
KTS-Unwrap

Key transport using
SSH as per IG D.G
provisions

SHA (LibMD)

SHA

MAC (LibMD)

MAC

DRBG (Kernel)

DRBG

Message Digest
Generation

Message
Authentication

Random Bit
Generation

IG:IG D.F Scenario 2
path (2), split.
Key confirmation:No
Key derivation:KDF
SSH (separately
tested).

Standard:SP 800-38F
IG D.G:Approved key
wrapping key using
combination
(encryption +
authentication)
method.
Caveat:Key
establishment
methodology provides
between 112 and 256
bits of security
strength

Algorithms
SHA2-384: (A4301)
SHA2-512: (A4301)
HMAC-SHA-1:
(A4301)
HMAC-SHA2-256:
(A4301)
HMAC-SHA2-512:
(A4301)
ECDSA KeyGen
(FIPS186-4): (A4301)
ECDSA KeyVer
(FIPS186-4): (A4301)
CKG: ()
HMAC DRBG:
(A4303)
KDF SSH: (A4301)
SHA-1: (A4301)
SHA2-256: (A4301)
SHA2-384: (A4301)
SHA2-512: (A4301)
ECDSA KeyGen
(FIPS186-4): (A4301)
ECDSA KeyVer
(FIPS186-4): (A4301)
KAS-ECC-SSC Sp800-
56Ar3: (A4301)
SHA-1: (A4301)
SHA2-256: (A4301)
SHA2-384: (A4301)
SHA2-512: (A4301)
KDF SSH: (A4301)
AES-CBC: (A4301)
AES-CTR: (A4301)
HMAC-SHA-1:
(A4301)
HMAC-SHA2-256:
(A4301)
HMAC-SHA2-512:
(A4301)

SHA-1: (A4306)
SHA2-256: (A4306)
SHA2-512: (A4306)
HMAC-SHA-1:
(A4306)
HMAC-SHA2-256:
(A4306)
HMAC DRBG:
(A4303)
HMAC-SHA2-256:
(A4303)
SHA2-256: (A4303)

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 14 of 35

Name
SHA (Kernel)

Type
SHA

Verify image

DigSig-SigVer

Description
Entropy source
conditioning
component
Verification of
firmware image

Key derivation
(MACsec)

KAS-56CKDF

Derivation of MACsec
MKA keys

Key wrap (MACsec)

KTS-Wrap
KTS-Unwrap

Distribution of
MACsec SAKs

Enc/Dec (MACsec)

BC-Auth

Integrity (MACsec)

MAC

Entropy Source

ENT-ESV

Table 11: Security Function Implementations

2.7 Algorithm Specific Information

Encryption and
decryption of MACsec
data
MACsec protocol data
integrity protection
Entropy source

Properties

Algorithms
SHA2-512: (A4303)

Standard:SP 800-38F
IG D.G:Approved key
wrapping key using
KW mode.
Caveat:Key
establishment
methodology provides
between 112 and 256
bits of security
strength

ECDSA SigVer
(FIPS186-4): (A4302)
Curve: P-256
SHA2-256: (A4302)
KDF SP800-108:
(A4304)
AES-CMAC: (A4304)
AES-CBC: (A4304)
AES-KW: (A4304)

AES-GCM: (AES 4550,
C1869, A4664)

AES-CMAC: (A4304)

SHA2-512: (A4303)

In reference to the MACsec protocol, the modules can take on the role of Peer or Authenticator.

The AES GCM IV construction is performed in compliance with IG C.H scenario 1c (MACsec per IEEE
802.1AE and its amendments).

The module includes ECDSA algorithms that have been validated using FIPS 186-4 CAVP tests, which
are mathematically identical to FIPS 186-5 CAVP tests. Per IG C.K, all RSA and ECDSA algorithms
implemented by the module are claimed compliant with FIPS 186-5.
The module complies with IG C.F. RSA Key Generation, Signature Generation and Signature Verification
have been tested and validated using CAVP testing for all implemented modulus lengths (2048, 3072
and 4096 bits).  The number of Miller-Rabin tests used for primality testing as part of RSA Key
Generation is consistent with Table C.3.

The module implements the following Approved key agreement methods which have been CAVP tested
and validated:

⦁  KAS-ECC per SP 800-56A Rev. 3 (FIPS 140-3 IG D.F Scenario 2, path 2).

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 15 of 35

The module obtains the FIPS 140-3 IG D.F required key agreement assurances in accordance with
Section 5.6.2 of SP800-56A Rev. 3. All the key agreement protocols implemented by the module are
Diffie-Hellman based.

2.8 RBG and Entropy

The tables below indicate the entropy source used by the module and their associated certificates.

Cert
Number
E103
E104

Vendor Name

Juniper Networks
Juniper Networks

Table 12: Entropy Certificates

Name

Type

Operational Environment  Sample

Size

Entropy
per
Sample

Conditioning
Component

EX4100 - Junos OS 22.4 Entropy
Source (E103)
MX304 - Junos OS 22.4 Entropy
Source (E104)

Non-
Physical
Non-
Physical

Table 13: Entropy Sources

ARM-cortex A72 64-bit,
single core
Intel Xeon D-1735TR

512 bits  448 bits  A4303 (SHA2-

512)

512 bits  448 bits  A4303 (SHA2-

512)

The entropy source is used to seed the module’s HMAC DRBG with the minimum required 256-bits of
entropy. Each 512-bit block of conditioned output from the entropy source contains 448 bits of
entropy. The HMAC DRBG is used for all random data required by the module, including key generation.

There are no initialization procedures required by the users of the module to operate the entropy source
in a compliant manner. The module complies with the ESV Public Use document of the validated
entropy source (Certs. E103 and E104).

2.9 Key Generation

The cryptographic module implements the key generation methods listed above in the Security
Functions implementation table.

2.10 Key Establishment

The cryptographic module implements the key establishment methods listed above in the Security
Functions implementation table.

2.11 Industry Protocols

The cryptographic module supports the protocols listed below. No part of these protocols, other than
the approved cryptographic algorithms and the KDFs, have been tested by the CAVP and CMVP. The
SSH algorithms allow independent selection of key exchange, authentication, cipher, and integrity. In

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 16 of 35

reference to the supported protocols table below, each column of options for a given protocol is
independent and may be used in any viable combination.

Protocol

Key Exchange

Auth

Cipher

Integrity

SSHv2

EC Diffie-Hellman P-256
EC Diffie-Hellman P-384
EC Diffie-Hellman P-521

MACsec

MACsec Key Agreement (SP800-108 KDF,
AES-CMAC-128/256, AES-KW 128/256)

ECDSA P-256
ECDSA P-384
ECDSA P-521
RSA 2048
RSA 3072
RSA 4096

Shared secret

AES CBC
128/192/256
AES CTR
128/192/256

AES-GCM-128
AES-GCM-256

HMAC-SHA-1
HMAC-SHA2-256
HMAC-SHA2-512

3 Cryptographic Module Interfaces

3.1 Ports and Interfaces

The following table maps each physical interface to one or more logical interface types defined in
the FIPS 140-3 standard. The module does not have a Control Output Interface.

Physical Port

Ethernet (data)

Ethernet (mgmt.)

Serial

Power
Reset button
USB

LED

SFP28 (EX4100 only)

Timing interface ports: 10MG, PPS, ToD, BITS, GM/PTP
(MX304 only)

Remote management

LAN communications

Data That Passes

Console serial port management

Logical
Interface(s)
Data Input
Data Output
Control Input
Status
Output
Data Input
Data Output
Control Input
Status
Output
Data Input
Data Output
Control Input
Status
Output
Power
Power
Control Input  Reset
Data Input
Control Input
Status
Output
Data Input
Data Output
Control Input
Status
Output
Control Input  Clock and timing signals from external

Status indicator lighting

Virtual chassis ports

Firmware load port

devices

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 17 of 35

Table 14: Ports and Interfaces

4 Roles, Services, and Authentication

4.1 Authentication Methods

The module implements two forms of role-based authentication methods, as described in the following
table.

Method
Name
Password
authentication

Signature
authentication

Description

User and CO
authentication via SSH
or consol. Minimum of
10 ASCII character
passwords.
User/CO
authentication via SSH

Security
Mechanism
SHA
(LibMD)

Strength Each
Attempt
Probability of guessing:
1/(96^10) <
1/1,000,000.

Strength per Minute

Timed access mechanism allows
max of 10 attempts / min.
Probability of guessing: 10/(96^10)
< 1/100,000.

SigVer (SSH)

Strength of signature
algorithm, minimum 112-
bits. Probability of
success for random
attempt: 1/(2^112) <
1/1,000,000.

A rate of 1 CPU cycle per failed
authentication for the Intel Xeon
D1735-TR processor (8 cores, 2.2
GHz) allows for the probability of
success by brute-force attack: 60 x
8 x 2.2 x 10^9 x 1/(2^112) <
1/100,000.

Table 15: Authentication Methods

4.2 Roles

Name
Crypto Officer

User

Table 16: Roles

Type
Role

Role

Operator Type  Authentication Methods
CO

Password authentication
Signature authentication
Password authentication
Signature authentication

Monitor

The module supports two roles: Cryptographic Officer (CO) and User. The module supports concurrent
operators but does not support a maintenance role and/or bypass capability. The module enforces the
separation of roles using either of the role-based operator authentication methods in Section 4.1.

The Cryptographic Officer role configures and monitors the module via a console or SSH connection. As
root or super-user, the Cryptographic Officer has permission to view and edit secrets within the module.

The User role monitors the module via the console or SSH. The user role cannot change the
configuration.

4.3 Approved Services

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 18 of 35

Name

Description

Indicator

Inputs

Outputs

Configure
Security

Security relevant
configuration

':fips' suffix
in CLI
prompt

CLI Command

Status

Security
Functions
SHA
(Kernel)
Entropy
Source
KeyGen
(SSH)
SHA
(LibMD)
MAC
(LibMD)
DRBG
(Kernel)

Configure  Non-security

None

CLI Command

Status

None

Secure
Traffic

Show
status
Zeroize

relevant
configuration
MACsec encrypted
transfer of data,
distribution of keys

':fips' suffix
in CLI
prompt

MACsec traffic
frames

MACsec traffic
frames

Show status

None

None

Zeroize all CSPs

None

CLI command

':fips' suffix in CLI
prompt
None (completion
indicator is
implicitly
provided by the
module
rebooting)

Key wrap
(MACsec)
Enc/Dec
(MACsec)
Integrity
(MACsec)

None

None

SSP Access

Crypto Officer
- HMAC DRBG V
value: E
- HMAC DRBG
Key value: E
- HMAC DRBG
Entropy Input: E
- HMAC DRBG
Seed: E
- User-PW: W
- CO-PW: W
- Root-PW: W
- SSH PUB:
G,R,W
- SSH PHK:
G,R,W
- MACsec CAK:
W
- MACsec CKN:
R,W
Crypto Officer

Crypto Officer
- MACsec KEK:
G,E
- MACsec SAK:
G,E
- MACsec ICK:
G,E
Crypto Officer
User
Crypto Officer
- HMAC DRBG V
value: Z
- HMAC DRBG
Key value: Z
- HMAC DRBG
Entropy Input: Z
- HMAC DRBG
Seed: Z
- SSH DH Shared
Secret: Z
- SSH PHK: Z
- SSH PUB: Z
- SSH DH PRV: Z
- SSH DH PUB: Z
- SSH DH Pub
(peer): Z
- SSH-SEKs: Z
- CO-PW: Z
- Root-PW: Z
- User-PW: Z
- Auth-CO Pub: Z
- Auth-User Pub:
Z

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 19 of 35

Name

Description

Indicator

Inputs

Outputs

Security
Functions

SSP Access

SSH
connect

Initiate SSH
connection for SSH
monitoring and
control (CLI)

':fips' suffix
in CLI
prompt

SSH packets

SSH packets,
Status

MACsec
connect

Initiate MACsec
connection

':fips' suffix
in CLI
prompt

MACsec link
configuration,
CKN, CAK

MACsec frames,
Status

Console
access

Console monitoring
and control (CLI)

None

CLI Command

Status

- Root-CA: Z
- Package-CA: Z
- MACsec CAK: Z
- MACsec CKN: Z
- MACsec SAK: Z
- MACsec KEK: Z
- MACsec ICK: Z
Crypto Officer
- HMAC DRBG V
value: E
- HMAC DRBG
Key value: E
- HMAC DRBG
Entropy Input: E
- HMAC DRBG
Seed: E
- SSH DH Shared
Secret: G,E
- SSH DH PRV:
G,E
- SSH DH PUB: G
- SSH-SEKs: G,E
- SSH DH Pub
(peer): E
- CO-PW: E
User
- HMAC DRBG V
value: E
- HMAC DRBG
Key value: E
- HMAC DRBG
Entropy Input: E
- HMAC DRBG
Seed: E
- SSH DH Shared
Secret: G,E
- SSH DH PRV:
G,E
- SSH DH PUB: G
- SSH-SEKs: G,E
- SSH DH Pub
(peer): E
- User-PW: E
Crypto Officer
- MACsec ICK: E
- MACsec SAK:
E,W,R
- MACsec KEK: E

Crypto Officer
- CO-PW: E
- Root-PW: E

Enc/Dec
(SSH)
KAS-SSC
(SSH)
SigGen
(SSH)
SigVer
(SSH)
MAC (SSH)
KAS
KeyGen
(SSH)
KDF (SSH)
Full KAS
(SSH)
KTS (SSH)
SHA
(Kernel)
Entropy
Source

Key
derivation
(MACsec)
Key wrap
(MACsec)
Enc/Dec
(MACsec)
Integrity
(MACsec)
None

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 20 of 35

Name

Description

Indicator

Inputs

Outputs

Security
Functions

SSP Access

Remote
reset

Software initiated
reset, performs self-
tests on demand.

None

CLI command

Status

None

Local reset  Hardware reset or

None

power cycle

Main power
cycle

Status

None

Traffic

Load
Image

Perform
self-test

Show
module
version

Traffic requiring no
cryptographic
services
Loading of firmware
image

On demand
execution of all pre-
operational and
conditional
algorithm self-tests
Show system
information
identifying module

Table 17: Approved Services

None

Traffic in

Traffic out

None

':fips' suffix
in CLI
prompt
None

CLI Command

Status

Local or remote
reset

Status

Verify
image

None

None

CLI command

Status

None

User
- User-PW: E
Crypto Officer
- HMAC DRBG V
value: Z
- HMAC DRBG
Key value: Z
- HMAC DRBG
Entropy Input: Z
- HMAC DRBG
Seed: Z
- SSH DH Shared
Secret: Z
- SSH DH PRV: Z
- SSH DH PUB: Z
- SSH-SEKs: Z
- SSH DH Pub
(peer): Z
- MACsec SAK: Z
- MACsec KEK: Z
- MACsec ICK: Z
Unauthenticated
- HMAC DRBG V
value: Z
- HMAC DRBG
Key value: Z
- HMAC DRBG
Entropy Input: Z
- HMAC DRBG
Seed: Z
- SSH DH Shared
Secret: Z
- SSH DH PRV: Z
- SSH DH PUB: Z
- SSH-SEKs: Z
- SSH DH Pub
(peer): Z
- MACsec SAK: Z
- MACsec KEK: Z
- MACsec ICK: Z
Unauthenticated

Crypto Officer
- Root-CA: E
- Package-CA: Z
Crypto Officer
User
Unauthenticated

Crypto Officer
User

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 21 of 35

4.4 Non-Approved Services

The module does not offer any non-approved services.

N/A for this module.

4.5 External Software/Firmware Loaded

The module includes a firmware load service that is used to install the Junos OS firmware image as part
of installation of the module, as described in Section 11.1. The loaded firmware is a complete image
replacement and constitutes an entirely new module and version of Junos OS which would require a
separate FIPS 140-3 validation.

5 Software/Firmware Security

5.1 Integrity Techniques

The cryptographic module implements a firmware integrity self-test that uses ECDSA P-256 with SHA2-
256 to ensure the integrity of all Junos OS firmware components. The self-test is automatically run on
power-up.

5.2 Initiate on Demand

The firmware integrity test can be run on demand by the module’s operator by power cycling the
module.

6 Operational Environment

6.1 Operational Environment Type and Requirements

Type of Operational Environment: Non-Modifiable

The module consists of hardware containing a non-modifiable operational environment as per the FIPS
140-3 definitions. It includes a firmware load service to support necessary updates. The loaded firmware
is a complete image replacement and constitutes an entirely new module and version of Junos OS which
would require a separate FIPS 140-3 validation.

6.2 Configuration Settings and Restrictions

There are no security rules, settings, or restrictions to the configuration of the operational environment
beyond the initialization instructions to set the module in Approved mode.

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 22 of 35

7 Physical Security

The module’s physical embodiment meets Level 1 Physical Security requirements. The module is
completely enclosed in a rectangular nickel or clear zinc coated, cold rolled steel, plated steel and
brushed aluminum enclosure. There are no ventilation holes, gaps, slits, cracks, slots, or crevices that
would allow for any sort of observation of any component contained within the cryptographic boundary.

Mechanism

Inspection
Frequency

Opaque metal enclosure  n/a

Inspection
Guidance
n/a

Table 18: Mechanisms and Actions Required

8 Non-Invasive Security

This section is not applicable, as there are currently no approved non-invasive mitigation techniques
specified in ISO/IEC 19790:2012.

9 Sensitive Security Parameters Management

9.1 Storage Areas

The table below lists the areas within the module’s cryptographic boundary where SSPs can be stored.

Storage
Area
Name
RAM
Flash

Description

Persistence
Type

Random Access Memory
Internal flash memory storage drive  Static

Dynamic

Table 19: Storage Areas

9.2 SSP Input-Output Methods

The table below lists the method used by the module for the input and output of SSPs.

Name

From

Entry via SSH
Entry via console
Output via SSH
Output via console
Entry as part of KAS
Output as part of KAS
Pre-loaded
MACsec Key Agreement
Input
MACsec Key Agreement
Output

Remote CO
Local CO
RAM
RAM
Remote peer
RAM
Manufacturer
Remote
device
RAM

Distribution
Type

To

Format
Type
RAM
Encrypted  Automated
RAM
Plaintext  Manual
Remote CO
Encrypted  Automated
Local CO
Plaintext  Manual
Plaintext
RAM
Remote peer  Plaintext
Flash
RAM

Plaintext  Manual
Encrypted  Automated

Automated
Automated

Remote
device

Encrypted  Automated

SFI or
Entry
Type
Algorithm
Electronic  KTS (SSH)
Electronic
Electronic  KTS (SSH)
Electronic
Electronic  Full KAS (SSH)
Electronic  Full KAS (SSH)
Direct
Electronic  Key wrap
(MACsec)
Electronic  Key wrap
(MACsec)

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 23 of 35

Table 20: SSP Input-Output Methods

9.3 SSP Zeroization Methods

The table below describes the SSP zeroization methods employed by the module.

Description

Rationale

Operator Initiation

Zeroization
Method
Zeroize CLI
command

Reset

This command erases all data, including
all configuration information, returning
the module to its factory default state
The system is then rebooted.
Zeroization of SSPs in RAM via
invocation of local or remote reset
service.

Explicit zeroize
function

Zeroization of SSPs in memory when no
longer needed.

Table 21: SSP Zeroization Methods

This command erases all keys and
CSPS from storage. The forced
power cycle also zeroizes SSPs in
volatile memory.
RAM is volatile and all data is lost
when power is taken off.
Zeroization is practically
instantaneous.
Use of explicit zeroization function
destroys SSP information
immediately by overwriting
memory area with zeroes.

Yes, CO via invocation
of zeroize CLI command.

Yes, both User and CO,
via invocation of Local
Reset or Remote Reset
services.
No. The operator cannot
directly initiate this
method.

The Zeroize CLI command method is detailed in section 11.2.3.

The completion of zeroization is indicated implicitly. If the zeroization is initiated using a zeroization
command or explicit delete command, completion of the command indicates that zeroization has
successfully completed. If the zeroization is initiated by power cycling the module, then successful
reboot of the module indicates that zeroization has completed successfully.  In the case of zeroization
initiated by session termination, SSPs are zeroized when the session terminates, and session termination
is indicated in the log.

9.4 SSPs

All SSPs used by the module are described in this section.

Name

Description

Size - Strength

A critical value of the
internal state of DRBG

256 - 256

Type -
Category
DRBG internal
state - CSP

Generated
By
DRBG
(Kernel)

HMAC
DRBG V
value
HMAC
DRBG Key
value
HMAC
DRBG
Entropy
Input
HMAC
DRBG
Seed

A critical value of the
internal state of DRBG

256 - 256

DRB internal
state - CSP

DRBG
(Kernel)

A critical value of the
internal state of DRBG
provided by entropy
source
Seed material used to
seed or reseed the HMAC
DRBG

256 - 256

Entropy source
output - CSP

Entropy
Source

256 - 256

DRBG internal
state - CSP

DRBG
(Kernel)

Established
By

Used By

DRBG
(Kernel)

DRBG
(Kernel)

DRBG
(Kernel)

DRBG
(Kernel)

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 24 of 35

Type -
Category
DH shared
value - CSP

Generated
By

Established
By
KAS-SSC
(SSH)

Used By

KDF (SSH)

Name

Description

Size - Strength

SSH DH
Shared
Secret

SSH PHK

Shared DH value
computed from the
ephemeral DH key-pairs
as part of SSH and used
to derive session keys.
SSH Private host key. 1st
time SSH is configured,
the keys are generated.

SSH PUB

SSH Public Host Key

SSH KAS private key

256, 384, 521 -
128, 192, 256

2048, 256, 4096,
384, 521 - 112,
128, 152, 192,
256
2048, 256, 4096,
384, 521 - 112,
128, 152, 192,
256
256, 384, 521 -
128, 192, 256

SSH DH
PRV

SSH DH
PUB
SSH DH
Pub (peer)

Asymmetric
private key -
CSP

KeyGen
(SSH)

Asymmetric
public key - PSP

KeyGen
(SSH)

Asymmetric
private key -
CSP

KAS KeyGen
(SSH)

SSH KAS public key

SSH KAS public key from
peer

256, 384, 521 -
128, 192, 256
256, 384, 521 -
128, 192, 256

Asymmetric
public key - PSP
Asymmetric
public key - PSP

KAS KeyGen
(SSH)

SSH-SEKs

SSH Session Encryption
Keys

128, 192, 256 -
128, 192, 256

Symmetric key -
CSP

CO-PW

Root-PW

User-PW

Auth-CO
Pub

Password used to
authenticate the CO.
Password used by CO to
authenticate as 'root'.
Password used to
authenticate User
SSH CO Authentication
Public Key

Auth-User
Pub

SSH User Authentication
Public Key

Root-CA

Package-
CA

MACsec
CAK

X.509 Certificate used to
verify the validity of the
Juniper Package CA
X.509 Certificate used to
verify the validity the
Juniper Image at software
load  and also at runtime
for integrity.
Externally generated pre-
shared key entered when
MACsec static
connectivity  association

Min 10
characters - n/a
Min 10
characters - n/a
Min 10
characters - n/a
2048, 4096, 256,
384, 521 - 112,
128, 152, 192,
256
2048, 4096, 256,
384, 521 - 112,
128, 152, 192,
256
256, 384 - 128,
196

256 - 128

32 (hex)
characters for
128-bit AES
keys, 64 (hex)
characters for

Authentication
password - CSP
Authentication
password - CSP
Authentication
password - CSP
Asymmetric
public key - PSP

Asymmetric
public key - PSP

Asymmetric
public key - PSP

Asymmetric
public key - PSP

Symmetric key -
CSP

SigGen
(SSH)

SigVer
(SSH)

KAS-SSC
(SSH)
Full KAS
(SSH)

KAS-SSC
(SSH)
Full KAS
(SSH)
Enc/Dec
(SSH)
MAC
(SSH)
SHA
(LibMD)
SHA
(LibMD)
SHA
(LibMD)
SigVer
(SSH)

SigVer
(SSH)

Verify
image

Verify
image

KDF (SSH)
Full KAS
(SSH)

KTS (SSH)

KTS (SSH)

KTS (SSH)

KTS (SSH)

KTS (SSH)

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 25 of 35

Name

Description

Size - Strength

Type -
Category

Generated
By

Established
By

Used By

MACsec
CKN

MACsec
SAK

MACsec
KEK

MACsec
ICK

key (CAK) security mode
is enabled.
Externally generated pre-
shared key used to
identify the CAK (64
characters)
Security Association Key
used to encrypt/decrypt
traffic for a given session
Key Encryption Key used
to transmit SAK to other
members of a MACsec
connectivity  association
Integrity Check Key used
to verify the integrity and
authenticity of MPDUs.

Table 22: SSP Table 1

256-bit AES keys
- 128, 256
64 characters -
n/a

Identifier - PSP

128, 256 - 128,
256

Symmetric key -
CSP

128, 256 - 128,
256

Symmetric key -
CSP

128, 256 - 128,
256

Symmetric key -
CSP

Key
derivation
(MACsec)
Key
derivation
(MACsec)

Key
derivation
(MACsec)

Key wrap
(MACsec)

Enc/Dec
(MACsec)

Key wrap
(MACsec)

Integrity
(MACsec)

Name

HMAC
DRBG V
value
HMAC
DRBG Key
value
HMAC
DRBG
Entropy
Input
HMAC
DRBG Seed

SSH DH
Shared
Secret

SSH PHK

SSH PUB

Input -
Output

Storage

Storage Duration

Zeroization

Related
SSPs

RAM:Plaintext

Until updated by
HMAC_DRBG_Update()

RAM:Plaintext

Until updated by
HMAC_DRBG_Update()

RAM:Plaintext

Until  HMAC_Instantiate_Update()
or HMAC_DRBG_Reseed() complete

RAM:Plaintext

Until HMAC_Instantiate_Update() or
HMAC_DRBG_Reseed() complete

RAM:Plaintext

Until SSH session termination

RAM:Plaintext
Flash:Plaintext

Until SSH session termination
(RAM)

Zeroize CLI
command
Reset
Zeroize CLI
command
Reset
Zeroize CLI
command
Reset

Zeroize CLI
command
Reset
Zeroize CLI
command
Reset
Explicit
zeroize
function
Zeroize CLI
command

SSH
PUB:Paired
With

RAM:Plaintext
Flash:Plaintext

Zeroize CLI
command

SSH
PHK:Paired
With

Entry via SSH
Entry via
console
Output via
SSH
Output via
console
Entry via SSH
Entry via
console
Output via
SSH
Output via
console

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 26 of 35

Input -
Output

Name

SSH DH
PRV

Storage

Storage Duration

Zeroization

RAM:Plaintext

Until SSH session termination

Related
SSPs
SSH DH
PUB:Paired
With

SSH DH
PRV:Paired
With

SSH DH
PUB

Output as part
of KAS

RAM:Plaintext

Until SSH session termination

SSH DH
Pub (peer)

Entry as part
of KAS

RAM:Plaintext

Until SSH session termination

SSH-SEKs

RAM:Plaintext

Until SSH session termination

CO-PW

Root-PW

User-PW

Auth-CO
Pub

Auth-User
Pub

Root-CA

Entry via SSH
Entry via
console
Entry via SSH
Entry via
console
Entry via SSH
Entry via
console
Entry via SSH
Entry via
console
Output via
SSH
Output via
console
Entry via SSH
Entry via
console
Output via
SSH
Output via
console
Pre-loaded

Package-CA  Pre-loaded

MACsec
CAK

MACsec
CKN

MACsec
SAK

Entry via SSH
Entry via
console
Entry via SSH
Entry via
console
MACsec Key
Agreement
Input
MACsec Key

RAM:Plaintext
Flash:Plaintext

RAM:Plaintext
Flash:Plaintext

RAM:Plaintext
Flash:Plaintext

RAM:Plaintext
Flash:Plaintext

RAM:Plaintext
Flash:Plaintext

RAM:Plaintext
Flash:Plaintext
RAM:Plaintext
Flash:Plaintext
RAM:Plaintext
Flash:Obfuscated

RAM:Plaintext
Flash:Obfuscated

RAM:Plaintext

Reset
Explicit
zeroize
function
Reset
Explicit
zeroize
function
Reset
Explicit
zeroize
function
Reset
Explicit
zeroize
function
Zeroize CLI
command

Zeroize CLI
command

Zeroize CLI
command

Zeroize CLI
command

Zeroize CLI
command

Zeroize CLI
command
Zeroize CLI
command
Zeroize CLI
command

Zeroize CLI
command

Zeroize CLI
command
Reset

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 27 of 35

Storage

Storage Duration

Zeroization

Related
SSPs

Zeroize CLI
command
Reset
Zeroize CLI
command
Reset

Input -
Output
Agreement
Output

Name

MACsec
KEK

RAM:Plaintext

MACsec ICK

RAM:Plaintext

Table 23: SSP Table 2

9.5 Transitions

The following transitions apply to algorithms used by this module:

SHA-1: The SHA-1 hash algorithm will be non-Approved for cryptographic protection purposes after
December 31, 2030.

10 Self-Tests

On power up or reset, the module performs the pre-operational self-tests and the indicated conditional
cryptographic algorithm self-tests described below. All KATs must be completed successfully prior to
any other use of cryptography by the module. The CASTs for algorithms utilized in the pre-operational
Firmware integrity check are performed prior to the Firmware integrity check.

10.1 Pre-Operational Self-Tests

Algorithm
or Test
Firmware
integrity
check
Critical
functions
test

Test
Properties
ECDSA P-
256 with
SHA2-256
SHA2-256

Test
Method
KAT

KAT

Test
Type
SW/FW
Integrity

Critical
Function

Table 24: Pre-Operational Self-Tests

10.2 Conditional Self-Tests

Indicator

Details

PASS/FAIL
console
output
PASS/FAIL
console
output

ECDSA verify

Checks that any file that is executed is registered in
a manifest of executable files that comes with the
firmware. Test verifies the integrity of the
operational environment is being enforced by
having the kernel attempt to run a specific
executable file that does not contain a hash in the
manifest file, verifying it cannot be executed.

Algorithm or Test

Entropy Source (start-up)

Test
Properties
n/a

Test
Method
APT,
RCT

Test
Type
CAST

Indicator

Details

Conditions

PASS/FAIL
console output

Start-up

On-power up

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 28 of 35

Algorithm or Test

Entropy Source
(continuous)

Test
Properties
n/a

Test
Method
APT,
RCT

Test
Type
CAST

AES-CBC (A4301) Encrypt

AES-CBC (A4301) Decrypt

HMAC-SHA-1 (A4301)

Key size: 128,
192, 256
Key size: 128,
192, 256
Key size: 160

KAT

CAST

KAT

CAST

KAT

CAST

HMAC-SHA2-256 (A4301)

Key size: 256

KAT

CAST

HMAC-SHA2-384 (A4301)

Key size: 384

KAT

CAST

HMAC-SHA2-512 (A4301)

Key size: 512

KAT

CAST

KAT

CAST

Indicator

Details

Conditions

Console output
/ output of
entropy source
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output

Continuous

Encrypt

Data output
from noise
source
On power-up

Decrypt

On power-up

MAC

MAC

MAC

MAC

Sign

On power-up

On power-up

On power-up

On power-up

On power-up

KAT

CAST

PASS/FAIL
console output

Verify

On power-up

RSA SigGen (FIPS186-5)
(A4301)

RSA SigVer (FIPS186-5)
(A4301)

ECDSA SigGen (FIPS186-4)
(A4301)
ECDSA SigVer (FIPS186-4)
(A4301)
KAS-ECC-SSC Sp800-
56Ar3 (A4301)
KDF SSH (A4301)

RSA KeyGen (FIPS186-5)
(A4301)

ECDSA KeyGen (FIPS186-
4) (A4301)

ECDSA SigVer (FIPS186-4)
(A4302)
FW Load

HMAC DRBG (A4303)

RSA 2048 w/
SHA2-256,
RSA 4096 w/
SHA2-256
RSA 2048 w/
SHA2-256,
RSA 4096 w/
SHA2-256
P-256, P-384,
P-521
P-256, P-384,
P-521
P-256, P-384,
P-521
SHA-1, SHA2-
256, SHA2-
384
n/a

KAT

CAST

KAT

CAST

KAT

CAST

KAT

CAST

PCT

PCT

n/a

PCT

PCT

P-256

KAT

CAST

KAT

SW/FW
Load

ECDSA P-256
with SHA2-
256

256, SHA2-
256

KAT

CAST

PASS/FAIL
console output

HMAC-SHA-1 (A4303)

Key size: 160

KAT

CAST

HMAC-SHA2-256 (A4303)

Key size: 256

KAT

CAST

PASS/FAIL
console output
PASS/FAIL
console output

PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output

Returned
key/transition
soft error state
Returned
key/transition
soft error state
PASS/FAIL
console output
PASS/FAIL
console output

Sign

On power-up

Verify

On power-up

ECDH
Computation
Key derivation
Computation

Generation and
Verification of
signature
Generation and
Verification of
signature
Verify

Verification of
ECDSA
signature on
FW
Health-tests
initialise, re-
seed, and
generate
MAC

On power-up

On power-up

On key
generation

On key
generation

On power-up

On FW load

On power-up

On power-up

MAC

On power-up

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 29 of 35

Algorithm or Test

SHA2-384 (A4303)

Test
Properties
n/a

Test
Method
KAT

Test
Type
CAST

SHA2-512 (A4303)

n/a

KAT

CAST

HMAC-SHA2-256 (A4306)

Key size: 256

KAT

CAST

HMAC-SHA-1 (A4306)

Key size: 256

KAT

CAST

SHA2-512 (A4306)

n/a

KAT

CAST

KDF SP800-108 (A4304)

Key size: 128

KAT

CAST

AES-KW (A4304) Wrap

AES-KW (A4304) Unwrap

AES-CMAC (A4304)

AES-GCM
(AES4550/C1869/A4664)
Encrypt

AES-GCM
(AES4550/C1869/A4664)
Decrypt

Key size: 128,
192, 256
Key size: 128,
192, 256
Key size: 128,
256
128,256

KAT

CAST

KAT

CAST

KAT

CAST

KAT

CAST

128,256

KAT

CAST

Table 25: Conditional Self-Tests

Indicator

Details

Conditions

Hash

Hash

MAC

MAC

Hash

On power-up

On power-up

On power-up

On power-up

On power-up

Derive

On power-up

Wrap

On power-up

Unwrap

On power-up

MAC

On power-up

Encrypt

On power-up

Decrypt

On power-up

PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
PASS/FAIL
console output
Internal status:
power-up
continues or
errors
Internal status:
power-up
continues or
errors

10.3 Periodic Self-Test Information

The module does not implement periodic self-testing.

Algorithm or Test
Firmware integrity
check
Critical functions test

Test Method
KAT

Test Type
SW/FW Integrity

Period
On demand

Periodic Method
Manually

KAT

Critical Function

On demand

Manually

Table 26: Pre-Operational Periodic Information

Algorithm or Test
Entropy Source (start-up)
Entropy Source
(continuous)
AES-CBC (A4301)
Encrypt
AES-CBC (A4301)
Decrypt
HMAC-SHA-1 (A4301)

Test Method
APT, RCT
APT, RCT

Test Type
CAST
CAST

Period
On demand
Continuous

Periodic Method
Manually
Automatically

KAT

KAT

KAT

CAST

CAST

CAST

On Demand

Manually

On Demand

Manually

On Demand

Manually

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 30 of 35

Test Method
KAT

PCT

KAT

KAT

KAT

KAT

KAT

KAT

KAT

KAT
PCT

Algorithm or Test
HMAC-SHA2-256
(A4301)
HMAC-SHA2-384
(A4301)
HMAC-SHA2-512
(A4301)
RSA SigGen (FIPS186-5)
(A4301)
RSA SigVer (FIPS186-5)
(A4301)
ECDSA SigGen (FIPS186-
4) (A4301)
ECDSA SigVer (FIPS186-
4) (A4301)
KAS-ECC-SSC Sp800-
56Ar3 (A4301)
KDF SSH (A4301)
RSA KeyGen (FIPS186-5)
(A4301)
ECDSA KeyGen
(FIPS186-4) (A4301)
ECDSA SigVer (FIPS186-
4) (A4302)
FW Load
HMAC DRBG (A4303)
HMAC-SHA-1 (A4303)
HMAC-SHA2-256
(A4303)
SHA2-384 (A4303)
SHA2-512 (A4303)
HMAC-SHA2-256
(A4306)
KAT
HMAC-SHA-1 (A4306)
KAT
SHA2-512 (A4306)
KAT
KDF SP800-108 (A4304)
AES-KW (A4304) Wrap
KAT
AES-KW (A4304) Unwrap  KAT
KAT
AES-CMAC (A4304)
KAT
AES-GCM
(AES4550/C1869/A4664)
Encrypt
AES-GCM
(AES4550/C1869/A4664)
Decrypt

KAT
KAT
KAT
KAT

KAT
KAT
KAT

KAT

KAT

Test Type
CAST

Period
On Demand

Periodic Method
Manually

CAST

CAST

CAST

CAST

CAST

CAST

CAST

CAST
PCT

PCT

CAST

On Demand

Manually

On Demand

Manually

On Demand

Manually

On Demand

Manually

On Demand

Manually

On Demand

Manually

On Demand

Manually

On Demand
On trigger condition

Manually
Automatic

On trigger condition

Automatic

On Demand

Manually

SW/FW Load
CAST
CAST
CAST

On FW load request
On Demand
On Demand
On Demand

Automatic
Manually
Manually
Manually

CAST
CAST
CAST

CAST
CAST
CAST
CAST
CAST
CAST
CAST

CAST

On Demand
On Demand
On Demand

On Demand
On Demand
On Demand
On Demand
On Demand
On Demand
On Demand

Manually
Manually
Manually

Manually
Manually
Manually
Manually
Manually
Manually
Manually

On Demand

Manually

Table 27: Conditional Periodic Information

10.4 Error States

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 31 of 35

Name
Critical
Failure
State

Soft
Error
State

Description
The cryptographic module ceases to perform
cryptographic operations, inhibits all data
output, and provides status of the error via
syslog messages and console status output
A non-critical self-test failure occurs, causing a
failure of the triggering operation

Conditions
On any power-up
self-test or PCT
failure

Recovery Method
Power cycle

Firmware load test or
continuous entropy
health test failure

The module
processes the error,
and resumes normal
operation

Indicator
Console
status
indicator

Console
displays
error

Table 28: Error States

The module enters critical error state upon failure of a self-test, causing the kernel to ‘panic‘ and all
execution to halt. The only way to exit from this state is to reboot the module, which causes the self-
tests to be repeated and pass successfully before the corresponding algorithms are usable.

10.5 Operator Initiation of Self-Tests

Self–tests that are performed at power-up are available on demand by power cycling the module.

11 Life-Cycle Assurance

11.1 Installation, Initialization, and Startup Procedures

The module must be correctly installed and configured to enter a FIPS compliant state and operate in
the Approved mode. The required procedures are as follows:

1.  Install the Junos OS firmware image - the procedure is detailed in section 11.2.1
2.  Configure device for the Approved mode - the procedure is section 11.2.2.

To continue using the module in a FIPS compliant way, the Module Operation Rules in section 11.4.2
must be followed.

11.2 Administrator Guidance

11.2.1 Installing the Junos OS firmware image

1.  Download the validated firmware image from

https://www.juniper.net/support/downloads/junos.html. Log in to the Juniper Networks
authentication system using the username (generally your e-mail address) and password supplied
by Juniper Networks representatives. Select the validated firmware image. Download the
firmware image to a local host or to an internal software distribution site.

The cryptographic module devices use the following firmware images
MX304
EX4100

junos-vmhost-install-mx-x86-64-22.4R2.8.tgz
junos-install-ex-arm-64-22.4R2.8.tgz

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 32 of 35

2.  Connect to the console port on the device from your management device, and log in to the

Junos OS CLI.

3.  Install the new package on the device (package may be a local file copied to the device, or a file

on a remote server):
MX304
EX4100

user@host> request vmhost software add <package>
user@host> request system software add <package>

4.  Reboot the device to load the installation:

MX304
EX4100

user@host> request vmhost reboot
user@host> request system reboot

5.  After the reboot has completed, log in and use the show version command to verify that the new

version of the software is successfully installed.

user@host> request vmhost reboot

11.2.2 Configure the device for the Approved mode

To configure the device for the Approved mode:

1.  Zeroize the device to delete all CSPs before entering the Approved mode.

MX304
EX4100

root@host# request vmhost zeroize no-forwarding
root@host# request system zeroize

2.  After the device comes up, login using username “root” and password blank.
3.  Configure root authentication with password at least 10 characters or more.
root@host# set vmhost root-authentication plain-text-password
root@host# set system root-authentication plain-text-password

MX304
EX4100

4.  Load configuration onto device and commit new configuration.

NOTE: SSH key-exchange configuration must not include ‘dh-group14-sha1’. It is not approved for
this module.

5.  Configure crypto-officer and login with crypto-officer credentials.
6.  For MX304 only, the “fips-mode” and “jpfe-fips” are optional packages needed for enabling FIPS.
These packages are part of Junos OS software. To enable these packages, use below commands:
crypto-officer@host> request system software add optional://fips-mode
MX304
crypto-officer@host> request system software add optional://jpfe-fips

7.  Set the fips level to 1.

MX304
EX4100

crypto-officer@host# set system fips chassis level 1
crypto-officer@host# set system fips level 1

8.  Commit and reboot the device.

crypto-officer@host# commit
crypto-officer@host# run request system reboot

11.2.3 Zeroizing the System

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 33 of 35

CAUTION: Perform system zeroization with care. After the zeroization process is complete, no data is
left on the device. The device is returned to the factory default state, equivalent to a fresh installation of
the firmware, without any configured users or configuration files.

After zeroizing the system, the module is no longer in a FIPS compliant state. (Installation and
configuration as per section 11.1 is required to enter the FIPS compliant state and enable the Approved
mode of operation).

NOTE: The Crypto-Officer must retain control of the module while zeroization is in progress.

To zeroize the device:

1.  Login to the device as Crypto Officer and from CLI, enter

MX304
EX4100

crypto-officer@host# request vmhost zeroize no-forwarding
crypto-officer@host# request system zeroize
warning: System will be rebooted and may not boot without configuration
Erase all data, including configuration and log files? [yes, no] (no)

2.  To initiate the zeroization process, type yes at the prompt:

Erase all data, including configuration and log files? [yes, no] (no)
yes

11.3 Non-Administrator Guidance

No specific non-administrator guidance is required to operate the module.

11.4 Design and Rules
11.4.1 Module Design Rules

The module design implements the following security rules:

1.  The module clears previous authentications on power cycle.
2.  Power up self-tests do not require any operator action.
3.  Data output is inhibited during key generation, self-tests, zeroization, and error states.
4.  Status information does not contain CSPs or sensitive data that if misused could lead to a

compromise of the module.

5.  There are no restrictions on which SSPs are zeroized by the zeroization service.
6.  The module does not support a maintenance interface or role.
7.  The module does not output intermediate key values.
8.  The module requires two independent internal actions to be performed prior to outputting

plaintext CSPs.

9.  If the module loses power and then it is restored, then a new key shall be established for use

with the AES GCM encryption/decryption processes.

11.4.2 Module Operation Rules

The following are requirements for compliant usage of the module:

1.  The cryptographic officer must retain control of the module while zeroization is in process.

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 34 of 35

2.  The cryptographic officer shall verify that the firmware image to be loaded on the module is a

FIPS validated image.

3.  Before pushing the factory reset button on the device, the cryptographic officer shall perform

the zeroize command as described in section 11.2.3.

4.  The password minimum-length must be configured to be at least 10.
5.  Virtual Chassis features must not be configured.
6.  Dynamic CAK mode shall not be configured for MACsec.
7.  Only the AES-GCM cipher suites shall be configured for MACsec.
8.  The module shall only be used with CMVP-validated modules when supporting the MACsec

protocol for providing Peer, Authenticator functionality.

9.  The link between the Peer and Authenticator, used in the MACsec communication, shall be

secure to prevent the possibility for an attacker to introduce foreign equipment into the local
area network.

10. The module shall not be configured to use a radius server and the radius server capability shall

be disabled.

11. SSH key-exchange must not be configured to include ‘dh-group14-sha1’.

11.5 Maintenance Requirements

No special maintenance requirements are required.

11.6 End of Life

When disposing of the cryptographic module, the cryptographic officer shall perform the zeroize
command as described in Section 11.2.3.

12 Mitigation of Other Attacks

The module does not implement mechanisms to mitigate other attacks beyond what is described in this
security policy.

Juniper Networks

Non-Proprietary FIPS 140-3 Security Policy

Page 35 of 35

