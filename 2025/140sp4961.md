Juniper Networks, Inc.
Juniper Networks PTX10008 and PTX10016 Packet Transport Routers
FIPS 140-3 Non-Proprietary Security Policy
Copyright Juniper Networks, Inc. 2024 Page 1 of 67 Document Version 1.0

Table of Contents
1 General ................................................................................................................................... 5
1.1 Overview .......................................................................................................................... 5
1.2 Security Levels ................................................................................................................. 5
1.3 Additional Information ....................................................................................................... 6
2 Cryptographic Module Specification ........................................................................................ 6
2.1 Description ....................................................................................................................... 6
2.2 Tested and Vendor Affirmed Module Version and Identification .......................................11
2.3 Excluded Components .....................................................................................................12
2.4 Modes of Operation .........................................................................................................12
2.5 Algorithms .......................................................................................................................13
2.6 Security Function Implementations ..................................................................................16
2.7 Algorithm Specific Information .........................................................................................20
2.8 RBG and Entropy ............................................................................................................20
2.9 Key Generation................................................................................................................21
2.10 Key Establishment .........................................................................................................21
2.11 Industry Protocols ..........................................................................................................21
2.12 Additional Information ....................................................................................................21
3 Cryptographic Module Interfaces............................................................................................22
3.1 Ports and Interfaces ........................................................................................................22
4 Roles, Services, and Authentication .......................................................................................23
4.1 Authentication Methods ...................................................................................................23
4.2 Roles ...............................................................................................................................25
4.3 Approved Services ..........................................................................................................26
4.4 Non-Approved Services ...................................................................................................41
4.5 External Software/Firmware Loaded ................................................................................43
4.6 Cryptographic Output Actions and Status ........................................................................43
5 Software/Firmware Security ...................................................................................................43
5.1 Integrity Techniques ........................................................................................................43
5.2 Initiate on Demand ..........................................................................................................44
5.3 Additional Information ......................................................................................................44
6 Operational Environment........................................................................................................44
6.1 Operational Environment Type and Requirements ..........................................................44
6.2 Configuration Settings and Restrictions ...........................................................................44
7 Physical Security ....................................................................................................................44
7.1 Mechanisms and Actions Required..................................................................................44
Copyright Juniper Networks, Inc. 2024 Page 2 of 67 Document Version 1.0

8 Non-Invasive Security ............................................................................................................45
8.1 Mitigation Techniques ......................................................................................................45
9 Sensitive Security Parameters Management ..........................................................................45
9.1 Storage Areas .................................................................................................................45
9.2 SSP Input-Output Methods ..............................................................................................45
9.3 SSP Zeroization Methods ................................................................................................46
9.4 SSPs ...............................................................................................................................46
10 Self-Tests .............................................................................................................................54
10.1 Pre-Operational Self-Tests ............................................................................................54
10.2 Conditional Self-Tests ....................................................................................................55
10.3 Periodic Self-Test Information ........................................................................................60
10.4 Error States ...................................................................................................................63
10.5 Operator Initiation of Self-Tests .....................................................................................64
11 Life-Cycle Assurance ...........................................................................................................64
11.1 Installation, Initialization, and Startup Procedures ..........................................................64
11.2 Administrator Guidance .................................................................................................66
11.3 Non-Administrator Guidance ..........................................................................................66
11.4 Maintenance Requirements ...........................................................................................66
11.5 End of Life .....................................................................................................................66
12 Mitigation of Other Attacks ...................................................................................................67
12.1 Attack List ......................................................................................................................67
Copyright Juniper Networks, Inc. 2024 Page 3 of 67 Document Version 1.0

List of Tables
Table 1: Security Levels ............................................................................................................. 6
Table 2: Tested Module Identification – Hardware ....................................................................12
Table 3: Modes List and Description .........................................................................................12
Table 4: Approved Algorithms ...................................................................................................15
Table 5: Vendor-Affirmed Algorithms ........................................................................................15
Table 6: Non-Approved, Allowed Algorithms .............................................................................16
Table 7: Non-Approved, Allowed Algorithms with No Security Claimed .....................................16
Table 8: Non-Approved, Not Allowed Algorithms .......................................................................16
Table 9: Security Function Implementations ..............................................................................20
Table 10: Entropy Certificates ...................................................................................................20
Table 11: Entropy Sources ........................................................................................................20
Table 12: Ports and Interfaces ..................................................................................................23
Table 13: Authentication Methods .............................................................................................25
Table 14: Roles .........................................................................................................................26
Table 15: Approved Services ....................................................................................................41
Table 16: Non-Approved Services.............................................................................................43
Table 17: Mechanisms and Actions Required ...........................................................................44
Table 18: Storage Areas ...........................................................................................................45
Table 19: SSP Input-Output Methods ........................................................................................45
Table 20: SSP Zeroization Methods ..........................................................................................46
Table 21: SSP Table 1 ..............................................................................................................51
Table 22: SSP Table 2 ..............................................................................................................54
Table 23: Pre-Operational Self-Tests ........................................................................................54
Table 24: Conditional Self-Tests ...............................................................................................60
Table 25: Pre-Operational Periodic Information .........................................................................60
Table 26: Conditional Periodic Information ................................................................................63
Table 27: Error States ...............................................................................................................63
List of Figures
Figure 1: Physical Cryptographic Boundary [Left to Right: PTX10008 and PTX10016] .............. 7
Figure 2: Routing Engine [JNP10K-RE0].................................................................................... 7
Figure 3: PTX10K-LC1105-M MACSec Line Card ...................................................................... 8
Figure 4: PTX10008 Chassis Rear ............................................................................................. 8
Figure 5: PTX10016 Chassis Rear ............................................................................................. 9
Figure 6: PTX10008 Block diagram ...........................................................................................10
Figure 7: PTX10016 Block diagram ...........................................................................................11
Copyright Juniper Networks, Inc. 2024 Page 4 of 67 Document Version 1.0

1 General
1.1 Overview
Introduction
Federal Information Processing Standards Publication 140-3 — Security Requirements for
Cryptographic Modules specifies requirements for cryptographic modules to be deployed in a
Sensitive but Unclassified environment. The National Institute of Standards and Technology
(NIST) and Canadian Centre for Cyber Security (CCCS) Cryptographic Module Validation
Program (CMVP) run the FIPS 140-3 program. The NVLAP accredits independent testing labs
to perform FIPS 140-3 testing; the CMVP validates modules meeting FIPS 140-3 validation.
Validated is the term given to a module that is documented and tested against the FIPS 140-3
criteria.
More information is available on the CMVP website at:
https://csrc.nist.gov/projects/cryptographic-module-validation-program.
About this Document
This non-proprietary Cryptographic Module Security Policy for the Juniper Networks PTX10008
and PTX10016 Packet Transport Routers with Routing Engine JNP10K-RE0 and MACsec Line
Card LC1105-M provides an overview of the product and a high-level description of how it
meets the overall Level 1, security requirements of FIPS 140-3.
The Juniper Networks PTX series router models: the PTX10008 and PTX10016 may also be
referred to as the “module” in this document.
Disclaimer
The contents of this document are subject to revision without notice due to continued progress
in methodology, design, and manufacturing. Juniper Networks shall have no liability for any
error or damages of any kind resulting from the use of this document.
Notices
This document may be freely reproduced and distributed in its entirety without modification.
This document describes the cryptographic module security policy for the Juniper Networks PTX
series router models: the PTX10008 and PTX10016 cryptographic module (also referred to as
the “module” hereafter) with firmware version Junos OS 22.4R2.8. The module has a multi-chip
standalone embodiment. It contains specification of the security rules, under which the
cryptographic module operates, including the security rules derived from the requirements of the
FIPS 140-3 standard.
1.2 Security Levels
Section Title Security Level
1 General 1
2 Cryptographic module specification 1
3 Cryptographic module interfaces 1
4 Roles, services, and authentication 3
5 Software/Firmware security 1
Copyright Juniper Networks, Inc. 2024 Page 5 of 67 Document Version 1.0

Section Title Security Level
6 Operational environment 1
7 Physical security 1
8 Non-invasive security N/A
9 Sensitive security parameter management 1
10 Self-tests 1
11 Life-cycle assurance 1
12 Mitigation of other attacks N/A
Overall Level 1
Table 1: Security Levels
1.3 Additional Information
The module claims an overall Security Level of 1 with all individual sections at a Security Level
1 with the exceptions of Roles, Services and Authentication (claimed at Security Level 3). The
module does not implement any non-invasive security mitigations or mitigations of other attacks
and thus the requirements per these sections are inapplicable.
2 Cryptographic Module Specification
2.1 Description
Purpose and Use:
The cryptographic module provides for an encrypted connection, using SSH, between the
management station and itself, i.e., the PTX series routers. The cryptographic module also
provides for an encrypted connection, using MACsec, between itself and a peer.
Module Type: Hardware
Module Embodiment: MultiChipStand
Cryptographic Boundary:
The cryptographic module’s operational environment is a limited operational environment. The
cryptographic boundary of the hardware module is the entirety of the module/chassis. This
includes the Routing Engine (RE). No components have been excluded from the cryptographic
boundary of the module.
Tested Operational Environment’s Physical Perimeter (TOEPP):
The Tested Operational Environment’s Physical Perimeter (TOEPP) is the entirety of the
module chassis.
The images below depict the physical boundary of the modules, including the Routing Engine,
the PTX10KLC1105-M MACsec Line Card and SIB. The non-crypto-relevant line cards included
in the figure are not inserted in the module/excluded from the boundary per the scope of this
validation.
Copyright Juniper Networks, Inc. 2024 Page 6 of 67 Document Version 1.0

Figure 1: Physical Cryptographic Boundary [Left to Right: PTX10008 and PTX10016]
Figure 2: Routing Engine [JNP10K-RE0]
1- RCB status LEDs 2- Console port (CON)
3- PTP-capable connections: SMB In, 4- Management port (MGMT)
SMB Out, 10 MHz In, 10 MHz Out
5- USB 2.0 port 6- Secondary 50-GB SATA SSD slot
7- Reset (RESET) button 8- Four SFP+ ports (reserved for future use)
Copyright Juniper Networks, Inc. 2024 Page 7 of 67 Document Version 1.0

Figure 3: PTX10K-LC1105-M MACSec Line Card
1- Power LED (PWR), status LED (STS), and offline (OFF) button
2- Network ports.
Figure 4: PTX10008 Chassis Rear
1- AC or DC power supplies numbered 0–5 (top to bottom)
2- Fan trays with redundant fans
Copyright Juniper Networks, Inc. 2024 Page 8 of 67 Document Version 1.0

Figure 5: PTX10016 Chassis Rear
1- Power supplies 2- Fan trays
3- ESD point 4- Protective earthing terminal
Copyright Juniper Networks, Inc. 2024 Page 9 of 67 Document Version 1.0

Figure 6: PTX10008 Block diagram
Copyright Juniper Networks, Inc. 2024 Page 10 of 67 Document Version 1.0

Figure 7: PTX10016 Block diagram
The PTX10K-LC1105-M has thirty 28-Gbps QSFP+ (QSFP28) ports that are Media Access
Control Security (MACsec) capable, each of which can be configured via the CLI to support
speeds of 100 Gbps or 40 Gbps.
Each of the 30 QSFP28 ports can operate as:
• 100-Gigabit Ethernet ports when using QSFP28 optical transceivers.
• 40-Gigabit Ethernet ports when using QSFP+ optical transceivers.
2.2 Tested and Vendor Affirmed Module Version and Identification
Tested Module Identification – Hardware:
Model Hardware Firmware Processors Features
and/or Version Version
Part
Number
PTX10008 PTX10008 Junos OS Intel Xeon E3- JNP10K-PWR-AC; JNP10K-
22.4R2.8 1125v2 PWR-DC; JNP10K-PWRAC2;
JNP10K-PWR-DC2
Copyright Juniper Networks, Inc. 2024 Page 11 of 67 Document Version 1.0

Model Hardware Firmware Processors Features
and/or Version Version
Part
Number
PTX10016 PTX10016 Junos OS Intel Xeon E3- JNP10K-PWR-AC; JNP10K-
22.4R2.8 1125v2 PWR-DC; JNP10K-PWRAC2;
JNP10K-PWR-DC2
Table 2: Tested Module Identification – Hardware
2.3 Excluded Components
No components have been excluded from the cryptographic boundary of the module.
2.4 Modes of Operation
Modes List and Description:
Mode Description Type Status Indicator
Name
Approved • The operator can verify that the cryptographic Approved global indicator
mode module is in the Approved mode by observing (string 'fips'
the console prompt and running the “show included in the
version” command; • When operating in the command
Approved mode, the prompt will read prompt)
“<operator>:fips#” (e.g. root:fips#); • The “show
version” command will allow the Crypto Officer
to verify that the validated firmware version is
running on the module; • The Crypto Officer can
also use the “show system fips chassis level”
command (returns “level 1”) to determine if the
module is operating in the Approved mode; •
The Approved mode is entered when the
module is configured for it and successfully
passes all self-tests (both pre-operational and
conditional cryptographic algorithm self-tests
(CASTs))
Non- • The cryptographic module supports a non- Non- global indicator
Approved Approved mode of operation; • When operated Approved (implicit indicator
mode in the non-Approved mode of operation, the based on
module supports non-Approved algorithms as exclusion of string
well as the algorithms supported in the 'fips' from the
Approved mode of operation command
prompt)
Table 3: Modes List and Description
The hardware versions contained in Table 2, with Junos OS 22.4R2.8 installed, contain one
Approved mode of operation and a non-Approved mode of operation. The Junos OS 22.4R2.8
Copyright Juniper Networks, Inc. 2024 Page 12 of 67 Document Version 1.0

firmware image must be installed on the module. The module is configured during initialization
by the Crypto Officer to operate in the Approved mode or the non-Approved mode.

When operated in the non-Approved mode of operation, the module supports non-Approved
algorithms as well as the algorithms supported in the Approved mode of operation. The module
is in a non-compliant state by default and the Crypto Officer can place the module into the non-
Approved mode of operation by following the instructions in Section 11 Life-Cyle Assurance in
this document.

Mode Change Instructions and Status:

The module must always be zeroised when switching between the Approved mode of operation
and the non-Approved mode of operation and vice versa.

Degraded Mode Description:

The module does not support a degraded mode of operation.

2.5 Algorithms

Approved Algorithms:

| Algorithm  | CAVP  | Properties  | Reference  |
| ---------- | ----- | ----------- | ---------- |
Cert
| AES-CBC  | A4301  | Direction - Decrypt, Encrypt  | SP 800-38A  |
| -------- | ------ | ----------------------------- | ----------- |
Key Length - 128, 192, 256
| AES-CBC  | A4304  | Direction - Decrypt, Encrypt  | SP 800-38A  |
| -------- | ------ | ----------------------------- | ----------- |
Key Length - 128, 192, 256
AES-CMAC  A4304  Direction - Generation, Verification  SP 800-38B
Key Length - 128, 256
| AES-CTR  | A4301  | Direction - Decrypt, Encrypt  | SP 800-38A  |
| -------- | ------ | ----------------------------- | ----------- |
Key Length - 128, 192, 256
| AES-ECB  | A4301  | Direction - Decrypt, Encrypt  | SP 800-38A  |
| -------- | ------ | ----------------------------- | ----------- |
Key Length - 128, 192, 256
| AES-ECB  | A4304  | Direction - Decrypt, Encrypt  | SP 800-38A  |
| -------- | ------ | ----------------------------- | ----------- |
Key Length - 128, 192, 256
| AES-GCM  | AES   | Direction - Decrypt, Encrypt  | SP 800-38D  |
| -------- | ----- | ----------------------------- | ----------- |
|          | 4369  | IV Generation - External      |             |
Key Length - 128, 256
| AES-KW  | A4304  | Direction - Decrypt, Encrypt  | SP 800-38F  |
| ------- | ------ | ----------------------------- | ----------- |
Key Length - 128
| AES-XPN  | AES   | Direction - Decrypt, Encrypt  | SP 800-38D  |
| -------- | ----- | ----------------------------- | ----------- |
|          | 4369  | Key Length - 128, 256         |             |
IV Generation - External
ECDSA KeyGen  A4301  Curve - P-256, P-384, P-521  FIPS 186-4
| (FIPS186-4)  |     | Secret Generation Mode - Testing  |     |
| ------------ | --- | --------------------------------- | --- |
Candidates
ECDSA KeyVer  A4301  Curve - P-256, P-384, P-521  FIPS 186-4
(FIPS186-4)
Copyright Juniper Networks, Inc. 2024  Page 13 of 67  Document Version 1.0

| Algorithm  | CAVP  | Properties  | Reference  |
| ---------- | ----- | ----------- | ---------- |
Cert
| ECDSA SigGen  | A4301  | Component - No               | FIPS 186-4  |
| ------------- | ------ | ---------------------------- | ----------- |
| (FIPS186-4)   |        | Curve - P-256, P-384, P-521  |             |
Hash Algorithm - SHA2-256, SHA2-384,
SHA2-512
| ECDSA SigVer  | A4301  | Component - No               | FIPS 186-4  |
| ------------- | ------ | ---------------------------- | ----------- |
| (FIPS186-4)   |        | Curve - P-256, P-384, P-521  |             |
Hash Algorithm - SHA2-256, SHA2-384,
SHA2-512
| HMAC DRBG   | A4301  | Prediction Resistance - Yes   | SP 800-90A  |
| ----------- | ------ | ----------------------------- | ----------- |
|             |        | Mode - SHA2-256               | Rev. 1      |
| HMAC DRBG   | A4303  | Prediction Resistance - Yes   | SP 800-90A  |
|             |        | Mode - SHA2-256               | Rev. 1      |
| HMAC-SHA-1  | A4301  | Key Length - Key Length: 160  | FIPS 198-1  |
HMAC-SHA2-256  A4301  Key Length - Key Length: 256  FIPS 198-1
HMAC-SHA2-256  A4303  Key Length - Key Length: 256  FIPS 198-1
HMAC-SHA2-512  A4301  Key Length - Key Length: 512  FIPS 198-1
KAS-ECC-SSC  A4301  Domain Parameter Generation Methods  SP 800-56A
| Sp800-56Ar3  |     | - P-256, P-384, P-521  | Rev. 3  |
| ------------ | --- | ---------------------- | ------- |
Scheme -
ephemeralUnified -
KAS Role - initiator, responder
KAS-FFC-SSC  A4301  Domain Parameter Generation Methods  SP 800-56A
| Sp800-56Ar3  |     | - FC, MODP-2048  | Rev. 3  |
| ------------ | --- | ---------------- | ------- |
Scheme -
dhEphem -
KAS Role - initiator
| KDF SP800-108  | A4304  | KDF Mode - Counter                      | SP 800-108  |
| -------------- | ------ | --------------------------------------- | ----------- |
|                |        | Supported Lengths - Supported Lengths:  | Rev. 1      |
128, 256
KDF SSH (CVL)  A4301  Cipher - AES-128, AES-192, AES-256,  SP 800-135
|     |     | TDES  | Rev. 1  |
| --- | --- | ----- | ------- |
Hash Algorithm - SHA-1, SHA2-256,
SHA2-384, SHA2-512
| RSA KeyGen   | A4301  | Key Generation Mode - B.3.3  | FIPS 186-4  |
| ------------ | ------ | ---------------------------- | ----------- |
| (FIPS186-4)  |        | Modulo - 2048, 3072, 4096    |             |
Primality Tests - Table C.2
Private Key Format - Standard
| RSA SigGen   | A4301  | Signature Type - PKCS 1.5  | FIPS 186-4  |
| ------------ | ------ | -------------------------- | ----------- |
| (FIPS186-4)  |        | Modulo - 2048, 3072, 4096  |             |
| RSA SigVer   | A4301  | Signature Type - PKCS 1.5  | FIPS 186-4  |
| (FIPS186-4)  |        | Modulo - 2048, 3072, 4096  |             |
Safe Primes Key  A4301  Safe Prime Groups - MODP-2048  SP 800-56A
| Generation  |     |     | Rev. 3  |
| ----------- | --- | --- | ------- |
Safe Primes Key  A4301  Safe Prime Groups - MODP-2048  SP 800-56A
| Verification  |     |     | Rev. 3  |
| ------------- | --- | --- | ------- |
SHA-1  A4301  Message Length - Message Length: 0- FIPS 180-4
65536 Increment 8
Copyright Juniper Networks, Inc. 2024  Page 14 of 67  Document Version 1.0

Algorithm CAVP Properties Reference
Cert
SHA2-256 A4301 Message Length - Message Length: 0- FIPS 180-4
65536 Increment 8
SHA2-256 A4303 Message Length - Message Length: 0- FIPS 180-4
65536 Increment 8
SHA2-512 A4301 Message Length - Message Length: 0- FIPS 180-4
65536 Increment 8
SHA2-512 A4303 Message Length - Message Length: 0- FIPS 180-4
65536 Increment 8
SHA2-512 A4306 Message Length - Message Length: 0- FIPS 180-4
65536 Increment 8
Table 4: Approved Algorithms
The following protocols are supported by the module in the Approved mode:
SSHv2 (EC Diffie-Hellman P-256, P-384, P-521; Diffie-Hellman MODP2048; RSA 2048, 3072,
4096 bits; ECDSA P-256, P-384, P-521; AES CBC 128, 192, 256 bits; AES CTR 128, 192, 256
bits, HMAC-SHA-1, HMAC-SHA2-256, HMAC-SHA2-512)
MACsec (MACsec Key Agreement (MKA); AES GCM, XPN 128 and 256 bits)
The SSH protocol allows independent selection of key exchange, authentication, cipher and
integrity algorithms. Please note that there are algorithms, modes, and key/moduli sizes that
have been CAVP-tested but are not used by any approved service of the module. Only the
algorithms, modes/methods, and key lengths/curves/moduli shown in the table above are used
by an approved service of the module.
Vendor-Affirmed Algorithms:
Name Properties Implementation Reference
CKG - Key N/A NIST SP800-133r2 Section 4:
Section 4 Type:Asymmetric Asymmetric seed generation using an
and 5.1 unmodified output from an Approved
DRBG; Section 5.1: Key Pairs for Digital
Signature Schemes
CKG - Key N/A NIST SP800-133r2 Section 4:
Section 4 Type:Asymmetric Asymmetric seed generation using an
and 5.2 unmodified output from an Approved
DRBG; Section 5.2: Key Pairs for Key
Establishment
CKG - Key N/A NIST SP800-133r2 Section 6.2.1:
Section Type:Symmetric Derivation of symmetric keys
6.2.1
Table 5: Vendor-Affirmed Algorithms
Non-Approved, Allowed Algorithms:
Copyright Juniper Networks, Inc. 2024 Page 15 of 67 Document Version 1.0

| Name  Properties  | Implementation  | Reference  |
| ----------------- | --------------- | ---------- |
| N/A               | N/A             | N/A        |
Table 6: Non-Approved, Allowed Algorithms

The module does not support any non-Approved algorithms in the Approved mode, i.e., it does
not support Non-Approved Algorithms Allowed in the Approved Mode of Operation.

Non-Approved, Allowed Algorithms with No Security Claimed:

| Name  | Caveat  | Use and Function  |
| ----- | ------- | ----------------- |
SHA2-256 (Junos  no  Used to store operator passwords in hashed form,
22.4R2 - LibMD  security  per IG 2.4.A: Use of a non-approved cryptographic
| Implementation)  | claimed  | algorithm to “obfuscate” a CSP  |
| ---------------- | -------- | ------------------------------- |
SHA-1 (Junos 22.4R2 -  no  Used for an extraneous check in the Kernel, per IG
Kernel Implementation)  security  2.4.A: Use of an approved, non-approved or
|     | claimed  | proprietary algorithm for a purpose that is not  |
| --- | -------- | ------------------------------------------------ |
security relevant
Table 7: Non-Approved, Allowed Algorithms with No Security Claimed

The module does not support any non-Approved algorithms in the Approved mode, i.e., it does
not support Non-Approved Algorithms Allowed in the Approved Mode of Operation with No
Security Claimed.

Non-Approved, Not Allowed Algorithms:

| Name  |     | Use and  |
| ----- | --- | -------- |
Function
| RSA with key size less than 2048      |     | SSH  |
| ------------------------------------- | --- | ---- |
| ECDSA with ed25519 curve              |     | SSH  |
| EC Diffie-Hellman with ed25519 curve  |     | SSH  |
| ARCFOUR                               |     | SSH  |
| Blowfish                              |     | SSH  |
| CAST                                  |     | SSH  |
| DSA (SignGen, SigVer, non-compliant)  |     | SSH  |
| HMAC-MD5                              |     | SSH  |
| HMAC-RIPEMD160                        |     | SSH  |
| UMAC                                  |     | SSH  |
Table 8: Non-Approved, Not Allowed Algorithms

In addition to the above non-Approved Algorithms Not Allowed in the Approved Mode of
Operation, all Approved algorithms supported in the Approved mode of operation are also
supported in the non-Approved mode.

2.6 Security Function Implementations

Copyright Juniper Networks, Inc. 2024  Page 16 of 67  Document Version 1.0

| Name  | Type        | Description        | Properties   | Algorithms  |
| ----- | ----------- | ------------------ | ------------ | ----------- |
| KAS1  | KAS-135KDF  | Key Agreement for  | SP 800-      | KAS-ECC-    |
|       | KAS-SSC     | SSHv2              | 56Arev3      | SSC         |
|       |             |                    | KAS-ECC per  | Sp800-      |
|       |             |                    | IG D.F       | 56Ar3       |
|       |             |                    | Scenario 2   | KDF SSH     |
path (2):size:
P-256, P-384,
P-521 curves;
encryption
strength:128,
192, 256 bits;
strength
caveat: SSP
establishment
methodology
provides
between 128
and 256 bits
of encryption
strength
| KAS2  | AsymKeyPair- | Key Agreement for  | SP800-          | KAS-FFC-      |
| ----- | ------------ | ------------------ | --------------- | ------------- |
|       | KeyGen       | SSHv2              | 56Arev3         | SSC           |
|       | AsymKeyPair- |                    | KAS-FFC per     | Sp800-        |
|       | KeyVer       |                    | IG D.F          | 56Ar3         |
|       | KAS-135KDF   |                    | Scenario 2      | KDF SSH       |
|       | KAS-SSC      |                    | path (2):size:  | Safe Primes   |
|       |              |                    | MODP 2048;      | Key           |
|       |              |                    | encryption      | Generation    |
|       |              |                    | strength: SSP   | Safe Primes   |
|       |              |                    | establishment   | Key           |
|       |              |                    | methodology     | Verification  |
provides 112
bits of
encryption
strength
| KTS1  | KTS-Wrap  | Key Transport for  | SP800-38A      | AES-CBC   |
| ----- | --------- | ------------------ | -------------- | --------- |
|       |           | SSHv2              | AES CBC,       | AES-CTR   |
|       |           |                    | CTR and        | AES-ECB   |
|       |           |                    | HMAC 198       | HMAC-     |
|       |           |                    | per IG         | SHA-1     |
|       |           |                    | D.G:size:      | HMAC-     |
|       |           |                    | 128, 192, and  | SHA2-256  |
|       |           |                    | 256-bit keys;  | HMAC-     |
|       |           |                    | SSP            | SHA2-512  |
|       |           |                    | establishment  | SHA-1     |
|       |           |                    | methodology    | SHA2-256  |
|       |           |                    | provides       | SHA2-512  |
between 128
and 256 bits
Copyright Juniper Networks, Inc. 2024  Page 17 of 67  Document Version 1.0

| Name  | Type  | Description  | Properties  | Algorithms  |
| ----- | ----- | ------------ | ----------- | ----------- |
of encryption
strength
ECDSA SigVer  DigSig-SigVer  ECDSA Signature  FIPS 186-4  ECDSA
|     |     | Verification used for  | :size: P-256,  | SigVer       |
| --- | --- | ---------------------- | -------------- | ------------ |
|     |     | firmware integrity     | encryption     | (FIPS186-4)  |
strength: 128
bits
ECDSA SigVer2  DigSig-SigVer  ECDSA Signature  FIPS 186- ECDSA
|     |     | Verification used for  | 4:size: P-256,  | SigVer       |
| --- | --- | ---------------------- | --------------- | ------------ |
|     |     | identity-based public  | P-384, P-521    | (FIPS186-4)  |
|     |     | key authentication     | curves, 128,    |              |
192 and 256
bits
| DRBG  | DRBG  | Kernel DRBG            |     | HMAC      |
| ----- | ----- | ---------------------- | --- | --------- |
|       |       | providing random bits  |     | DRBG      |
|       |       | to the DRBG2 for       |     | HMAC-     |
|       |       | SSP generation in the  |     | SHA2-256  |
|       |       | user/application       |     | SHA2-256  |
space
| DRBG2  | DRBG  | SSP generation in  |     | HMAC  |
| ------ | ----- | ------------------ | --- | ----- |
|        |       | user/application   |     | DRBG  |
|        |       | space              |     | HMAC- |
SHA2-256
SHA2-256
| Entropy Souce  | ENT-Cond  | Non-Physical Entropy  |     | SHA2-512  |
| -------------- | --------- | --------------------- | --- | --------- |
Source
| ECDSA KeyGen  | AsymKeyPair- | Generation of SSH  |     | ECDSA   |
| ------------- | ------------ | ------------------ | --- | ------- |
|               | KeyGen       | host keys          |     | KeyGen  |
(FIPS186-4)
| ECDSA KeyGen2  | AsymKeyPair- | SSP Agreement in    |     | ECDSA   |
| -------------- | ------------ | ------------------- | --- | ------- |
|                | KeyGen       | the context of SSH  |     | KeyGen  |
(FIPS186-4)
| ECDSA KeyVer  | AsymKeyPair- | Verification of keys  |     | ECDSA   |
| ------------- | ------------ | --------------------- | --- | ------- |
|               | KeyVer       | generated             |     | KeyVer  |
(FIPS186-4)
| ECDSA SigGen  | DigSig-      | Signature Generation  |     | ECDSA        |
| ------------- | ------------ | --------------------- | --- | ------------ |
|               | SigGen       | using ECDSA in the    |     | SigGen       |
|               |              | context of SSH        |     | (FIPS186-4)  |
| RSA KeyGen    | AsymKeyPair- | Generation of SSH     |     | RSA          |
|               | KeyGen       | host keys             |     | KeyGen       |
(FIPS186-4)
| RSA SigGen  | DigSig- | Signature Generation  |     | RSA          |
| ----------- | ------- | --------------------- | --- | ------------ |
|             | SigGen  | using RSA in the      |     | SigGen       |
|             |         | context of SSH        |     | (FIPS186-4)  |
RSA SigVer  DigSig-SigVer  Signature Verification    RSA SigVer
|     |     | using RSA for public  |     | (FIPS186-4)  |
| --- | --- | --------------------- | --- | ------------ |
key authentication
Copyright Juniper Networks, Inc. 2024  Page 18 of 67  Document Version 1.0

| Name           | Type  | Description    | Properties  | Algorithms  |
| -------------- | ----- | -------------- | ----------- | ----------- |
| Password Hash  | SHA   | Used to store  |             | SHA2-512    |
passwords in hashed
form
| CKG  | CKG  | Cryptographic Key  |     | CKG -    |
| ---- | ---- | ------------------ | --- | -------- |
|      |      | Generation (CKG)   |     | Section  |
6.2.1
Key Type:
Symmetric
| MACsec                 | BC-Auth   | Encryption/Decryption  |             | AES-GCM  |
| ---------------------- | --------- | ---------------------- | ----------- | -------- |
| Encryption/Decryption  |           | of MACsec packets      |             | AES-XPN  |
| KTS2                   | KTS-Wrap  | Key Transport for      | SP800-38D   | AES-KW   |
|                        |           | MACsec                 | AES KW per  |          |
IG D.G
:size:128-
,192-,256-bit
keys;
encryption
strength: SSP
establishment
methodology
provides
between 128
and 256 bits
of encryption
strength
| MACsec Key  | KBKDF  | NIST SP 800-108       |     | KDF        |
| ----------- | ------ | --------------------- | --- | ---------- |
| Derivation  | MAC    | KDF used in the       |     | SP800-108  |
|             |        | context of MAcsec to  |     | AES-CMAC   |
|             |        | derive SSPs           |     | AES-ECB    |
AES-CBC
| CASTs on boot  | BC-Auth        | List of algorithms for  |     | AES-CBC   |
| -------------- | -------------- | ----------------------- | --- | --------- |
|                | BC-UnAuth      | which Known Answer      |     | HMAC      |
|                | DigSig-        | Tests (CASTs) have      |     | DRBG      |
|                | SigGen         | been implemented in     |     | HMAC-     |
|                | DigSig-SigVer  | the module and          |     | SHA-1     |
|                | DRBG           | perform on each boot    |     | HMAC-     |
|                | ENT-Cond       |                         |     | SHA2-256  |
|                | KAS-135KDF     |                         |     | HMAC-     |
|                | KBKDF          |                         |     | SHA2-512  |
|                | MAC            |                         |     | KAS-ECC-  |
|                | SHA            |                         |     | SSC       |
Sp800-
56Ar3
KAS-FFC-
SSC
Sp800-
56Ar3
KDF SSH
ECDSA
Copyright Juniper Networks, Inc. 2024  Page 19 of 67  Document Version 1.0

Name Type Description Properties Algorithms
SigGen
(FIPS186-4)
ECDSA
SigVer
(FIPS186-4)
RSA
SigGen
(FIPS186-4)
RSA SigVer
(FIPS186-4)
HMAC
DRBG
HMAC-
SHA2-256
SHA2-512
AES-GCM
AES-KW
KDF
SP800-108
SHA2-512
AES-CMAC
Table 9: Security Function Implementations
2.7 Algorithm Specific Information
The module only supports testable RSA moduli/key sizes (2048, 3072 and 4096 bits) and thus
the requirements per FIPS 140-3 IG C.F do not apply.
2.8 RBG and Entropy
Cert Vendor Name
Number
E104 Juniper Networks
Table 10: Entropy Certificates
Name Type Operational Sample Entropy Conditioning
Environment Size per Component
Sample
Junos OS Non- Non- Intel Xeon E3- 8 bits 0.83 bits SHA2-512 (CAVP
Physical Entropy Physical 1125v2 Cert. #A3403)
Source
Table 11: Entropy Sources
Copyright Juniper Networks, Inc. 2024 Page 20 of 67 Document Version 1.0

2.9 Key Generation
The module implements two NIST SP 800-90Ar1 DRBGs and supports the following sections
per NIST SP 800-133r2 (CKG): Sections 4, 5.1, 5.2 and 6.2.1.
2.10 Key Establishment
Per IG D.F:
The module implements full KAS (KAS-ECC-SSC, KAS-FFC-SSC per NIST SP 800-56Ar3 and
KDF SSH per NIST SP 800-135r1; IG D.F Scenario 2 (path 2 option 2, separate testing of the
SSC and SP800-135r1 KDF). The KAS1 and KAS2 in the SFI Table have been documented in
accordance with this requirement:
KAS1: KAS (KAS-ECC-SSC Cert.#A4301 and CVL Cert. #A4301; SSP establishment
methodology provides between 128 and 256 bits of encryption strength)
KAS2: KAS (KAS-FFC-SSC Cert.#A4301 and CVL Cert. #A4301; SSP establishment
methodology provides 112 bits of encryption strength)
The Approved Algorithm list includes the tested components (KAS-ECC-SSC, KAS-FFC-SSC
and KDF SSH) as individual entries.
Per IG D.G:
The module supports the IETF SSH and MACsec protocols and thus implements key transport
in the context of the protocols (per the KTS1 and KTS2 entries in the SFI table of the Security
Policy).
The module implements the following approved KTS using approved AES modes:
AES CBC and CTR (KTS1): KTS (AES Cert. #A4301 and HMAC Cert. #A4301; SSP
establishment methodology provides between 128 and 256 bits of encryption strength)
AES KW (KTS2): KTS (AES Cert. #A4304; SSP establishment methodology provides between
128 and 256 bits of encryption strength)
2.11 Industry Protocols
No parts of the SSH and MACsec protocols, other than the KDF SSH and the NIST SP 800-108
KDF for MACsec, have been tested by the CAVP or CMVP.
2.12 Additional Information
The module design corresponds to the security rules below. The term shall in this context
specifically refers to a requirement for correct usage of the module in the Approved mode; all
other statements indicate a security rule implemented by the module.
1. The module clears previous authentications on power cycle.
2. When the module has not been placed in a valid role, the operator does not have access
to any cryptographic services.
Copyright Juniper Networks, Inc. 2024 Page 21 of 67 Document Version 1.0

3. Self-tests do not require any operator action.
4. Data output is inhibited during SSP generation, self-test execution, zeroisation, and error
states.
5. Status information does not contain SSPs or sensitive data that if misused could lead to
a compromise of the module.
6. There are no restrictions on which SSPs are zeroised by the zeroisation service.
7. The module does not support a maintenance interface or role.
8. The module does not output intermediate key values.
9. The module does not output plaintext CSPs.
10. The Crypto officer shall verify that the firmware image to be loaded on the module is a
FIPS 140-3 validated image. If any non-validated firmware image is loaded the module
will no longer be a validated module.
11. The Crypto Officer shall retain control of the module while zeroisation is in process.
12. MACsec protocol IV generation:
• The AES GCM IV construction is performed internal to the module in compliance
with IEEE 802.1AEand its amendments. The IV length is 96 bits (per SP 800-38D).
The module ensures the IV is constructed deterministically per Section 8.2 in SP
800-38D and the MACsec standard IEEE 802.1AE as a result of concatenating the
fixed field (SCI) and invocation field (PN).
• The module can take on the role of Peer or Authenticator in reference to the MACsec
protocol.
• The module shall only be used with other FIPS 140-3 validated modules when
supporting the MACsec protocol in the role of a Peer/Authenticator for providing the
remaining functionalities.
• Per FIPS 140-3 IG C.H Scenario 3, if the module loses power and then it is restored,
then a new key shall be established for use with the AES GCM encryption/decryption
processes.
• The link between the Peer and Authenticator, used in the MACsec communication,
shall be secure to prevent the possibility for an attacker to introduce foreign
equipment into the local area network.
13. The module shall not be configured to use a radius server and the radius server
capability shall be disabled.
3 Cryptographic Module Interfaces
3.1 Ports and Interfaces
Physical Port Logical Data That Passes
Interface(s)
Ethernet (Management port) Data Input LAN, Communications/remote management
Data Output
Control Input
Status Output
Serial Data Input Console Serial Port
Data Output
Copyright Juniper Networks, Inc. 2024 Page 22 of 67 Document Version 1.0

| Physical Port  |     | Logical  | Data That Passes  |     |     |
| -------------- | --- | -------- | ----------------- | --- | --- |
Interface(s)
Control Input
Status Output
| USB  |     | Data Input  | USB port, load Junos Image  |     |     |
| ---- | --- | ----------- | --------------------------- | --- | --- |
Control Input
| Power         |     | Power          | Power connector, Power over Ethernet  |     |     |
| ------------- | --- | -------------- | ------------------------------------- | --- | --- |
| Alarm LEDs    |     | Status Output  | Status indicator lighting             |     |     |
| Reset Button  |     | Control Input  | Reset signal                          |     |     |
PTP-capable connections  Data Input  SMB In/out (clock synchronization)
Data Output
| Online/Offline Button  |     | Control Input  | Online/Offline signal  |     |     |
| ---------------------- | --- | -------------- | ---------------------- | --- | --- |
Table 12: Ports and Interfaces

The module does not support control output.

4 Roles, Services, and Authentication

4.1 Authentication Methods

| Method  | Description  |     | Security   | Strength  | Strength per  |
| ------- | ------------ | --- | ---------- | --------- | ------------- |
| Name    |              |     | Mechanism  | Each      | Minute        |
Attempt
Username  • The module enforces 10- SHA2-512  1/(96^10)  9/(96^10)
| and          | character passwords (at      |     | (A4306)  |     |     |
| ------------ | ---------------------------- | --- | -------- | --- | --- |
| password     | minimum) chosen from the 96  |     |          |     |     |
| over the     | human readable ASCII         |     |          |     |     |
| console and  | characters; The maximum      |     |          |     |     |
| SSH          | password length is 20-       |     |          |     |     |
characters; Thus, the probability
of a successful random attempt is
1/(96^10), which is less than
1/1,000,000 (million);  • The
module enforces a timed access
mechanism as follows: For the
first two failed attempts
(assuming 0 time to process), no
timed access is enforced; Upon
the third attempt, the module
enforces a 5-second delay; Each
failed attempt thereafter results in
an additional 5-second delay
above the previous (e.g., 4th
failed attempt = 10-second delay,
5th failed attempt = 15-second
delay, 6th failed attempt = 20-
second delay, 7th failed attempt
Copyright Juniper Networks, Inc. 2024  Page 23 of 67  Document Version 1.0

Method Description Security Strength Strength per
Name Mechanism Each Minute
Attempt
= 25-second delay); This leads to
a maximum of 7 possible
attempts in a one-minute period
for each getty; The best
approach for the attacker would
be to disconnect after 4 failed
attempts and wait for a new getty
to be spawned; This would allow
the attacker to perform roughly
9.6 attempts per minute (576
attempts per hour/60 mins); this
would be rounded down to 9 per
minute, because there is no such
thing as 0.6 attempts; The
probability of a success with
multiple consecutive attempts in
a one-minute period is 9/(96^10),
which is less than 1/100,000
Username • The module supports ECDSA ECDSA 1/(2^128) 15,000/(2^128)
and ECDSA (P-256, P-384, and P-521), which SigVer
public key has a minimum equivalent (FIPS186-4)
over SSH computational resistance to (A4301)
attack of either 2^128, 2^192 or
2^256 depending on the curve;
Thus, the probability of a
successful random attempt is
1/(2^128), which is less than
1/1,000,000 (million) •
Configurable SSH connection
establishment rate limits the
number of connection attempts,
and thus failed authentication
attempts in a one-minute period
to a maximum of 15,000
attempts; The probability of a
success with multiple
consecutive attempts in a one-
minute period is 15,000/(2^128),
which is less than 1/100,000
Username • The module supports RSA RSA SigVer 1/ 15,000/(2^112)
and RSA (2048, 3072, 4096 bits), which (FIPS186-4) (2^112)
public key has a minimum equivalent (A4301)
over SSH computational resistance to
attack of 2^112 (2048 bits); Thus,
the probability of a successful
random attempt is 1/ (2^112),
which is less than 1/1,000,000
(million) • Configurable SSH
Copyright Juniper Networks, Inc. 2024 Page 24 of 67 Document Version 1.0

Method Description Security Strength Strength per
Name Mechanism Each Minute
Attempt
connection establishment rate
limits the number of connection
attempts, and thus failed
authentication attempts in a one-
minute period to a maximum of
15,000 attempts; The probability
of a success with multiple
consecutive attempts in a one-
minute period is 15,000/(2^112),
which is less than 1/100,000
Table 13: Authentication Methods
The module enforces the separation of roles using identity-based operator authentication. The
module implements two forms of identity-based authentication, username, and password over
the console and SSH connections, as well as username and an ECDSA or RSA public key-
based authentication over SSHv2.
4.2 Roles
Name Type Operator Type Authentication Methods
Super-user Identity Crypto Officer Username and password
(CO) over the console and SSH
Username and ECDSA
public key over SSH
Username and RSA
public key over SSH
Operator Identity User Username and password
over the console and SSH
Username and ECDSA
public key over SSH
Username and RSA
public key over SSH
Read-only Identity User Username and password
over the console and SSH
Username and ECDSA
public key over SSH
Username and RSA
public key over SSH
Root Identity Crypto Officer Username and password
(CO) over the console and SSH
Username and ECDSA
public key over SSH
Username and RSA
public key over SSH
Unauthorised Identity User Username and password
over the console and SSH
Copyright Juniper Networks, Inc. 2024 Page 25 of 67 Document Version 1.0

| Name  |     | Type  |     | Operator Type  | Authentication Methods  |     |
| ----- | --- | ----- | --- | -------------- | ----------------------- | --- |
Username and ECDSA
public key over SSH
Username and RSA
public key over SSH
Table 14: Roles

The module supports two roles: Crypto Officer (CO) and User. Root and Super-user correspond
to the Crypto Officer role whereas Operator, Read-Only and Unauthorised operator types
correspond to the User role. The module supports concurrent operators but does not support a
maintenance role and/or bypass capability.

An operator assuming the Crypto Officer role configures and monitors the module via a console
or SSH connection. As Root or Super-user, the Crypto Officer has permission to view and
configure passwords and public keys within the module. The User role monitors the module via
the console or SSH. The User role does not have the permission to modify the configuration.

4.3 Approved Services

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|          | n         | r       |           | ts       | Functions  |        |
| -------- | --------- | ------- | --------- | -------- | ---------- | ------ |
| Configur | Security  | Global  | Commands  | Traffic  | DRBG       | Root   |
| e        | relevant  | Approve | (SSH      |          | DRBG2      | - SSH  |
security  configurati d Mode  configuration Password Hash  Private Host
| (security  | on (SSH,    | indicator  | : set system  |     | CKG  | Key: G        |
| ---------- | ----------- | ---------- | ------------- | --- | ---- | ------------- |
| relevant)  | authenticat | “fips” at  | services ssh  |     |      | - User        |
|            | ion data)   | the CLI    | root-login    |     |      | Password:     |
|            |             | combine    | allow)        |     |      | W,E           |
|            |             | d with     |               |     |      | - CO          |
|            |             | success    |               |     |      | Password:     |
|            |             | ful        |               |     |      | W,E           |
|            |             | completi   |               |     |      | -             |
|            |             | on of      |               |     |      | HMAC_DRB      |
|            |             | each       |               |     |      | G V value: E  |
|            |             | service    |               |     |      | -             |
HMAC_DRB
G Key value:
E
-
HMAC_DRB
G entropy
input: E
-
HMAC_DRB
G seed: E
- SSH Public
Host Key: G
- User
Authenticatio
Copyright Juniper Networks, Inc. 2024  Page 26 of 67  Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
n Public
Keys: W
- CO
Authenticatio
n Public
Keys: W
Super-user
- SSH
Private Host
Key: G
- User
Password:
W,E
- CO
Password:
W,E
-
HMAC_DRB
G V value: E
-
HMAC_DRB
G Key value:
E
-
HMAC_DRB
G entropy
input: E
-
HMAC_DRB
G seed: E
- SSH Public
Host Key: G
- User
Authenticatio
n Public
Keys: W
- CO
Authenticatio
n Public
Keys: W
Configur Non- Global Commands Traffic Password Hash Super-user
e (non- security Approve (miscellaneo - CO
security relevant d Mode us Password: E
relevant) configurati indicator commands Root
on “fips” at e.g., for IP - CO
the CLI address Password: E
combine configuration
d with , routing
success
Copyright Juniper Networks, Inc. 2024 Page 27 of 67 Document Version 1.0

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|     | n   | r        |             | ts  Functions  |     |
| --- | --- | -------- | ----------- | -------------- | --- |
|     |     | ful      | protocols,  |                |     |
|     |     | completi | etc.)       |                |     |
on of
each
service
Show  Query the  Global  Command  CLI  Password Hash  Super-user
| status  | module  | Approve    | (show)  | output  | - CO         |
| ------- | ------- | ---------- | ------- | ------- | ------------ |
|         | status  | d Mode     |         |         | Password: E  |
|         |         | indicator  |         |         | Root         |
|         |         | “fips” at  |         |         | - CO         |
|         |         | the CLI    |         |         | Password: E  |
|         |         | combine    |         |         | Operator     |
|         |         | d with     |         |         | - User       |
|         |         | success    |         |         | Password: E  |
|         |         | ful        |         |         | Read-only    |
|         |         | completi   |         |         | - User       |
|         |         | on of      |         |         | Password: E  |
|         |         | each       |         |         | Unauthorise  |
|         |         | service    |         |         | d            |
- User
Password: E
| Show    | LEDs on     | LED(s)   | N/A  | LED  None  | Super-user  |
| ------- | ----------- | -------- | ---- | ---------- | ----------- |
| status  | the module  | on the   |      |            | Operator    |
| (LED)   | provide     | chassis  |      |            | Read-only   |
|         | physical    | turned   |      |            | Unauthorise |
|         | status      | on       |      |            | d           |
|         | output      |          |      |            | Root        |
Unauthentic
ated
Show  Query the  Global  Command  CLI  Password Hash  Super-user
| module’s  | module’s     | Approve    | (show     | output  | - CO         |
| --------- | ------------ | ---------- | --------- | ------- | ------------ |
| versionin | versioning   | d Mode     | version)  |         | Password: E  |
| g         | information  | indicator  |           |         | Operator     |
| informati |              | “fips” at  |           |         | - User       |
| on        |              | the CLI    |           |         | Password: E  |
|           |              | combine    |           |         | Read-only    |
|           |              | d with     |           |         | - User       |
|           |              | success    |           |         | Password: E  |
|           |              | ful        |           |         | Unauthorise  |
|           |              | completi   |           |         | d            |
|           |              | on of      |           |         | - User       |
|           |              | each       |           |         | Password: E  |
|           |              | service    |           |         | Root         |
- CO
Password: E
Zeroise  Destroy all  Global  Command  N/A  Password Hash  Super-user
| (Perform  | SSPs  | Approve | (request  |     | - SSH         |
| --------- | ----- | ------- | --------- | --- | ------------- |
|           |       | d Mode  | vmhost    |     | Private Host  |
Copyright Juniper Networks, Inc. 2024  Page 28 of 67  Document Version 1.0

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|           | n   | r          |              | ts  Functions  |               |
| --------- | --- | ---------- | ------------ | -------------- | ------------- |
| zeroisati |     | indicator  | zeroise no-  |                | Key: Z        |
| on)       |     | “fips” at  | forwarding)  |                | - SSH ECDH    |
|           |     | the CLI    |              |                | Private Key:  |
|           |     | combine    |              |                | Z             |
|           |     | d with     |              |                | - SSH DH      |
|           |     | success    |              |                | Private Key:  |
|           |     | ful        |              |                | Z             |
|           |     | completi   |              |                | - SSH         |
|           |     | on of      |              |                | Session       |
|           |     | each       |              |                | Key: Z        |
|           |     | service    |              |                | - User        |
Password: Z
- CO
Password:
E,Z
-
HMAC_DRB
G V value: Z
-
HMAC_DRB
G Key value:
Z
-
HMAC_DRB
G entropy
input: Z
-
HMAC_DRB
G seed: Z
- ECDH
Shared
Secret: Z
- DH Shared
Secret: Z
- HMAC
Key: Z
- SSH Public
Host Key: Z
- User
Authenticatio
n Public
Keys: Z
- CO
Authenticatio
n Public
Keys: Z
-
JuniperRoot
CA: Z
Copyright Juniper Networks, Inc. 2024  Page 29 of 67  Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
-
PackageCA:
Z
- SSH ECDH
Public Key:
Z
- SSH DH
Public Key:
Z
- SSH ECDH
Client Public
Key: Z
- SSH DH
Client Public
Key: Z
- MACsec
PSK: Z
- MACsec
SAK: Z
- MACsec
KEK: Z
- MACsec
ICK: Z
Root
- SSH
Private Host
Key: Z
- SSH ECDH
Private Key:
Z
- SSH DH
Private Key:
Z
- SSH
Session
Key: Z
- User
Password: Z
- CO
Password:
E,Z
-
HMAC_DRB
G V value: Z
-
HMAC_DRB
G Key value:
Z
-
Copyright Juniper Networks, Inc. 2024 Page 30 of 67 Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
HMAC_DRB
G entropy
input: Z
-
HMAC_DRB
G seed: Z
- ECDH
Shared
Secret: Z
- DH Shared
Secret: Z
- HMAC
Key: Z
- SSH Public
Host Key: Z
- User
Authenticatio
n Public
Keys: Z
- CO
Authenticatio
n Public
Keys: Z
-
JuniperRoot
CA: Z
-
PackageCA:
Z
- SSH ECDH
Public Key:
Z
- SSH DH
Public Key:
Z
- SSH ECDH
Client Public
Key: Z
- SSH DH
Client Public
Key: Z
- MACsec
PSK: Z
- MACsec
SAK: Z
- MACsec
KEK: Z
- MACsec
ICK: Z
Copyright Juniper Networks, Inc. 2024 Page 31 of 67 Document Version 1.0

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|     | n   | r   |     | ts  Functions  |     |
| --- | --- | --- | --- | -------------- | --- |
Perform  Initiate  Global  Authenticatio SSH  KAS1  Super-user
| approve   | SSH         | Approve    | n data     | sessio KAS2    | - SSH         |
| --------- | ----------- | ---------- | ---------- | -------------- | ------------- |
| d         | connection  | d Mode     | (Username  | n  KTS1        | Private Host  |
| security  | for SSH     | indicator  | and        | ECDSA SigVer2  | Key: E        |
functions  monitoring  “fips” at  password/pu DRBG  - SSH ECDH
| (SSH     | and control  | the CLI  | blic-key      | DRBG2          | Private Key:  |
| -------- | ------------ | -------- | ------------- | -------------- | ------------- |
| connecti | (CLI)        | combine  | based         | Entropy Souce  | G,E,Z         |
| on)      |              | d with   | authenticatio | ECDSA KeyGen   | - SSH DH      |
|          |              | success  | n)            | ECDSA          | Private Key:  |
|          |              | ful      |               | KeyGen2        | G,E,Z         |
|          |              | completi |               | ECDSA KeyVer   | - SSH         |
|          |              | on of    |               | ECDSA SigGen   | Session       |
|          |              | each     |               | RSA KeyGen     | Key: G,E,Z    |
|          |              | service  |               | RSA SigGen     | -             |
RSA SigVer  HMAC_DRB
Password Hash  G V value: E
CKG  -
HMAC_DRB
G Key value:
E
-
HMAC_DRB
G entropy
input: E
-
HMAC_DRB
G seed: E
- ECDH
Shared
Secret:
G,E,Z
- DH Shared
Secret:
G,E,Z
- HMAC
Key: G,E,Z
- SSH Public
Host Key: G
- SSH DH
Public Key:
G,E,Z
- SSH ECDH
Public Key:
G,E,Z
- CO
Password: E
- CO
Authenticatio
n Public
Copyright Juniper Networks, Inc. 2024  Page 32 of 67  Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
Keys: E
- SSH ECDH
Client Public
Key: W,E,Z
- SSH DH
Client Public
Key: W,E,Z
Root
- SSH
Private Host
Key: E
- SSH ECDH
Private Key:
G,E,Z
- SSH DH
Private Key:
G,E,Z
- SSH
Session
Key: G,E,Z
-
HMAC_DRB
G V value: E
-
HMAC_DRB
G Key value:
E
-
HMAC_DRB
G entropy
input: E
-
HMAC_DRB
G seed: E
- ECDH
Shared
Secret:
G,E,Z
- DH Shared
Secret:
G,E,Z
- HMAC
Key: G,E,Z
- SSH Public
Host Key: E
- SSH ECDH
Public Key:
G,E,Z
- SSH DH
Copyright Juniper Networks, Inc. 2024 Page 33 of 67 Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
Public Key:
G,E,Z
- CO
Password: E
- CO
Authenticatio
n Public
Keys: E
- SSH ECDH
Client Public
Key: W,E,Z
- SSH DH
Client Public
Key: W,E,Z
Operator
- SSH
Private Host
Key: E
- SSH ECDH
Private Key:
G,E,Z
- SSH DH
Private Key:
G,E,Z
- SSH
Session
Key: G,E,Z
-
HMAC_DRB
G V value: E
-
HMAC_DRB
G entropy
input: E
-
HMAC_DRB
G seed: E
- ECDH
Shared
Secret:
G,E,Z
- DH Shared
Secret:
G,E,Z
- HMAC
Key: G,E,Z
- SSH Public
Host Key: E
- SSH ECDH
Copyright Juniper Networks, Inc. 2024 Page 34 of 67 Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
Public Key:
G,E,Z
- SSH DH
Public Key:
G,E,Z
- User
Password: E
- User
Authenticatio
n Public
Keys: E
-
HMAC_DRB
G Key value:
E
- SSH ECDH
Client Public
Key: W,E,Z
- SSH DH
Client Public
Key: W,E,Z
Read-only
- SSH
Private Host
Key: E
- SSH ECDH
Private Key:
G,E,Z
- SSH DH
Private Key:
G,E,Z
- SSH
Session
Key: G,E,Z
-
HMAC_DRB
G V value: E
-
HMAC_DRB
G Key value:
E
-
HMAC_DRB
G entropy
input: E
-
HMAC_DRB
G seed: E
- ECDH
Copyright Juniper Networks, Inc. 2024 Page 35 of 67 Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
Shared
Secret:
G,E,Z
- DH Shared
Secret:
G,E,Z
- HMAC
Key: G,E,Z
- SSH Public
Host Key: E
- SSH ECDH
Public Key:
G,E,Z
- SSH DH
Public Key:
G,E,Z
- User
Password: E
- User
Authenticatio
n Public
Keys: E
- SSH ECDH
Client Public
Key: W,E,Z
- SSH DH
Client Public
Key: W,E,Z
Unauthorise
d
- SSH
Private Host
Key: E
- SSH ECDH
Private Key:
G,E,Z
- SSH DH
Private Key:
G,E,Z
- SSH
Session
Key: G,E,Z
-
HMAC_DRB
G V value: E
-
HMAC_DRB
G entropy
input: E
Copyright Juniper Networks, Inc. 2024 Page 36 of 67 Document Version 1.0

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|     | n   | r   |     | ts  Functions  |     |
| --- | --- | --- | --- | -------------- | --- |
-
HMAC_DRB
G seed: E
- ECDH
Shared
Secret:
G,E,Z
- DH Shared
Secret:
G,E,Z
- HMAC
Key: G,E,Z
- SSH Public
Host Key: E
- SSH ECDH
Public Key:
G,E,Z
- SSH DH
Public Key:
G,E,Z
- User
Password: E
- User
Authenticatio
n Public
Keys: E
-
HMAC_DRB
G Key value:
E
- SSH ECDH
Client Public
Key: W,E,Z
- SSH DH
Client Public
Key: W,E,Z
Console  Console  Global  Username,  N/A  Password Hash  Super-user
| Access  | monitoring   | Approve    | password      |     | - CO         |
| ------- | ------------ | ---------- | ------------- | --- | ------------ |
|         | and control  | d Mode     | (set system   |     | Password: E  |
|         | (CLI)        | indicator  | login user    |     | Operator     |
|         |              | “fips” at  | <username>    |     | - CO         |
|         |              | the CLI    | class         |     | Password: E  |
|         |              | combine    | <crypto-      |     | Read-only    |
|         |              | d with     | officer/user  |     | - User       |
|         |              | success    | class>        |     | Password: E  |
|         |              | ful        | operator      |     | Unauthorise  |
|         |              | completi   | authenticatio |     | d            |
|         |              | on of      | n plaintext-  |     | - User       |
|         |              |            | password)     |     | Password: E  |
Copyright Juniper Networks, Inc. 2024  Page 37 of 67  Document Version 1.0

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|     | n   | r        |     | ts  Functions  |       |
| --- | --- | -------- | --- | -------------- | ----- |
|     |     | each     |     |                | Root  |
|     |     | service  |     |                | - CO  |
Password: E
| Perform  | Software  | Global  | Control  | N/A  KAS1  | Super-user  |
| -------- | --------- | ------- | -------- | ---------- | ----------- |
self-tests  initiated  Approve input/reset  KAS2  - SSH ECDH
| (remote  | reset,      | d Mode     | signal    | KTS1           | Private Key:  |
| -------- | ----------- | ---------- | --------- | -------------- | ------------- |
| reset)   | performs    | indicator  | (request  | DRBG           | Z             |
|          | self-tests  | “fips” at  | vmhost    | DRBG2          | - SSH DH      |
|          | on          | the CLI    | reboot)   | Entropy Souce  | Private Key:  |
|          | demand      | combine    |           | ECDSA KeyGen   | Z             |
|          | via SSH     | d with     |           | ECDSA          | - SSH         |
|          |             | success    |           | KeyGen2        | Session       |
|          |             | ful        |           | ECDSA KeyVer   | Key: Z        |
|          |             | completi   |           | ECDSA SigGen   | -             |
|          |             | on of      |           | RSA KeyGen     | HMAC_DRB      |
|          |             | each       |           | RSA SigGen     | G Key value:  |
|          |             | service    |           | Password Hash  | G,Z           |
CKG  -
CASTs on boot  HMAC_DRB
G V value:
G,Z
-
HMAC_DRB
G entropy
input: G,Z
-
HMAC_DRB
G seed: G,Z
- ECDH
Shared
Secret: Z
- DH Shared
Secret: Z
- HMAC
Key: G,E,Z
- SSH ECDH
Public Key:
G,E
- SSH DH
Public Key:
G,E
- CO
Password: E
- Firmware
Integrity
Key: E
- SSH
Private Host
Key: E
Copyright Juniper Networks, Inc. 2024  Page 38 of 67  Document Version 1.0

Name Descriptio Indicato Inputs Outpu Security SSP Access
n r ts Functions
- SSH Public
Host Key: E
- User
Authenticatio
n Public
Keys: E
- CO
Authenticatio
n Public
Keys: E
Root
- SSH ECDH
Private Key:
Z
- SSH DH
Private Key:
Z
- SSH
Session
Key: Z
-
HMAC_DRB
G Key value:
G,Z
-
HMAC_DRB
G V value:
G,Z
-
HMAC_DRB
G entropy
input: G,Z
-
HMAC_DRB
G seed: G,Z
- ECDH
Shared
Secret: Z
- DH Shared
Secret: Z
- HMAC
Key: G,E,Z
- SSH ECDH
Public Key:
G,E
- SSH DH
Public Key:
G,E
- CO
Copyright Juniper Networks, Inc. 2024 Page 39 of 67 Document Version 1.0

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|     | n   | r   |     | ts  Functions  |     |
| --- | --- | --- | --- | -------------- | --- |
Password: E
- Firmware
Integrity
Key: E
- SSH
Private Host
Key: E
- SSH Public
Host Key: E
- User
Authenticatio
n Public
Keys: E
- CO
Authenticatio
n Public
Keys: E
Perform  Hardware  Global  Control  N/A  CASTs on boot  Super-user
| self-tests  | reset or  | Approve    | input/reset  |     | - Firmware  |
| ----------- | --------- | ---------- | ------------ | --- | ----------- |
| (local      | power     | d Mode     | signal       |     | Integrity   |
| reset)      | cycle     | indicator  |              |     | Key: E      |
|             |           | “fips” at  |              |     | Root        |
|             |           | the CLI    |              |     | - Firmware  |
|             |           | combine    |              |     | Integrity   |
|             |           | d with     |              |     | Key: E      |
|             |           | success    |              |     | Operator    |
|             |           | ful        |              |     | - Firmware  |
|             |           | completi   |              |     | Integrity   |
|             |           | on of      |              |     | Key: E      |
|             |           | each       |              |     | Read-only   |
|             |           | service    |              |     | - Firmware  |
Integrity
Key: E
Unauthorise
d
- Firmware
Integrity
Key: E
Unauthentic
ated
- Firmware
Integrity
Key: E
Load  Verification  Global  Image,  N/A  ECDSA SigVer  Super-user
| Image  | and          | Approve    | commands  | Password Hash  | - CO         |
| ------ | ------------ | ---------- | --------- | -------------- | ------------ |
|        | loading of   | d Mode     |           |                | Password: E  |
|        | a validated  | indicator  |           |                | - Firmware   |
|        | firmware     | “fips” at  |           |                | Integrity    |
|        | image into   | the CLI    |           |                | Key: E       |
Copyright Juniper Networks, Inc. 2024  Page 40 of 67  Document Version 1.0

Name  Descriptio Indicato Inputs  Outpu Security  SSP Access
|     | n           | r        |     | ts  | Functions  |             |
| --- | ----------- | -------- | --- | --- | ---------- | ----------- |
|     | the         | combine  |     |     |            | -           |
|     | router/swit | d with   |     |     |            | JuniperRoot |
|     | ch          | success  |     |     |            | CA: E       |
|     |             | ful      |     |     |            | -           |
|     |             | completi |     |     |            | PackageCA:  |
|     |             | on of    |     |     |            | E           |
|     |             | each     |     |     |            | Root        |
|     |             | service  |     |     |            | - CO        |
Password: E
- Firmware
Integrity
Key: E
-
JuniperRoot
CA: E
-
PackageCA:
E
| Perform  | Initiate  | Global  | Commands       | MACs | CKG     | Root      |
| -------- | --------- | ------- | -------------- | ---- | ------- | --------- |
| approve  | MACsec    | Approve | (set security  | ec   | MACsec  | - MACsec  |
d  connection  d Mode  macsec  sessio Encryption/Decry PSK: W,E
| security   |     | indicator  | connectivity- | n   | ption       | - MACsec    |
| ---------- | --- | ---------- | ------------- | --- | ----------- | ----------- |
| functions  |     | “fips” at  | association   |     | KTS2        | SAK: G,R,E  |
| (MACsec    |     | the CLI    | connectivity- |     | MACsec Key  | - MACsec    |
| connecti   |     | combine    | association-  |     | Derivation  | KEK: G,E    |
| on)        |     | d with     | name; set     |     |             | - MACsec    |
|            |     | success    | security      |     |             | ICK: G,E    |
|            |     | ful        | macsec        |     |             | Super-user  |
|            |     | completi   | connectivity- |     |             | - MACsec    |
|            |     | on of      | association   |     |             | PSK: W,E    |
|            |     | each       | connectivity- |     |             | - MACsec    |
|            |     | service    | association-  |     |             | SAK: G,R,E  |
|            |     |            | name pre-     |     |             | - MACsec    |
|            |     |            | shared key)   |     |             | KEK: G,E    |
- MACsec
ICK: G,E
Table 15: Approved Services

4.4 Non-Approved Services

| Name  |     | Description  |     | Algorithms  | Role  |     |
| ----- | --- | ------------ | --- | ----------- | ----- | --- |
Configure security  Security relevant  RSA with key  Root, Super-user
| (security relevant)  |     | configuration  |     | size less than  |     |     |
| -------------------- | --- | -------------- | --- | --------------- | --- | --- |
2048
ECDSA with
ed25519 curve
Copyright Juniper Networks, Inc. 2024  Page 41 of 67  Document Version 1.0

| Name  | Description  | Algorithms  | Role  |
| ----- | ------------ | ----------- | ----- |
EC Diffie-
Hellman with
ed25519 curve
ARCFOUR
Blowfish
CAST
DSA (SignGen,
SigVer, non-
compliant)
HMAC-MD5
HMAC-
RIPEMD160
UMAC
Configure (non- Non-security relevant  None  Root, Super-user
| security relevant)  | configuration     |       |                       |
| ------------------- | ----------------- | ----- | --------------------- |
| Show status         | Query the module  | None  | Root, Super-user,     |
|                     | status            |       | Operator, Read-Only,  |
Unauthorized
Show status (LED)  LEDs on the module  None  Root, Super-user,
|     | provide physical status  |     | Operator, Read-Only,  |
| --- | ------------------------ | --- | --------------------- |
|     | output                   |     | Unauthorized,         |
Unauthenticated
| Show module’s     | Query the module’s      | None  | Root, Super-user,     |
| ----------------- | ----------------------- | ----- | --------------------- |
| versioning        | versioning information  |       | Operator, Read-Only,  |
| information       |                         |       | Unauthorized          |
| Zeroise (Perform  | Destroy all SSPs        | None  | Root, Super-user      |
zeroisation)
Perform approved  Initiate SSH connection  RSA with key  Root, Super-user,
security functions  for SSH monitoring and  size less than  Operator, Read-Only,
| (SSH connection)  | control (CLI)  | 2048  | Unauthorized  |
| ----------------- | -------------- | ----- | ------------- |
ECDSA with
ed25519 curve
EC Diffie-
Hellman with
ed25519 curve
ARCFOUR
Blowfish
CAST
DSA (SignGen,
SigVer, non-
compliant)
HMAC-MD5
HMAC-
RIPEMD160
UMAC
| Console Access  | Console monitoring  | None  | Root, Super-user,     |
| --------------- | ------------------- | ----- | --------------------- |
|                 | and control (CLI)   |       | Operator, Read-Only,  |
Unauthorized
Copyright Juniper Networks, Inc. 2024  Page 42 of 67  Document Version 1.0

Name Description Algorithms Role
Perform self-tests Software initiated reset, None Root, Super-user,
(remote reset) performs self-tests on Operator, Read-Only,
demand Unauthorized
Perform self-tests Hardware reset or None Root, Super-user,
(local reset) power cycle Operator, Read-Only,
Unauthorized,
Unauthenticated
Load Image Verification and loading None Root, Super-user
of a validated firmware
image into the
router/switch
Perform approved Initiate MACsec None Root, Super-user
security functions connection
(MACsec
connection)
Table 16: Non-Approved Services
4.5 External Software/Firmware Loaded
The module supports loading of firmware from an external source (a complete image
replacement) and a firmware load test using ECDSA P-256 with SHA2-256 (CAVP Cert.
#A4301) is performed in support of the load.
4.6 Cryptographic Output Actions and Status
The module supports self-initiated cryptographic output in the context of the MACsec protocol
and three independent configurations are required serving as three independent internal actions
(two actions required at minimum):
• set security macsec connectivity-association <name> cipher-suite
• set interfaces <name> connectivity-association <name>
• set interfaces <name> unit 0 family inet address <ip address>
The following “show” commands indicate the status of the MACsec service:
• show security macsec connections
• show security mka sessions
• show security mka statistics
5 Software/Firmware Security
5.1 Integrity Techniques
The module performs the firmware integrity check using ECDSA P-256 with SHA2-256 (CAVP
Cert. #A4301). The ECDSA P-256 public key used for signature verification is a non-SSP and
stored persistently across reboots in the module’s Non-Volatile RAM (NVRAM) and is exempt
from zeroisation.
Copyright Juniper Networks, Inc. 2024 Page 43 of 67 Document Version 1.0

5.2 Initiate on Demand
The operator can initiate the integrity test on demand by rebooting the module.
5.3 Additional Information
The module firmware image is delivered in the form of a pre-compiled tarball (.tgz).
6 Operational Environment
6.1 Operational Environment Type and Requirements
Type of Operational Environment: Limited
How Requirements are Satisfied:
The module contains a limited operational environment since it supports loading of firmware
from an external source. The Junos OS 22.4R2.8 operating system is contained within the
module, i.e., the tested configurations listed in the Tested Module Identification – Hardware in
this document.
6.2 Configuration Settings and Restrictions
Security rules and restrictions for configuration of the operational environment have been
specified in Sections 2.12 and 11.1 of this document.
7 Physical Security
7.1 Mechanisms and Actions Required
Mechanism Inspection Inspection
Frequency Guidance
N/A N/A N/A
Table 17: Mechanisms and Actions Required
The module’s physical embodiment is that of a multi-chip standalone meeting Level 1 Physical
Security requirements. The module is completely enclosed in a rectangular nickel or clear zinc
coated, cold rolled steel, plated steel and brushed aluminum enclosure. The module enclosure
is made of production grade materials. There are no ventilation holes, gaps, slits, cracks, slots,
or crevices that would allow for any sort of observation of any component contained within the
cryptographic boundary. No actions are required by the operator to ensure that physical security
is maintained.
Copyright Juniper Networks, Inc. 2024 Page 44 of 67 Document Version 1.0

8 Non-Invasive Security
8.1 Mitigation Techniques

The module does not implement any non-invasive security mitigations and thus the
requirements per this section do not apply to the module.

9 Sensitive Security Parameters Management
9.1 Storage Areas

| Storage  | Description  |     | Persistence  |     |     |     |
| -------- | ------------ | --- | ------------ | --- | --- | --- |
| Area     |              |     | Type         |     |     |     |
Name
| NVRAM  | Non-Volatile Random Access Memory  |     | Static   |     |     |     |
| ------ | ---------------------------------- | --- | -------- | --- | --- | --- |
| RAM    | Random Access Memory               |     | Dynamic  |     |     |     |
Table 18: Storage Areas

9.2 SSP Input-Output Methods

| Name  | From  | To  | Format  | Distribution  | Entry  | SFI or     |
| ----- | ----- | --- | ------- | ------------- | ------ | ---------- |
|       |       |     | Type    | Type          | Type   | Algorithm  |
Entered over  External  NVRAM  Encrypted  Automated  Electronic  KTS1
| SSH - NVRAM  | endpoint  |        |            |      |      |     |
| ------------ | --------- | ------ | ---------- | ---- | ---- | --- |
| Loaded at    | External  | NVRAM  | Plaintext  | N/A  | N/A  |     |
| manufacture  | endpoint  |        |            |      |      |     |
Entered through  External  NVRAM  Plaintext  Manual  Direct
| the CLI via  | endpoint  |     |     |     |     |     |
| ------------ | --------- | --- | --- | --- | --- | --- |
console
connection -
NVRAM
Output  RAM  External  Encrypted  Automated  Electronic  KTS2
| encrypted with  |     | endpoint  |     |     |     |     |
| --------------- | --- | --------- | --- | --- | --- | --- |
| MAcsec KEK      |     | (MACsec   |     |     |     |     |
peer)
Input during  External  RAM  Plaintext  Automated  Electronic
| SSH negotiation  | endpoint  |     |     |     |     |     |
| ---------------- | --------- | --- | --- | --- | --- | --- |
Output during  NVRAM  External  Plaintext  Automated  Electronic
| SSH negotiation  |     | endpoint  |     |     |     |     |
| ---------------- | --- | --------- | --- | --- | --- | --- |
(host key)
Output during  RAM  External  Plaintext  Automated  Electronic
| SSH negotiation  |     | endpoint  |     |     |     |     |
| ---------------- | --- | --------- | --- | --- | --- | --- |
(Key Agreement
public key)
Table 19: SSP Input-Output Methods

Copyright Juniper Networks, Inc. 2024  Page 45 of 67  Document Version 1.0

The module is complaint with FIPS 140-3 IG 9.5.A MD/DE and AD/EE for SSPs entered via the
module’s CLI via a direct connection to its serial/console port and for SSPs
entered/output/established via SSH/MACsec respectively.

9.3 SSP Zeroization Methods

| Zeroization  | Description  |     | Rationale  |     | Operator    |     |
| ------------ | ------------ | --- | ---------- | --- | ----------- | --- |
| Method       |              |     |            |     | Initiation  |     |
Zeroisation  Command used to zeroise the  Used to provide zeroisation as  Operator
| command  | module: request vmhost  |     | a service  |     | initiated  |     |
| -------- | ----------------------- | --- | ---------- | --- | ---------- | --- |
zeroize no-forwarding
Power-cycle  Power cycling the module to  Power cycling the module to  Operator
|     | zeroise temporary SSPs  |     | zeroise temporary SSPs  |     | initiated  |     |
| --- | ----------------------- | --- | ----------------------- | --- | ---------- | --- |
Session  Termination of SSH sessions  Termination of SSH sessions  Module
termination  automatically zeroises  automatically zeroises  initiated
|     | temporary SSPs used as part  |     | temporary SSPs used as part  |     |     |     |
| --- | ---------------------------- | --- | ---------------------------- | --- | --- | --- |
|     | of the session               |     | of the session               |     |     |     |
Not zeroised  PSP not zeroised since it  PSP not zeroised since it  N/A
|     | cannot be modified due to  |     | cannot be modified due to  |     |     |     |
| --- | -------------------------- | --- | -------------------------- | --- | --- | --- |
|     | being inaccessible in the  |     | being inaccessible in the  |     |     |     |
|     | filesystem                 |     | filesystem                 |     |     |     |
Derivation of  EC Diffie-Hellman/Diffie- EC Diffie-Hellman/Diffie- Module
SSH session  Hellman shared secrets are  Hellman shared secrets are  initiated
| key  | zeroised after use in          |     | zeroised after use in          |     |     |     |
| ---- | ------------------------------ | --- | ------------------------------ | --- | --- | --- |
|      | derivation of SSH session key  |     | derivation of SSH session key  |     |     |     |
Table 20: SSP Zeroization Methods

9.4 SSPs

| Name  | Description  | Size -  | Type -    | Generat | Establish | Used  |
| ----- | ------------ | ------- | --------- | ------- | --------- | ----- |
|       |              | Strengt | Category  | ed By   | ed By     | By    |
h
| SSH Private  | Host key            | P-256     | Private Host  | DRBG2   |     | KAS1  |
| ------------ | ------------------- | --------- | ------------- | ------- | --- | ----- |
| Host Key     | generated, used     | for       | Key - CSP     | ECDSA   |     | KAS2  |
|              | for authentication  | ECDSA,    |               | KeyGen  |     |       |
|              | and encryption in   | 2048      |               | RSA     |     |       |
|              | the context of      | bits for  |               | KeyGen  |     |       |
|              | SSH                 | RSA -     |               |         |     |       |
128 bits
for
ECDSA,
112 bits
for RSA
| SSH ECDH     | Ephemeral EC      | KAS-    | ECDH         | DRBG2    |     | KAS1  |
| ------------ | ----------------- | ------- | ------------ | -------- | --- | ----- |
| Private Key  | Diffie-Hellman    | ECC-    | Private Key  | ECDSA    |     |       |
|              | private key used  | SSC P-  | - CSP        | KeyGen2  |     |       |
|              | in SSH            | 256, P- |              |          |     |       |
Copyright Juniper Networks, Inc. 2024  Page 46 of 67  Document Version 1.0

| Name  | Description  | Size -  | Type -    | Generat | Establish | Used  |
| ----- | ------------ | ------- | --------- | ------- | --------- | ----- |
|       |              | Strengt | Category  | ed By   | ed By     | By    |
h
384, P-
512 -
128 bits,
192 bits,
256 bits
| SSH DH       | Ephemeral Diffie- | 2048      | DH Private  | DRBG2  |     | KAS2  |
| ------------ | ----------------- | --------- | ----------- | ------ | --- | ----- |
| Private Key  | Hellman private   | bits for  | Key - CSP   |        |     |       |
|              | key used in SSH   | KAS-      |             |        |     |       |
FFC-
SSC -
112 bits
for KAS-
FFC-
SSC
| SSH          | SSH Session Key  | 128 bits,  | Session    | CKG  | KAS1  |     |
| ------------ | ---------------- | ---------- | ---------- | ---- | ----- | --- |
| Session Key  |                  | 192 bits,  | Key - CSP  |      | KAS2  |     |
256 bits
- 128
bits, 192
bits, 256
bits
| User      | Passwords used   | 10-20    | User        |     |     |     |
| --------- | ---------------- | -------- | ----------- | --- | --- | --- |
| Password  | to authenticate  | characte | Password -  |     |     |     |
|           | users to the     | rs -     | CSP         |     |     |     |
|           | module           | 1/(96^10 |             |     |     |     |
) per
attempt,
9/(96^10
) per
minute
| CO        | Passwords used   | 10-20    | CO          |     |     |     |
| --------- | ---------------- | -------- | ----------- | --- | --- | --- |
| Password  | to authenticate  | characte | Password -  |     |     |     |
|           | COs to the       | rs -     | CSP         |     |     |     |
|           | module           | 1/(96^10 |             |     |     |     |
) per
attempt,
9/(96^10
) per
minute
HMAC_DRB A critical value of  256 bits  Internal  DRBG    DRBG
G V value  the internal state  - 256  state of the  DRBG2  DRBG
|     | of DRBG  | bits  | DRBG -  |     |     | 2   |
| --- | -------- | ----- | ------- | --- | --- | --- |
CSP
HMAC_DRB A critical value of  440 bits  Internal  DRBG    DRBG
G Key value  the internal state  - 440  state of the  DRBG2  DRBG
|     | of DRBG  | bits  | DRBG -  |     |     | 2   |
| --- | -------- | ----- | ------- | --- | --- | --- |
CSP
Copyright Juniper Networks, Inc. 2024  Page 47 of 67  Document Version 1.0

| Name  | Description  | Size -  | Type -    | Generat | Establish | Used  |
| ----- | ------------ | ------- | --------- | ------- | --------- | ----- |
|       |              | Strengt | Category  | ed By   | ed By     | By    |
h
| HMAC_DRB   | Entropy input to  | 512 bits   | Entropy       | Entropy  |     |     |
| ---------- | ----------------- | ---------- | ------------- | -------- | --- | --- |
| G entropy  | the HMAC_DRBG     | - 448      | input to the  | Souce    |     |     |
| input      |                   | bits       | HMAC_DR       |          |     |     |
BG - CSP
| HMAC_DRB | Seed provided to  | 512 bits  | Seed         | DRBG   |     | DRBG  |
| -------- | ----------------- | --------- | ------------ | ------ | --- | ----- |
| G seed   | the HMAC_DRBG     | - 440     | provided to  | DRBG2  |     | DRBG  |
|          |                   | bits      | the          |        |     | 2     |
HMAC_DR
BG - CSP
| ECDH    | Used in EC Diffie- | P-256,   | Shared    |     | KAS1  |     |
| ------- | ------------------ | -------- | --------- | --- | ----- | --- |
| Shared  | Hellman (ECDH)     | P-384,   | secret -  |     |       |     |
| Secret  | exchange           | P-521 -  | CSP       |     |       |     |
128 bits,
192 bits,
256 bits
| DH Shared  | Used in Diffie- | 2048      | Shared     |     | KAS2  |     |
| ---------- | --------------- | --------- | ---------- | --- | ----- | --- |
| Secret     | Hellman (DH)    | bits -    | secret -   |     |       |     |
|            | exchange        | 112 bits  | CSP        |     |       |     |
| HMAC Key   | MAC key         | 128 bits  | MAC key -  |     | KAS1  |     |
|            |                 | and 256   | CSP        |     | KAS2  |     |
bits -
128 bits
and 256
bits
| SSH Public  | Host key            | P-256     | Public key -  | DRBG2   |     |     |
| ----------- | ------------------- | --------- | ------------- | ------- | --- | --- |
| Host Key    | generated, used     | for       | PSP           | ECDSA   |     |     |
|             | to identify the     | ECDSA     |               | KeyGen  |     |     |
|             | host. Also paired   | and       |               | RSA     |     |     |
|             | with the private    | 2048      |               | KeyGen  |     |     |
|             | key for             | bits for  |               |         |     |     |
|             | authentication and  | RSA -     |               |         |     |     |
|             | encryption in the   | 128 bits  |               |         |     |     |
|             | context of SSH      | for       |               |         |     |     |
ECDSA,
112 bits
for RSA
| User          | Used to             | P-256,  | Public key -  |     |     |     |
| ------------- | ------------------- | ------- | ------------- | --- | --- | --- |
| Authenticatio | authenticate users  | P-384,  | PSP           |     |     |     |
| n Public      | to the module       | P-521   |               |     |     |     |
| Keys          |                     | for     |               |     |     |     |
ECDSA
and
2048,
3072
and
4096
bits for
Copyright Juniper Networks, Inc. 2024  Page 48 of 67  Document Version 1.0

| Name  | Description  | Size -  | Type -    | Generat | Establish | Used  |
| ----- | ------------ | ------- | --------- | ------- | --------- | ----- |
|       |              | Strengt | Category  | ed By   | ed By     | By    |
h
RSA -
128,
192, 256
bits for
ECDSA,
112, 192
and 256
bits for
RSA
| CO            | Used to           | P-256,  | Public key -  |     |     |     |
| ------------- | ----------------- | ------- | ------------- | --- | --- | --- |
| Authenticatio | authenticate the  | P-384,  | PSP           |     |     |     |
| n Public      | CO to the module  | P-521   |               |     |     |     |
| Keys          |                   | for     |               |     |     |     |
ECDSA
and
2048,
3072
and
4096
bits for
RSA -
128,
192, 256
bits for
ECDSA,
112, 192
and 256
bits for
RSA
| JuniperRoot | ECDSA             | ECDSA     | Public key     |     |     |     |
| ----------- | ----------------- | --------- | -------------- | --- | --- | --- |
| CA          | prime256v1 X.509  | P-256 -   | certificate -  |     |     |     |
|             | V3 Certificate    | 128 bits  | Neither        |     |     |     |
Used to verify the
validity of the
PackagCA
| PackageCA  | ECDSA             | ECDSA     | Public key     |     |     |     |
| ---------- | ----------------- | --------- | -------------- | --- | --- | --- |
|            | prime256v1 X.509  | P-256 -   | certificate -  |     |     |     |
|            | V3 Certificate    | 128 bits  | Neither        |     |     |     |
Certificate that
holds the public
key for the signing
key used to
generate all the
signatures used
on the packages
and signature lists
Copyright Juniper Networks, Inc. 2024  Page 49 of 67  Document Version 1.0

| Name  | Description  | Size -  | Type -    | Generat | Establish | Used  |
| ----- | ------------ | ------- | --------- | ------- | --------- | ----- |
|       |              | Strengt | Category  | ed By   | ed By     | By    |
h
| SSH ECDH    | Ephemeral EC        | KAS-    | Public key -  | DRBG2    |     |     |
| ----------- | ------------------- | ------- | ------------- | -------- | --- | --- |
| Public Key  | Diffie-Hellman      | ECC-    | PSP           | ECDSA    |     |     |
|             | public key used in  | SSC P-  |               | KeyGen2  |     |     |
|             | SSH                 | 256, P- |               |          |     |     |
384, P-
512 -
128 bits,
192 bits,
256 bits
for KAS-
ECC-
SSC
| SSH DH      | Ephemeral Diffie- | 2048      | Public key -  | DRBG2  |     |     |
| ----------- | ----------------- | --------- | ------------- | ------ | --- | --- |
| Public Key  | Hellman public    | bits for  | PSP           |        |     |     |
|             | key used in SSH   | KAS-      |               |        |     |     |
FFC-
SSC  -
112 bits
for KAS-
FFC-
SSC
| Firmware       | Public key used to  | ECDSA     | Public key -  |     |     |     |
| -------------- | ------------------- | --------- | ------------- | --- | --- | --- |
| Integrity Key  | perform the         | P-256 -   | Neither       |     |     |     |
|                | firmware integrity  | 128 bits  |               |     |     |     |
test on each boot
and authenticate
firmware loaded
from an external
source
| MACsec  | Credential used  | 128, 256  | Symmetric  |     |     |     |
| ------- | ---------------- | --------- | ---------- | --- | --- | --- |
| PSK     | for device-to-   | bits -    | key - CSP  |     |     |     |
|         | device           | 128, 256  |            |     |     |     |
|         | authentication,  | bits      |            |     |     |     |
consists of the
CAK (pre-shared
key) and CKN
(identifier for the
pre-shared key)
| MACsec  | Security           | 128, 256  | Symmetric  | MACsec    |     |     |
| ------- | ------------------ | --------- | ---------- | --------- | --- | --- |
| SAK     | Association Key    | bits -    | key - CSP  | Key       |     |     |
|         | used for creating  | 128, 256  |            | Derivatio |     |     |
|         | Security           | bits      |            | n         |     |     |
Associations for
encryption/decrypt
ion of MACsec
traffic
Copyright Juniper Networks, Inc. 2024  Page 50 of 67  Document Version 1.0

| Name  | Description  | Size -  | Type -    | Generat | Establish | Used  |
| ----- | ------------ | ------- | --------- | ------- | --------- | ----- |
|       |              | Strengt | Category  | ed By   | ed By     | By    |
h
| MACsec  | Used to transmit  | 128, 256  | Symmetric  | MACsec    |     |     |
| ------- | ----------------- | --------- | ---------- | --------- | --- | --- |
| KEK     | SAKs to other     | bits -    | key - CSP  | Key       |     |     |
|         | members of a      | 128, 256  |            | Derivatio |     |     |
|         | MACsec            | bits      |            | n         |     |     |
connectivity
association
MACsec ICK  Used to verify the  128, 256  Symmetric  MACsec
|     | integrity and    | bits -    | key - CSP  | Key       |     |     |
| --- | ---------------- | --------- | ---------- | --------- | --- | --- |
|     | authenticity of  | 128, 256  |            | Derivatio |     |     |
|     | MACsec protocol  | bits      |            | n         |     |     |
data units
| SSH ECDH       | Ephemeral EC        | KAS-       | Public key -  |     |     |     |
| -------------- | ------------------- | ---------- | ------------- | --- | --- | --- |
| Client Public  | Diffie-Hellman      | ECC-       | PSP           |     |     |     |
| Key            | public key used in  | SSC P-     |               |     |     |     |
|                | SSH (sent by the    | 256, P-    |               |     |     |     |
|                | client to the       | 384, P-    |               |     |     |     |
|                | module acting as    | 512 -      |               |     |     |     |
|                | the server)         | 128 bits,  |               |     |     |     |
192 bits,
256 bits
for KAS-
ECC-
SSC
| SSH DH         | Ephemeral Diffie-    | 2048      | Public key -  |     |     |     |
| -------------- | -------------------- | --------- | ------------- | --- | --- | --- |
| Client Public  | Hellman public       | bits for  | PSP           |     |     |     |
| Key            | key used in SSH      | KAS-      |               |     |     |     |
|                | (sent by the client  | FFC-      |               |     |     |     |
|                | to the module        | SSC -     |               |     |     |     |
|                | acting as the        | 112 bits  |               |     |     |     |
|                | server)              | for KAS-  |               |     |     |     |
FFC-
SSC
Table 21: SSP Table 1

| Name         | Input -  | Storage          | Storage      |     | Zeroization  | Related  |
| ------------ | -------- | ---------------- | ------------ | --- | ------------ | -------- |
|              | Output   |                  | Duration     |     |              | SSPs     |
| SSH Private  |          | NVRAM:Plaintext  |              |     | Zeroisation  |          |
| Host Key     |          |                  |              |     | command      |          |
| SSH ECDH     |          | RAM:Plaintext    | Until        |     | Zeroisation  |          |
| Private Key  |          |                  | session      |     | command      |          |
|              |          |                  | termination  |     | Power-cycle  |          |
Session
termination
| SSH DH       |     | RAM:Plaintext  | Until        |     | Zeroisation  |     |
| ------------ | --- | -------------- | ------------ | --- | ------------ | --- |
| Private Key  |     |                | session      |     | command      |     |
|              |     |                | termination  |     | Power-cycle  |     |
Copyright Juniper Networks, Inc. 2024  Page 51 of 67  Document Version 1.0

| Name  | Input -  | Storage  | Storage   | Zeroization  | Related  |
| ----- | -------- | -------- | --------- | ------------ | -------- |
|       | Output   |          | Duration  |              | SSPs     |
Session
termination
| SSH Session  |     | RAM:Plaintext  | Until        | Zeroisation  |     |
| ------------ | --- | -------------- | ------------ | ------------ | --- |
| Key          |     |                | session      | command      |     |
|              |     |                | termination  | Power-cycle  |     |
Session
termination
User Password  Entered over  NVRAM:Obfuscated    Zeroisation
|     | SSH -  | NVRAM:Obfuscated  |     | command  |     |
| --- | ------ | ----------------- | --- | -------- | --- |
NVRAM
Entered
through the
CLI via
console
connection -
NVRAM
CO Password  Entered over  NVRAM:Obfuscated    Zeroisation
|     | SSH -  | NVRAM:Obfuscated  |     | command  |     |
| --- | ------ | ----------------- | --- | -------- | --- |
NVRAM
Entered
through the
CLI via
console
connection -
NVRAM
| HMAC_DRBG  |     | RAM:Plaintext  | Until  | Power-cycle  |     |
| ---------- | --- | -------------- | ------ | ------------ | --- |
| V value    |     |                | power- |              |     |
cycle
| HMAC_DRBG  |     | RAM:Plaintext  | Until  | Power-cycle  |     |
| ---------- | --- | -------------- | ------ | ------------ | --- |
| Key value  |     |                | power- |              |     |
cycle
| HMAC_DRBG      |     | RAM:Plaintext  | Until  | Power-cycle  |     |
| -------------- | --- | -------------- | ------ | ------------ | --- |
| entropy input  |     |                | power- |              |     |
cycle
| HMAC_DRBG  |     | RAM:Plaintext  | Until  | Power-cycle  |     |
| ---------- | --- | -------------- | ------ | ------------ | --- |
| seed       |     |                | power- |              |     |
cycle
| ECDH Shared  |     | RAM:Plaintext  | Until SSH    | Zeroisation  |     |
| ------------ | --- | -------------- | ------------ | ------------ | --- |
| Secret       |     |                | session key  | command      |     |
|              |     |                | derivation   | Power-cycle  |     |
Derivation
of SSH
session key
| DH Shared  |     | RAM:Plaintext  | Until SSH    | Zeroisation  |     |
| ---------- | --- | -------------- | ------------ | ------------ | --- |
| Secret     |     |                | session key  | command      |     |
|            |     |                | derivation   | Power-cycle  |     |
Derivation
Copyright Juniper Networks, Inc. 2024  Page 52 of 67  Document Version 1.0

| Name  | Input -  | Storage  | Storage   | Zeroization  | Related  |
| ----- | -------- | -------- | --------- | ------------ | -------- |
|       | Output   |          | Duration  |              | SSPs     |
of SSH
session key
| HMAC Key  |     | RAM:Plaintext  | Until        | Zeroisation  |     |
| --------- | --- | -------------- | ------------ | ------------ | --- |
|           |     |                | session      | command      |     |
|           |     |                | termination  | Power-cycle  |     |
Session
termination
| SSH Public  | Output during  | NVRAM:Plaintext  |     | Zeroisation  |     |
| ----------- | -------------- | ---------------- | --- | ------------ | --- |
| Host Key    | SSH            |                  |     | command      |     |
negotiation
(host key)
| User            | Entered over  | NVRAM:Plaintext  |     | Zeroisation  |     |
| --------------- | ------------- | ---------------- | --- | ------------ | --- |
| Authentication  | SSH -         |                  |     | command      |     |
| Public Keys     | NVRAM         |                  |     |              |     |
Entered
through the
CLI via
console
connection -
NVRAM
| CO              | Entered over  | NVRAM:Plaintext  |     | Zeroisation  |     |
| --------------- | ------------- | ---------------- | --- | ------------ | --- |
| Authentication  | SSH -         |                  |     | command      |     |
| Public Keys     | NVRAM         |                  |     |              |     |
Entered
through the
CLI via
console
connection -
NVRAM
| JuniperRootCA  | Loaded at    | NVRAM:Plaintext  |     | Not       |     |
| -------------- | ------------ | ---------------- | --- | --------- | --- |
|                | manufacture  |                  |     | zeroised  |     |
| PackageCA      | Loaded at    | NVRAM:Plaintext  |     | Not       |     |
|                | manufacture  |                  |     | zeroised  |     |
SSH ECDH  Output during  RAM:Plaintext  Until  Zeroisation
| Public Key  | SSH          |     | session      | command      |     |
| ----------- | ------------ | --- | ------------ | ------------ | --- |
|             | negotiation  |     | termination  | Power-cycle  |     |
|             | (Key         |     |              | Session      |     |
|             | Agreement    |     |              | termination  |     |
public key)
SSH DH Public  Output during  RAM:Plaintext  Until  Zeroisation
| Key  | SSH          |     | session      | command      |     |
| ---- | ------------ | --- | ------------ | ------------ | --- |
|      | negotiation  |     | termination  | Power-cycle  |     |
|      | (Key         |     |              | Session      |     |
|      | Agreement    |     |              | termination  |     |
public key)
| Firmware       | Loaded at    | NVRAM:Plaintext  |     | Not       |     |
| -------------- | ------------ | ---------------- | --- | --------- | --- |
| Integrity Key  | manufacture  |                  |     | zeroised  |     |
Copyright Juniper Networks, Inc. 2024  Page 53 of 67  Document Version 1.0

| Name        | Input -       | Storage          | Storage   | Zeroization  | Related  |
| ----------- | ------------- | ---------------- | --------- | ------------ | -------- |
|             | Output        |                  | Duration  |              | SSPs     |
| MACsec PSK  | Entered over  | NVRAM:Plaintext  |           | Zeroisation  |          |
|             | SSH -         |                  |           | command      |          |
NVRAM
Entered
through the
CLI via
console
connection -
NVRAM
| MACsec SAK  | Output       | RAM:Plaintext  | Until        | Zeroisation  |     |
| ----------- | ------------ | -------------- | ------------ | ------------ | --- |
|             | encrypted    |                | session      | command      |     |
|             | with MAcsec  |                | termination  | Power-cycle  |     |
|             | KEK          |                |              | Session      |     |
termination
| MACsec KEK  |     | RAM:Plaintext  | Until        | Zeroisation  |     |
| ----------- | --- | -------------- | ------------ | ------------ | --- |
|             |     |                | session      | command      |     |
|             |     |                | termination  | Power-cycle  |     |
Session
termination
| MACsec ICK  |     | RAM:Plaintext  | Until        | Zeroisation  |     |
| ----------- | --- | -------------- | ------------ | ------------ | --- |
|             |     |                | session      | command      |     |
|             |     |                | termination  | Power-cycle  |     |
Session
termination
| SSH ECDH       | Input during  | RAM:Plaintext  | Until        | Zeroisation  |     |
| -------------- | ------------- | -------------- | ------------ | ------------ | --- |
| Client Public  | SSH           |                | session      | command      |     |
| Key            | negotiation   |                | termination  | Power-cycle  |     |
Session
termination
SSH DH Client  Input during  RAM:Plaintext  Until  Zeroisation
| Public Key  | SSH          |     | session      | command      |     |
| ----------- | ------------ | --- | ------------ | ------------ | --- |
|             | negotiation  |     | termination  | Power-cycle  |     |
Session
termination
Table 22: SSP Table 2

10 Self-Tests
10.1 Pre-Operational Self-Tests

Algorithm or  Test Properties  Test  Test Type  Indicator  Details
Test  Method
Firmware  Using ECDSA P-256  KAT  SW/FW  FIPS Self-tests  Verify
| Integrity Test  | with SHA2-256  |     | Integrity  | Passed  |     |
| --------------- | -------------- | --- | ---------- | ------- | --- |
Table 23: Pre-Operational Self-Tests
Copyright Juniper Networks, Inc. 2024  Page 54 of 67  Document Version 1.0

The module is complaint with FIPS 140-3 IG 10.2.A in that it performs a self-test, a Known
Answer Test (KAT) for the ECDSA P-256 (with SHA2-256) algorithm used in the firmware
integrity test on each boot prior to executing the firmware integrity test.

10.2 Conditional Self-Tests

| Algorith | Test        | Test    | Test  Indicator  | Details  | Condition |
| -------- | ----------- | ------- | ---------------- | -------- | --------- |
| m or     | Properties  | Method  | Type             |          | s         |
Test
| HMAC     | Prediction   | KAT  | CAST  NIST 800- | N/A  | During  |
| -------- | ------------ | ---- | --------------- | ---- | ------- |
| DRBG     | Resistance:  |      | 90 HMAC         |      | boot    |
| (A4303)  | Yes          |      | DRBG            |      |         |
Supports  Known
Reseed  Answer
Capabilities:  Test :
Mode:  Passed
SHA2-256
Entropy
Input: 256
Nonce: 128
Personalizati
on String
Length: 0-
256
Increment 8
Additional
Input: 8-256
Increment 8
Returned
Bits: 1024
| HMAC- | Key Length:  | KAT  | CAST  HMAC- | N/A  | During  |
| ----- | ------------ | ---- | ----------- | ---- | ------- |
| SHA2- | 256 bits     |      | SHA2-256    |      | boot    |
256  Known
(A4303)  Answer
Test :
Passed
| AES- | Key Length:  | KAT  | CAST  AES-CBC  | Encrypt  | During  |
| ---- | ------------ | ---- | -------------- | -------- | ------- |
| CBC  | 128 bits     |      | Known          |          | boot    |
(A4301)  Answer
Test :
Passed
| AES- | Key Length:  | KAT  | CAST  AES-CBC  | Encrypt  | During  |
| ---- | ------------ | ---- | -------------- | -------- | ------- |
| CBC  | 192 bits     |      | Known          |          | boot    |
(A4301)  Answer
Test :
Passed
| AES- | Key Length:  | KAT  | CAST  AES-CBC  | Encrypt  | During  |
| ---- | ------------ | ---- | -------------- | -------- | ------- |
| CBC  | 256 bits     |      | Known          |          | boot    |
(A4301)  Answer
Copyright Juniper Networks, Inc. 2024  Page 55 of 67  Document Version 1.0

| Algorith | Test        | Test    | Test  Indicator  | Details  | Condition |
| -------- | ----------- | ------- | ---------------- | -------- | --------- |
| m or     | Properties  | Method  | Type             |          | s         |
Test
Test :
Passed
| AES- | Key Length:  | KAT  | CAST  AES-CBC  | Decrypt  | During  |
| ---- | ------------ | ---- | -------------- | -------- | ------- |
| CBC  | 128 bits     |      | Known          |          | boot    |
(A4301)  Answer
Test :
Passed
| AES- | Key Length:  | KAT  | CAST  AES-CBC  | Decrypt  | During  |
| ---- | ------------ | ---- | -------------- | -------- | ------- |
| CBC  | 192 bits     |      | Known          |          | boot    |
(A4301)  Answer
Test :
Passed
| AES- | Key Length:  | KAT  | CAST  AES-CBC  | Decrypt  | During  |
| ---- | ------------ | ---- | -------------- | -------- | ------- |
| CBC  | 256 bits     |      | Known          |          | boot    |
(A4301)  Answer
Test :
Passed
| HMAC     | Mode:       | KAT  | CAST  NIST 800- | N/A  | During  |
| -------- | ----------- | ---- | --------------- | ---- | ------- |
| DRBG     | SHA2-256,   |      | 90 HMAC         |      | boot    |
| (A4301)  | Entropy     |      | DRBG            |      |         |
Input: 256 ,  Known
Nonce: 128,   Answer
Personalizati Test :
on String  Passed
Length: 0-
256 ,
Increment 8 ,
Additional
Input: 8-256
Increment 8 ,
Returned
Bits: 1024
| HMAC-  | Key Length:  | KAT  | CAST  HMAC- | N/A  | During  |
| ------ | ------------ | ---- | ----------- | ---- | ------- |
| SHA-1  | 160 bits     |      | SHA-1       |      | boot    |
(A4301)  Known
Answer
Test :
Passed
| HMAC- | Key Length:  | KAT  | CAST  HMAC- | N/A  | During  |
| ----- | ------------ | ---- | ----------- | ---- | ------- |
| SHA2- | 256 bits     |      | SHA2-256    |      | boot    |
256  Known
(A4301)  Answer
Test :
Passed
| HMAC- | Key Length:  | KAT  | CAST  HMAC- | N/A  | During  |
| ----- | ------------ | ---- | ----------- | ---- | ------- |
| SHA2- | 512 bits     |      | SHA2-512    |      | boot    |
Known
Copyright Juniper Networks, Inc. 2024  Page 56 of 67  Document Version 1.0

| Algorith | Test        | Test    | Test  Indicator  | Details  | Condition |
| -------- | ----------- | ------- | ---------------- | -------- | --------- |
| m or     | Properties  | Method  | Type             |          | s         |
Test
512  Answer
(A4301)  Test :
Passed
| KAS-   | Domain      | KAT  | CAST  KAS-ECC- | N/A  | During  |
| ------ | ----------- | ---- | -------------- | ---- | ------- |
| ECC-   | Parameter   |      | EPHEM-         |      | boot    |
| SSC    | Generation  |      | UNIFIED-       |      |         |
| Sp800- | Methods: P- |      | NOKC           |      |         |
| 56Ar3  | 256         |      | Known          |      |         |
(A4301)  Answer
Test:
Passed
| KAS-   | Domain      | KAT  | CAST  KAS-ECC- | N/A  | During  |
| ------ | ----------- | ---- | -------------- | ---- | ------- |
| ECC-   | Parameter   |      | EPHEM-         |      | boot    |
| SSC    | Generation  |      | UNIFIED-       |      |         |
| Sp800- | Methods: P- |      | NOKC           |      |         |
| 56Ar3  | 384         |      | Known          |      |         |
(A4301)  Answer
Test:
Passed
| KAS-   | Domain      | KAT  | CAST  KAS-FFC- | N/A  | During  |
| ------ | ----------- | ---- | -------------- | ---- | ------- |
| FFC-   | Parameter   |      | EPHEM-         |      | boot    |
| SSC    | Generation  |      | NOKC           |      |         |
| Sp800- | Methods:    |      | Known          |      |         |
| 56Ar3  | MODP-2048   |      | Answer         |      |         |
(A4301)  Test:
Passed
| KDF      | Cipher: AES- | KAT  | CAST  KDF-SSH- | N/A  | During  |
| -------- | ------------ | ---- | -------------- | ---- | ------- |
| SSH      | 128, AES-    |      | SHA2-256       |      | boot    |
| (A4301)  | 192, AES-    |      | Known          |      |         |
256 ;  Hash  Answer
Algorithm:  Test:
SHA-1,  Passed
SHA2-256,
SHA2-512
| RSA     | Modulus    | KAT  | CAST  RSA-SIGN  | Sign  | During  |
| ------- | ---------- | ---- | --------------- | ----- | ------- |
| SigGen  | 2048 bits  |      | Known           |       | boot    |
| (FIPS18 | SHA2-256   |      | Answer          |       |         |
6-4)  Test:
(A4301)  Passed
| RSA     | Modulus    | KAT  | CAST  RSA- | Verify  | During  |
| ------- | ---------- | ---- | ---------- | ------- | ------- |
| SigVer  | 2048 bits  |      | VERIFY     |         | boot    |
| (FIPS18 | SHA2-256   |      | Known      |         |         |
6-4)  Answer
(A4301)  Test:
Passed
| ECDSA   | Curve: P-256  | KAT  | CAST  ECDSA- | Sign  | During  |
| ------- | ------------- | ---- | ------------ | ----- | ------- |
| SigGen  | Hash          |      | SIGN         |       | boot    |
Copyright Juniper Networks, Inc. 2024  Page 57 of 67  Document Version 1.0

| Algorith | Test        | Test    | Test  Indicator  | Details  | Condition |
| -------- | ----------- | ------- | ---------------- | -------- | --------- |
| m or     | Properties  | Method  | Type             |          | s         |
Test
| (FIPS18 | Algorithm:  |     | Known   |     |     |
| ------- | ----------- | --- | ------- | --- | --- |
| 6-4)    | SHA2-256    |     | Answer  |     |     |
(A4301)  Test:
Passed
| ECDSA   | Curve: P-256  | KAT  | CAST  ECDSA- | Verify  | During  |
| ------- | ------------- | ---- | ------------ | ------- | ------- |
| SigVer  | Hash          |      | VERIFY       |         | boot    |
| (FIPS18 | Algorithm:    |      | Known        |         |         |
| 6-4)    | SHA2-256      |      | Answer       |         |         |
(A4301)  Test:
Passed
| SHA2- | SHA2-512  | KAT  | CAST  SHA-2- | N/A  | During  |
| ----- | --------- | ---- | ------------ | ---- | ------- |
| 512   |           |      | 512          |      | boot    |
(A4306)  Known
Answer
Test:
Passed
| Entropy  | NIST SP     | RCT  | CAST  pass  | Cutoff value C =  | During       |
| -------- | ----------- | ---- | ----------- | ----------------- | ------------ |
| test     | 800-90B     |      |             | 21                | boot and     |
|          | Repetitive  |      |             |                   | continually  |
Count Test
| Entropy  | NIST SP    | APT  | CAST  pass  | W = 512; Cutoff  | During       |
| -------- | ---------- | ---- | ----------- | ---------------- | ------------ |
| test     | 800-90B    |      |             | value C = 311    | boot and     |
|          | Adapative  |      |             |                  | continually  |
Proportion
Test
ECDSA  Curve: P-256  PCT  PCT  0  Key pair generated  On key
| KeyGen   | Hash        |     |     | for signature        | generation  |
| -------- | ----------- | --- | --- | -------------------- | ----------- |
| (FIPS18  | Algorithm:  |     |     | generation/verificat |             |
| 6-4)     | SHA2-256    |     |     | ion in the context   |             |
| (A4301)  |             |     |     | of SSHv2 protocol    |             |
ECDSA  Curve: P-256  PCT  PCT  0  Key pair generated  On key
| KeyGen  | Hash        |     |     | for SSP agreement  | generation  |
| ------- | ----------- | --- | --- | ------------------ | ----------- |
| (FIPS18 | Algorithm:  |     |     | in the context of  |             |
| 6-4)    | SHA2-256    |     |     | SSHv2 protocol     |             |
(A4301)
| KAS-   | Capabilities:  | PCT  | PCT  0  | Key pair generated  | On key      |
| ------ | -------------- | ---- | ------- | ------------------- | ----------- |
| FFC-   | Domain         |      |         | for SSP agreement   | generation  |
| SSC    | Parameter:     |      |         | in the context of   |             |
| Sp800- | MODP2048       |      |         | SSHv2 protocol      |             |
56Ar3
(A4301)
| RSA      | Modulus:   | PCT  | PCT  0  | Key pair generated   | On key      |
| -------- | ---------- | ---- | ------- | -------------------- | ----------- |
| KeyGen   | 2048 Hash  |      |         | for signature        | generation  |
| (FIPS18  | SHA2-256   |      |         | generation/verificat |             |
| 6-4)     |            |      |         | ion in the context   |             |
| (A4301)  |            |      |         | of SSHv2 protocol    |             |
Copyright Juniper Networks, Inc. 2024  Page 58 of 67  Document Version 1.0

| Algorith | Test        | Test    | Test  Indicator  | Details  | Condition |
| -------- | ----------- | ------- | ---------------- | -------- | --------- |
| m or     | Properties  | Method  | Type             |          | s         |
Test
| AES-KW   | Key Length:  | KAT  | CAST  AES- | Encrypt  | During  |
| -------- | ------------ | ---- | ---------- | -------- | ------- |
| (A4304)  | 128 bits     |      | KEYWRA     |          | boot    |
P Known
Answer
Test:
Passed
| AES-KW   | Key Length:  | KAT  | CAST  AES- | Decrypt  | During  |
| -------- | ------------ | ---- | ---------- | -------- | ------- |
| (A4304)  | 128 bits     |      | KEYWRA     |          | boot    |
P Known
Answer
Test:
Passed
| KDF    | Mode:    | KAT  | CAST  KBKDF  | N/A  | During  |
| ------ | -------- | ---- | ------------ | ---- | ------- |
| SP800- | Counter  |      | Known        |      | boot    |
108  Answer
(A4304)  Test:Pass
ed
| AES- | Key Length:  | KAT  | CAST  0  | Encrypt  | During  |
| ---- | ------------ | ---- | -------- | -------- | ------- |
| GCM  | 256 bits     |      |          |          | boot    |
(AES
4369)
| AES- | Key Length:  | KAT  | CAST  0  | Decrypt  | During  |
| ---- | ------------ | ---- | -------- | -------- | ------- |
| GCM  | 256 bits     |      |          |          | boot    |
(AES
4369)
| AES-  | Key Length:  | KAT  | CAST  AES128- | Encrypt  | During  |
| ----- | ------------ | ---- | ------------- | -------- | ------- |
| CMAC  | 128 bits     |      | CMAC          |          | boot    |
(A4304)  Known
Answer
Test:
Passed
| AES-  | Key Length:  | KAT  | CAST  AES128- | Decrypt  | During  |
| ----- | ------------ | ---- | ------------- | -------- | ------- |
| CMAC  | 128 bits     |      | CMAC          |          | boot    |
(A4304)  Known
Answer
Test:
Passed
| AES-  | Key Length:  | KAT  | CAST  AES256- | Encrypt  | During  |
| ----- | ------------ | ---- | ------------- | -------- | ------- |
| CMAC  | 256 bits     |      | CMAC          |          | boot    |
(A4304)  Known
Answer
Test:
Passed
| AES-  | Key Length:  | KAT  | CAST  AES256- | Decrypt  | During  |
| ----- | ------------ | ---- | ------------- | -------- | ------- |
| CMAC  | 256 bits     |      | CMAC          |          | boot    |
(A4304)  Known
Answer
Copyright Juniper Networks, Inc. 2024  Page 59 of 67  Document Version 1.0

| Algorith | Test        | Test    | Test  Indicator  | Details  | Condition |
| -------- | ----------- | ------- | ---------------- | -------- | --------- |
| m or     | Properties  | Method  | Type             |          | s         |
Test
Test:
Passed
| ECDSA    | Curve: P-256  | KAT  | SW/F Host OS   | Verify  | On loading   |
| -------- | ------------- | ---- | -------------- | ------- | ------------ |
| SigVer   | Hash          |      | W  upgrade     |         | of firmware  |
| (FIPS18  | Algorithm:    |      | Load  staged.  |         | from an      |
| 6-4)     | SHA2-256      |      | Reboot         |         | external     |
| (A4301)  |               |      | the system     |         | source       |
to
complete
installation
!
| Manual      | Duplicate      | Duplicate   | Manu Command        | N/A  | On          |
| ----------- | -------------- | ----------- | ------------------- | ---- | ----------- |
| entry test  | entry test     | entry test  | al  prompt          |      | configurati |
| (duplicat   | required for   | required    | Entry  with "fips"  |      | on of       |
| e           | entry of       | for entry   | string              |      | operator    |
| entries)    | operator       | of          | provided            |      | passwords   |
|             | passwords      | operator    | post                |      | and         |
|             | and MACsec     | passwor     | completion          |      | MACsec      |
|             | PSK via        | ds and      | of the test         |      | PSK         |
|             | direct         | MACsec      |                     |      |             |
|             | connection to  | PSK via     |                     |      |             |
|             | the module's   | direct      |                     |      |             |
|             | console        | connecti    |                     |      |             |
|             | (serial)       | on to the   |                     |      |             |
|             | interface      | module's    |                     |      |             |
console
(serial)
interface
Table 24: Conditional Self-Tests

Cryptographic Algorithm Self-tests (CASTs) are performed on each boot of the module. Other
conditional self-tests are performed by the module when the corresponding condition is met.
The pairwise consistency tests are performed on key pair generation for use in signature
generation/verification (ECDSA and/or RSA tests) and/or for use in KAS-ECC-SSC or KAS-
FFC-SSC SSP agreement (ECDSA and FFC tests respectively). The firmware load test is
performed when a firmware image is loaded onto the module from an external source.

10.3 Periodic Self-Test Information

| Algorithm or    | Test Method  |     | Test Type        | Period     | Periodic        |
| --------------- | ------------ | --- | ---------------- | ---------- | --------------- |
| Test            |              |     |                  |            | Method          |
| Firmware        | KAT          |     | SW/FW Integrity  | On Demand  | Manually via a  |
| Integrity Test  |              |     |                  |            | reboot          |
Table 25: Pre-Operational Periodic Information
Copyright Juniper Networks, Inc. 2024  Page 60 of 67  Document Version 1.0

| Algorithm or  | Test Method  | Test Type  | Period     | Periodic        |
| ------------- | ------------ | ---------- | ---------- | --------------- |
| Test          |              |            |            | Method          |
| HMAC DRBG     | KAT          | CAST       | On Demand  | Manually via a  |
| (A4303)       |              |            |            | reboot          |
| HMAC-SHA2-    | KAT          | CAST       | On Demand  | Manually via a  |
| 256 (A4303)   |              |            |            | reboot          |
| AES-CBC       | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| AES-CBC       | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| AES-CBC       | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| AES-CBC       | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| AES-CBC       | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| AES-CBC       | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| HMAC DRBG     | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| HMAC-SHA-1    | KAT          | CAST       | On Demand  | Manually via a  |
| (A4301)       |              |            |            | reboot          |
| HMAC-SHA2-    | KAT          | CAST       | On Demand  | Manually via a  |
| 256 (A4301)   |              |            |            | reboot          |
| HMAC-SHA2-    | KAT          | CAST       | On Demand  | Manually via a  |
| 512 (A4301)   |              |            |            | reboot          |
| KAS-ECC-SSC   | KAT          | CAST       | On Demand  | Manually via a  |
| Sp800-56Ar3   |              |            |            | reboot          |
(A4301)
| KAS-ECC-SSC  | KAT  | CAST  | On Demand  | Manually via a  |
| ------------ | ---- | ----- | ---------- | --------------- |
| Sp800-56Ar3  |      |       |            | reboot          |
(A4301)
| KAS-FFC-SSC  | KAT  | CAST  | On Demand  | Manually via a  |
| ------------ | ---- | ----- | ---------- | --------------- |
| Sp800-56Ar3  |      |       |            | reboot          |
(A4301)
| KDF SSH      | KAT  | CAST  | On Demand  | Manually via a  |
| ------------ | ---- | ----- | ---------- | --------------- |
| (A4301)      |      |       |            | reboot          |
| RSA SigGen   | KAT  | CAST  | On Demand  | Manually via a  |
| (FIPS186-4)  |      |       |            | reboot          |
(A4301)
| RSA SigVer   | KAT  | CAST  | On Demand  | Manually via a  |
| ------------ | ---- | ----- | ---------- | --------------- |
| (FIPS186-4)  |      |       |            | reboot          |
(A4301)
| ECDSA SigGen  | KAT  | CAST  | On Demand  | Manually via a  |
| ------------- | ---- | ----- | ---------- | --------------- |
| (FIPS186-4)   |      |       |            | reboot          |
(A4301)
| ECDSA SigVer  | KAT  | CAST  | On Demand  | Manually via a  |
| ------------- | ---- | ----- | ---------- | --------------- |
| (FIPS186-4)   |      |       |            | reboot          |
(A4301)
Copyright Juniper Networks, Inc. 2024  Page 61 of 67  Document Version 1.0

| Algorithm or  | Test Method  | Test Type  | Period     | Periodic        |
| ------------- | ------------ | ---------- | ---------- | --------------- |
| Test          |              |            |            | Method          |
| SHA2-512      | KAT          | CAST       | On Demand  | Manually via a  |
| (A4306)       |              |            |            | reboot          |
| Entropy test  | RCT          | CAST       | On Demand  | Manually via a  |
reboot
| Entropy test  | APT  | CAST  | On Demand  | Manually via a  |
| ------------- | ---- | ----- | ---------- | --------------- |
reboot
| ECDSA KeyGen  | PCT  | PCT  | On Demand  | Manually via a  |
| ------------- | ---- | ---- | ---------- | --------------- |
| (FIPS186-4)   |      |      |            | reboot          |
(A4301)
| ECDSA KeyGen  | PCT  | PCT  | On Demand  | Manually via a  |
| ------------- | ---- | ---- | ---------- | --------------- |
| (FIPS186-4)   |      |      |            | reboot          |
(A4301)
| KAS-FFC-SSC  | PCT  | PCT  | On Demand  | Manually via a  |
| ------------ | ---- | ---- | ---------- | --------------- |
| Sp800-56Ar3  |      |      |            | reboot          |
(A4301)
| RSA KeyGen   | PCT  | PCT  | On Demand  | Manually via a  |
| ------------ | ---- | ---- | ---------- | --------------- |
| (FIPS186-4)  |      |      |            | reboot          |
(A4301)
| AES-KW         | KAT  | CAST        | On Demand  | Manually via a    |
| -------------- | ---- | ----------- | ---------- | ----------------- |
| (A4304)        |      |             |            | reboot            |
| AES-KW         | KAT  | CAST        | On Demand  | Manually via a    |
| (A4304)        |      |             |            | reboot            |
| KDF SP800-108  | KAT  | CAST        | On Demand  | Manually via a    |
| (A4304)        |      |             |            | reboot            |
| AES-GCM (AES   | KAT  | CAST        | On Demand  | Manually via a    |
| 4369)          |      |             |            | reboot            |
| AES-GCM (AES   | KAT  | CAST        | On Demand  | Manually via a    |
| 4369)          |      |             |            | reboot            |
| AES-CMAC       | KAT  | CAST        | On Demand  | Manually via a    |
| (A4304)        |      |             |            | reboot            |
| AES-CMAC       | KAT  | CAST        | On Demand  | Manually via a    |
| (A4304)        |      |             |            | reboot            |
| AES-CMAC       | KAT  | CAST        | On Demand  | Manually via a    |
| (A4304)        |      |             |            | reboot            |
| AES-CMAC       | KAT  | CAST        | On Demand  | Manually via a    |
| (A4304)        |      |             |            | reboot            |
| ECDSA SigVer   | KAT  | SW/FW Load  | On Demand  | Manually via      |
| (FIPS186-4)    |      |             |            | loading of        |
| (A4301)        |      |             |            | firmware from an  |
external source
Manual entry  Duplicate entry  Manual Entry  On Demand  Manually via
| test (duplicate  | test required for  |     |     | configuration of  |
| ---------------- | ------------------ | --- | --- | ----------------- |
| entries)         | entry of operator  |     |     | operator          |
|                  | passwords and      |     |     | passwords and     |
|                  | MACsec PSK         |     |     | MACsec PSK        |
via direct
connection to
the module's
Copyright Juniper Networks, Inc. 2024  Page 62 of 67  Document Version 1.0

Algorithm or Test Method Test Type Period Periodic
Test Method
console (serial)
interface
Table 26: Conditional Periodic Information
The pre-operational firmware integrity test as well as all CASTs must be completed successfully
prior to any other use of cryptography by the module in the Approved mode of operation. These
tests can also be performed periodically by rebooting the module.
10.4 Error States
Name Description Conditions Recovery Indicator
Method
Hard If the pre-operation If the pre- N/A "FIPS error: self-
Error firmware integrity test, if operational test failure" for
state any of the CASTs or pair- firmware firmware integrity
wise consistency tests integrity test, failure, "FIPS error
fail, then the module fails, if any of 1: <name of the
returns an error indicator, the CASTs fail algorithm> Known
inhibits all data output or if a pairwise Answer Test:
and enters the hard error consistency Failed" for CAST
state test fails failure and -1 for
pair-wise
consistency test
failure
Soft •In case of a firmware If the firmware N/A for firmware "Validation Error"
Error load test failure, the load test fails load test failure; for the firmware
state module rejects the If the APT or In case of APT load test failure;
firmware, returns an error RCT test fails and/or RCT entropy data
indicator and enters the failures, new data discarded in case
soft error state •In the continues to be of APT/RCT
event of an APT or RCT tested by the failure
health test failure, output health tests, and
from the entropy source once both health
is inhibited, all entropy tests indicate a
accumulated in the “pass”, the
conditioning context is entropy source
discarded and the start- again outputs
up health-tests are data
performed again
Table 27: Error States
If the pre-operation firmware integrity test or if any of the CASTs fail, then the module returns
the error indicator “FIPS error: self-test failure”, inhibits all data output and enters the hard error
state.
If the conditional self-tests fail, the module enters the soft error state, i.e., it rejects the
generated keypair/loaded image, returns an error indicator and resumes normal operation.
Copyright Juniper Networks, Inc. 2024 Page 63 of 67 Document Version 1.0

10.5 Operator Initiation of Self-Tests
Each time the module is powered up it tests that all the cryptographic algorithms operate
correctly, and that sensitive data have not been damaged. Pre-operational as well as
Conditional Cryptographic Algorithm Self-tests (CAST) are performed on each power up/boot of
the module and on demand by power cycling the module (Perform self-tests (remote reset)
service).
11 Life-Cycle Assurance
11.1 Installation, Initialization, and Startup Procedures
The Crypto Officer must follow the procedures defined below for secure installation, initialization,
startup and operation of the module.
Crypto Officer Guidance
The Crypto Officer must check to verify the firmware image being loaded on the module is the
FIPS 140-3 validated version/image. If the image is the FIPS 140-3 validated image, then
proceed with installation of the image.
Installing The Firmware Image
Download the validated firmware image from
https://www.juniper.net/support/downloads/junos.html. Log in to the Juniper Networks
authentication system using the username (generally your e-mail address) and password
supplied by Juniper Networks representatives. Select the validated firmware image. Download
the firmware image to a local host or to an internal software distribution site.
Connect to the console port on the device from your management device and log in to the Junos
OS CLI. Copy the firmware package to the device to the /var/tmp/ directory. Install the new
package on the device using the following command: operator> request vmhost software add
/var/tmp/<package>.tgz.
NOTE: If you need to terminate the installation, do not reboot your device; instead, finish the
installation and then issue the request system software delete package.tgz command, where
package.tgz is, for example, junos-vmhost-install-ptx-x86-64-22.4R2.8.tgz. This is your last
chance to stop the installation.
Reboot the device to complete the load and start the installation:
operator> request vmhost reboot
After the reboot has completed, log in and use the show version command to verify that the new
version of the firmware is successfully installed.
Copyright Juniper Networks, Inc. 2024 Page 64 of 67 Document Version 1.0

Also install the built-in fips-mode.tgz package needed for enabling the Approved-mode and the
jpfe-fips package needed for execution of the CASTs. Please note that this is a one-time
installation after which the module remains in the Approved mode once enabled and
automatically executes the CASTs on each boot without requiring any operator or external
intervention. The following are the commands used for installing these packages:
operator >request system software add optional://fips-mode.tgz
operator >request system software add optional://jpfe-fips.tgz
Enabling Approved Mode of Operation
The Crypto Officer is responsible for initializing the module in the Approved mode of operation.
The Approved mode of operation is not automatically enabled. The Crypto Officer shall place
the module in the Approved mode by first zeroising it to ensure no SSPs are present. Next, the
cryptographic officer shall follow the steps found in the Junos OS FIPS Evaluated Configuration
Guide for PTX Series, Release 22.4R2 document Chapter 2 to place the module into an
Approved mode of operation. The steps from the aforementioned document have been
reiterated below.
To enable the Approved mode in Junos OS on the module:
1. Zeroise the module using the “request vmhost zeroize” command. Once the module
comes up in the “amnesiac mode” post zeroisation, connect to it using the console port
with username “root”, enter the configuration mode and configure the root-
authentication password (i.e., Crypto Officer credentials) as follows:
root@device> edit
Entering configuration mode
[edit]
root@device# set system root-authentication plain-text-
password New password:
Retype new password:
[edit]
root@device# commit
configuration check succeeds
commit complete
2. Enable Approved mode on the device by setting the Approved level to 1, and verify the
level:
[edit]
root@device# set system fips level 1
[edit]
root@device# show system fips level
level 1;
4. Commit the configuration
Copyright Juniper Networks, Inc. 2024 Page 65 of 67 Document Version 1.0

[edit ]
root@device# commit
configuration check succeeds
Generating RSA key /etc/ssh/fips_ssh_host_key
Generating RSA2 key /etc/ssh/fips_ssh_host_rsa_key
Generating ECDSA key /etc/ssh/fips_ssh_host_ecdsa_key
'system' reboot is required to transition to fips level 1
commit complete
5. Reboot the device:
[edit]
root@device# run request system reboot
Reboot the system ? [yes,no] (no) yes
During the reboot, the device runs the pre-operational firmware integrity test and
all CASTs. It returns a login prompt as follows:
root@device:fips>
6. After the reboot has completed, log in and use the show version command to verify the
firmware version is the validated version:
root@device:fips > show version
Placing the Module in the Non-Approved Mode of Operation
As Crypto Officer, the operator needs to disable the Approved mode of operation on the device
to return it to the non-Approved mode of operation. To disable the Approved mode on the
device, the module must be zeroised (step 1 defined above).
11.2 Administrator Guidance
For further information and for the Administrator guidance, please see the Junos OS FIPS
Evaluated Configuration Guide for PTX, Release 22.4R2 document.
11.3 Non-Administrator Guidance
For further information and for the Administrator guidance, please see the Junos OS FIPS
Evaluated Configuration Guide for PTX, Release 22.4R2 document.
11.4 Maintenance Requirements
No other maintenance requirements apply for operation of the module in the Approved/non-
Approved modes as defined above.
11.5 End of Life
The module can be securely sanitized at the end of its lifetime by zeroising it.
Copyright Juniper Networks, Inc. 2024 Page 66 of 67 Document Version 1.0

12 Mitigation of Other Attacks
12.1 Attack List
The module does not implement any mitigation of other attacks and thus the requirements per
this section do not apply to the module.
Copyright Juniper Networks, Inc. 2024 Page 67 of 67 Document Version 1.0