Apple Inc.
Apple corecrypto Module v12
[Intel, User, Software]
FIPS 140-3 Non-Proprietary Security Policy
Document version: 1.0
January 15, 2025
Prepared by:
www.acumensecurity.net
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Table of Contents
1. General ................................................................................................................................................ 3
2. Cryptographic Module Specification............................................................................................ 5
3. Cryptographic Module Interfaces ..............................................................................................16
4. Roles, Services, and Authentication ..........................................................................................18
5. Software/Firmware Security .......................................................................................................34
6. Operational Environment .............................................................................................................35
7. Physical Security .............................................................................................................................36
8. Non-invasive Security ...................................................................................................................37
9. Sensitive Security Parameter Management ............................................................................38
10. Self-tests ...........................................................................................................................................48
11. Life-cycle Assurance ......................................................................................................................51
12. Mitigation of Other Attacks ..........................................................................................................52
List of Tables
Table 1 – Security Levels ............................................................................................................................................. 4
Table 2 – Tested Operational Environments ............................................................................................................. 5
Table 3 – Vendor Affirmed Operational Environments ............................................................................................ 6
Table 4 – Approved Algorithms................................................................................................................................. 13
Table 5 – Non-Approved Algorithms Not Allowed in the Approved Mode of Operation with No Security
Claimed ......................................................................................................................................................................... 14
Table 6 – Non-Approved Algorithms Not Allowed in the Approved Mode of Operation ................................... 15
Table 7 – Ports and Interfaces .................................................................................................................................. 16
Table 8 – Roles, Service Commands, Input and Output ....................................................................................... 19
Table 9 – Approved Services ..................................................................................................................................... 30
Table 10 – Non-Approved Services .......................................................................................................................... 33
Table 11 – SSPs ........................................................................................................................................................... 44
Table 12 – Non-Deterministic Random Number Generation Specification ......................................................... 45
List of Figures
Figure 1 – Cryptographic boundary and physical perimeter ................................................................................... 7
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

1. General
Trademarks
Apple’s trademarks applicable to this document are listed in https://www.apple.com/legal/intellectual-
property/trademark/appletmlist.html. Other company, product, and service names may be trademarks
or service marks of others.
This document is the non-proprietary FIPS 140-3 Security Policy for the Apple, Inc. corecrypto
Module v12 [Intel, User, Software] cryptographic module. It contains the security rules under which
the module must operate and describes how this module meets the requirements as specified in FIPS
PUB 140-3 (Federal Information Processing Standards Publication 140-3) for an Overall Security
Level 1 module.
This document provides all tables and diagrams (when applicable) required by NIST SP 800-140B.
The column names of the tables follow the template tables provided in NIST SP 800-140B.
Table 1 describes the individual security areas of FIPS 140-3, as well as the Security Levels of those
individual areas.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

ISO/IEC 24759
Section 6.
Security
FIPS 140-3 Section Title
| [Number  |     |     |     | Level  |
| -------- | --- | --- | --- | ------ |
Below]
| 1   |                                      |                             | General  | 1               |
| --- | ------------------------------------ | --------------------------- | -------- | --------------- |
| 2   | Cryptographic Module Specification   |                             |          | 1               |
| 3   | Cryptographic Module Interfaces      |                             |          | 1               |
| 4   | Roles, Services, and Authentication  |                             |          | 1               |
| 5   |                                      | Software/Firmware Security  |          | 1               |
| 6   |                                      | Operational Environment     |          | 1               |
| 7   |                                      | Physical Security           |          | Not Applicable  |
| 8   |                                      | Non-invasive Security       |          | Not Applicable  |
Sensitive Security Parameter
| 9   |     |     |     | 1   |
| --- | --- | --- | --- | --- |
Management
| 10  |     |                              | Self-tests  | 1               |
| --- | --- | ---------------------------- | ----------- | --------------- |
| 11  |     | Life-cycle Assurance         |             | 1               |
| 12  |     | Mitigation of Other Attacks  |             | Not Applicable  |
         Table 1 – Security Levels

The module claims an overall Security Level 1.

  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

2.
Cryptographic Module Specification

The Apple corecrypto Module v12 [Intel, User, Software] cryptographic module (hereafter referred to
as “the module”) is a software module running on a multi-chip standalone general-purpose
computing platform. The version of module is 12, written as v12. The module provides
implementations of low-level cryptographic primitives to the Host OS’s (macOS Monterey 12) Security
Framework and Common Crypto. The module has been tested by Acumen Security, LLC. CST lab on
the following platforms with and without AES-NI:

Operating  Hardware
| #   |     | Processor  | PAA/Acceleration  |
| --- | --- | ---------- | ----------------- |
System  Platform
| macOS Monterey  |              | Intel i5 (Amber  |         |
| --------------- | ------------ | ---------------- | ------- |
| 1               | MacBook Air  |                  | AES-NI  |
12  Lake)
| macOS Monterey  |              | Intel i5 (Amber  |      |
| --------------- | ------------ | ---------------- | ---- |
| 2               | MacBook Air  |                  | N/A  |
12  Lake)

Intel i5 (Comet
| 3  macOS Monterey  | iMac  |     | AES-NI  |
| ------------------ | ----- | --- | ------- |
Lake)
12
| macOS Monterey  |       | Intel i5 (Comet  |      |
| --------------- | ----- | ---------------- | ---- |
| 4               | iMac  |                  | N/A  |
12  Lake)
macOS Monterey
| 5   | MacBook Air  | Intel i7 (Ice Lake)  | AES-NI  |
| --- | ------------ | -------------------- | ------- |
12
macOS Monterey
| 6   | MacBook Air  | Intel i7 (Ice Lake)  | N/A  |
| --- | ------------ | -------------------- | ---- |
12
| macOS Monterey  |              | Intel i7 (Coffee  |         |
| --------------- | ------------ | ----------------- | ------- |
| 7               | MacBook Pro  |                   | AES-NI  |
12  Lake)
| macOS Monterey  |              | Intel i7 (Coffee  |      |
| --------------- | ------------ | ----------------- | ---- |
| 8               | MacBook Pro  |                   | N/A  |
12  Lake)
| macOS Monterey  |       | Intel i7 (Comet  |         |
| --------------- | ----- | ---------------- | ------- |
| 9               | iMac  |                  | AES-NI  |
12  Lake)
| macOS Monterey  |       | Intel i7 (Comet  |      |
| --------------- | ----- | ---------------- | ---- |
| 10              | iMac  |                  | N/A  |
12  Lake)
| macOS Monterey  |              | Intel i9 (Coffee  |         |
| --------------- | ------------ | ----------------- | ------- |
| 11              | MacBook Pro  |                   | AES-NI  |
12  Lake)
| macOS Monterey  |              | Intel i9 (Coffee  |      |
| --------------- | ------------ | ----------------- | ---- |
| 12              | MacBook Pro  |                   | N/A  |
12  Lake)
macOS Monterey
| 13  | iMac Pro  | Xeon W Sky Lake  | AES-NI  |
| --- | --------- | ---------------- | ------- |
12
macOS Monterey
| 14  | iMac Pro  | Xeon W Sky Lake  | N/A  |
| --- | --------- | ---------------- | ---- |
12
| macOS Monterey  |          | Xeon W Cascade  |         |
| --------------- | -------- | --------------- | ------- |
| 15              | Mac Pro  |                 | AES-NI  |
12  Lake
| macOS Monterey  |          | Xeon W Cascade  |      |
| --------------- | -------- | --------------- | ---- |
| 16              | Mac Pro  |                 | N/A  |
12  Lake
       Table 2 – Tested Operational Environments
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

In addition to the platforms listed in Table 2, Apple Inc. has also tested the module on the following
platforms and claims vendor affirmation on them (the processor and year per platform have also
been specified):

| #   | Operating  |     | Hardware Platform  |     |
| --- | ---------- | --- | ------------------ | --- |
System
| 1   | macOS Monterey  | MacBook Pro  | i5 (Ice Lake)  | 2020  |
| --- | --------------- | ------------ | -------------- | ----- |
12
| 2   |     | MacBook Pro  | i5 (Coffee Lake)  | 2020, 2019, 2018  |
| --- | --- | ------------ | ----------------- | ----------------- |
macOS Monterey
12
| 3   | macOS Monterey  | MacBook Pro  | i7 (Amber Lake)  | 2019, 2018  |
| --- | --------------- | ------------ | ---------------- | ----------- |
12
4  macOS Monterey  MacBook Pro  i7 (Coffee Lake)  2020, 2019, 2018
12
| 5   | macOS Monterey  | MacBook Pro  | i7 (Ice Lake)  | 2020  |
| --- | --------------- | ------------ | -------------- | ----- |
12
6  macOS Monterey  MacBook Pro   i9 (Coffee Lake)  2019, 2018
12
| 7   | macOS Monterey  | MacBook Air  | i5 (Ice Lake)  | 2020  |
| --- | --------------- | ------------ | -------------- | ----- |
12
| 8   | macOS Monterey  | MacBook Air  | i7 (Ice Lake)  | 2020  |
| --- | --------------- | ------------ | -------------- | ----- |
12
| 9   | macOS Monterey  | MacBook Air  | i5 (Amber Lake)  | 2019, 2018  |
| --- | --------------- | ------------ | ---------------- | ----------- |
12
| 10  | macOS Monterey  | MacBook Air  | i7 (Amber Lake)  | 2018  |
| --- | --------------- | ------------ | ---------------- | ----- |
12
| 11  | macOS Monterey  | Mac mini  | i5 (Coffee Lake)  | 2018  |
| --- | --------------- | --------- | ----------------- | ----- |
12
| 12  | macOS Monterey  | Mac mini  | i7 (Coffee Lake)  | 2018  |
| --- | --------------- | --------- | ----------------- | ----- |
12
| 13  | macOS Monterey  | iMac  | i5 (Comet Lake)  | 2020  |
| --- | --------------- | ----- | ---------------- | ----- |
12
| 14  | macOS Monterey  | iMac  | i7 (Comet Lake)  | 2020  |
| --- | --------------- | ----- | ---------------- | ----- |
12
| 15  | macOS Monterey  | iMac  | i9 (Comet Lake)  | 2020  |
| --- | --------------- | ----- | ---------------- | ----- |
12
| 16  | macOS Monterey  | iMac  | i5 (Coffee Lake)  | 2019  |
| --- | --------------- | ----- | ----------------- | ----- |
12
| 17  | macOS Monterey  | iMac  | i7 (Coffee Lake)  | 2019  |
| --- | --------------- | ----- | ----------------- | ----- |
12
| 18  | macOS Monterey  | iMac  | i9 (Coffee Lake)  | 2019  |
| --- | --------------- | ----- | ----------------- | ----- |
12
Table 3 – Vendor Affirmed Operational Environments

The CMVP makes no statement as to the correct operation of the module or the security strengths of
the generated keys when so ported if the specific operational environment is not listed on the validation
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

certificate.
The physical perimeter of the module which is also the Tested Operational Environment’s Physical
Perimeter (TOEPP), is the physical perimeter of the macOS device that contains the module. Consequently,
the embodiment of the module is a multi-chip standalone cryptographic module.
(Figure 1) below depicts the following information:
The location of the module with respect to the operating system (blue dotted outline),
o
other supporting applications so that all the logical and physical layers between the
cryptographic boundary and the physical perimeter are clearly defined; and
The interactions of the logical object of the module with the operating system and other
o
supporting applications resident within the physical perimeter boundary.
Figure 1 – Cryptographic boundary and physical perimeter
The table below lists all Approved or Vendor-affirmed security functions of the module, including
specific key size(s) employed for approved services, and implemented modes of operation. The module
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

is in the Approved mode of operation when the module utilizes the services that use the security
functions listed in the table below. The module supports an Approved mode and a non-Approved mode
of operation. The module does not support a degraded operation.
The Approved mode of operation is configured in the system by default and can only be transitioned
into the non-Approved mode by calling one of the non-Approved services listed in Table 10 - Non-
Approved Services. If the device starts up successfully, then the module has passed all self-tests and is
operating in the Approved mode.

Description /
|            | Algorithm and  |              | Key Size(s) /  |                 |
| ---------- | -------------- | ------------ | -------------- | --------------- |
| CAVP Cert  |                | Mode/Method  |                | Use / Function  |
|            | Standard       |              | Key            |                 |
Strength(s)
#A2821
(vng_asm)
#A2820
| (c_ltc)  |           | AES-128,  |     |                |
| -------- | --------- | --------- | --- | -------------- |
| #A2815   | CTR_DRBG  | AES-256   |     | Random Number  |
128, 256 bits
| (c_asm)    | [SP800-90Ar1]  | Derivation Function  |     | Generation  |
| ---------- | -------------- | -------------------- | --- | ----------- |
| #A2814 (c- |                | Enabled              |     |             |
aesni)
#A2822
(vng_aesni)
#A2820
| (c_ltc)  |     | SHA-1,  |     |     |
| -------- | --- | ------- | --- | --- |
112 bits or
| #A2817  |     | SHA-224,  |     |     |
| ------- | --- | --------- | --- | --- |
greater
| (c_avx2)  | HMAC_DRBG      | SHA-256,  |     | Random Number  |
| --------- | -------------- | --------- | --- | -------------- |
| #A2816    | [SP800-90Ar1]  | SHA-384,  |     | Generation     |
| (c_avx)   |                | SHA-512   |     |                |
#A2818
(c_ssse3)

  Key Generation
#A2820
|     |     | Key Generation  | 2048, 3072,  |     |
| --- | --- | --------------- | ------------ | --- |
(c_ltc)
|     |     | (ANSI X9.31),  | 4096  |     |
| --- | --- | -------------- | ----- | --- |
#A2817
|           |               | Signature          | Signature    |                    |
| --------- | ------------- | ------------------ | ------------ | ------------------ |
| (c_avx2)  |               |                    |              | Digital Signature  |
|           | RSA           | Generation         | Generation   |                    |
|           |               |                    |              | and Asymmetric     |
|           | [FIPS 186-4]  |                    | Modulus:     |                    |
| #A2816    |               |                    |              | Key Generation     |
|           |               | (PKCS#1 v1.5) and  | 2048 (SHA-1  |                    |
(c_avx)
|     |     | (PKCS PSS)  | (legacy), SHA2- |     |
| --- | --- | ----------- | --------------- | --- |
#A2818
|     |     | Signature  | 224, SHA2-256,  |     |
| --- | --- | ---------- | --------------- | --- |
(c_ssse3)
|     |     | Verification  | SHA2-284,  |     |
| --- | --- | ------------- | ---------- | --- |
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Description /
Algorithm and  Key Size(s) /
| CAVP Cert  | Mode/Method  |     | Use / Function  |
| ---------- | ------------ | --- | --------------- |
Standard  Key
Strength(s)
|     |                    | SHA2-512),      |     |
| --- | ------------------ | --------------- | --- |
|     | (PKCS#1 v1.5) and  | 3072 (SHA-1     |     |
|     | (PKCS PSS)         | (legacy), SHA2- |     |
|     |                    | 224, SHA2-256,  |     |
SHA2-284,
SHA2-512),
4096 (SHA-1
(legacy), SHA2-
224, SHA2-256,
SHA2-284,
SHA2-512)

Signature
Verification
Modulus: 1024
(SHA-1 (legacy),
SHA2-224,
SHA2-256,
SHA2-284),
2048 (SHA-1
(legacy), SHA2-
224, SHA2-256,
SHA2-284,
SHA2-512),
3072 (SHA-1
(legacy), SHA2-
224, SHA2-256,
SHA2-284,
SHA2-512),
4096 (SHA-1
(legacy), SHA2-
224, SHA2-256,
SHA2-284,
SHA2-512)
| #A2820  |     | Key Pair  |     |
| ------- | --- | --------- | --- |
Key Pair Generation
| (c_ltc)  |     | Generation  |     |
| -------- | --- | ----------- | --- |
(PKG)
| #A2817  |     | (PKG):  |     |
| ------- | --- | ------- | --- |
ECDSA  Public Key
| (c_avx2)  |     | P-224, P-256, P- | Digital Signature  |
| --------- | --- | ---------------- | ------------------ |
ANSI  Validation (PKV)
| #A2816  |     | 384, P-521  | and Asymmetric  |
| ------- | --- | ----------- | --------------- |
X9.62  Signature
| (c_avx)  |     |     | Key Generation  |
| -------- | --- | --- | --------------- |
[FIPS 186-4]  Generation
| #A2818  |     | Public Key  |     |
| ------- | --- | ----------- | --- |
Signature
| (c_ssse3)  |     | Validation  |     |
| ---------- | --- | ----------- | --- |
Verification
|     |     | (PKV):  |     |
| --- | --- | ------- | --- |
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Description /
|            | Algorithm and  |              | Key Size(s) /  |                 |
| ---------- | -------------- | ------------ | -------------- | --------------- |
| CAVP Cert  |                | Mode/Method  |                | Use / Function  |
|            | Standard       |              | Key            |                 |
Strength(s)
P-224, P-256, P-
384, P-521

Signature
Generation:
P-224, P-256, P-
384, P-521
SHA2-224,
SHA2-256,
SHA2-384,
SHA2-512

Signature
Verification:
P-224, P-256, P-
384, P-521
SHA-1 (legacy),
SHA2-224,
SHA2-256,
SHA2-384,
SHA2-512
#A2820
(c_ltc)
| #A2818       |               | SHA-1,          |      |                 |
| ------------ | ------------- | --------------- | ---- | --------------- |
| (c_ssse3)    |               | SHA-224,        |      |                 |
| #A2823       | SHS           | SHA-256,        |      |                 |
|              |               |                 | N/A  | Message Digest  |
| (vng_Intel)  | [FIPS 180-4]  | SHA-384,        |      |                 |
| #A2817       |               | SHA-512,        |      |                 |
| (c_avx2)     |               | SHA-512/256     |      |                 |
| #A2816       |               | (except A2823)  |      |                 |
(c_avx)
Key Length:
CBC, CCM, CFB128,
128, 192, 256
| #A2820   |                | CFB8, CMAC, CTR,  |               |     |
| -------- | -------------- | ----------------- | ------------- | --- |
|          | AES            |                   | CMAC :128     |     |
| (c_ltc)  |                | ECB, GCM, KW,     |               |     |
|          | [FIPS 197]     |                   | XTS (128 and  |     |
|          |                | OFB, XTS          |               |     |
|          | [SP 800-38 A]  |                   | 256-bits key  |     |
  Symmetric Encryption
|     | [SP 800-38 C]  |     | size only)  |     |
| --- | -------------- | --- | ----------- | --- |
and Decryption
|            | [SP 800-38 D]  | CBC, CCM, CFB128,  | Key Length:    |     |
| ---------- | -------------- | ------------------ | -------------- | --- |
| #A2815     | [SP 800-38 E]  | CFB8, CTR, ECB,    | 128, 192, 256  |     |
| #A2814     | [SP 800-38 F]  | GCM, KW, OFB,      | XTS (128 and   |     |
| (c_aesni)  |                | XTS                | 256-bits key   |     |
  size only)
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Description /
|            | Algorithm and  |              | Key Size(s) /  |                 |
| ---------- | -------------- | ------------ | -------------- | --------------- |
| CAVP Cert  |                | Mode/Method  |                | Use / Function  |
|            | Standard       |              | Key            |                 |
Strength(s)
#A2821
CCM, CTR, ECB,
#A2822
GCM

Key Length:
A2819
|     |     | CBC  | 128, 192, 256  |     |
| --- | --- | ---- | -------------- | --- |
(c_glad)

#A2812
Key Length:
(asm_aesni)
128, 192, 256

| #A2813  |     | CBC, ECB, XTS  |     |     |
| ------- | --- | -------------- | --- | --- |
XTS (128 and
(asm_x86)
256-bits
key size only)

#A2823
(vng_Intel)
| #A2817    |     | SHA-1,    |     |     |
| --------- | --- | --------- | --- | --- |
| (c_avx2)  |     | SHA-224,  |     |     |
HMAC
| #A2816   |        | SHA-256,  | 112 bits or  |             |
| -------- | ------ | --------- | ------------ | ----------- |
|          | [FIPS  |           |              | Keyed Hash  |
| (c_avx)  |        | SHA-384,  | greater      |             |
198]
| #A2820   |     | SHA-512         |     |     |
| -------- | --- | --------------- | --- | --- |
| (c_ltc)  |     | SHA-512/256     |     |     |
| #A2818   |     | (except A2823)  |     |     |
(c_ssse3)
Domain
Parameter
Generation
Methods:
|          |               | Scheme: dhEphem:      |             | Key Agreement       |
| -------- | ------------- | --------------------- | ----------- | ------------------- |
| #A2820   |               |                       | MODP-2048,  |                     |
|          | KAS-FFC-SSC   | KAS Role: initiator,  |             | Scheme – Shared     |
| (c_Itc)  |               |                       | MODP-4096,  |                     |
|          | [SP800-56r3]  | responder             |             | Secret Computation  |
MODP-6144,
MODP-8192

Domain
|     |     | Scheme:  | Parameter  |     |
| --- | --- | -------- | ---------- | --- |
Key Agreement
|                | KAS-ECC-SSC   | ephemeralUnified:     | Generation   |                  |
| -------------- | ------------- | --------------------- | ------------ | ---------------- |
| #A2820(c_Itc)  |               |                       |              | Scheme – Shared  |
|                | [SP800-56r3]  | KAS Role: initiator,  | Methods: P-  |                  |
Secret Computation
|     |     | responder  | 224, P-256, P- |     |
| --- | --- | ---------- | -------------- | --- |
384, P-
|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

Description /
|            | Algorithm and  |              | Key Size(s) /  |                 |
| ---------- | -------------- | ------------ | -------------- | --------------- |
| CAVP Cert  |                | Mode/Method  |                | Use / Function  |
|            | Standard       |              | Key            |                 |
Strength(s)
521

KDF Mode: Counter
and Feedback

|     |     | MAC Mode: HMAC- | Supported        |     |
| --- | --- | --------------- | ---------------- | --- |
|     |     | SHA-1,          | Lengths: 8-4096  |     |
|     |     | HMAC-SHA2-224,  | Increment 8      |     |
#A2820 (c_ltc
|     |     | HMAC-SHA2-  |     |     |
| --- | --- | ----------- | --- | --- |
)
|     | KBKDF  | 256, HMAC-SHA2- | Fixed Data  |     |
| --- | ------ | --------------- | ----------- | --- |
#A2817
|           | [SP800-108]  | 384, HMAC-SHA2- | Order: Before  |                 |
| --------- | ------------ | --------------- | -------------- | --------------- |
| (c_avx2)  |              |                 |                | Key Derivation  |
|           |              | 512             | Fixed          |                 |
A2816 (c_avx)
|     |     |     | Data  |     |
| --- | --- | --- | ----- | --- |
#A2818
|     |     | CMAC-AES128,  |     |     |
| --- | --- | ------------- | --- | --- |
(c_ssse3)
|     |     | CMAC-AES192,    | Counter Length:  |     |
| --- | --- | --------------- | ---------------- | --- |
|     |     | CMAC-AES256     | 32               |     |
|     |     |  (only #A2820)  |                  |     |

Password
length: 8- 128
bytes Increment
1
#A2820 (c_ltc
Salt Length:
)
|     |     | HMAC with:  | 128-4096  |     |
| --- | --- | ----------- | --------- | --- |
#A2817
|           |              | SHA-1, SHA-224,  | Increment 8       |                 |
| --------- | ------------ | ---------------- | ----------------- | --------------- |
| (c_avx2)  | PBKDF        |                  |                   |                 |
|           |              | SHA-256,         | Iteration Count:  | Key Derivation  |
| #A2816    | [SP800-132]  |                  |                   |                 |
|           |              | SHA-384,         | 10-1000           |                 |
(c_avx)
|     |     | SHA-512  | Increment 1  |     |
| --- | --- | -------- | ------------ | --- |
#A2818

(c_ssse3)

|     |     | Key Generation for  | Safe Prime  |     |
| --- | --- | ------------------- | ----------- | --- |
#A2820 (c_ltc
Safe Primes Key  Diffie-Hellman  Groups: MODP- Key Generation
)
|     | generation                                | (KAS-FFC-SSC)  | 2048, MODP-  |     |
| --- | ----------------------------------------- | -------------- | ------------ | --- |
|     | © 2024 Apple Inc., All rights reserved.   |                |              |     |
This document may be reproduced and distributed only in its original entirely without revision

Description /
|            | Algorithm and  |              | Key Size(s) /  |                 |
| ---------- | -------------- | ------------ | -------------- | --------------- |
| CAVP Cert  |                | Mode/Method  |                | Use / Function  |
|            | Standard       |              | Key            |                 |
Strength(s)
3072, MODP-
4096,
MODP-6144,
MODP-
8192
2048, 4096,
| KAS-1  |     |     | 6144, 8192-bit  |     |
| ------ | --- | --- | --------------- | --- |
SP 800-56Arev3.
| KAS-FFC-SSC  |     |     | key providing  |     |
| ------------ | --- | --- | -------------- | --- |
Key Agreement –
KAS-FFC-SSC per IG
| Sp800- | KAS  |     | 112, 152, 176,  | Shared Secret  |
| ------ | ---- | --- | --------------- | -------------- |
D.F Scenario 2 path
| 56Ar3/A2820  |     |     | 200 bits of  |     |
| ------------ | --- | --- | ------------ | --- |
Computation
(1)
|     |     |     | encryption  |     |
| --- | --- | --- | ----------- | --- |
strength
224 , 256, 384,
521-bit key
| KAS-2        |      | SP 800-56Arev3.      |                 |                  |
| ------------ | ---- | -------------------- | --------------- | ---------------- |
|              |      |                      | providing 112,  | Key Agreement –  |
| KAS-ECC-SSC  |      | KAS-ECC-SSC per IG   |                 |                  |
|              | KAS  |                      | 128, 192, 256   | Shared Secret    |
| Sp800-       |      | D.F Scenario 2 path  |                 |                  |
bits of
| 56Ar3/A2820  |     | (1)  |     | Computation  |
| ------------ | --- | ---- | --- | ------------ |
encryption
strength
KTS
AES-
128, 192, and
KW/A2814
256- bit keys
| AES- |     | SP 800-38D and SP  |     |     |
| ---- | --- | ------------------ | --- | --- |
providing 128,
| KW/A2815  | KTS  | 800-38F; key         |                   |               |
| --------- | ---- | -------------------- | ----------------- | ------------- |
|           |      |                      | 192, or 256 bits  | Key Wrapping  |
| AES-      |      | wrapping per IG D.G  |                   |               |
of encryption
KW/A2820
strength

RSA Key
Generation (ANSI
RSA:
X9.31),
|     | Cryptographic  |     | Modulus: 2048,  |     |
| --- | -------------- | --- | --------------- | --- |

|           | Key         |                    | 3072, 4096  |                 |
| --------- | ----------- | ------------------ | ----------- | --------------- |
| Vendor    |             | ECDSA Key Pair     |             |                 |
|           | Generation  |                    |             | Key Generation  |
| Affirmed  |             | Generation (PKG),  |             |                 |
|           | (CKG)       |                    | ECDSA:      |                 |

|     | [SP800-133r2]  |     | P-224, P-256, P- |     |
| --- | -------------- | --- | ---------------- | --- |
Sections 4, 5.1,
384, P-521
5.2, 6.2.2 and 6.2.3
per SP800-132r2
|     |     |     |     |     |
| --- | --- | --- | --- | --- |
   Table 4 – Approved Algorithms
This module does not have non-Approved but Allowed Algorithms used in the Approved mode of
operation.

|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

The table below list non-Approved but Allowed security functions with no security claimed:
Algorithm Caveat Use / Function
Message Digest (used as part of
the TLS key establishment scheme
MD5 no security claimed
only),
Digest Size: 128-bit
Table 5 – Non-Approved Algorithms Not Allowed in the Approved Mode of Operation with No Security
Claimed
The table below lists Non-Approved security functions that are not Allowed in the Approved Mode of
Operation:
Algorithm/Function Use/Function
ANSI X9.31 Key Pair Generation Key Size < 2048
RSA PKCS#1 v1.5 and PSS Signature Generation Key Size
Signature Generation / Signature < 2048
Verification / Asymmetric Key Generation PKCS#1 v1.5 and PSS Signature Verification
Key Size< 1024
RSA Key Wrapping OAEP, PKCS#1 v1.5 and -PSS schemes
Diffie-Hellman Key agreement scheme
EC Diffie-Hellman Key agreement scheme
Key Agreement
Ed25519 Sig(gen)
Sig(ver)
ANSI X9.63 KDF Hash based Key Derivation Function
RFC6637 Key Derivation Function
HKDF [SP800-56Cr1] Key Derivation Function
DES Encryption / Decryption Key Size 56-bits
Encryption / Decryption
CAST
Key Sizes 40 to 128-bits in 8-bit increments
Encryption / Decryption
RC4
Key Sizes 8 to 4096-bits
RC2 Encryption / Decryption Key Sizes 8 to 1024-bits
MD2 Message Digest Digest size 128-bit
MD4 Message Digest Digest size 128-bit
RIPEMD Message Digest Digest size 160-bits
PKG: Curve P-192
PKV: Curve P-192
ECDSA
Signature Generation: Curve P-192
Signature Verification: Curve P-192
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Key Pair Generation for compact point representation
of points
Key Pair Generation for compact point representation
of points
Integrated Encryption Scheme on elliptic
Encryption / Decryption
curves (ECIES)
Blowfish Encryption / Decryption
OMAC (One-Key CBC MAC) MAC generation
Triple-DES [SP 800-67] CBC, CTR, CFB64, ECB, CFB8, OFB
Table 6 – Non-Approved Algorithms Not Allowed in the Approved Mode of Operation
Overall Security Rules of Operation
• AES-GCM IV is constructed in compliance with IG C.H scenario 1a (TLS 1.2) and scenario 1b
(IPsec-v3). The TLS and IPSec/IKE protocols have not been reviewed or tested by the CAVP and
CMVP. The GCM IV generation follows RFC 5288 and shall only be used for the TLS protocol
version 1.2. The counter portion of the IV is set by the module within its cryptographic boundary.
The module does not implement the TLS protocol. The module’s implementation of AES-GCM is
used together with an application that runs outside the module’s cryptographic boundary. The
design of the TLS protocol implicitly ensures that the nonce_explicit, or counter portion of the IV
will not exhaust all of its possible values. The GCM IV generation follows RFC 4106 and shall only
be used for the IPsec-v3 protocol version 3. The counter portion of the IV is set by the module
within its cryptographic boundary. The module does not implement the IPsec protocol. The
module’s implementation of AES-GCM is used together with an application that runs outside the
module’s cryptographic boundary. The design of the IPsec protocol implicitly ensures that the
nonce_explicit, or counter portion of the IV will not exhaust all of its possible values. In both
protocols in case the module’s power is lost and then restored, the key used for the AES GCM
encryption/decryption shall be re-distributed. This condition is not enforced by the module;
however, it is met implicitly. The module does not retain any state when power is lost. As indicated
in Table 10, column Storage, the module exclusively uses volatile storage. This means that AES-
GCM key/IVs are not persistently stored during power off: therefore, there is no re-connection
possible when the power is back on with re-generation of the key used for GCM. After restoration
of the power, the user of the module (e.g., TLS, IKE) along with User application that implements
the protocol, must perform a complete new key establishment operation using new random
numbers (Entropy input string, DRBG seed, DRBG internal state V and Key, shared secret values
that are not retained during power cycle, see table 10) with subsequent KDF operations to
establish a new GCM key/IV pair on either side of the network communication channel.
• AES-XTS mode is only approved for hardware storage applications. The length of the AES-XTS data
unit does not exceed 220 blocks. The module checks explicitly that Key_1 ≠ Key_2 before using
the keys in the XTS-Algorithm to process data with them compliant with IG C.I.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

3. Cryptographic Module Interfaces
As a software-only module, the module does not have physical ports. For the purpose of the FIPS 140-
3 validation, the physical ports are interpreted to be the physical ports of the hardware platform on
which it runs.
The logical interfaces are the application program interface (API) through which applications request
services and the Operating System calls that the module invokes.
The underlying logical interfaces of the module are the C language User Interfaces (APIs). In detail
these interfaces are described in (Table 7):
Logical interface Data that passes over port/interface
Data inputs are provided in the variables passed in
Data input interface
the API and callable service invocations, generally
through caller-supplied buffers
Data outputs are provided in the variables passed
Data output interface in the API and callable service invocations,
generally through caller-supplied buffers
Control inputs which control the mode of the
Control input interface module are provided through dedicated
parameters.
Status output is provided in return codes and
through messages. Documentation for each API
lists possible return codes. A complete list of all
Status output interface return codes returned by the C language APIs
within the module is provided in the header files
and the API documentation. Messages are also
documented in the API documentation.
Table 7 – Ports and Interfaces
The module does not support a control output interface.
The module is optimized for library use within the macOS User space and does not contain any
terminating assertions or exceptions. It is implemented as a macOS dynamically loadable library. The
dynamically loadable library is loaded into the macOS User and its cryptographic functions are made
available to the macOS application. Any internal error detected by the module is reflected back to the
caller with an appropriate return code. The calling macOS application must examine the return code and
act accordingly.
The module communicates any error status synchronously through the use of its documented return
codes, thus indicating the module’s status. It is the responsibility of the caller to handle exceptional
conditions in a FIPS 140-3 appropriate manner.
Caller-induced or internal errors do not reveal any sensitive material to callers. Cryptographic bypass
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

capability is not supported by the module.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

4. Roles, Services, and Authentication

The module supports a single instance of one authorized role: The Crypto Officer. No support is provided
for multiple concurrent operators or a Maintenance Operator.

| Role  |     | Service  |                            | Input  |                         | Output  |
| ----- | --- | -------- | -------------------------- | ------ | ----------------------- | ------- |
|       |     |          | Input for Encryption: key  |        | Output for Encryption:  |         |
AES Encryption /
|     |     |     |     | and plain text  | cipher text  |     |
| --- | --- | --- | --- | --------------- | ------------ | --- |
Decryption (Perform
|     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- |
approved security
|     |     |     | Input for Decryption:  | Output for Decryption: plain  |     |     |
| --- | --- | --- | ---------------------- | ----------------------------- | --- | --- |
functions)
|     |     |     | key and cipher text  |     |     | text  |
| --- | --- | --- | -------------------- | --- | --- | ----- |
AES Key Wrapping
key encryption key and
|     | (Perform approved  |     |     |     | wrapped key  |     |
| --- | ------------------ | --- | --- | --- | ------------ | --- |
key to be wrapped
security functions)
Secure Hash Generation
|     | (Perform approved  |     |     | Message  | Hash value  |     |
| --- | ------------------ | --- | --- | -------- | ----------- | --- |
security functions)
HMAC generation
|     | (Perform approved  |     | HMAC key and message  |     | keyed Hash value  |     |
| --- | ------------------ | --- | --------------------- | --- | ----------------- | --- |
security functions)
|     |     | RSA signature  | Input for SigGen: RSA  |     |     |     |
| --- | --- | -------------- | ---------------------- | --- | --- | --- |
Output SigGen: signature
|     |     | generation and  | private key and message  |     |     |     |
| --- | --- | --------------- | ------------------------ | --- | --- | --- |

|     |     | verification  |     |     |     |     |
| --- | --- | ------------- | --- | --- | --- | --- |
Output for Sigver: True or
|     | (Perform approved  |     | Input for SigVer: RSA  |     |     |     |
| --- | ------------------ | --- | ---------------------- | --- | --- | --- |
False
|     | security functions)  |     | public key and signature  |     |     |     |
| --- | -------------------- | --- | ------------------------- | --- | --- | --- |
ECDSA signature  Input for SigGen: ECDSA  Output for SigGen:
Crypto Officer (CO)
|     |     | generation and  | private key and message  |     | signature  |     |
| --- | --- | --------------- | ------------------------ | --- | ---------- | --- |
|     |     | verification    |                          |     |            |     |
(Perform approved  Input for SigVer: ECDSA  Output for SigVer:
security functions)  public key and signature  True or False
Random number
|     |     | generation  | Entropy input string,  |     |     |     |
| --- | --- | ----------- | ---------------------- | --- | --- | --- |
Random numbers
|     | (Perform approved  |     |     | nonce  |     |     |
| --- | ------------------ | --- | --- | ------ | --- | --- |
security functions)
PBKDF
|     | (Perform approved  |     |     | password  | derived key  |     |
| --- | ------------------ | --- | --- | --------- | ------------ | --- |
security functions)
KBKDF
|     | (Perform approved  |     | key derivation key  |     | Derived key  |     |
| --- | ------------------ | --- | ------------------- | --- | ------------ | --- |
security functions)
ECDSA (key pair
|     |     | generation)  |     |     | generated private and  |     |
| --- | --- | ------------ | --- | --- | ---------------------- | --- |
random numbers
|     | (Perform approved  |     |     |     | public key pair  |     |
| --- | ------------------ | --- | --- | --- | ---------------- | --- |
security functions)
|     |     | RSA (key pair  |     |     | generated private and  |     |
| --- | --- | -------------- | --- | --- | ---------------------- | --- |
random prime numbers
|     |     | generation)  |     |     | public key pair  |     |
| --- | --- | ------------ | --- | --- | ---------------- | --- |
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

| Role  |     | Service  |     | Input  |     | Output  |
| ----- | --- | -------- | --- | ------ | --- | ------- |
(Perform approved
security functions)
Safe primes key
|     |     | generation   |     |     | generated private and  |     |
| --- | --- | ------------ | --- | --- | ---------------------- | --- |
key size
|     | (Perform approved  |     |     |     |     | public key pair  |
| --- | ------------------ | --- | --- | --- | --- | ---------------- |
security functions)
Diffie-Hellman Key
|     |                    | Shared Secret  | domain parameter,        |     |     |                |
| --- | ------------------ | -------------- | ------------------------ | --- | --- | -------------- |
|     |                    | Computation    | received public key and  |     |     | shared secret  |
|     | (Perform approved  |                | possessed private key    |     |     |                |
security functions)
EC Diffie-Hellman
|     |                    | Shared Secret  | domain parameter,        |     |     |                |
| --- | ------------------ | -------------- | ------------------------ | --- | --- | -------------- |
|     |                    | Computation    | received public key and  |     |     | shared secret  |
|     | (Perform approved  |                | possessed private key    |     |     |                |
security functions)
Release all resources of
symmetric crypto
|     |     |     | handler of symmetric  |     | zeroised and released  |     |
| --- | --- | --- | --------------------- | --- | ---------------------- | --- |
function context
|     |     |     | crypto function context  |     |     | memory space  |
| --- | --- | --- | ------------------------ | --- | --- | ------------- |
(Perform zeroisation)

Release all resources of
hash context  handler of hash context  released memory space
(Perform zeroisation)
Release of all resources
of Diffie-Hellman
|     | context for Diffie-    |     | handler of (EC)        |     | zeroised and released  |               |
| --- | ---------------------- | --- | ---------------------- | --- | ---------------------- | ------------- |
|     | Hellman and EC Diffie- |     | DiffieHellman context  |     |                        | memory space  |
Hellman
(Perform zeroisation)
Release of all resources
of key derivation  handler of key derivation  zeroised and released
|     |     | function context  | function context  |     |     | memory space  |
| --- | --- | ----------------- | ----------------- | --- | --- | ------------- |
(Perform zeroisation)
Release of all resources
of asymmetric crypto  handler of asymmetric  zeroised and released
|     |     | function context  | crypto function context  |     |     | memory space  |
| --- | --- | ----------------- | ------------------------ | --- | --- | ------------- |
(Perform zeroisation)
Self-test
|     |     |     |     | power  |     | Pass/Fail status  |
| --- | --- | --- | --- | ------ | --- | ----------------- |
(Perform self-tests)
|     |     | Show Status  |     | API invocation  | Operational/Error status  |     |
| --- | --- | ------------ | --- | --------------- | ------------------------- | --- |
Show Module Info
|     |     |     |     | API invocation  |     | Module Base Name +  |
| --- | --- | --- | --- | --------------- | --- | ------------------- |
(Show module’s
|     |     |     |     |     | Module Version Number  |     |
| --- | --- | --- | --- | --- | ---------------------- | --- |
versioning information)
Table 8 – Roles, Service Commands, Input and Output

  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

FIPS 140-3 does not require an authentication mechanism for level 1 modules. Therefore, the module
does not implement an authentication mechanism for Crypto Officer. The Crypto Officer role is
authorized to access all services provided by the module (see Table 9 - Approved Services and Table
10 - Non-Approved Services below).
The module implements a dedicated API function to indicate if a requested service utilizes an
approved security function. For services listed in Table 9 - Approved Services, the indicator function
returns 1. For services listed in Table 10 - Non-Approved Services, the indicator function returns 0.
The table below lists all approved services that can be used in the approved mode of operation. The
abbreviations of the access rights to keys and SSPs have the following interpretation:
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
Keys and/or  to
| Services  | Description  | Security  |     | Roles  | Indicator  |
| --------- | ------------ | --------- | --- | ------ | ---------- |
SSPs  Keys
Functions
and/or
SSPs
|     |     | Symmetric  |     | CO  |     |
| --- | --- | ---------- | --- | --- | --- |
Encryption and
Decryption
AES-CBC
(#A2820,
#A2815, #A2814,
A2819, #A2812,
#A2813)

AES-ECB
(#A2820,
#A2815, #A2814,
#A2812, #A2813,
#A2821, #A2822)

Input for
AES-CCM
Encryption: key
(#A2820,
and plain text
|      | #A2815, #A2814,  |     |     |     |     |
| ---- | ---------------- | --- | --- | --- | --- |
|      | Output for       |     |     |     |     |
| AES  | #A2821, #A2822)  |     |     |     |     |
|      | Encryption:      |     |     |     |     |
Encryption /

|             | cipher text      |           |          |       |     |
| ----------- | ---------------- | --------- | -------- | ----- | --- |
| Decryption  |                  | AES-GCM   |          |       |     |
|             | Input for        |           | AES key  | W, E  | 1   |
| (Perform    |                  | (#A2820,  |          |       |     |
|             | Decryption: key  |           |          |       |     |
| approved    | #A2815, #A2814,  |           |          |       |     |
|             | and cipher text  |           |          |       |     |
| security    | #A2821, #A2822)  |           |          |       |     |
|             | Output for       |           |          |       |     |
| functions)  |                  |           |          |       |     |
Decryption:
AES-
plain text
CFB128(#A2820,

#A2815, #A2814)

AES-
CFB8(#A2820,
#A2815, #A2814)

AES-OFB
(#A2820,
#A2815, #A2814)

AES-CTR
(#A2820,
#A2815, #A2814,
#A2821, #A2822)

  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
Keys and/or  to
| Services  | Description  | Security  |     | Roles  | Indicator  |
| --------- | ------------ | --------- | --- | ------ | ---------- |
SSPs  Keys
Functions
and/or
SSPs
AES-XTS
(#A2820,
#A2815, #A2814,
#A2812, #A2813)

CMAC (#A2820)

| AES Key                I n  p  u  t :     |                                           |                  |                 | CO       |     |
| ----------------------------------------- | ----------------------------------------- | ---------------- | --------------- | -------- | --- |
| Wrapping                                  | key encryption                            |                  |                 |          |     |
|                                           |                                           | Key Wrapping     | AES key, key    |          |     |
| (Perform                                  | key and key to                            |                  |                 |          | 1   |
|                                           |                                           | KW (#A2820,      | to be wrapped,  | W, R, E  |     |
| approved                                  | be wrapped                                |                  |                 |          |     |
|                                           |                                           | #A2815, #A2814)  | wrapped key     |          |     |
| security                                  | Output: wrapped                           |                  |                 |          |     |
| functions)                                | key                                       |                  |                 |          |     |
|                                           | © 2024 Apple Inc., All rights reserved.   |                  |                 |          |     |
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
|           |              |           | Keys and/or  |        | to         |     |
| --------- | ------------ | --------- | ------------ | ------ | ---------- | --- |
| Services  | Description  | Security  |              | Roles  | Indicator  |     |
|           |              |           | SSPs         |        | Keys       |     |
Functions
and/or
SSPs
|     |     | Message Digest  |     | CO  |     |     |
| --- | --- | --------------- | --- | --- | --- | --- |
SHA-1,
SHA-224,
SHA-256,
| Secure Hash  |     | SHA-384,  |     |     |     |     |
| ------------ | --- | --------- | --- | --- | --- | --- |
| Generation   |     | SHA-512,  |     |     |     |     |
Input: message
| (Perform  |               | SHA-512/256  |       |     |      |     |
| --------- | ------------- | ------------ | ----- | --- | ---- | --- |
|           | Output: Hash  |              | none  |     | N/A  | 1   |
| approved  |               | (except for  |       |     |      |     |
value
| security    |     | A2823)  |     |     |     |     |
| ----------- | --- | ------- | --- | --- | --- | --- |
| functions)  |     |         |     |     |     |     |

(#A2820, #A2818
#A2823, #A2817,
#A2816)
|     |     | Keyed Hash  |     | CO  |     |     |
| --- | --- | ----------- | --- | --- | --- | --- |
SHA-1,
SHA-224,
SHA-256,
SHA-384,
HMAC
|     | Input: HMAC key  | SHA-512,  |     |     |     |     |
| --- | ---------------- | --------- | --- | --- | --- | --- |
generation
|           | and message    | SHA-512/256  |           |     |       |     |
| --------- | -------------- | ------------ | --------- | --- | ----- | --- |
| (Perform  |                |              | HMAC key  |     | W, E  | 1   |
|           | Output: keyed  | (except for  |           |     |       |     |
approved
|     | Hash value  | A2823)  |     |     |     |     |
| --- | ----------- | ------- | --- | --- | --- | --- |
security

functions)
(#A2820,
#A2823, #A2818
#A2817, #A2816)

CO
|     | Input for  | Digital Signature  |     |     |     |     |
| --- | ---------- | ------------------ | --- | --- | --- | --- |

|     | SigGen:  |  Generation  |     |     |     |     |
| --- | -------- | ------------ | --- | --- | --- | --- |

|     | RSA private key  | (PKCS#1 v1.5)  |     |     |     |     |
| --- | ---------------- | -------------- | --- | --- | --- | --- |
RSA
|               | and message        | and (PKCS PSS)  |               |     |       |     |
| ------------- | ------------------ | --------------- | ------------- | --- | ----- | --- |
| signature     |                    |                 | RSA Key Pair  |     |       |     |
|               | Output:            | Signature       |               |     |       |     |
| generation    |                    |                 | (including    |     |       |     |
|               | signature          | Verification    |               |     |       |     |
| and           |                    |                 | intermediate  |     | W, E  | 1   |
|               |                    | (PKCS#1 v1.5)   |               |     |       |     |
| verification  |                    |                 | keygen        |     |       |     |
|               | Input for SigVer:  | and (PKCS PSS)  |               |     |       |     |
| (Perform      |                    |                 | values)       |     |       |     |
|               | RSA public key     |                 |               |     |       |     |
approved
|     | and signature  | (#A2820,  |     |     |     |     |
| --- | -------------- | --------- | --- | --- | --- | --- |
security
|     | Output: True or  | #A2817, #A2816,  |     |     |     |     |
| --- | ---------------- | ---------------- | --- | --- | --- | --- |
funct ions)
|     | False  | #A2818)  |     |     |     |     |
| --- | ------ | -------- | --- | --- | --- | --- |
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
|           |              |           | Keys and/or  |        | to         |     |
| --------- | ------------ | --------- | ------------ | ------ | ---------- | --- |
| Services  | Description  | Security  |              | Roles  | Indicator  |     |
|           |              |           | SSPs         |        | Keys       |     |
Functions
and/or
SSPs
CO
Digital Signature
Input for
Generation: P-
| ECDSA  | SigGen:  |     |     |     |     |     |
| ------ | -------- | --- | --- | --- | --- | --- |
224, P-256, P-
| signature     | ECDSA private      |                  |               |     |       |     |
| ------------- | ------------------ | ---------------- | ------------- | --- | ----- | --- |
|               |                    | 384, P-521       | ECDSA Key     |     |       |     |
| generation    | key and message    |                  |               |     |       |     |
|               |                    | Signature        | Pair          |     |       |     |
| and           | Output:            |                  |               |     |       |     |
|               |                    | Verification: P- | (including    |     |       |     |
| verification  | signature          |                  |               |     | W, E  | 1   |
|               |                    | 224, P-256, P-   | intermediate  |     |       |     |
| (Perform      | Input for SigVer:  |                  |               |     |       |     |
|               |                    | 384, P-521       | keygen        |     |       |     |
| approved      | ECDSA public key   |                  |               |     |       |     |
  values)
| security  | and signature  |     |     |     |     |     |
| --------- | -------------- | --- | --- | --- | --- | --- |
(#A2820,
| functions)  | Output: True or  |     |     |     |     |     |
| ----------- | ---------------- | --- | --- | --- | --- | --- |
#A2817, #A2816,
False
#A28 18)
|     |     | Random number  |     | CO  |     |     |
| --- | --- | -------------- | --- | --- | --- | --- |
generation

CTR_DRBG
(AES-128, AES-
|     |     | 256)  | Entropy Input  |     |     |     |
| --- | --- | ----- | -------------- | --- | --- | --- |
Random
|     | Input: Entropy  | #A2820, #A2821,  | String, Seed,  |     |     |     |
| --- | --------------- | ---------------- | -------------- | --- | --- | --- |
number
|     | input string,  | #A2815, #A2814,  | DRBG V and  |     |     |     |
| --- | -------------- | ---------------- | ----------- | --- | --- | --- |
generation
|           | nonce           | #A2822  | DRBG Key,  |     | G, R,    |     |
| --------- | --------------- | ------- | ---------- | --- | -------- | --- |
| (Perform  |                 |         |            |     |          | 1   |
|           | Output: Random  |         | random     |     | W, E, Z  |     |
approved
|     | numbers (DRBG  |     | numbers  |     |     |     |
| --- | -------------- | --- | -------- | --- | --- | --- |
security
|     | Output)  |     | (DRBG  |     |     |     |
| --- | -------- | --- | ------ | --- | --- | --- |
functions)
  Output)
HMAC_DRBG
(SHA-1, SHA2-
224, SHA2-256,
SHA2-384, SHA2-
512)
|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
Keys and/or  to
| Services  | Description  | Security  |     | Roles  | Indicator  |
| --------- | ------------ | --------- | --- | ------ | ---------- |
SSPs  Keys
Functions
and/or
SSPs
#A2820, #A2817,
#A2816, #A2818

#A2820, #A2817,
#A2816, #A2818

CK G
|     |     | Key Derivation  |     | CO  |     |
| --- | --- | --------------- | --- | --- | --- |
PBKDF
HMAC with:
PBKDF
| PBKDF  |     | SHA-1, SHA-224,  |     |     |     |
| ------ | --- | ---------------- | --- | --- | --- |
Derived Keys
| (Perform  | Input: password  | SHA-256, SHA- |     |     |     |
| --------- | ---------------- | ------------- | --- | --- | --- |
(including  G, R,
| approved  | Output: derived  | 384, SHA-512  |     |     | 1   |
| --------- | ---------------- | ------------- | --- | --- | --- |
password  W, E
| security  | key  |     |     |     |     |
| --------- | ---- | --- | --- | --- | --- |
hash), PBKDF
| functions)  |     | #A2820, #A2817,  |     |     |     |
| ----------- | --- | ---------------- | --- | --- | --- |
Password
#A2816, #A2818

CK G
|     |     | Key Derivation  |     | CO  |     |
| --- | --- | --------------- | --- | --- | --- |

KDF Mode:
Counter and
Feedback MAC
Mode: HMAC-
SHA-1, HMAC-
KBKDF
|     | Input: key  | SHA2-224, HMAC- | KBKDF Key  |     |     |
| --- | ----------- | --------------- | ---------- | --- | --- |
(Perform
|           | derivation key   | SHA2- 256,      | Derivation  | G, R,  |     |
| --------- | ---------------- | --------------- | ----------- | ------ | --- |
| approved  |                  |                 |             |        | 1   |
|           | Output: derived  | HMAC-SHA2-384,  | Key, KBKDF  | W, E   |     |
security
|     | key  | HMAC-SHA2-512  | Derived Key  |     |     |
| --- | ---- | -------------- | ------------ | --- | --- |
functions)
Supported
Lengths: 8-4096
Increment 8 Fixed
Data Order:
Before Fixed Data
Counter Length:
32 KDF Mode:
|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
Keys and/or  to
| Services  | Description  | Security  |     | Roles  | Indicator  |
| --------- | ------------ | --------- | --- | ------ | ---------- |
SSPs  Keys
Functions
and/or
SSPs
Counter AES-
CMAC based (for
A2820 only)

#A2820, #A2817,
#A2816, #A2818

CK G
CO

Key Pair
Generation
| ECDSA (key   |                  | (PKG): P-224, P-   |               |          |     |
| ------------ | ---------------- | ------------------ | ------------- | -------- | --- |
|              | Input: random    |                    | ECDSA Key     |          |     |
| pair         |                  | 256, P-384, P-521  |               |          |     |
|              | numbers          |                    | Pair          |          |     |
| generation)  |                  | Public Key         |               |          |     |
|              | Output:          |                    | (including    |          |     |
| (Perform     |                  | Validation (PKV):  |               | G, R, E  | 1   |
|              | generated        |                    | intermediate  |          |     |
| approved     |                  | P-224, P-256, P-   |               |          |     |
|              | private and      |                    | keygen        |          |     |
| security     |                  | 384, P-521         |               |          |     |
|              | public key pair  |                    | values)       |          |     |
| functions)   |                  | #A2820, #A2817,    |               |          |     |
#A2816, #A2818

CK G
|     |     | Asymmetric Key  |     | CO  |     |
| --- | --- | --------------- | --- | --- | --- |
RSA (key
|       | Input: random  | Generation  |               |     |     |
| ----- | -------------- | ----------- | ------------- | --- | --- |
| pair  |                |             | RSA Key Pair  |     |     |
prime numbers
| generation)  |                  |                  | (including    |          |     |
| ------------ | ---------------- | ---------------- | ------------- | -------- | --- |
|              | Output:          | Modulus 2048,    |               |          |     |
| (Perform     |                  |                  | intermediate  | G, R, E  | 1   |
|              | generated        | 3072, 4096       |               |          |     |
| approved     |                  |                  | keygen        |          |     |
|              | private and      | #A2820, #A2817,  |               |          |     |
| security     |                  |                  | values)       |          |     |
|              | public key pair  | #A2816, #A2818   |               |          |     |
functions)
CK G
|     | Input: domain  |     |     | CO  |     |
| --- | -------------- | --- | --- | --- | --- |
Diffie-
parameter,
| Hellman Key  |     |     | DH Key Pair  |     |     |
| ------------ | --- | --- | ------------ | --- | --- |
received public
| Shared  |     | KAS-FFC-SSC  | (including  |     |     |
| ------- | --- | ------------ | ----------- | --- | --- |
key and  G, R,
| Secret  |     |     | intermediate  |     | 1   |
| ------- | --- | --- | ------------- | --- | --- |
possessed  W, E
| Computation  |     | #A2820  | keygen  |     |     |
| ------------ | --- | ------- | ------- | --- | --- |
private key
| (Perform  |     |     | values)  |     |     |
| --------- | --- | --- | -------- | --- | --- |
Output: shared
approved
secret
|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
|           |              |           | Keys and/or  |        | to    |            |
| --------- | ------------ | --------- | ------------ | ------ | ----- | ---------- |
| Services  | Description  | Security  |              | Roles  |       | Indicator  |
|           |              |           | SSPs         |        | Keys  |            |
Functions
and/or
SSPs
security
functions)
| EC Diffie- |     |     |     | CO  |     |     |
| ---------- | --- | --- | --- | --- | --- | --- |
Input: domain
Hellman
|     | parameter,  |     | ECC CDH Key  |     |     |     |
| --- | ----------- | --- | ------------ | --- | --- | --- |
Shared
|              | received public  |              | Pair          |     |        |     |
| ------------ | ---------------- | ------------ | ------------- | --- | ------ | --- |
| Secret       |                  | KAS-ECC-SSC  |               |     |        |     |
|              | key and          |              | (including    |     | G, R,  |     |
| Computation  |                  |              |               |     |        | 1   |
|              | possessed        |              | intermediate  |     | W, E   |     |
| (Perform     |                  | #A2820       |               |     |        |     |
|              | private key      |              | keygen        |     |        |     |
approved
|     | Output: shared  |     | values)  |     |     |     |
| --- | --------------- | --- | -------- | --- | --- | --- |
security
secret
functions)
|              |                  | Safe primes key  |               | CO  |          |     |
| ------------ | ---------------- | ---------------- | ------------- | --- | -------- | --- |
|              | Input: key size  | pair generation  | DH Key Pair   |     |          |     |
| Safe primes  | Output:          |                  | (including    |     |          |     |
| key          | generated        | #A2820           | intermediate  |     | G, R, E  | 1   |
| generation   | private and      | CKG              | keygen        |     |          |     |
|              | public key pair  |                  | values)       |     |          |     |

| Release all   |                    |      |          | CO  |     |     |
| ------------- | ------------------ | ---- | -------- | --- | --- | --- |
| resources of  | Input: handler of  |      |          |     |     |     |
| symmetric     | symmetric crypto   |      |          |     |     |     |
| crypto        | function context   |      |          |     |     |     |
|               |                    | N/A  | AES key  |     | Z   | 1   |
| function      | Output: zeroised   |      |          |     |     |     |
| context       | and released       |      |          |     |     |     |
| (Perform      | memory space       |      |          |     |     |     |
zeroisation)
| Release all   |                    |      |           | CO  |     |     |
| ------------- | ------------------ | ---- | --------- | --- | --- | --- |
| resources of  | Input: handler of  |      |           |     |     |     |
| hash          | hash context       |      |           |     |     |     |
|               |                    | N/A  | HMAC key  |     | Z   | 1   |
| context       | Output: released   |      |           |     |     |     |
| (Perform      | memory space       |      |           |     |     |     |
zeroisation)
|     |     |     | DH Key Pair  | CO  |     |     |
| --- | --- | --- | ------------ | --- | --- | --- |
Release of
|     | Input: handler of  |     | (including  |     |     |     |
| --- | ------------------ | --- | ----------- | --- | --- | --- |
all resources
|     | (EC) Diffie-  |     | intermediate  |     |     |     |
| --- | ------------- | --- | ------------- | --- | --- | --- |
of Diffie-
|          | Hellman context   |      | keygen        |     |     |     |
| -------- | ----------------- | ---- | ------------- | --- | --- | --- |
| Hellman  |                   | N/A  |               |     | Z   | 1   |
|          | Output: zeroised  |      | values), ECC  |     |     |     |
context for
|     | and released  |     | CDH Key Pair  |     |     |     |
| --- | ------------- | --- | ------------- | --- | --- | --- |
Diffie-
|     | memory space  |     | (including  |     |     |     |
| --- | ------------- | --- | ----------- | --- | --- | --- |
Hellman and
intermediate
|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
|           |              |           | Keys and/or  |        | to         |     |
| --------- | ------------ | --------- | ------------ | ------ | ---------- | --- |
| Services  | Description  | Security  |              | Roles  | Indicator  |     |
|           |              |           | SSPs         |        | Keys       |     |
Functions
and/or
SSPs
| EC Diffie-    |     |     | keygen           |     |     |     |
| ------------- | --- | --- | ---------------- | --- | --- | --- |
| Hellman       |     |     | values), DH      |     |     |     |
| (Perform      |     |     | Shared Secret,   |     |     |     |
| zeroisation)  |     |     | ECC CDH          |     |     |     |
Shared Secret
| Release of     |                    |      | KBKDF Key    | CO  |     |     |
| -------------- | ------------------ | ---- | ------------ | --- | --- | --- |
| all resources  | Input: handler of  |      | Derivation   |     |     |     |
| of key         | key derivation     |      | Key, PBKDF   |     |     |     |
| derivation     | function context   |      | Password,    |     |     |     |
|                |                    | N/A  |              |     | Z   | 1   |
| function       | Output: zeroised   |      | KBKDF        |     |     |     |
| context        | and released       |      | Derived Key  |     |     |     |
| (Perform       | memory space       |      | and PBKDF    |     |     |     |
| zeroisation)   |                    |      | Derived Key  |     |     |     |
| Release of     |                    |      |              | CO  |     |     |
| all resources  | Input: handler of  |      |              |     |     |     |
| of             | asymmetric         |      |              |     |     |     |
| asymmetric     | crypto function    |      |              |     |     |     |
RSA/EC/DH
| crypto  | context  | N/A  |     |     | Z   | 1   |
| ------- | -------- | ---- | --- | --- | --- | --- |
keys
| function  | Output: zeroised  |     |     |     |     |     |
| --------- | ----------------- | --- | --- | --- | --- | --- |
| context   | and released      |     |     |     |     |     |
| (Perform  | memory space      |     |     |     |     |     |
zeroisation)
|     |     | AES-CCM  |     | CO  |     |     |
| --- | --- | -------- | --- | --- | --- | --- |
(#A2820,
#A2815, #A2814,
#A2821, #A2822)

AES-GCM
(#A2820,
#A2815, #A2814,
#A2821, #A2822)
| Self-test  | Input: power  |     |     |     |     |     |
| ---------- | ------------- | --- | --- | --- | --- | --- |

| (Perform  | Output: Pass/Fail  |     | All SSPs  |     | E   | 1   |
| --------- | ------------------ | --- | --------- | --- | --- | --- |
 AES-XTS
| Self-tests)  | status  |     |     |     |     |     |
| ------------ | ------- | --- | --- | --- | --- | --- |
(#A2820,
#A2815, #A2814,
#A2812, #A2813)

AES-CBC
(#A2820,
#A2815, #A2814,
A9819,
#A2812, #A2813)
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
Keys and/or to
Services Description Security Roles Indicator
SSPs Keys
Functions
and/or
SSPs
AES-ECB
(#A2820,
#A2815, #A2814,
#A2812, #A2813,
#A2821, #A2822)
HMAC_DRBG
(#A2820,
#A2817, #A2816,
#A2818)
CTR_DRBG,
#A2820, #A2821,
#A2815, #A2814,
#A2822
HMAC
(#A2820, #A2818
#A2823, #A2817,
#A2816)
RSA Signature
Generation
(#A2820,
#A2817, #A2816,
#A2818)
RSA Signature
Verification
(#A2820,
#A2817, #A2816,
#A2818)
ECDSA Signature
Generation
(#A2820,
#A2817, #A2816,
#A2818)
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Access
rights
Approved
|           |              | Keys and/or  |       |        | to         |
| --------- | ------------ | ------------ | ----- | ------ | ---------- |
| Services  | Description  | Security     |       | Roles  | Indicator  |
|           |              |              | SSPs  |        | Keys       |
Functions
and/or
SSPs
ECDSA Signature
Verification
(#A2820,
#A2817, #A2816,
#A2818)

 DH and ECDH Z
computation
(#A2820)

 PBKDF
(#A2820,
#A2817, #A2816,
#A2818)

 KBKDF
(#A2820,
#A2817, #A2816,
#A28 18)
|     | Input: API  |     |     | CO  |     |
| --- | ----------- | --- | --- | --- | --- |
invocation
Status
| Show Status  | Output:  | N/A  | None  |     | N/A  |
| ------------ | -------- | ---- | ----- | --- | ---- |
returned
Operational/Error
status
| Show         |             |     |     | CO  |     |
| ------------ | ----------- | --- | --- | --- | --- |
| Module Info  | Input: API  |     |     |     |     |
Versioning
| (Show     | invocation      |      |       |     |                   |
| --------- | --------------- | ---- | ----- | --- | ----------------- |
|           |                 | N/A  | None  |     | N/A  information  |
| module’s  | Output: Module  |      |       |     |                   |
returned
| versioning  | Base Name  |     |     |     |     |
| ----------- | ---------- | --- | --- | --- | --- |
information)
Table 9 – Approved Services

G = Generate: The module generates or derives the SSP.
R = Read: The SSP is read from the module (e.g., the SSP is output).
W = Write: The SSP is updated, imported, or written to the module.
E = Execute: The module uses the SSP in performing a cryptographic operation.
Z = Zeroise: The module zeroises the SSP.
N/A= The service does not access any SSP during its operation
  © 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

Algorithms
| Service  | Description  |     | Role  | Indicator  |
| -------- | ------------ | --- | ----- | ---------- |
Accessed
| Triple-DES    | Module does not meet      |     |     |     |
| ------------- | ------------------------- | --- | --- | --- |
| encryption /  | FIPS 140-3 IG C.G         |     |     |     |
| decryption    | because it does not have  |     |     |     |
  a control over the
  number of blocks to be
  encrypted under the
Crypto
  same Triple-DES key.
|     |     | Triple-DES  | Officer (CO)  | 0   |
| --- | --- | ----------- | ------------- | --- |
  Input for Encryption: key
  and plain text Output for
  Encryption: cipher text
  Input for Decryption: key
  and cipher text Output
  for Decryption:
   plain text

They are non-approved
encryption algorithms.

  Input for Encryption: key

  and plain text Output for
|                    |                            | Blowfish,    | Crypto        |     |
| ------------------ | -------------------------- | ------------ | ------------- | --- |
| (other) symmetric  | Encryption: cipher text    |              |               | 0   |
|                    |                            | CAST5, DES,  | Officer (CO)  |     |
| encryption /       | Input for Decryption: key  |              |               |     |
ECIES, RC2,
| decryption  | and cipher text Output  |     |     |     |
| ----------- | ----------------------- | --- | --- | --- |
RC4
for Decryption:
plain text
The CAST does not
perform the full KTS,
only the raw RSA
|                   | encrypt/decrypt  | RSA              | Crypto        |     |
| ----------------- | ---------------- | ---------------- | ------------- | --- |
| RSA Key Wrapping  |                  |                  |               | 0   |
|                   | Input:           | encrypt/decrypt  | Officer (CO)  |     |
RSA public key and key
to be wrapped Output:
wrapped key
|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

Algorithms
|     | Service  |     | Description  |     |     |     |     | Role  | Indicator  |
| --- | -------- | --- | ------------ | --- | --- | --- | --- | ----- | ---------- |
Accessed
ANSI X9.31 Key Pair
Generation Key Size <
2048
RSA Signature
|                        |     |                           | PKCS#1 v1.5 and PSS  |     |                 | RSA KeyGen  |               |         |     |
| ---------------------- | --- | ------------------------- | -------------------- | --- | --------------- | ----------- | ------------- | ------- | --- |
| Generation/Signature   |     |                           |                      |     |                 |             |               | Crypto  |     |
|                        |     | Signature Generation Key  |                      |     | RSA SigGen RSA  |             |               |         | 0   |
| Verification/Key-pair  |     |                           |                      |     |                 |             | Officer (CO)  |         |     |
|                        |     |                           | Size < 2048          |     |                 | SigVer      |               |         |     |
Generation
PKCS#1 v1.5 and PSS
Signature Verification
Key Size < 1024
ECDSA PKG, PKV,
|                       |               |                        |     |        |                | ECDSA PKG,  |               | Crypto  |     |
| --------------------- | ------------- | ---------------------- | --- | ------ | -------------- | ----------- | ------------- | ------- | --- |
|                       | Signature     | ECDSA keys with curve  |     |        |                |             |               |         |     |
|                       |               |                        |     |        |                | PKV,        | Officer (CO)  |         | 0   |
| Generation/Signature  |               |                        |     | P-192  |                |             |               |         |     |
|                       | Verification  |                        |     |        | SigGen/SigVer  |             |               |         |     |
Ed25519
|                        | Ed25519 Key   |     |              |     |     | KeyGen   |               | Crypto  |     |
| ---------------------- | ------------- | --- | ------------ | --- | --- | -------- | ------------- | ------- | --- |
| Generation, Signature  |               |     |              |     |     | Ed25519  | Officer (CO)  |         |     |
|                        |               |     | 256-bit key  |     |     |          |               |         | 0   |
| Generation/Signature   |               |     |              |     |     | SigGen   |               |         |     |
|                        | Verification  |     |              |     |     | Ed25519  |               |         |     |

SigVer
|                    | ANSI X9.63 Key  |     |                     |     |     |          |               | Crypto  |     |
| ------------------ | --------------- | --- | ------------------- | --- | --- | -------- | ------------- | ------- | --- |
|                    |                 |     | SHA-1 hash-based    |     |     | SHA-1    |               |         | 0   |
|                    | Derivation      |     |                     |     |     |          | Officer (CO)  |         |     |
| SP800-56Cr1 Key    |                 |     |                     |     |     |          |               | Crypto  |     |
|                    |                 |     | SHA-256 hash-based  |     |     | SHA-256  |               |         | 0   |
| Derivation (HKDF)  |                 |     |                     |     |     |          | Officer (CO)  |         |     |
SHA-256, SHA-
|     | RFC6637 Key  |     |                 |     |                |     |               | Crypto  |     |
| --- | ------------ | --- | --------------- | --- | -------------- | --- | ------------- | ------- | --- |
|     |              |     | SHA hash based  |     | 512, AES-128,  |     |               |         | 0   |
|     | Derivation   |     |                 |     |                |     | Officer (CO)  |         |     |
AES-256
OMAC Message
| Authentication Code  |                 | One-Key CBC MAC using  |              |     |     |       |               | Crypto  |     |
| -------------------- | --------------- | ---------------------- | ------------ | --- | --- | ----- | ------------- | ------- | --- |
|                      |                 |                        |              |     |     | OMAC  |               |         | 0   |
|                      | Generation and  |                        | 128-bit key  |     |     |       | Officer (CO)  |         |     |
Verification
Crypto
|     | Message digest  |     | Input: message  |     |     | MD2, MD4,  |     |     | 0   |
| --- | --------------- | --- | --------------- | --- | --- | ---------- | --- | --- | --- |
Officer (CO)
|                    | verification    |                         |                    |     |              | RIPEMD  |               |         |     |
| ------------------ | --------------- | ----------------------- | ------------------ | --- | ------------ | ------- | ------------- | ------- | --- |
|                    |                 | Output: message digest  |                    |     |              |         |               |         |     |
|                    |                 |                         |                    |     |              |         |               |         |     |
|                    |                 | KAS-FFC-SSC using key   |                    |     |              |         |               | Crypto  |     |
|                    | Diffie-Hellman  |                         |                    |     | KAS-FFC-SSC  |         |               |         | 0   |
|                    |                 |                         | sizes < 2048       |     |              |         | Officer (CO)  |         |     |
|                    |                 |                         | KAS-ECC-SSC using  |     |              |         |               | Crypto  |     |
| EC Diffie-Hellman  |                 |                         |                    |     | KAS-ECC-SSC  |         |               |         | 0   |
|                    |                 |                         | curves < P-224     |     |              |         | Officer (CO)  |         |     |
Input: peer public key,
|     | Ed25519 Key  |                          |     |     |     |          |               | Crypto  |     |
| --- | ------------ | ------------------------ | --- | --- | --- | -------- | ------------- | ------- | --- |
|     |              | own private key Output:  |     |     |     | Ed25519  |               |         | 0   |
|     | Agreement    |                          |     |     |     |          | Officer (CO)  |         |     |
shared secret
|                        |     |     | Encrypt: Input: peer                      |     |     | Integrated  |               |         |     |
| ---------------------- | --- | --- | ----------------------------------------- | --- | --- | ----------- | ------------- | ------- | --- |
| Integrated Encryption  |     |     |                                           |     |     |             |               | Crypto  |     |
|                        |     |     | public key, plaintext                     |     |     | Encryption  |               |         | 0   |
| Scheme on elliptic     |     |     |                                           |     |     |             | Officer (CO)  |         |     |
|                        |     |     | Output: public key,                       |     |     | Scheme on   |               |         |     |
|                        |     |     | © 2024 Apple Inc., All rights reserved.   |     |     |             |               |         |     |
This document may be reproduced and distributed only in its original entirely without revision

Algorithms
Service Description Role Indicator
Accessed
curves (ECIES) ciphertext (with elliptic curves
Encryption/Decryption authentication tag) (ECIES)
Decrypt: Input:
authentication tag,
ciphertext, own private
key Output: plaintext
message or error
Table 10 – Non-Approved Services
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

5. Software/Firmware Security
Integrity Techniques
The Apple corecrypto Module v12 [Intel, User, Software] is in the form of binary executable code. A
software integrity test is performed on the runtime image of the module. The HMAC-SHA2-256
implemented in the module is used as an approved algorithm for the integrity test. If the test fails, the
module enters an error state where no cryptographic services are provided and data output is prohibited
i.e. the module is not operational. The Software Integrity Key (HMAC-SHA2-256 with 256 bits of security
strength), a non-SSP, is stored in the module binary computed during build.
On-Demand Integrity Test
The integrity test is also performed as part of the Pre-Operational Self-Tests. It is automatically
executed at power-on. It can also be invoked by powering-off and reloading the module to meet the
on-demand request for integrity test.
In addition, the module provides the Self-Test service to perform self-tests, including integrity test
and algorithm tests, on demand.
Software Loading
The module does not support loading of any additional software.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

6. Operational Environment
Applicability
The Apple corecrypto Module v12 [Intel, User, Software] operates in a modifiable operational
environment per FIPS 140-3 level 1 specifications. The module is supplied as part of macOS Monterey
12, a commercially available general-purpose operating system executing on the hardware specified in
section 2.
Policy
The operating system is restricted to a single operator (single-user mode; i.e. concurrent operators are
explicitly excluded).
When the operating system loads the module into memory, it invokes the Self-Test functionality, which in
turn runs the mandatory self-tests.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

7. Physical Security
The FIPS 140-3 physical security requirements do not apply to the Apple corecrypto Module v12 [Intel,
User, Software] since it is a software module.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

8. Non-invasive Security
Currently, the non-invasive security is not required by FIPS 140-3 (see NIST SP 800-140F). The
requirements of this area are not applicable to the module.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

9. Sensitive Security Parameter Management

The following table summarizes the keys and Sensitive Security Parameters (SSPs) that are used by the
cryptographic services implemented in the module:

|     |     | Security  |     | Import  |     |     |     | Use  |
| --- | --- | --------- | --- | ------- | --- | --- | --- | ---- |
Key/SSP
|     | Stren | Function  | Generat |     | Establish | Storag | Zeroisat | and  |
| --- | ----- | --------- | ------- | --- | --------- | ------ | -------- | ---- |
Name/T
/Expor
|      | gth  | and Cert.  | ion  |     | ment  | e   | ion  | related  |
| ---- | ---- | ---------- | ---- | --- | ----- | --- | ---- | -------- |
| ype  |      |            |      | t   |       |     |      |          |
|      |      | Number     |      |     |       |     |      | keys     |
Symmetric
Encryption
and
Decryption
AES-CBC
(#A2820,
#A2815,
#A2814,
A9819,
#A2812,
#A2813)
AES-ECB

(#A2820,

|          |         | #A2815,   |      |           |      |          | Automati   |          |
| -------- | ------- | --------- | ---- | --------- | ---- | -------- | ---------- | -------- |
|          | Size:   |           |      |           |      | N/A:     |            |          |
|          |         | #A2814,   |      |           |      |          | c          |          |
|          | 128,    |           |      |           |      | The      |            |          |
|          |         | #A2812,   |      |           |      |          | zeroisatio |          |
|          | 192,    |           |      | Import    |      | module   |            |          |
|          |         | #A2813,   |      |           |      |          | n when     | Symmet   |
|          | 256     |           |      | and       |      | does     |            |          |
|          |         | #A2821,   |      |           |      |          | structure  | ric      |
|          |         |           |      | Export    |      | not      |            |          |
| AES Key  |         | #A2822)   |      |           |      |          | is         | Encrypti |
|          |         |           | N/A  | to        | N/A  | provide  |            |          |
| (CSP)    |         | AES-CCM   |      |           |      |          | deallocat  | on and   |
|          | Strengt |           |      | calling   |      | persist  |            |          |
|          |         | (#A2820,  |      |           |      |          | ed or      | Decrypti |
|          | h:      |           |      | applicati |      | ent      |            |          |
|          |         | #A2815,   |      |           |      |          | when the   | on       |
|          | 128,    |           |      | on        |      | keys/S   |            |          |
|          |         | #A2814,   |      |           |      |          | system is  |          |
|          | 192,    |           |      |           |      | SPs      |            |          |
|          |         | #A2821,   |      |           |      |          | powered    |          |
|          | 256     |           |      |           |      | storage  |            |          |
|          |         | #A2822)   |      |           |      |          | down       |          |

AES-GCM

(#A2820,
#A2815,
#A2814,
#A2821,
#A2822)
AES-
CFB128(#A2
820,
#A2815,
#A2814)
AES-
CFB8(#A282
|     |     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |     |
| --- | --- | ----------------------------------------- | --- | --- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

|     |     | Security  |     | Import  |     |     | Use  |
| --- | --- | --------- | --- | ------- | --- | --- | ---- |
Key/SSP
|     | Stren | Function  | Generat |     | Establish | Storag Zeroisat | and  |
| --- | ----- | --------- | ------- | --- | --------- | --------------- | ---- |
Name/T
/Expor
|      | gth  | and Cert.  | ion  |     | ment  | e  ion  | related  |
| ---- | ---- | ---------- | ---- | --- | ----- | ------- | -------- |
| ype  |      |            |      | t   |       |         |          |
|      |      | Number     |      |     |       |         | keys     |
0, #A2815,
#A2814)
AES-OFB
(#A2820,
#A2815,
#A2814)
AES-CTR
(#A2820,
#A2815,
#A2814,
#A2821,
#A2822)
AES-XTS
(#A2820,
#A2815,
#A2814,
#A2812,
#A2813)
CMAC
(#A2 820)

|     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- |
|     |     |     |     |     |     |     |     |

|     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- |
HMAC
generation
Min:
|     | 112   | SHA-1,     |     |     |     |     |     |
| --- | ----- | ---------- | --- | --- | --- | --- | --- |
|     | bits  | SHA2-224,  |     |     |     |     |     |
SHA2-256,
SHA2-384,
|     |     | SHA2-512  |     |     |     |     | Keyed  |
| --- | --- | --------- | --- | --- | --- | --- | ------ |
HMAC
|     |     | SHA2- |     |     | N/A  |     | Hash  |
| --- | --- | ----- | --- | --- | ---- | --- | ----- |
Key (CSP)
512/256

#A2820,
#A2818
#A2823,
#A2817,
#A2816
|           |         | ECDSA                                     | The key    |     |      |     |          |
| --------- | ------- | ----------------------------------------- | ---------- | --- | ---- | --- | -------- |
| ECDSA     |         | Keygen                                    | pairs are  |     |      |     | Digital  |
| Key Pair  | Curves  |                                           | generate   |     | N/A  |     | Signatu  |
| (CSP)     | :       | #A2820,                                   | d          |     |      |     | re       |
|           | P-224,  | #A2817,                                   | conforma   |     |      |     |          |
|           |         | © 2024 Apple Inc., All rights reserved.   |            |     |      |     |          |
This document may be reproduced and distributed only in its original entirely without revision

|     |     | Security  |     | Import  |     |     |     | Use  |
| --- | --- | --------- | --- | ------- | --- | --- | --- | ---- |
Key/SSP
|     | Stren | Function  | Generat |     | Establish | Storag Zeroisat |     | and  |
| --- | ----- | --------- | ------- | --- | --------- | --------------- | --- | ---- |
Name/T
/Expor
|      | gth     | and Cert.  | ion      |     | ment  | e   | ion  | related  |
| ---- | ------- | ---------- | -------- | --- | ----- | --- | ---- | -------- |
| ype  |         |            |          | t   |       |     |      |          |
|      |         | Number     |          |     |       |     |      | keys     |
|      | P-256,  | #A2816,    | nt to    |     |       |     |      |          |
|      | P-384,  | #A2818     | SP800-   |     |       |     |      |          |
|      | P-521   |            | 133r2    |     |       |     |      |          |
|      |         | CK G       | (CKG)    |     |       |     |      |          |
|      |         |            | using    |     |       |     |      |          |
|      | Strengt |            | FIPS186- |     |       |     |      |          |
|      |         |            |          |     |       |     |      |          |
|      | h:      |            | 4 Key    |     |       |     |      |          |
|      | 112,    |            | Generati |     |       |     |      |          |

|     | 128,  |     | on       |     |     |     |     |     |
| --- | ----- | --- | -------- | --- | --- | --- | --- | --- |
|     |       |     |          |     |     |     |     |     |
|     | 192,  |     | method,  |     |     |     |     |     |

|     | 256  |     | and the  |     |     |     |     |     |
| --- | ---- | --- | -------- | --- | --- | --- | --- | --- |

random
|     |     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
value
|     |     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
used in
the key
generatio

|     | Modulu |             | n is     |     |     |     |     |     |
| --- | ------ | ----------- | -------- | --- | --- | --- | --- | --- |
|     |        | RSA Keygen  | generate |     |     |     |     |     |
s:

|     |     |     | d using  |     |     |     |     |     |
| --- | --- | --- | -------- | --- | --- | --- | --- | --- |
2048,
#A2820,
|          | 3072,  |          | SP800-  |     |      |     |     | Digital  |
| -------- | ------ | -------- | ------- | --- | ---- | --- | --- | -------- |
|          |        | #A2817,  | 90Ar1   |     |      |     |     |          |
| RSA Key  | 4096   |          |         |     | N/A  |     |     | Signatu  |
#A2816,
DRBG
| Pair (CSP)  | Strengt |         |     |     |     |     |     | re  |
| ----------- | ------- | ------- | --- | --- | --- | --- | --- | --- |
|             |         | #A2818  |     |     |     |     |     |     |
h:
|     |     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
112,
CK G
|     |     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
128,
|     |     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
152
|     |     |           | Obtained  | Import  |      |     |     |         |
| --- | --- | --------- | --------- | ------- | ---- | --- | --- | ------- |
|     |     |           |           |         |      |     |     |         |
|     |     | CTR_DRBG  |           |         | N/A  |     |     | Random  |
|     |     |           | from the  | from    |      |     |     |         |
Entropy
(AES-128,
ENT
| Input  | 256  | AES-256)  |     |     |     |     |     |     |
| ------ | ---- | --------- | --- | --- | --- | --- | --- | --- |

|         |       |          |     |      |     |     |     |         |
| ------- | ----- | -------- | --- | ---- | --- | --- | --- | ------- |
| String  | bits  | #A2820,  |     | OS;  |     |     |     | Number  |

(CSP)
|     |     | #A2821,  |     |     |     |     |     |     |
| --- | --- | -------- | --- | --- | --- | --- | --- | --- |
#A2815,
|     |     |     |     |     |     |     |     |         |
| --- | --- | --- | --- | --- | --- | --- | --- | ------- |
|     |     |     |     | No  |     |     |     | Generat |
#A2814,
|     |     |     |     | Export  |     |     |     | ion  |
| --- | --- | --- | --- | ------- | --- | --- | --- | ---- |
#A2822
|     |     | HMAC_DRB | Derived  |     |     |     |     |     |
| --- | --- | -------- | -------- | --- | --- | --- | --- | --- |
from
G (SHA-1,
entropy
SHA-224,
| Seed   | 256   |           |            |     |      |     |     |     |
| ------ | ----- | --------- | ---------- | --- | ---- | --- | --- | --- |
|        |       | SHA-256,  | input      |     |      |     |     |     |
|        |       |           |            |     |      |     |     |     |
| (CSP)  | bits  |           | string as  |     | N/A  |     |     |     |
SHA-384,
defined
SHA-512)
|     |     | #A2820,  | by SP  |     |     |     |     |     |
| --- | --- | -------- | ------ | --- | --- | --- | --- | --- |
800-
#A2817,
90Ar1
|     |     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |     |
| --- | --- | ----------------------------------------- | --- | --- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

|     |     | Security  |     | Import  |     |     |     | Use  |
| --- | --- | --------- | --- | ------- | --- | --- | --- | ---- |
Key/SSP
|     | Stren | Function  | Generat |     | Establish | Storag | Zeroisat | and  |
| --- | ----- | --------- | ------- | --- | --------- | ------ | -------- | ---- |
Name/T
/Expor
|      | gth  | and Cert.  | ion  |     | ment  | e   | ion  | related  |
| ---- | ---- | ---------- | ---- | --- | ----- | --- | ---- | -------- |
| ype  |      |            |      | t   |       |     |      |          |
|      |      | Number     |      |     |       |     |      | keys     |
#A2816,
|     |     | #A2818  |     |     |     |     | Automati |     |
| --- | --- | ------- | --- | --- | --- | --- | -------- | --- |
N/A:
c
The
zeroisatio
module
|     |     |     | Generate |     |     |     | n when  |     |
| --- | --- | --- | -------- | --- | --- | --- | ------- | --- |
does
|     |     |     | d   |     |     |     | structure  |     |
| --- | --- | --- | --- | --- | --- | --- | ---------- | --- |
not
| DRBG V  |     |     | Internally  |      |      |          | is        | Generat |
| ------- | --- | --- | ----------- | ---- | ---- | -------- | --------- | ------- |
|         |     |     |             | N/A  | N/A  | provide  |           |         |
| (CSP)   |     |     | using the   |      |      |          | deallocat | ion     |
persist
|     |     |     | approved  |     |     |     | ed or  |     |
| --- | --- | --- | --------- | --- | --- | --- | ------ | --- |
ent
|     |     |     | DRBG  |     |     |     | when the  |     |
| --- | --- | --- | ----- | --- | --- | --- | --------- | --- |
keys/S
system is
SPs
powered
storage
down
Automati
N/A:
c
The
zeroisatio
module
|     |     |     | Generate |     |     |     | n when  |     |
| --- | --- | --- | -------- | --- | --- | --- | ------- | --- |
does
|     |     |     | d   |     |     |      | structure  |         |
| --- | --- | --- | --- | --- | --- | ---- | ---------- | ------- |
|     |     |     |     |     |     | not  |            | Generat |
256
| DRBG       |       |     | Internally  |      |      |          | is        |      |
| ---------- | ----- | --- | ----------- | ---- | ---- | -------- | --------- | ---- |
|            | bits  |     |             | N/A  | N/A  | provide  |           | ion  |
| Key (CSP)  |       |     | using the   |      |      |          | deallocat |      |
|            |       |     |             |      |      | persist  |           |      |
|            |       |     | approved    |      |      |          | ed or     |      |
ent
|     |     |     | DRBG  |     |     |     | when the  |     |
| --- | --- | --- | ----- | --- | --- | --- | --------- | --- |
keys/S
system is
SPs
powered
storage
down
CTR_DRBG
|     |     | (AES-128,  |     |     |     |     | Automati |     |
| --- | --- | ---------- | --- | --- | --- | --- | -------- | --- |
N/A:
c
AES-256)
The
|     |     | #A2820,  |     |     |     |     | zeroisatio |     |
| --- | --- | -------- | --- | --- | --- | --- | ---------- | --- |
module
|     |     | #A2821,  | Generate |     |     |     | n when  |     |
| --- | --- | -------- | -------- | --- | --- | --- | ------- | --- |
does
|         |     | #A2815,  | d           |      |      |          | structure  |         |
| ------- | --- | -------- | ----------- | ---- | ---- | -------- | ---------- | ------- |
| DRBG    |     |          |             |      |      | not      |            |         |
|         |     | #A2814,  | Internally  |      |      |          | is         | Generat |
| Output  |     |          |             | N/A  | N/A  | provide  |            |         |
#A2822
|        |     |              | using the  |     |     |         | deallocat | ion  |
| ------ | --- | ------------ | ---------- | --- | --- | ------- | --------- | ---- |
| (CSP)  |     |              |            |     |     | persist |           |      |
|        |     | HMAC_DRBG    | approved   |     |     |         | ed or     |      |
|        |     | (SHA-1, SHA- |            |     |     | ent     |           |      |
|        |     |              | DRBG       |     |     |         | when the  |      |
keys/S
224, SHA-
system is
|     |     | 256, SHA- |     |     |     | SPs  |     |     |
| --- | --- | --------- | --- | --- | --- | ---- | --- | --- |
powered
|     |     | 384, SHA- |     |     |     | storage  |     |     |
| --- | --- | --------- | --- | --- | --- | -------- | --- | --- |
down
512) #A2820,
|     |     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |     |
| --- | --- | ----------------------------------------- | --- | --- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

|     |     | Security  |     | Import  |     |     | Use  |
| --- | --- | --------- | --- | ------- | --- | --- | ---- |
Key/SSP
|     | Stren | Function  | Generat |     | Establish | Storag Zeroisat | and  |
| --- | ----- | --------- | ------- | --- | --------- | --------------- | ---- |
Name/T
/Expor
|      | gth  | and Cert.  | ion  |     | ment  | e  ion  | related  |
| ---- | ---- | ---------- | ---- | --- | ----- | ------- | -------- |
| ype  |      |            |      | t   |       |         |          |
|      |      | Number     |      |     |       |         | keys     |
#A2817,
#A2816,
#A2818

CKG

|          |       |          | Internally  |          |      |     | Key      |
| -------- | ----- | -------- | ----------- | -------- | ---- | --- | -------- |
|          | Min:  |          |             | No       |      |     |          |
|          |       |          | generate    |          | N/A  |     | Derivati |
| PBKDF    | 112   |          |             | Import;  |      |     |          |
|          |       | PBKDF    | d via       |          |      |     | on       |
| Derived  | bits  |          |             |          |      |     |          |
|          |       | #A2820,  | SP800-      |          |      |     |          |
Keys
|             |     | #A2817,  | 132       |           |     |     |     |
| ----------- | --- | -------- | --------- | --------- | --- | --- | --- |
| (including  |     |          |           | Export    |     |     |     |
|             |     | #A2816,  | PBKDF     |           |     |     |     |
| password    |     |          |           | to        |     |     |     |
|             |     | #A2818   | key       |           |     |     |     |
| hash)       |     |          |           | calling   |     |     |     |
|             |     | CK G     | derivatio |           |     |     |     |
| (CSP)       |     |          |           | applicati |     |     |     |
n
on
algorithm
|        |      | PBKDF    |      | importe |      |     |     |
| ------ | ---- | -------- | ---- | ------- | ---- | --- | --- |
| PBKDF  | N/A  |          | N/A  |         | N/A  |     |     |
|        |      | #A2820,  |      | d       |      |     |     |
#A2817,
Key
| Password  |     | #A2816,  |     | from  |     |     |     |
| --------- | --- | -------- | --- | ----- | --- | --- | --- |
Derivati
| (CSP)  |     | #A2818  |     | calling  |     |     |     |
| ------ | --- | ------- | --- | -------- | --- | --- | --- |
on

|     |     |     |     | applicati |     |     |     |
| --- | --- | --- | --- | --------- | --- | --- | --- |
on,
No
|     |     |     |     |     |     |     |     |
| --- | --- | --- | --- | --- | --- | --- | --- |
Export
| KBKDF     |       | KBKDF Key    |             |         |      |     |     |
| --------- | ----- | ------------ | ----------- | ------- | ---- | --- | --- |
| Key       |       | Derivation   |             |         |      |     |     |
|           | Min:  |              |             | importe |      |     |     |
| Derivatio |       | KDF Mode:    | N/A         |         | N/A  |     |     |
|           | 112   |              |             | d       |      |     |     |
| n Key     |       | Counter and  |             |         |      |     |     |
| (CSP)     |       | Feedback     |             |         |      |     |     |
|           |       | MAC Mode:    | Internally  |         |      |     |     |
|           |       | HMAC-SHA-    | generate    |         |      |     |     |
|           |       | 1, HMAC-     | d via       |         |      |     |     |
No
|     |     | SHA2-224,  | SP800-  |     |     |     |     |
| --- | --- | ---------- | ------- | --- | --- | --- | --- |
Import;
| KBKDF  | Min:  | HMAC- | 108  |     |     |     |     |
| ------ | ----- | ----- | ---- | --- | --- | --- | --- |
Export
| Derived  | 112   | SHA2- 256,  | KBKDF  |     |      |     | Key      |
| -------- | ----- | ----------- | ------ | --- | ---- | --- | -------- |
|          |       |             |        | to  | N/A  |     |          |
| Key      | bits  | HMAC-       | key    |     |      |     | Derivati |
calling
| (CSP)  |     | SHA2-384,  | derivatio |     |     |     | on   |
| ------ | --- | ---------- | --------- | --- | --- | --- | ---- |
applicati
|     |     | HMAC- | n   |     |     |     |     |
| --- | --- | ----- | --- | --- | --- | --- | --- |
on
|     |     | SHA2-512  | algorithm  |     |     |     |     |
| --- | --- | --------- | ---------- | --- | --- | --- | --- |

#A2820,
|     |     | #A2817,                                   |     |     |     |     |     |
| --- | --- | ----------------------------------------- | --- | --- | --- | --- | --- |
|     |     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |
This document may be reproduced and distributed only in its original entirely without revision

|     | Security  |     | Import  |     |     | Use  |
| --- | --------- | --- | ------- | --- | --- | ---- |
Key/SSP
|     | Stren Function  | Generat |     | Establish | Storag Zeroisat | and  |
| --- | --------------- | ------- | --- | --------- | --------------- | ---- |
Name/T
/Expor
|      | gth  and Cert.  | ion  |     | ment  | e  ion  | related  |
| ---- | --------------- | ---- | --- | ----- | ------- | -------- |
| ype  |                 |      | t   |       |         |          |
Number  keys
#A2816,
#A2818

KBKDF
|     |   CMAC based  |     |     |     |     |     |
| --- | ------------- | --- | --- | --- | --- | --- |
(for A2820
only)

CKG

Generate
d
using
Import
Safe-
from
prime
| DH Key  |     |     | calling  |     |     |     |
| ------- | --- | --- | -------- | --- | --- | --- |
groups
| Pair  |     |     | applicati | N/A  |     |     |
| ----- | --- | --- | --------- | ---- | --- | --- |
MODP
| (CSP)  |     |     | on,  |     |     |     |
| ------ | --- | --- | ---- | --- | --- | --- |
groups
No
belongin
Export
KAS-FFC- g
KAS-
SSC  to (RFC
|     | 2048  |     |     |     |     | SSC  |
| --- | ----- | --- | --- | --- | --- | ---- |
#A2820  3526)
FFC
  CKG
Computed
No
using
Import;
| DH  |     |     |     | SP800-  |     |     |
| --- | --- | --- | --- | ------- | --- | --- |
Export
| Shared  |     |      |     | 56Ar3 DH  |     |     |
| ------- | --- | ---- | --- | --------- | --- | --- |
|         |     | N/A  | to  |           |     |     |
| Secret  |     |      |     | shared    |     |     |
calling
| (CSP)  |     |     |     | secret  |     |     |
| ------ | --- | --- | --- | ------- | --- | --- |
applicati
computatio
on
n
|     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |
| --- | ----------------------------------------- | --- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

|     |     | Security  |     | Import  |     |     |     | Use  |
| --- | --- | --------- | --- | ------- | --- | --- | --- | ---- |
Key/SSP
|     | Stren | Function  | Generat |     | Establish | Storag Zeroisat |     | and  |
| --- | ----- | --------- | ------- | --- | --------- | --------------- | --- | ---- |
Name/T
/Expor
|      | gth  | and Cert.  | ion  |     | ment  | e   | ion  | related  |
| ---- | ---- | ---------- | ---- | --- | ----- | --- | ---- | -------- |
| ype  |      |            |      | t   |       |     |      |          |
|      |      | Number     |      |     |       |     |      | keys     |
Generate
d using
FIPS
186-4
Curves
|     | :       |     | Key      |     |     |     |     |     |
| --- | ------- | --- | -------- | --- | --- | --- | --- | --- |
|     | P-224,  |     | Generati |     |     |     |     |     |
on
|     | P-256,  |          |          |         |     |     |     |     |
| --- | ------- | -------- | -------- | ------- | --- | --- | --- | --- |
|     | P-384,  |          | method,  | Import  |     |     |     |     |
|     | P-521   | KAS-ECC- | and the  | from    |     |     |     |     |
KAS-
| ECC CDH  |     | SSC     | random  | calling   |      |     |     |      |
| -------- | --- | ------- | ------- | --------- | ---- | --- | --- | ---- |
|          |     |         |         |           | N/A  |     |     | SSC  |
| Key      |     | #A2820  | value   | applicati |      |     |     |      |
ECC
| Pair (CSP)  | Strengt | CKG  | used in   | on,     |     |     |     |     |
| ----------- | ------- | ---- | --------- | ------- | --- | --- | --- | --- |
|             | h:      |      | key       | No      |     |     |     |     |
|             | 112,    |      | generatio | Export  |     |     |     |     |
|             | 128,    |      | n is      |         |     |     |     |     |
|             | 192,    |      | generate  |         |     |     |     |     |
|             | 256     |      | d using   |         |     |     |     |     |
SP800-
90Ar1
|     |     |     | DRBG    |     |     |     |     |     |
| --- | --- | --- | ------- | --- | --- | --- | --- | --- |
Curves
:
|     | P-224,  |     | Internally  |     |     |     |     |     |
| --- | ------- | --- | ----------- | --- | --- | --- | --- | --- |
|     | P-256,  |     | generate    |     |     |     |     |     |
No
|     | P-384,  |     | d via  |     |     |     |     |     |
| --- | ------- | --- | ------ | --- | --- | --- | --- | --- |
Import;
| ECC CDH  | P-521   |          | SP800-   |          |      |     |     |      |
| -------- | ------- | -------- | -------- | -------- | ---- | --- | --- | ---- |
|          |         | KAS-ECC- |          | Export   |      |     |     | KAS- |
| Shared   |         |          | 56Ar3    |          |      |     |     |      |
|          |         | SSC      |          | to       | N/A  |     |     | SSC  |
| Secret   |         |          | ECC CDH  |          |      |     |     |      |
|          |         | #A2820   |          | calling  |      |     |     | ECC  |
| (CSP)    | Strengt |          | shared   |          |      |     |     |      |
applicati
|     | h:  |     | secret  |     |     |     |     |     |
| --- | --- | --- | ------- | --- | --- | --- | --- | --- |
on
|     | 112,  |     | computat |     |     |     |     |     |
| --- | ----- | --- | -------- | --- | --- | --- | --- | --- |
|     | 128,  |     | io n     |     |     |     |     |     |
192,
256
Table 11 – SSPs

The Software Integrity Key (HMAC-SHA2-256 with 256 bits of security strength), a non-SSP, is stored in
the module binary computed during build.

Random Number Generation
A NIST approved deterministic random bit generator based on a block cipher as specified in NIST [SP
800-90Ar1] is used. The default Approved DRBG used for random number generation is a CTR_DRBG
|     |     | © 2024 Apple Inc., All rights reserved.   |     |     |     |     |     |     |
| --- | --- | ----------------------------------------- | --- | --- | --- | --- | --- | --- |
This document may be reproduced and distributed only in its original entirely without revision

using AES-256 with derivation function and without prediction resistance. The random numbers used for
key generation are all generated by CTR_DRBG in this module. Per section 10.2.1.1 of [SP 800-90Ar1],
the internal state of CTR_DRBG is the value V, Key and a reseed counter.
The module also employs a HMAC_DRBG for random number generation. The HMAC_DRBG is only used
at the early boot time of macOS User for memory randomization. The output of HMAC_DRBG is not
used for key generation. Per section 10.1.2.1 of [SP 800-90Ar1], the internal state of HMAC_DRBG is
the value V, Key and a reseed counter.
The deterministic random bit generators are seeded by read_random. The read_random is the User
Space interface that extracts random bits from the entropy pool. The output of entropy pool provides
256-bits of entropy to seed and reseed SP800-90B DRBG during initialization (seed) and reseeding
(reseed).
Minimum number of bits
Entropy sources Details
of entropy
NISP SP800-90B
The seed is provided by an
compliant ENT (P) 256-bits per 256-bit
SP 800-90B compliant
output sample
ESV Cert. #E14
entropy source
Table 12 – Non-Deterministic Random Number Generation Specification
Key / SSP Generation
The module generates Keys and SSPs in accordance with FIPS 140-3 IG D.H. The cryptographic module
performs Cryptographic Key Generation (CKG) for asymmetric keys as per sections 4, 5.1, 5.2, 6.2.2 and
6.2.3 [SP800-133r2] (vendor affirmed), compliant with [FIPS186-4], and using DRBG compliant with
[SP800-90Ar1]. A seed (i.e., the random value) used in asymmetric key pair generation is a direct output
from [SP800-90Ar1] CTR_DRBG. The key generation service for RSA, Diffie-Hellman, and EC key pairs as
well as the [SP 800-90Ar1] DRBG have been ACVT tested with algorithm certificates found in Table 4.
Keys/SSPs Establishment
The module provides the following key/SSP establishment services in the Approved mode:
• AES-Key Wrapping
The module implements a Key Transport Scheme (KTS) using AES-KW compliant to [SP800-
o
38F]. The SSP establishment methodology provides between 128 and 256 bits of encryption
strength.
• Diffie-Hellman Shared Secret Computation
The module implements a shared secret compliant to [SP800-56Ar3]. The shared secret
o
computation provides between 112 and 200 bits of encryption strength.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

• EC Diffie-Hellman Shared Secret Computation
The module implements a shared secret Z compliant to [SP800-56Ar3]. The shared secret
o
computation provides between 112 and 256 bits of encryption strength.
• PBKDF Key Derivation
The module implements a CAVP compliance tested key derivation function compliant to
o
[SP800-132]. The service returns the key derived from the provided password to the caller.
The password consists of at least eight alphanumeric characters from the ninety-six (96)
printable and human- readable characters2. PBKDFv2 is implemented to support all options
specified in section 5.4 of [SP800-132]. The keys derived from [SP800-132] map to section
4.1 of [SP800-133r2] as indirect generation from DRBG. The derived keys may only be used in
storage applications.
• KBKDF Key Derivation
The KBKDF is compliant to [SP800-108]. The module implements both Counter and Feedback
o
modes with HMAC-SHA-1, HMAC-SHA2-224, HMAC-SHA2-256, HMAC-SHA2-384, or HMAC-
SHA2-512 as the PRF.
Keys/SSPs Import/Export
All keys and SSPs that are entered from, or output to module, are entered from or output to the invoking
application running on the same device. Keys/SSPs entered into the module are electronically entered in
plain text form. Keys/SSPs are output from the module in plain text form if required by the calling
application.
The module allows the output of plaintext CSPs (i.e., EC/DH/RSA Key Pairs). To prevent inadvertent
output of sensitive information, the module performs the following two independent internal actions:
1. The module will internally request the random number generation service to obtain the random
numbers and verify that the service completed without errors.
2. Once the keys are generated the module will perform the pairwise consistency test and verify that the
test is completed without errors.
Only after successful completion of both actions, are the generated CSPs output via the KPI output
parameter in plaintext.
Keys/SSPs Storage
The Apple corecrypto Module v12 [Intel, User, Software] stores ephemeral keys/SSPs in memory only.
They are received for use or generated by the module only at the command of the calling application. The
module does not provide persistent keys/SSPs storage.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

The module protects all keys/SSPs through the memory separation and protection mechanisms provided
by the operating system. No process other than the module itself can access the keys/SSPs in its process’
memory.
Keys/SSPs Zeroization
Keys and SSPs are zeroised when the appropriate context object is destroyed or when the system is
powered down. Input and output interfaces are inhibited while zeroisation is performed.
© 2024 Apple Inc., All rights reserved.
This document may be reproduced and distributed only in its original entirely without revision

10. Self-tests
The module performs pre-operational self-tests automatically when the module is loaded into
memory; the pre- operational self-tests triggered at power-on ensure that the module is not
corrupted and that the cryptographic algorithms work as expected.
FIPS 140-3 only requires that software/firmware integrity test(s) and the requisite cryptographic
algorithm(s) be tested during power-up, but the Apple corecrypto Module v12 [Intel, User,
Software] runs all Cryptographic Algorithm Tests (CASTs) during power-up as well.
The following tests are performed each time the Apple corecrypto Module v12 [Intel, User,
Software] starts. If any of the following tests fails the device (tested platform) fails to
startup. To invoke the self-tests (pre-operational and CASTs) on demand (and periodically),
the user may reboot the system.
While the module is executing the self-tests, services are not available and input and
output are inhibited. The self-tests are implemented for the following algorithms:
• Pre-operational Self-Tests:
o HMAC-SHA2-256: Used for module integrity test
• Conditional Self-Tests:
o Conditional Cryptographic Algorithm Self-tests (CAST):
 AES CBC 128 bits Encrypt KAT
 AES CCM 128 bits Encrypt KAT
 AES GCM 128 bits Encrypt KAT
 AES XTS 128 bits Encrypt KAT
 AES ECB 128 bits Encrypt KAT
 AES CMAC 128 bits Encrypt KAT
 AES CBC 128 bits Decrypt KAT
 AES CCM 128 bits Decrypt KAT
 AES GCM 128 bits Decrypt KAT
 AES XTS 128 bits Decrypt KAT
 AES ECB 128 bits Decrypt KAT
 AES CMAC 128 bits Decrypt KAT
 CTR_DRBG KAT
▪ Generate, Instantiate and Reseed
 HMAC_DRBG KAT
▪ Generate, Instantiate and Reseed
 HMAC-SHA-1 KAT; covers SHA-1 KAT
 HMAC-SHA2-256 KAT; covers SHA2-256 KAT
 HMAC-SHA2-512 KAT; covers SHA2-512 KAT
Version 1.0 Page 48 of 52
Public Material – May be reproduced only in its original entirety (without revision).

 RSA 2048 bits SHA2-256 Signature Generation
KAT
 RSA 2048 bits SHA2-256 Verify KAT
 ECDSA P-224 SHA2-224 Sig Gen KAT
 ECDSA P-224 SHA2-224 Sig Ver KAT
 KAS-FFC-SSC KAT
 KAS-ECC-SSC KAT
 PBKDF KAT
 KBKDF counter KAT
 NIST SP 800-90B Repetitive Count Test (RCT)
 NIST SP 800-90B Adaptive Proportion Test (APT)
o Pairwise consistency test when generating ECDSA key pairs (for signature
generation/verification/key agreement (KAS-ECC-SSC))
o Pairwise consistency test when generating RSA key pairs (for signature
generation/verification)
o Pairwise consistency test when generating DH key pairs (for key agreement)
Integrity Test
A software integrity test is performed on the runtime image of the Apple corecrypto Module
v12 [Intel, User, Software]. The module’s HMAC-SHA2-256 is used as an approved algorithm
for the integrity test. If the test fails, then the device powers itself off. The HMAC value is
pre-computed at build time and stored in the module. The HMAC value is recalculated during
runtime and compared with the stored value.
Conditional Tests
The following sub-sections describe the conditional tests supported by the Apple
corecrypto Module v12 [Intel, User, Software].
Cryptographic algorithm tests
The Apple corecrypto Module v12 [Intel, User, Software] runs all Cryptographic
Algorithm Tests during power-up. These tests are detailed above in this section.
Pairwise Consistency Test
The Apple corecrypto Module v12 [Intel, User, Software] does generate asymmetric keys and
performs all required pair-wise consistency tests on the newly generated key pairs.
Error Handling
If any of the above-mentioned self-tests fail, the module reports the cause of the error and
enters an error state where no cryptographic services are provided and data output is
Version 1.0 Page 49 of 52
Public Material – May be reproduced only in its original entirety (without revision).

prohibited. The only method to clear the error state is to power cycle the device. The
module will only enter into the operational state after successfully passing the preoperational
software integrity test and the Conditional CASTs. The module returns the “FAILED:
fipspost_post_integrity” error indicator in case of a software integrity test failure, “FAILED:
<algorithm>” in case of a CAST failure.
Version 1.0 Page 50 of 52
Public Material – May be reproduced only in its original entirety (without revision).

11. Life-cycle Assurance
Delivery and Operation
The module is built into macOS Monterey 12 and delivered with macOS. There is no standalone
delivery of the module as a software library.
The vendor’s internal development process guarantees that the correct version of module goes
with its intended macOS version. For additional assurance, the module is digitally signed by
vendor and it is verified during the integration into macOS.
This digital signature-based integrity protection during the delivery/integration process is
not to be confused with the HMAC-SHA2-256 based integrity check performed by the module
itself as its pre-operational self-test. No additional maintenance requirements apply.
Crypto Officer Guidance
The Approved mode of operation is configured in the system by default and can only be
transitioned into the non-Approved mode by calling one of the non-Approved services listed
in Table 10 - Non-Approved Services. If the device starts up successfully, then the module
has passed all self-tests and is operating in the Approved mode.
A Crypto Officer Role Guide is provided by Apple which offers IT System Administrators with
the necessary technical information to ensure FIPS 140-3 Compliance of macOS Monterey 12
systems. This guide walks the reader through the system’s assertion of cryptographic module
integrity and the steps necessary if module integrity requires remediation. A link to the
Guide can be found on the Product security, validations, and guidance page.
Version 1.0 Page 51 of 52
Public Material – May be reproduced only in its original entirety (without revision).

12. Mitigation of Other Attacks
The module does not claim mitigation of other attacks.
Version 1.0 Page 52 of 52
Public Material – May be reproduced only in its original entirety (without revision).