STMicroelectronics

Trusted Platform Module ST33KTPM2A / ST33KTPM2I

FIPS 140-3 Non-Proprietary Security Policy

Document Version: 04-02
Date: 2025-11-13

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 1 of 96

Table of Contents

1 General ................................................................................................................................... 6
1.1 Overview .......................................................................................................................... 6
1.2 Security Levels ................................................................................................................. 6
2 Cryptographic Module Specification ........................................................................................ 7
2.1 Description ....................................................................................................................... 7
2.2 Tested and Vendor Affirmed Module Version and Identification ........................................ 9
2.3 Excluded Components .....................................................................................................10
2.4 Modes of Operation .........................................................................................................10
2.5 Algorithms .......................................................................................................................11
2.6 Security Function Implementations ..................................................................................15
2.7 Algorithm Specific Information .........................................................................................18
2.8 RBG and Entropy ............................................................................................................18
2.9 Key Generation................................................................................................................19
2.10 Key Establishment .........................................................................................................19
2.11 Industry Protocols ..........................................................................................................19
3 Cryptographic Module Interfaces............................................................................................20
3.1 Ports and Interfaces ........................................................................................................20
3.2 Pinout description ............................................................................................................21
4 Roles, Services, and Authentication .......................................................................................25
4.1 Authentication Methods ...................................................................................................25
4.2 Roles ...............................................................................................................................25
4.3 Approved Services ..........................................................................................................26
4.4 Non-Approved Services ...................................................................................................64
4.5 External Software/Firmware Loaded ................................................................................68
5 Software/Firmware Security ...................................................................................................69
5.1 Integrity Techniques ........................................................................................................69
5.2 Initiate on Demand ..........................................................................................................69
6 Operational Environment........................................................................................................70
6.1 Operational Environment Type and Requirements ..........................................................70
7 Physical Security ....................................................................................................................71
7.1 Mechanisms and Actions Required..................................................................................71
7.2 EFP/EFT Information .......................................................................................................71
7.3 Hardness Testing Temperature Ranges ..........................................................................73
8 Non-Invasive Security ............................................................................................................74
8.1 Mitigation Techniques ......................................................................................................74

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 2 of 96

9 Sensitive Security Parameters Management ..........................................................................75
9.1 Storage Areas .................................................................................................................75
9.2 SSP Input-Output Methods ..............................................................................................75
9.3 SSP Zeroization Methods ................................................................................................77
9.4 SSPs ...............................................................................................................................77
9.5 Transitions .......................................................................................................................82
10 Self-Tests .............................................................................................................................84
10.1 Pre-Operational Self-Tests ............................................................................................84
10.2 Conditional Self-Tests ....................................................................................................84
10.3 Periodic Self-Test Information ........................................................................................86
10.4 Error States ...................................................................................................................87
11 Life-Cycle Assurance ...........................................................................................................88
11.1 Installation, Initialization, and Startup Procedures ..........................................................88
11.2 Administrator Guidance .................................................................................................90
11.3 Non-Administrator Guidance ..........................................................................................91
11.4 Design and Rules ..........................................................................................................91
11.5 End of Life .....................................................................................................................91
12 Mitigation of Other Attacks ...................................................................................................93
References and Definitions .......................................................................................................94

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 3 of 96

List of Tables

Table 1: Security Levels ............................................................................................................. 6
Table 2: Tested Module Identification – Hardware ..................................................................... 9
Table 3: Modes List and Description .........................................................................................11
Table 4: Approved Algorithms ...................................................................................................13
Table 5: Vendor-Affirmed Algorithms ........................................................................................13
Table 6: Non-Approved, Allowed Algorithms .............................................................................14
Table 7: Non-Approved, Allowed Algorithms with No Security Claimed .....................................14
Table 8: Non-Approved, Not Allowed Algorithms .......................................................................15
Table 9: Security Function Implementations ..............................................................................18
Table 10: Entropy Certificates ...................................................................................................18
Table 11: Entropy Sources ........................................................................................................19
Table 12: Ports and Interfaces ..................................................................................................20
Table 13 – UFQFPN32 / UFQFPN32 WF Pins Definition .....................................................................22
Table 14 – TSSOP20 Pins Definition ................................................................................................23
Table 15 – WLCSP24 Pins Definition ...............................................................................................24
Table 16: Authentication Methods .............................................................................................25
Table 17: Roles .........................................................................................................................26
Table 18 – Mapping between services............................................................................................26
Table 19: Approved Services ....................................................................................................62
Table 20: Non-Approved Services.............................................................................................67
Table 21: Mechanisms and Actions Required ...........................................................................71
Table 22: EFP/EFT Information .................................................................................................72
Table 23: Hardness Testing Temperatures ...............................................................................73
Table 24: Storage Areas ...........................................................................................................75
Table 25: SSP Input-Output Methods ........................................................................................76
Table 26: SSP Zeroization Methods ..........................................................................................77
Table 27: SSP Table 1 ..............................................................................................................79
Table 28: SSP Table 2 ..............................................................................................................82
Table 29 – Security Strength of a Key Depending on the Underlying Algorithm Used and its Size ..........83
Table 30: Pre-Operational Self-Tests ........................................................................................84
Table 31: Conditional Self-Tests ...............................................................................................85
Table 32: Pre-Operational Periodic Information .........................................................................86
Table 33: Conditional Periodic Information ................................................................................87
Table 34: Error States ...............................................................................................................87
Table 35 – List of policy commands to use in a policy session ............................................................89
Table 36 – ZA9 Module Configuration ............................................................................................89
Table 37 – AC5 Module Configuration ............................................................................................90
Table 38 – ZB1 Module Configuration ............................................................................................90
Table 39 – AD6 Module Configuration ............................................................................................90
Table 40 – References ..................................................................................................................95
Table 41 – Acronyms and Definitions .............................................................................................96

List of Figures

Figure 1 – HW block diagram ..................................................................................................... 8

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 4 of 96

Figure 2 – UFQFPN32 WF Package .......................................................................................... 9
Figure 3 – TSSOP20 Package ..................................................................................................10
Figure 4 – WLCSP24 Package .................................................................................................10
Figure 5 – UFQFPN32 / UFQFPN32 WF Pinout Diagram .........................................................22
Figure 6 – TSSOP20 Pinout Diagram .......................................................................................23
Figure 7 – WLCSP24 Pinout Diagram bottom view ...................................................................24
Figure 8 – Firmware block diagram ...........................................................................................69

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 5 of 96

1 General

1.1 Overview

This  document  is  the  non-proprietary  FIPS  140-3  Security  Policy  for  the  STMicroelectronics  Trusted
Platform Module ST33KTPM2A / ST33KTPM2I (ST33KTPM2A is also branded commercially “STSAFE-V100-
TPM”). It contains the security rules under which the Module must operate and describes how this module
meets  the  requirements  as  specified  in  FIPS  PUB  140-3  (Federal  Information  Processing  Standards
Publication 140-3) for an overall Security Level 2 module.

1.2 Security Levels

The FIPS 140-3 security levels for the Module are listed in table below:

Section
1
2
3
4
5
6
7
8
9
10
11
12

Title
General
Cryptographic module specification
Cryptographic module interfaces
Roles, services, and authentication
Software/Firmware security
Operational environment
Physical security
Non-invasive security
Sensitive security parameter management
Self-tests
Life-cycle assurance
Mitigation of other attacks
Overall Level

Security Level
2
2
2
2
2
N/A
3
N/A
2
2
2
N/A
2

Table 1: Security Levels

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 6 of 96

2 Cryptographic Module Specification

The ST33KTPM2A / ST33KTPM2I module, hereafter denoted as the Module, is a fully integrated security
module implementing the revision 1.59 of the Trusted Computing Group (TCG) specification for Trusted
Platform Modules (TPM) version 2.0.

2.1 Description

Purpose and Use:

The Module is intended for use by US Federal agencies or other markets that require FIPS 140-3 validated
Level  2.  The  Module  is  designed  to  be  integrated  into  personal  computers  or  any  other  embedded
electronic  systems.  TPM  is  primarily  used  for  cryptographic  keys  generation,  keys  storage,  keys
management and secure storage for digital certificates.

Module Type: Hardware

Module Embodiment: SingleChip

Module Characteristics:

Cryptographic Boundary:

The cryptographic boundary of the Module is defined as the perimeter of the IC package and both versions
of the Module are represented in the next figure. The Module is composed of:

•  Two CPU cores, each including an MPU.

•  Memories (RAMs, Flash and ROM) that store data or FW.

•  HW accelerators for CRC (16 and 32-bits), symmetric cryptographic operations (AES) and asymmetric

cryptographic operations (RSA/ECC).

•  A clock generator and timers.

•  An entropy source covered by an ESV Certificate.

•  SPI and I2C master/slave blocks.

•  An administration block dedicated to chip security configuration and alarms detection.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 7 of 96

Figure 1 – HW block diagram

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 8 of 96

2.2 Tested and Vendor Affirmed Module Version and Identification

Tested Module Identification – Hardware:

The operating environments covered by the FIPS 140-3 validation are summarized in the table below:

Model and/or
Part Number

Hardware
Version

Firmware
Version

Processors

Features

ST33KTPM2A

ST33K1M5A
revB

10.512 (dec.)
0x00.0A.02.00
(hex.)

ST33K1M5A

ST33KTPM2I

ST33K1M5A
revB

10.512 (dec.)
0x00.0A.02.00
(hex.)

ST33K1M5A

Table 2: Tested Module Identification – Hardware

SPI or I2C. The interface is
exclusive and selectable
dynamically during product
boot. Available as a
UFQFPN32WF or
TSSOP20 package.
SPI or I2C. The interface is
exclusive and selectable
dynamically during product
boot. Available as a
UFQFPN32WF or
WLCSP24 package.

ST33KTPM2A and ST33KTPM2I are manufactured in the UFQFPN32 WF package:

•  UFQFPN32 WF

▪  Ultra-thin pitch Quad Flat No-lead 32-pin Wettable Flanks

▪  5 x 5 mm

The ST33KTPM2A product is also manufactured in the TSSOP20 package:

Figure 2 – UFQFPN32 WF Package

•  TSSOP 20-pin

•  6.5 x 4.4 mm

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 9 of 96

The ST33KTPM2I product is also manufactured in the WLCSP24 package:

Figure 3 – TSSOP20 Package

•  WLCSP 24-pin

•  1.8 x 2.5 mm

Figure 4 – WLCSP24 Package

2.3 Excluded Components

No components have been excluded from the cryptographic boundary.

2.4 Modes of Operation

Modes List and Description:

Mode
Name

Normal
mode

Description

Type

Status Indicator

TPM is in normal
operation mode
when all pre-
operational and
conditional self-
tests (apart from
FW load and PCT
tests) are
complete. All
approved services
are usable. The
corresponding
indicator reports if
the service uses an
approved
cryptographic
algorithm or
security function.

Approved

TPM2_GetCapability (capability =
TPM_CAP_VENDOR_PROPERTIES) with the
sub-capability
TPM_SUBCAP_VENDOR_TPMA_MODES =
0x7 shall be used. It outputs a 2-bit indicator
equals to 01b if the module is in an approved
mode of operation

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 10 of 96

Mode
Name

Non-
approved
mode of
operation

Description

Type

Status Indicator

The module enters
a non-approved
mode if one of the
non-approved
services is used by
the operator.

Non-
Approved

TPM2_GetCapability (capability =
TPM_CAP_VENDOR_PROPERTIES) with the
sub-capability
TPM_SUBCAP_VENDOR_TPMA_MODES =
0x7 shall be used. It outputs a 2-bit indicator
equals to 10b if the module is in a non-
approved mode of operation

Table 3: Modes List and Description

2.5 Algorithms

Approved Algorithms:

The Module implements the Approved cryptographic algorithms listed in the table below:

Algorithm

AES-CBC

CAVP
Cert

A5356

AES-CFB128

A5356

AES-CTR

A5356

AES-ECB

A5356

AES-OFB

A5356

ECDSA KeyGen
(FIPS186-4)
ECDSA KeyVer
(FIPS186-4)

A5358

Properties

Direction - Decrypt, Encrypt
Key Length - 128, 192, 256
Direction - Decrypt, Encrypt
Key Length - 128, 192, 256
Direction - Decrypt, Encrypt
Key Length - 128, 192, 256
Direction - Decrypt, Encrypt
Key Length - 128, 192, 256
Direction - Decrypt, Encrypt
Key Length - 128, 192, 256
Curve - P-256, P-384, P-521
Secret Generation Mode - Extra Bits

Reference

SP 800-38A

SP 800-38A

SP 800-38A

SP 800-38A

SP 800-38A

FIPS 186-4

A5358

Curve - P-256, P-384, P-521

FIPS 186-4

ECDSA SigGen
(FIPS186-4)

A5358

ECDSA SigVer
(FIPS186-4)

EDDSA KeyGen
EDDSA KeyVer
EDDSA SigGen
EDDSA SigVer

A5358

A5359
A5359
A5359
A5359

Component - No
Curve - P-256, P-384, P-521
Hash Algorithm - SHA2-256, SHA2-384,
SHA2-512, SHA3-256, SHA3-384
Component - No
Curve - P-256, P-384, P-521
Hash Algorithm - SHA2-256, SHA2-384,
SHA2-512, SHA3-256, SHA3-384
Curve - ED-448
Curve - ED-448
Curve - ED-448
Curve - ED-448

FIPS 186-4

FIPS 186-4

FIPS 186-5
FIPS 186-5
FIPS 186-5
FIPS 186-5

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 11 of 96

Algorithm

Hash DRBG

CAVP
Cert

A5351

HMAC-SHA-1

A5355

HMAC-SHA2-256

A5355

HMAC-SHA2-384

A5355

HMAC-SHA2-512

A5355

HMAC-SHA3-256

A5355

HMAC-SHA3-384

A5355

KAS-ECC Sp800-
56Ar3

A5358

KDF SP800-108

A5354

KTS-IFC

A5357

LMS SigVer
RSA Decryption
Primitive Sp800-56Br2
(CVL)

A5360

A5357

RSA KeyGen
(FIPS186-5)

A5357

Properties

Prediction Resistance - No
Mode - SHA2-256
Key Length - Key Length: 8-8192
Increment 8
Key Length - Key Length: 8-8192
Increment 8
Key Length - Key Length: 8-8192
Increment 8
Key Length - Key Length: 8-8192
Increment 8
Key Length - Key Length: 8-8192
Increment 8
Key Length - Key Length: 8-8192
Increment 8
Domain Parameter Generation Methods -
P-256, P-384, P-521
Function - Full Validation, Key Pair
Generation
Scheme -
fullUnified -
KAS Role - Initiator, Responder
KDF Methods -
oneStepKdf -
Key Length - 128
onePassDh -
KAS Role - Initiator, Responder
KDF Methods -
oneStepKdf -
Key Length - 128
KDF Mode - Counter
Supported Lengths - Supported Lengths:
160-512 Increment 8
Modulo - 2048, 3072, 4096
Key Generation Methods - rsakpg1-basic
Scheme -
KTS-OAEP-basic -
KAS Role - initiator, responder
Key Transport Method -
Key Length - 256
LMS Modes - LMS_SHA256_M32_H10

Modulo - 2048, 3072, 4096

Key Generation Mode - probable
Modulo - 2048, 3072, 4096
Primality Tests - 2pow100
Private Key Format - standard

Reference

SP 800-90A
Rev. 1

FIPS 198-1

FIPS 198-1

FIPS 198-1

FIPS 198-1

FIPS 198-1

FIPS 198-1

SP 800-56A
Rev. 3

SP 800-108
Rev. 1

SP 800-56B
Rev. 2

SP 800-208

SP 800-56B
Rev. 2

FIPS 186-5

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 12 of 96

Algorithm

RSA SigGen
(FIPS186-5)
RSA SigVer
(FIPS186-5)

SHA-1

SHA-1

CAVP
Cert

A5357

A5357

A5352

A5353

SHA2-256

A5352

SHA2-256

A5353

SHA2-384

A5352

SHA2-384

A5353

SHA2-512

A5352

SHA2-512

A5353

SHA3-256

A5352

SHA3-384

A5352

Properties

Modulo - 2048, 3072, 4096
Signature Type - pkcs1v1.5, pss
Modulo - 2048, 3072, 4096
Signature Type - pkcs1v1.5, pss
Message Length - Message Length: 160,
0-65528 Increment 8
Message Length - Message Length: 160,
0-65528 Increment 8
Message Length - Message Length: 256,
0-65528 Increment 8
Message Length - Message Length: 256,
0-65528 Increment 8
Message Length - Message Length: 384,
0-65528 Increment 8
Message Length - Message Length: 384,
0-65528 Increment 8
Message Length - Message Length: 512,
0-65528 Increment 8
Message Length - Message Length: 512,
0-65528 Increment 8
Message Length - Message Length: 0-
65528 Increment 8
Message Length - Message Length: 0-
65528 Increment 8

Reference

FIPS 186-5

FIPS 186-5

FIPS 180-4

FIPS 180-4

FIPS 180-4

FIPS 180-4

FIPS 180-4

FIPS 180-4

FIPS 180-4

FIPS 180-4

FIPS 202

FIPS 202

Table 4: Approved Algorithms

Vendor-Affirmed Algorithms:

The Module implements the Vendor Affirmed cryptographic algorithms listed.

Name

Properties

Implementation

CKG

Key Type:Symmetric

CKG-
Asym

Key
Type:Asymmetric
Table 5: Vendor-Affirmed Algorithms

N/A

N/A

Reference
Section 4, Example 1 of [133r2]; IG
D.H
Section 4, Example 1 of [133r2]; IG
D.H

Non-Approved, Allowed Algorithms:

The Module implements the Non-Approved, but Allowed cryptographic algorithms listed.

Name
ECC BP
P-256

Properties

brainpool256r1:

Implementation
ECDSA [186] (KeyGen, PKV, SigGen,
SigVer), KAS [56Ar3]

Reference
[RFC5639], IG C.A
([IG])

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 13 of 96

Name
ECC BP
P-384
ECC BP
P-512

Properties

brainpool384r1:

brainpool512r1:

Implementation
ECDSA [186] (KeyGen, PKV, SigGen,
SigVer), KAS [56Ar3]
ECDSA [186] (KeyGen, PKV, SigGen,
SigVer), KAS [56Ar3]

Reference
[RFC5639], IG C.A
([IG])
[RFC5639], IG C.A
([IG])

Table 6: Non-Approved, Allowed Algorithms

Non-Approved, Allowed Algorithms with No Security Claimed:

The Module implements the Non-Approved, Allowed cryptographic Algorithms with No Security
Claimed.

Name

XOR

Caveat

No security claimed per IG 2.4.A with the example of scenario #1.
The algorithm:  * is not used except for this purpose * does not
access or share CSPs in a way that counters the requirements of
the IG * not intended to be used as a security function. * can't be
confused for a security function

Table 7: Non-Approved, Allowed Algorithms with No Security Claimed

Use and
Function

Obfuscation of
input or output
data

Non-Approved, Not Allowed Algorithms:

The Module implements the Non-Approved, Not Allowed cryptographic algorithms listed.

Name
ECC BN P-256
(non-compliant)
ECC derived keys
(non-compliant)
ECDAA (non-
compliant)

ECDSA (non-
compliant)

ECSchnorr (non-
compliant)
HMAC (non-
compliant)
KAS (non-
compliant)
KBKDF (non-
compliant)

Key generation, digital signature generation based on ECC BN P-256

Use and Function

Secret exchange or digital signature generation/verification

Key generation, digital signature generation

Digital signature with an ECC signing key generated with an
undetermined scheme (field inPublic.buffer.parameters.scheme.scheme
= TPM_ALG_NULL), derived from a derivation parent key, or a key
loaded in the NULL hierarchy

Key generation, digital signature generation and verification

Key length < 112 bits for message authentication

Key agreement with an ECC key that has an undetermined scheme (field
inPublic.buffer.parameters.scheme.scheme = TPM_ALG_NULL)

Non-Approved key derivation usage

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 14 of 96

Name

KTS-IFC (non-
compliant)

RSA (non-
compliant)
RSA with no
padding mode
(null scheme)
(non-compliant)
RSAES-PKCS1-
v1_5 (non-
compliant)
SHA-1 (non-
compliant)
X448 (non-
compliant)

Use and Function
Key encapsulation with an RSA decryption key that has an undetermined
scheme (field inPublic.buffer.parameters.scheme.scheme =
TPM_ALG_NULL)
1024-bit RSA digital signature generation or with a key loaded in the Null
hierarchy

Key transport

Key transport

Digital signature generation

Key generation, key agreement scheme based on Curve448

Table 8: Non-Approved, Not Allowed Algorithms

2.6 Security Function Implementations

Next table shows the Security Function Implementations that the Module implements:

Name

Type

Description

Properties

KeyGe
n

AsymKeyPair
-KeyGen

Key-Pair
Generation

Publications:FIPS
186-5

KeyVer

AsymKeyPair
-KeyVer

Key-Pair
Verification

Publications:FIPS
186-5

KeyVal

AsymKeyPair
-PubKeyVal

Key-pair
Validation

Publications:186-5

AES-
ENC

BC-UnAuth

Unauthenticate
d Encryption

Publication:FIPS
197

SigGen

DigSig-
SigGen

Signature
Generation

Publication:FIPS
186-5

Algorithms
ECDSA KeyGen
(FIPS186-4): (A5358)
EDDSA KeyGen: (A5359)
Curves: Ed448
CKG-Asym: ()
Key Type: Asymmetric
RSA KeyGen (FIPS186-
5): (A5357)
ECDSA KeyVer (FIPS186-
4): (A5358)
EDDSA KeyVer: (A5359)
Curves: Ed448
KAS-ECC Sp800-56Ar3:
(A5358)
Function: Full Validation
KTS-IFC: (A5357)
Function: partialVal
AES-CBC: (A5356)
AES-CFB128: (A5356)
AES-CTR: (A5356)
AES-ECB: (A5356)
AES-OFB: (A5356)
ECDSA SigGen (FIPS186-
4): (A5358)
Curves: P-256, P-384, P-

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 15 of 96

Name

Type

Description

Properties

SigVer

DigSig-
SigVer

Signature
Verification

Publications:FIPS
186-5

DRBG

DRBG

Random
Number
Generation

Publication:
:SP800-90A

ENT-
ESV

ENT-ESV

ESV

Publications:SP800
-90B

KAS

KAS-Full

Key
establishment

Publications:SP
800-56A, Rev 3

Algorithms
521, brainpool256r1,
brainpool384r1,
brainpool512r1
EDDSA SigGen: (A5359)
Curves: Ed448
RSA SigGen (FIPS186-5):
(A5357)
Key Sizes: 2048, 3072,
4096
SHA: SHA2-256, SHA2-
384, SHA2-512, SHA3-
256, SHA3-384
SHA2-256: (A5352)
SHA2-384: (A5352)
SHA2-512: (A5352)
SHA3-256: (A5352)
SHA3-384: (A5352)
LMS SigVer: (A5360)
LMS:
LMOTS_SHA256_N32_W
4
LMS_SHA256_M32_H10
ECDSA SigVer (FIPS186-
4): (A5358)
Curves:  P-256, P-384, P-
521, brainpool256r1,
brainpool384r1,
brainpool512r1
EDDSA SigVer: (A5359)
Curves: Ed448
RSA SigVer (FIPS186-5):
(A5357)
Key Sizes: 2048, 3072,
4096
SHA2-256: (A5352)
SHA2-384: (A5352)
SHA2-512: (A5352)
SHA3-256: (A5352)
SHA3-384: (A5352)
Hash DRBG: (A5351)
Method: SHA2-256
SHA2-256: (A5352)
SHA2-256: (A5352)
Conditioning Component:
SHA2-256
KAS-ECC Sp800-56Ar3:
(A5358)
Schemes: fullUnified,
onePassDH

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 16 of 96

Name

Type

Description

Properties

KTS-
IFC

KTS-Encap

Key
Encapsulation

KTS

KTS-Wrap

Key transport

Publication:SP 800-
56B rev 2, IG D.G
Method:KTS-
OAEP-basic

Publication:SP 800-
38F, IG D.G

KBKDF

KBKDF

Key-Based Key
Derivation

Publications:SP800
-108

MAC

MAC

Message
Authentication

Publication:FIPS19
8

SHA

SHA

Secure Hash

Publications:FIPS
180-4, FIPS 202

Algorithms
KDF: oneStepKDF
SHA-1: (A5352)
SHA2-256: (A5352)
SHA2-384: (A5352)
SHA2-512: (A5352)
SHA3-256: (A5352)
SHA3-384: (A5352)

KTS-IFC: (A5357)
RSA Decryption Primitive
Sp800-56Br2: (A5357)

HMAC-SHA2-256:
(A5355)
AES-CFB128: (A5356)
KDF SP800-108: (A5354)
SHA-1: (A5353)
SHA2-256: (A5353)
SHA2-384: (A5353)
SHA2-512: (A5353)
SHA3-256: (A5352)
SHA3-384: (A5352)
HMAC-SHA-1: (A5355)
HMAC-SHA2-256:
(A5355)
HMAC-SHA2-384:
(A5355)
HMAC-SHA2-512:
(A5355)
HMAC-SHA3-256:
(A5355)
HMAC-SHA3-384:
(A5355)
SHA-1: (A5352)
SHA2-256: (A5352)
SHA2-384: (A5352)
SHA2-512: (A5352)
SHA3-256: (A5352)
SHA3-384: (A5352)
SHA-1: (A5353, A5352)
SHA2-256: (A5352,
A5353)
SHA2-384: (A5352,
A5353)
SHA2-512: (A5352,
A5353)
SHA3-256: (A5352)
SHA3-384: (A5352)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 17 of 96

Name

Type

Description

CKG

CKG

Symmetric Key
Generation

Properties
Publications:SP800
-133rev2, Section
4; IG D.H

Algorithms

Hash DRBG: (A5351)

KAS-
KeyGe
n

AES-
DEC

KAS-KeyGen

KAS-ECC Key
Generation

Publication:SP800-
56Arev3

KAS-ECC Sp800-56Ar3:
(A5358)

BC-UnAuth

Unauthenticate
d Decryption

Publication:FIPS
197

AES-CBC: (A5356)
AES-CFB128: (A5356)
AES-CTR: (A5356)
AES-ECB: (A5356)
AES-OFB: (A5356)

Table 9: Security Function Implementations

2.7 Algorithm Specific Information

Notes:

KAS [56Ar3] - Per [IG] D.F Scenario 2 path (2), compliant key agreement scheme where testing is
performed end-to-end for the shared secret computation and key derivation.

2.8 RBG and Entropy

The Module implements:

•  A Hash-DRBG based on SHA2-256 and is compliant with the [90A] standard (state is referred to as
drbgState in SSPs table). It is seeded at each module start-up with 512 bits issued from the ENT
(P).  Hash-DRBG  is  used  for  any  generation  of  random  values  used  as  SSP  in  a  cryptographic
operation. It can be reseeded by using the service TPM2_StirRandom.

•  A  transient  Hash-DRBG  based  on  SHA2-256  and  is  compliant  with  the  [90A]  standard  (state  is
referred to as tdrbgState in SSPs table) involved only in primary keys generation and seeded as
defined in [TPM2.0 Part1] and [TPM2.0 Part3].

•  An entropy source as detailed below:

Cert
Number
E41

Vendor Name

STMicroelectronics

Table 10: Entropy Certificates

Name

Type

Operational
Environment

Sample
Size

Entropy
per
Sample

Conditioning
Component

Trusted Platform Module
ST33KTPM2X,
ST33KTPM2XSPI,
ST33KTPM2XI2C,

Physical

ST33K1M5T/A
platforms

1 bit

0.819266
bits

A5352
(SHA2-256)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 18 of 96

Name

Type

Operational
Environment

Sample
Size

Entropy
per
Sample

Conditioning
Component

ST33KTPM2A,
ST33KTPM2I entropy
source

Table 11: Entropy Sources

2.9 Key Generation

For Key Generation, see Section 2.5 and Section 2.6 above.

2.10 Key Establishment

Key Agreement Information

For Key Agreement, see Section 2.5 and Section 2.6 above.

Key Transport Information

For Key Transport, see Section 2.5 and Section 2.6 above.

2.11 Industry Protocols

The Module does not implement any Industry Protocols.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 19 of 96

3 Cryptographic Module Interfaces

3.1 Ports and Interfaces

The Module’s ports and associated logical interface categories are listed below:

Physical Port

SPI_NSS /
SPI_CLK /
SPI_MOSI /
I2C_SCL /
I2C_SDA / RESET /
PP

SPI_NSS /
SPI_CLK /
SPI_MISO /
I2C_SCL /
I2C_SDA / PIRQ

SPI_NSS /
SPI_CLK /
SPI_MISO /
I2C_SCL /
I2C_SDA / PIRQ
SPI_NSS /
SPI_CLK /
SPI_MOSI /
I2C_SCL /
I2C_SDA
SPI_NSS /
SPI_CLK /
SPI_MISO /
I2C_SCL /
I2C_SDA
VCC / GND

Logical
Interface(s)

Data That Passes

Control
Input

Control parts of the TPM commands provided to the
security module. It concerns all bytes of a command
except plaintext data, ciphertext data and SSPs (entered
with the data input interface).

Control
Output

Control parts of the TPM responses output by the
security module. It concerns all bytes of a response
except plaintext data, ciphertext data and SSPs (output
with the data output interface) and except the
responseCode of a response (output with the status
output interface)

Status
Output

Status output by the security module (responseCode
parameter of a response)

Data Input

Data (plaintext data, ciphertext data and SSPs) provided
to the security module as part of an input processing
command

Data Output

Data (plaintext data, ciphertext data and SSPs) output
by the security module as part of the response to a
processing command

Power

Power interface of the security module

Table 12: Ports and Interfaces

Additional details concerning the ports and interfaces of TPM:

1.  Control and data inputs are multiplexed over the same physical interface. Control and data are
distinguished by properly parsing input TPM command parameters according to input structures
description,  indicated  for  each  command  in  [TPM2.0  Part3].  Some  commands  only  deal  with
control input and status output parameters.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 20 of 96

2.  Status, data and control output are multiplexed over the same physical interface. Status, data,
and control are distinguished by properly setting output TPM response parameters according to
output structures description, indicated for each command in [TPM2.0 Part3].

3.  The logical state machine and the command structure parsing of the Module prevent the Module
from  using  input  data  externally  from  the  “data  input  path”  and  prevent  the  Module  from
outputting data externally from the “data output path”.

4.  While performing key generation or key zeroization (no manual key entry on TPM), the output
data path is logically disconnected while the output status path remains connected to report any
possible failure during command processing. Generally, the output data path is only connected
when TPM outputs response containing data.

5.  To prevent the inadvertent output of CSPs in plaintext form on TPM2_Duplicate, the two following

independent internal actions are performed:

a.  Verification of the encryptedDuplication attribute of the key to be duplicated

b.  Verification of the handle of the new parent of the key to be duplicated

encryptedDuplication attribute must be set to 0 and new handle must be set to the null handle to
authorize outputting the private part of the key in plaintext form.

6.  The logical state machine and command structure of the Module guarantees the inhibition of all
data output via the data output interface whenever an error state exists and while doing self-
tests.

7.  The  status  output  interface  remains  active  during  the  error  state  to  output  the  status  of  the

security module with the service TPM2_GetCapability and TPM2_GetTestResult.

3.2 Pinout description

The pin layouts for the various packages are shown in the next figures.

The ST33KTPM2A / ST33KTPM2I security modules support both SPI and I2C physical interfaces but only
one  interface  is  configured  during  TPM  boot.  The  interface  configured  remains  active  until  the  next
module reset.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 21 of 96

UFQFPN32 / UFQFPN32 WF configuration

The pin layouts for the UFWFPN32 / UFWFPN32 WF packages are shown in the next figure.

Figure 5 – UFQFPN32 / UFQFPN32 WF Pinout Diagram

The table below gives a description of the products’ pins.

Type

Input

Input
Input
Input or
Input/Output

Input/Output

Output
Input or
Input/Output
Input or
Input/Output
Output or
Input/Output
Input or
Input/Output

Signal

VCC

GND
RESET
I2C SCL /
GPIO5
I2C SDA /
GPIO6
PIRQ
SPI CLK /
GPIO1
SPI NSS /
GPIO2
SPI MISO /
GPIO0
SPI MOSI /
GPIO3

GPI8

PP

NC

Description

Power supply. This pin must be connected to 1.8V or 3.3V DC power
rail supplied by the motherboard.
GND has to be connected to the main motherboard ground.
Reset used to re-initialize the device
I²C serial clock (Open drain with no weak pull-up resistor) or GPIO if SPI
interface is selected
I²C serial data (Open drain with no weak pull-up resistor) or GPIO if SPI
interface is selected
IRQ used by TPM to generate an interrupt

SPI serial clock (output from master) or GPIO if I2C interface is selected

SPI slave select (active low; output from master) or GPIO if I2C
interface is selected
SPI Master Input, Slave Output (output from slave) or GPIO if I2C
interface is selected
SPI Master Output, Slave Input (output from master) or GPIO if I2C
interface is selected
GPI default to low. The level of this pin on the rising edge of the RESET
signal is used to determine the physical interface to use (high level
corresponds to SPI configuration and low-level to I2C)
Physical presence, active high, internal pull-down. Used to indicate
Physical Presence to the TPM.
Not Connected: connected to the die but not usable. May be left
unconnected. Internal pull-down.
Table 13 – UFQFPN32 / UFQFPN32 WF Pins Definition

-

Input

Input

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 22 of 96

TSSOP20 configuration

The pin layouts for the TSSOP20 package are shown in the next figure.

The table below gives a description of the products’ pins.

Figure 6 – TSSOP20 Pinout Diagram

Signal

VCC

GND
RESET
I2C SCL /
GPIO5
I2C SDA /
GPIO6
PIRQ
SPI CLK /
GPIO1
SPI NSS /
GPIO2
SPI MISO /
GPIO0
SPI MOSI /
GPIO3

Type

Input

Input
Input
Input or
Input/Output

Input/Output

Output
Input or
Input/Output
Input or
Input/Output
Output or
Input/Output
Input or
Input/Output

I2C SEL

Input

PP

NiC

Input

-

Description

Power supply. This pin must be connected to 1.8V or 3.3V DC
power rail supplied by the motherboard.
GND has to be connected to the main motherboard ground.
Reset used to re-initialize the device
I²C serial clock (Open drain with no weak pull-up resistor) or GPIO
if SPI interface is selected
I²C serial data (Open drain with no weak pull-up resistor) or GPIO if
SPI interface is selected
IRQ used by TPM to generate an interrupt
SPI serial clock (output from master) or GPIO if I2C interface is
selected
SPI slave select (active low; output from master) or GPIO if I2C
interface is selected
SPI Master Input, Slave Output (output from slave) or GPIO if I2C
interface is selected
SPI Master Output, Slave Input (output from master) or GPIO if I2C
interface is selected
This pin must be connected to an external pull-down resistor to
activate the I²C protocol during product boot time. It can remain
unconnected for the SPI protocol. This pin is internal pull-up by
default and becomes internal floating after I²C activation.
Physical presence, active high, internal pull-down. Used to indicate
Physical Presence to the TPM.
Not internally connected: not connected to the die. May be left
unconnected but no impact on TPM if connected.

Table 14 – TSSOP20 Pins Definition

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 23 of 96

WLCSP24 configuration

The pin layouts for the WLCSP24 package are shown in the next figure.

Figure 7 – WLCSP24 Pinout Diagram bottom view

The table below gives a description of the products’ pins.

Signal

VCC

GND
RESET
I2C SCL /
GPIO5
I2C SDA /
GPIO6
PIRQ
SPI CLK /
GPIO1
SPI NSS /
GPIO2
SPI MISO /
GPIO0
SPI MOSI /
GPIO3

Type

Input

Input
Input
Input or
Input/Output

Input/Output

Output
Input or
Input/Output
Input or
Input/Output
Output or
Input/Output
Input or
Input/Output

I2C SEL

Input

PP

Input

Description

Power supply. This pin must be connected to 1.8V or 3.3V DC
power rail supplied by the motherboard.
GND has to be connected to the main motherboard ground.
Reset used to re-initialize the device
I²C serial clock (Open drain with no weak pull-up resistor) or GPIO
if SPI interface is selected
I²C serial data (Open drain with no weak pull-up resistor) or GPIO if
SPI interface is selected
IRQ used by TPM to generate an interrupt
SPI serial clock (output from master) or GPIO if I2C interface is
selected
SPI slave select (active low; output from master) or GPIO if I2C
interface is selected
SPI Master Input, Slave Output (output from slave) or GPIO if I2C
interface is selected
SPI Master Output, Slave Input (output from master) or GPIO if I2C
interface is selected
This pin must be connected to an external pull-down resistor to
activate the I²C protocol during product boot time. It can remain
unconnected for the SPI protocol. This pin is internal pull-up by
default and becomes internal floating after I²C activation.
Physical presence, active high, internal pull-down. Used to indicate
Physical Presence to the TPM.
Table 15 – WLCSP24 Pins Definition

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 24 of 96

4 Roles, Services, and Authentication

4.1 Authentication Methods

The Module implements the following authentication techniques in accordance with the Level 2
requirements:

Method
Name

Description

Security
Mechanism

Strength
Each
Attempt

Challenge-
response
authentication

Enhanced
authorization

The challenge-response
mechanism uses an
authorization value
(authValue) as HMAC key
or part of an HMAC key.
The authValue is entered
into the Module during the
creation/loading of an
object (key,  NV index) or
during replacement of the
default value (hierarchies).
The Module enforces a
minimum size of 14 bytes.

Enhanced authorization
includes a policy command
(i.e.,
TPM2_PolicyAuthValue,
TPM2_PolicySigned,
TPM2_PolicyAuthorize,
TPM2_PolicySecret,
TPM2_PolicyTicket)
requiring the knowledge of
an authValue or the proof
of the ownership of a
signing key. It can also be
a bound session, which
also requires proving
knowledge of an authValue
of an object.

MAC

SigVer

Minimum
strength is
reached
with an
authValue
of 14
bytes:
1/2^112 =
1.92*10^-
34

Minimum
strength is
reached
with an
authValue
of 14
bytes:
1/2^112 =
1.92*10^-
34 or an
RSA 2048
signature
with a
security
strength of
112 bits

Table 16: Authentication Methods

4.2 Roles

The Roles Table below lists all operator roles supported by the Module.

Strength per
Minute

Probability of a
successful random
attempt during a
one-minute period
is equal to
60000*1.92*10^-34
= 1.15*10^-29
(considering 60000
trials per minute).
Assuming a
minimum
command duration
of 1ms, 60000
trials can be
executed during a
one-minute period.
Probability of a
successful random
attempt during a
one-minute period
is equal to
60000*1.92*10^-34
= 1.15*10^-29
(considering 60000
trials per minute).
Assuming a
minimum
command duration
of 1ms, 60000
trials can be
executed during a
one-minute period.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 25 of 96

Name

Type

Operator Type  Authentication Methods

Crypto officer (CO)

Role

User (U)

Role

Table 17: Roles

Administrator of
the Module

User of the
Module

Challenge-response
authentication
Enhanced authorization
Challenge-response
authentication
Enhanced authorization

The  Module  does  not  provide  a  maintenance  role  or  maintenance  interface  and  does  not  support
concurrent operators. The role is implicitly selected by the TPM operator on service execution by proving
the knowledge of the enhanced authorization commands sequence and/or the authorization value of an
object.

4.3 Approved Services

All services are accessible under the roles defined above and no specific access rights are considered to
operate with keys and SSPs. Full services inputs and outputs are defined in [TPM2.0 Part3]. The next table
indicates how mandatory services of [ISO/IEC 19790] (§7.4.3.1) are mapped to security module’s services:

Mandatory  service  requested
[ISO/IEC 19790]

from

Corresponding services from the security module

Show module’s versioning information

TPM2_GetCapability

Show status

Perform self-tests

TPM2_GetTestResult

TPM2_SelfTest

Perform Approved security functions

See Approved services listed in next table

Perform zeroization

See services listed in section 9.3 SSP Zeroization
Methods.

Table 18 – Mapping between services

 All Approved services implemented by the Module are listed in the next table.

The SSPs modes of access shown in the table below are defined as:
•
•
•
•
•

G =  Generate: The Module generates or derives the SSP.
R =  Read: The SSP is read from the Module (e.g., the SSP is output).
W = Write: The SSP is updated, imported, or written to the Module (SSP is input).
E =  Execute: The Module uses the SSP in performing a cryptographic operation.
Z =  Zeroize: The Module zeroizes the SSP

Some details about information found in the table:

•

In “Name” column, (I) indicates that service is usable with sessions integrity mechanism, (E)
indicates that service is usable with encryption session (encryption of 1st parameter of
response), (D) indicates that service is usable with decryption session (decryption of 1st
parameter of command)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 26 of 96

•

•

•

•

•

In “Indicator” column, the value of indicator can be Approved (bit field 01b), non-Approved (bit
field 10b) or non-security relevant (bit field 00b).

In  “Inputs”  column,  commands  inputs  are  not  exhaustive,  some  non-security  parameters  are
voluntarily missed. Full inputs of all commands are defined in [TPM2.0 Part3]

In “Outputs” column, Outputs of all responses are defined in [TPM2.0 Part3]

In  “Security  Function  Implementation”  column,  security  functions  are  referenced  by  their
identifiers indicated in Table 4, Table 5, Table 11, and Table 12.

In “Roles” column, NA indicates that the service does not require authentication. The list of roles
is indicated in paragraph 4.2.

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_Init

Reboot or
power-on of
the TPM.

00b

None

None

None

SSP
Access

Unauthen
ticated
-
nullSeed:
Z
-
nullProof:
Z
-
platformA
uth: Z
-
objSeed:
Z
- objAuth:
Z
-
objSens:
Z
- objPub:
Z
- sesSalt:
Z
-
sesHmac
Key: Z
-
sesSymK
ey: Z
-
contextK
ey: Z
-
objSymK

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 27 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

ey: Z
-
objHmac
Key: Z
-
contextE
ncKey: Z
-
dupSeed:
Z
-
dupInSy
mKey: Z
-
dupOutS
ymKey: Z
-
dupOutH
macKey:
Z
-
creSeed:
Z
-
creSymK
ey: Z
-
creHmac
Key: Z
-
ephSens
EccKey:
Z
-
ephPubE
ccKey: Z
-
seqAuth:
Z
-
drbgSeed
: Z
-
tdrbgStat
e: Z
-
fuSymKe

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 28 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_Startup

Set-up the
TPM after a
power cycle.

01b

Startup
type

None

DRB
G
ENT-
ESV

TPM2_Shutdown (I)

Prepare the
TPM for a
power cycle.

00b

Shutdow
n type

None

None

TPM2_SelfTest (I)

Self-tests
execution

01b

Full or
backgrou
nd self-
tests

Self-test
result if full
self-tests
required

AES-
ENC
SigG
en
SigV
er
DRB
G

SSP
Access

y: Z
-
diagSym
Key: Z
Unauthen
ticated
- phSeed:
G
- ehSeed:
G
- shSeed:
G
-
phProof:
G
-
ehProof:
G
- shProof:
G
-
contextK
ey: G
-
drbgSeed
: G
-
drbgState
: G
-
nullSeed:
G
-
nullProof:
G

Unauthen
ticated

Unauthen
ticated

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 29 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

TPM2_IncrementalSelf
Test (I)

Incremental
self-tests
execution

01b

List of
tests to
pass

List of
remaining
tests

Secu
rity
Func
tions
ENT-
ESV
KAS
KBK
DF
MAC
SHA
AES-
DEC
AES-
ENC
SigG
en
SigV
er
DRB
G
ENT-
ESV
KAS
KBK
DF
MAC
SHA
AES-
DEC

TPM2_GetTestResult
(I)

Get self-tests
result

00b

None

Self-tests
status

KBK
DF

TPM2_StartAuthSessio
n (I/E/D)

Session
command

01b

Decrypti
on key
handle;
Binding
entity
handle;
Encrypte
d salt;
Nonce
caller;
Session

Nonce TPM

KAS
KTS-
IFC
KBK
DF

SSP
Access

Unauthen
ticated

Unauthen
ticated
-
diagSym
Key:
G,E,Z
-
diagSym
Seed: E
Unauthen
ticated
-
sesHmac
Key: G,W
-
sesSymK
ey: G,W
- sesSalt:
W,E,Z
-

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 30 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

Type
(HMAC
or
Policy)

TPM2_PolicyRestart (I)

Policy session
restart

00b

Session
handle

None

None

TPM2_Create (I/E/D)  Object creation  01b

Parent
object
handle
Object
sensitive
part
Object
public
template
Creation
data List
of PCR

Object
private part
(encrypted)
Object
public part
Creation
data Digest
of creation
data Ticket
to be used
by
TPM2_Cert
ifyCreation(
)

Key
Gen
AES-
ENC
SigG
en
SigV
er
DRB
G
ENT-
ESV
KTS
KBK
DF
MAC
SHA
CKG
KAS-
Key
Gen

SSP
Access

objSens:
E
- objAuth:
E
- nvAuth:
E
-
platformA
uth: E
-
endorse
mentAuth
: E
-
ownerAut
h: E
-
lockoutA
uth: E
-
seqAuth:
E
Unauthen
ticated
User (U)
-
objSeed:
G,R,E
-
objSymK
ey: G,E,Z
-
objHmac
Key:
G,E,Z
-
objSens:
G,R,E
- objPub:
G,R,E
-
drbgState
: W,E
- objAuth:
W,R
-
nullProof:

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 31 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_Load (I/E/D)

Object loading

01b

Parent
object
handle
Object
private
part
(encrypt
ed)
Object
public
part

Name of
the loaded
object

KeyV
er
KTS
KBK
DF
MAC
SHA
AES-
DEC

TPM2_LoadExternal
(I/E/D)

External object
loading

01b

Object
public
part
Hierarch
y

Name of
the loaded
object

KeyV
al

TPM2_ReadPublic (I)

Read public
part of a
loaded object

01b

Handle
of an
object

Object
public part
Object
name
Object

None

SSP
Access

E
-
phProof:
E
-
ehProof:
E
- shProof:
E
User (U)
-
objSymK
ey:
G,W,E,Z
-
objHmac
Key:
G,W,E,Z
-
objSens:
W,E
- objPub:
W
-
objSeed:
W,E
- objAuth:
W
Unauthen
ticated
- objPub:
W
-
objSens:
W
- objAuth:
W
-
objSeed:
W

Unauthen
ticated
- objPub:
R

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 32 of 96

Name

Description

Enables the
association of
a credential
with an object
in a way that
ensures that
the TPM has
validated the
parameters of
the
credentialed
object

Allows the
TPM to
perform the
actions
required of a
Certificate
Authority (CA)
in creating a
TPM2B_ID_O
BJECT
containing an
activation
credential

Returns the
data in a
loaded Sealed
Data Object

Changes the
authorization
secret for a
TPM-resident
object

TPM2_ActivateCredent
ial (I/E/D)

TPM2_MakeCredential
(I/E/D)

TPM2_Unseal (I/E/D)

TPM2_ObjectChangeA
uth (I/E/D)

Indi
cato
r

01b

01b

01b

01b

Secu
rity
Func
tions

SSP
Access

Inputs

Outputs

qualified
name

Handle
of the
object
with
credentia
ls
Handle
of a
loaded
private
key
Encrypte
d
credentia
l
Encrypte
d seed
Handle
of a
loaded
public
key
Credenti
al
informati
on Name
of the
object
with
credentia
ls
Handle
of a
loaded
data
object
Handle
of an
object
Handle
of the
parent of
the
object

Decrypted
certificate
information

Encrypted
credential
Encrypted
seed

KAS
KTS-
IFC
KTS
KBK
DF
MAC
SHA
AES-
DEC

AES-
ENC
KAS
KTS-
IFC
KTS
KBK
DF
MAC
SHA

Unsealed
data

None

Object
private part

AES-
ENC
KBK
DF
MAC
SHA

Crypto
officer
(CO)
-
creSymK
ey: G,E,Z
-
creHmac
Key:
G,E,Z
-
objSens:
E
-
creSeed:
W,E,Z

Unauthen
ticated
-
creSeed:
G,R,E,Z
-
creSymK
ey: G,E,Z
-
creHmac
Key:
G,E,Z
- objPub:
E

User (U)
-
objSens:
R

User (U)
-
objSeed:
R,E
-
objSens:
R
-

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 33 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

New
authoriza
tion
value

TPM2_CreateLoaded
(I/E/D)

Creates an
object and
loads it in the
TPM

01b

Parent
object
handle
Object
sensitive
part
Object
public
template

Object
private part
(encrypted)
Object
public part
Creation
object
name

Key
Gen
KeyV
er
AES-
ENC
SigG
en
SigV
er
DRB
G
ENT-
ESV
KAS
KBK
DF
MAC
SHA
CKG
KAS-
Key
Gen

SSP
Access

drbgState
: W,E
- objAuth:
R
-
objSymK
ey: E
-
objHmac
Key: E
Crypto
officer
(CO)
-
objSeed:
G,R,E
-
objSymK
ey: G,E
-
objHmac
Key: G,E
-
objSens:
G,R,E
- objPub:
G,R,E
-
tdrbgStat
e: G,W,E
-
drbgState
: W,E
- objAuth:
W,R
-
nullSeed:
E
- phSeed:
E
- ehSeed:
E
- shSeed:
E
-
nullProof:
E

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 34 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

-
phProof:
E
-
ehProof:
E
- shProof:
E
- ekRsa:
E
- ekEcc:
E
-
shProofF
orReseed
: G,E
User (U)
-
objSeed:
G,E
-
objSymK
ey: G,E
-
objHmac
Key: G,E
-
objSens:
G,R
- objPub:
G,R,E
-
tdrbgStat
e: G,W,E
-
drbgState
: W
- objAuth:
W
-
nullSeed:
E
- phSeed:
E
-
ephSens
EccKey:

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 35 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_Duplicate
(I/E/D)

Duplicates a
loaded object
so that it may
be used in a
different
hierarchy

01b

Handle
of the
loaded
object to
duplicate
Handle
of the
new
parent
Optional
symmetri
c
encryptio
n key

Encryption
key for
inner
wrapper
Duplicated
object
private part
(encrypted)
Encrypted
seed

AES-
ENC
DRB
G
KTS-
IFC
KAS
KTS
KBK
DF
MAC
SHA
CKG

SSP
Access

E
- shSeed:
E
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
-
shProofF
orReseed
: G,E
- ekRsa:
E
- ekEcc:
E
User (U)
-
dupSeed:
G,R,E,Z
-
objSeed:
R
-
dupOutS
ymKey:
G,E,Z
-
dupInSy
mKey:
G,R,W,E,
Z
-
dupOutH
macKey:
G,E,Z
-
objSens:
R
- objAuth:
R
-
drbgState

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 36 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_Rewrap (I/E/D)

Rewraps a
duplicated
object with a
new parent key

01b

TPM2_Import (I/E/D)

Allows an
object to be
encrypted
using the
symmetric
encryption
values of a
Storage Key

01b

Handle
of the old
parent
Handle
of the
new
parent
Duplicat
ed object
private
part
(encrypt
ed)
Name of
the
object
being
rewrapp
ed
Encrypte
d seed

Handle
of the
new
parent
Duplicat
ed object
private
part
(encrypt
ed)
Object
public
part
Encrypte
d seed

Duplicated
object
private part
(encrypted)
Encrypted
seed

Object
private part
(encrypted)

AES-
ENC
AES-
DEC
KAS
KTS-
IFC
KTS
KBK
DF
MAC
SHA
CKG

AES-
ENC
AES-
DEC
KAS
KTS-
IFC
KTS
KBK
DF
MAC
SHA
CKG

SSP
Access

: W,E
- objPub:
E
User (U)
-
dupOutS
ymKey:
G,E,Z
-
dupOutH
macKey:
G,E,Z
-
objSens:
R,W,E
-
dupSeed:
R,W,E,Z
-
objSeed:
R,W
-
dupInSy
mKey:
W,Z
-
drbgState
: W,E
- objPub:
E
- objAuth:
R,W
User (U)
-
objSens:
R,W,E,Z
-
objSeed:
R,W,Z
- objPub:
W,E,Z
-
dupOutS
ymKey:
W,E,Z
- objAuth:
R,W,Z

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 37 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

Encrypti
on key
for inner
wrapper

RSA
public
key
handle
Message
to
encrypt
RSA
scheme
to use
RSA
private
key
handle
Cipherte
xt to
decrypt
RSA
scheme
to use

Encrypted
output

KTS-
IFC

Decrypted
output

KTS-
IFC

TPM2_RSA_Encrypt
(I/E/D)

Performs RSA
encryption

01b

TPM2_RSA_Decrypt
(I/E/D)

Performs RSA
decryption

01b

TPM2_ECDH_KeyGen
(I/E/D)

Shared secret
value
computation
using ECDH

01b

ECC key
public
part
handle

Shared
secret
Ephemeral
public key

KAS
KAS-
Key
Gen

SSP
Access

-
drbgState
: E
-
dupSeed:
E,W,Z
-
dupInSy
mKey:
E,W,Z
-
dupOutH
macKey:
W,E,Z

Unauthen
ticated
- objPub:
E

User (U)
-
objSens:
Z

Unauthen
ticated
-
ephSens
EccKey:
G,E,Z
-
ephPubE
ccKey:
G,R,Z
-
drbgState

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 38 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_ECDH_ZGen
(I/E/D)

Shared secret
value recovery
using ECDH

01b

Handle
of a
loaded
ECC key
Ephemer
al public
key

Recovered
shared
secret

KAS

SSP
Access

: W,E
- objPub:
E
User (U)
-
ephPubE
ccKey:
W,E,Z
-
objSens:
E

TPM2_ECC_Paramete
rs (I)

Returns the
parameters of
an ECC curve
identified by its
TCG-assigned
curveID

00b

ID of an
ECC
curve

Curve
parameters

None

Unauthen
ticated

TPM2_EncryptDecrypt
(I/E)

Symmetric
encryption or
decryption

01b

TPM2_EncryptDecrypt
2 (I/E/D)

Symmetric
encryption or
decryption

01b

TPM2_Hash (I/E/D)

Performs a
hash operation
on data

01b

Symmetr
ic key
handle
Decrypti
on or
encryptio
n
indicator
Input IV
Data
Mode
Symmetr
ic key
handle
Decrypti
on or
encryptio
n
indicator
Input IV
Data
Mode
Data to
hash
Hash
algorithm
Hierarch
y to use
for ticket

Encrypted
or
decrypted
data Output
IV (for
chaining)

AES-
ENC
AES-
DEC

User (U)
-
objSens:
E

Encrypted
or
decrypted
data Output
IV (for
chaining)

AES-
ENC
AES-
DEC

User (U)
-
objSens:
E

Digest
Ticket
linked to
the input
hierarchy

MAC
SHA

Unauthen
ticated
-
nullProof:
E
-
phProof:

Page 39 of 96

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_HMAC (I/E/D)

Performs a
HMAC
operation on
data

01b

TPM2_GetRandom
(I/E)

Outputs
random bytes
from a DRBG

01b

TPM2_StirRandom
(I/D)

Reseed the
state of a
DRBG

01b

TPM2_HMAC_Start
(I/D)

Starts an
HMAC
sequence

01b

TPM2_HashSequence
Start (I/D)

Starts a hash
or an event
sequence

01b

Symmetr
ic
signing
key
handle
Data to
HMAC
Hash
algorithm
Number
of
random
bytes to
generate

Addition
al
informati
on

Handle
of an
HMAC
key
Authoriz
ation
value for
sequenc
e Hash
algorithm
Authoriz
ation
value for
sequenc
e Hash
algorithm

HMAC

MAC

Output
random
bytes

DRB
G

None

DRB
G
ENT-
ESV

Sequence
handle

MAC

Sequence
handle

SHA

SSP
Access

E
-
ehProof:
E
- shProof:
E

User (U)
-
objSens:
E

Unauthen
ticated
-
drbgState
: W,E
Unauthen
ticated
-
drbgSeed
: W,E,Z
-
drbgState
: W,E

User (U)
-
seqAuth:
W
-
objSens:
E

Unauthen
ticated
-
seqAuth:
W

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 40 of 96

Inputs

Outputs

Secu
rity
Func
tions

MAC
SHA

None

Name

Description

TPM2_SequenceUpda
te (I/D)

Adds data to a
hash or HMAC
sequence

Indi
cato
r

01b

TPM2_SequenceComp
lete (I/E/D)

Adds last part
of data to a
hash or HMAC
sequence and
returns the
result

01b

TPM2_EventSequence
Complete (I/D)

Adds last part
of data to a
hash or HMAC
sequence and
returns the
result in a
digest list

01b

TPM2_Certify (I/E/D)

Proves that an
object with a
specific Name
is loaded in the
TPM

01b

TPM2_CertifyCreation
(I/E/D)

Proves the
association

01b

Sequenc
e handle
Data to
hash/HM
AC

Sequenc
e handle
Data to
hash/HM
AC
Hierarch
y for
ticket

Handle
of PCR
to extend
Sequenc
e handle
Data to
hash/HM
AC
Handle
of the
object to
certify
Handle
of a
signing
key
Qualifyin
g data
Signatur
e
scheme
Handle
of the

SSP
Access

User (U)
-
objSens:
E

User (U)
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E
-
objSens:
E
-
seqAuth:
Z

User (U)
-
objSens:
E
-
seqAuth:
Z

HMAC or
digest
Ticket
linked to
the input
hierarchy

MAC
SHA

List of
digests
computed
for the PCR

MAC
SHA

Certification
structure
Signature
over the
certification
structure

SigG
en
DRB
G
KBK
DF
MAC
SHA
CKG

User (U)
-
drbgState
: W,E
-
objSens:
E
- shProof:
E

Certification
structure

SigG
en

User (U)
-

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 41 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

between an
object and its
creation data

TPM2_Quote (I/E/D)

Quotes PCR
values

01b

TPM2_GetSessionAudi
tDigest (I/E/D)

Returns a
digital
signature of
the audit
session digest

01b

object to
certify
Handle
of a
signing
key
Qualifyin
g data
Signatur
e
scheme
Ticket
Creation
hash

Handle
of a
signing
key
Qualifyin
g data
Selection
of PCRs
Signatur
e
scheme
Handle
of a
privacy
administr
ator
Handle
of a
signing
key
Handle
of an
audit
session
Qualifyin
g data
Signatur
e
scheme

Signature
over the
certification
structure

Secu
rity
Func
tions
DRB
G
KBK
DF
MAC
SHA
CKG

Quoted
information
Signature
over the
quoted
information

SigG
en
DRB
G
KBK
DF
MAC
SHA
CKG

SSP
Access

drbgState
: W,E
-
objSens:
E
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E

User (U)
-
drbgState
: W,E
-
objSens:
E
- shProof:
E

Audit
information
Signature
over the
quoted
information

SigG
en
KBK
DF
DRB
G
MAC
SHA
CKG

Crypto
officer
(CO)
-
drbgState
: W,E
-
objSens:
E
- shProof:
E

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 42 of 96

Inputs

Outputs

Name

Description

TPM2_GetCommandA
uditDigest (I/E/D)

Returns the
current value
of the
command audit
digest, a digest
of the
commands
being audited,
and the audit
hash algorithm

Indi
cato
r

01b

TPM2_GetTime (I/E/D)

Returns the
current values
of Time and
Clock

01b

TPM2_CertifyX509
(I/E/D)

X.509
certificate
generation

01b

TPM2_VerifySignature
(I/D)

Uses loaded
keys to
validate a
signature on a

01b

Handle
of a
privacy
administr
ator
Handle
of a
signing
key
Qualifyin
g data
Signatur
e
scheme
Handle
of a
privacy
administr
ator
Handle
of a
signing
key
Qualifyin
g data
Signatur
e
scheme
Handle
of the
object to
certify
Handle
of a
signing
key
Partial
certificat
e
Signatur
e
scheme
Handle
of a
public
key

Secu
rity
Func
tions

SigG
en
DRB
G
KBK
DF
MAC
SHA
CKG

SSP
Access

Crypto
officer
(CO)
-
drbgState
: W,E
-
objSens:
E
- shProof:
E

SigG
en
KBK
DF
DRB
G
MAC
SHA
CKG

Crypto
officer
(CO)
-
drbgState
: W,E
-
objSens:
E
- shProof:
E

Audit
information
Signature
over the
quoted
information

Attestation
data
Signature
over the
attestation
data

Additional
certificate
information
Digest
Signature
over the
digest

SigG
en
SHA

User (U)
-
drbgState
: W,E
-
objSens:
E

Validation
ticket

SigV
er
MAC

Unauthen
ticated
- objPub:
E

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 43 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

message with
the message
digest passed
to the TPM

Digest of
a
message
Signatur
e to be
tested

TPM2_Sign (I/D)

TPM2_SetCommandC
odeAuditStatus (I)

Causes the
TPM to sign an
externally
provided hash
with the
specified
symmetric or
asymmetric
signing key

01b

Handle
of a
signing
key
Digest to
be
signed
Scheme
Proof
ticket for
digest

Changes the
audit status of
a command or
to set the hash
algorithm used
for the audit
digest

00b

Authoriz
ation
handle
Hash
algorithm

Signature
over the
digest

SigG
en
DRB
G
MAC
SHA

None

None

SSP
Access

-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E
User (U)
-
objSens:
E
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E

Crypto
officer
(CO)

TPM2_PCR_Extend (I)

Updates the
indicated PCR

01b

TPM2_PCR_Event
(I/D)

Updates the
indicated PCR
and reports list
of digests

01b

PCR
handle
List of
digests
used to
extend
PCRs
PCR
handle
Event
data

None

SHA

Unauthen
ticated

Digests

SHA

Unauthen
ticated

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 44 of 96

Indi
cato
r

00b

00b

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

Selection
of PCR
to read

Selection
of PCR
to
allocate

PCR
information

None

Unauthen
ticated

PCR
allocation
information

None

Crypto
officer
(CO)

00b

PCR to
reset

none

None

Unauthen
ticated

01b

None

None

SHA

Unauthen
ticated

01b

Data

None

SHA

Unauthen
ticated

Name

Description

TPM2_PCR_Read (I)

TPM2_PCR_Allocate
(I)

TPM2_PCR_Reset (I)

_TPM_Hash_Start

_TPM_Hash_Data

TPM_Hash_End

Returns the
values of all
PCR specified
in
pcrSelectionIn
Sets the
desired PCR
allocation of
PCR and
algorithms
Sets the PCR
in all banks to
zero
Indicates to the
TPM interface
the start of an
H-CRTM
measurement
sequence
Indicates to the
TPM interface
data to be
included in the
H-CRTM
measurement
sequence
Indicates to the
TPM interface
the end of the
H-CRTM
measurement
sequence

01b

None

None

SHA

TPM2_PolicySigned
(I/E/D)

Includes a
signed
authorization in
a policy

01b

Signatur
e key
handle
Policy
session
handle
Nonce
TPM
Digest
Signatur
e
Expiratio
n of
authoriza

Policy
timeout
Policy ticket

SigV
er
MAC
SHA

Unauthen
ticated

Unauthen
ticated
- objPub:
E
-
nullProof:
E
-
phProof:
E
-
ehProof:
E

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 45 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

- shProof:
E

tion
Policy
referenc
e value
Authoriz
ation
object
handle
Policy
session
handle
Nonce
TPM
Digest
Expiratio
n of
authoriza
tion
Policy
referenc
e value
Policy
session
handle
Nonce
TPM
Digest
Expiratio
n of
authoriza
tion
Policy
referenc
e value
Authoriz
ation
object
name
Ticket

Policy
session
handle
List of
digests

TPM2_PolicySecret
(I/E/D)

Includes a
secret-based
authorization to
a policy

01b

TPM2_PolicyTicket
(I/D)

Includes a
ticket in a
policy

01b

TPM2_PolicyOR (I)

Allows options
in
authorizations
without
requiring that
the TPM

01b

Policy
timeout
Policy ticket

MAC
SHA

None

MAC
SHA

User (U)
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E

Unauthen
ticated
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E

None

SHA

Unauthen
ticated

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 46 of 96

Name

Description

evaluate all the
options

Causes
conditional
gating of a
policy based
on PCR

TPM2_PolicyPCR (I/D)

Indi
cato
r

01b

TPM2_PolicyLocality
(I)

Indicates that
the policy will
be limited to a
specific locality

01b

TPM2_PolicyNV (I/D)

TPM2_PolicyCounterTi
mer (I/D)

Causes
conditional
gating of a
policy based
on the contents
of an NV Index

01b

Causes
conditional
gating of a
policy based
on the contents
of the
TPMS_TIME_I
NFO structure

01b

TPM2_PolicyComman
dCode (I)

Limits policy to
a specific
command code

01b

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

Policy
session
handle
Expecte
d digest
value
PCR
selection
Policy
session
handle
Locality
Authoriz
ation
handle
NV index
handle
Policy
session
handle
Operand
, offset,
operatio
n

Policy
session
handle
Operand
, offset,
operatio
n

Policy
session
handle
Comman
d code

None

SHA

Unauthen
ticated

None

SHA

Unauthen
ticated

None

SHA  User (U)

None

SHA

Unauthen
ticated

None

SHA

Unauthen
ticated

TPM2_PolicyPhysicalP
resence (I)

Physical
presence will
need to be
asserted at the
time the
authorization is
performed

01b

Policy
session
handle

None

SHA

Unauthen
ticated

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 47 of 96

Name

Description

TPM2_PolicyCpHash
(I/D)

TPM2_PolicyNameHas
h (I/D)

Allows a policy
to be bound to
a specific
command and
command
parameters
Allows a policy
to be bound to
a specific set
of TPM entities
without being
bound to the
parameters of
the command

Indi
cato
r

01b

01b

TPM2_PolicyDuplicatio
nSelect (I/D)

Allows
qualification of
duplication to
allow
duplication to a
selected new
parent

01b

TPM2_PolicyAuthorize
(I/D)

TPM2_PolicyAuthValu
e (I)

Check a ticket
issued from the
signature
verification of a
new policy so
that it may be
used in an
existing policy

01b

Allows a policy
to be bound to
the
authorization
value of the

01b

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

Policy
session
handle
Digest to
add to
policy

Policy
session
handle
Digest to
add to
policy

Policy
session
handle
Object
name to
be
duplicate
d New
Parent
name
Object
name
inclusion
indicator
Policy
session
handle
Digest of
the
policy
being
approve
d Policy
qualifier
Key
name
Ticket

Policy
session
handle

None

SHA

Unauthen
ticated

None

SHA

Unauthen
ticated

None

SHA

Unauthen
ticated

Unauthen
ticated
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E

Unauthen
ticated

None

MAC
SHA

None

SHA

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 48 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

TPM2_PolicyPassword
(I)

TPM2_PolicyGetDigest
(I/E)

TPM2_PolicyNvWritten
(I)

TPM2_PolicyTemplate
(I/D)

TPM2_PolicyAuthorize
NV (I)

TPM2_CreatePrimary
(I/E/D)

authorized
entity
Allows a policy
to be bound to
the
authorization
value of the
authorized
object
Returns the
current
policyDigest of
a policy
session
Allows a policy
to be bound to
the
TPMA_NV_W
RITTEN
attributes

Allows a policy
to be bound to
a specific
creation
template

Provides a
capability that
is the
equivalent of a
revocable
policy

Creates a
Primary Object
under one of
the Primary
Seeds or a
Temporary
Object under
TPM_RH_NUL
L

01b

Policy
session
handle

None

SHA

Unauthen
ticated

00b

01b

01b

01b

01b

Policy
session
handle

Policy
session
handle
NV index
written
indicator
Policy
session
handle
Digest to
add to
policy
Source
handle
for
authoriza
tion  NV
index to
read
Policy
session
handle

Primary
handle
Key
sensitive
data Key
public
template
Creation
data

Policy
digest

None

Unauthen
ticated

None

SHA

Unauthen
ticated

None

SHA

Unauthen
ticated

None

SHA  User (U)

Object
handle
Object
Public part
Creation
data Digest
of creation
data
Creation
ticket Name

Key
Gen
KeyV
er
AES-
ENC
SigG
en
SigV
er

Crypto
officer
(CO)
-
objSeed:
G,E,Z
-
objSymK
ey: G,E,Z
-

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 49 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Creation
PCR

of the
object

Secu
rity
Func
tions
DRB
G
KBK
DF
MAC
SHA
CKG
KAS-
Key
Gen

SSP
Access

objHmac
Key:
G,E,Z
-
objSens:
G,E,Z
- objPub:
G,R,E,Z
-
tdrbgStat
e:
G,W,E,Z
-
drbgState
: W,E
- objAuth:
W
-
nullSeed:
E
- phSeed:
E
- ehSeed:
E
- shSeed:
E
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E
- ekRsa:
E
- ekEcc:
E
-
shProofF
orReseed
: G,E

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 50 of 96

Name

Description

TPM2_HierarchyContr
ol (I)

Enables and
disables use of
a hierarchy
and its
associated NV
storage

Indi
cato
r

00b

TPM2_SetPrimaryPolic
y (I/D)

Sets the
authorization
policy for a
hierarchy

00b

Primary
handle
Hierarch
y to
enable
or
disable
Enable
or
disable
indicator
Primary
handle
Policy
digest
Hash
algorithm

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

None

None

Crypto
officer
(CO)

None

None

TPM2_ChangePPS (I)

TPM2_ChangeEPS (I)

Replaces the
current
platform
primary seed
(PPS) with a
value from the
RNG and sets
platformPolicy
to the default
initialization
value

Replaces the
current
endorsement
primary seed
EPS) with a
value from the
RNG and sets
endorsementP
olicy to the
default

01b

Authoriz
ation
handle

None

DRB
G

01b

Authoriz
ation
handle

None

DRB
G

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 51 of 96

Crypto
officer
(CO)

Crypto
officer
(CO)
-
drbgState
: W,E
-
phProof:
Z
- phSeed:
Z
-
objSeed:
Z
-
objSens:
Z
- objPub:
Z
Crypto
officer
(CO)
-
drbgState
: W,E
- ehSeed:
Z
-
ehProof:

Name

Description

initialization
value

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_Clear (I)

Removes all
TPM context
associated with
a specific
Owner

01b

Authoriz
ation
handle

None

DRB
G

TPM2_ClearControl (I)

Disables and
enables the
execution of
TPM2_Clear()

00b

Authoriz
ation
handle
Set or
clear
disableO
wnerFlag

None

None

SSP
Access

Z
-
objSeed:
Z
-
objSens:
Z
- objPub:
Z
- ekRsa:
Z
- ekEcc:
Z
Crypto
officer
(CO)
-
drbgState
: W,E
- shSeed:
Z
-
ehProof:
Z
- shProof:
Z
-
shProofF
orReseed
: Z
-
objSeed:
Z
-
objSens:
Z
- objPub:
Z
- objAuth:
Z

Crypto
officer
(CO)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 52 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_HierarchyChan
geAuth (I/D)

Changes the
authValue of
hierarchies

00b

Authoriz
ation
handle
New
authoriza
tion
value

None

None

TPM2_DictionaryAttac
kLockReset (I)

Cancels the
effect of a TPM
lockout due to
several
successive
authorization
failures

00b

Authoriz
ation
handle

None

None

SSP
Access

Crypto
officer
(CO)
-
lockoutA
uth: W
-
endorse
mentAuth
: W
-
ownerAut
h: W
-
platformA
uth: W

Crypto
officer
(CO)

TPM2_DictionaryAttac
kParameters (I)

Changes the
lockout
parameters

00b

Authoriz
ation
handle
newMax
Tries,
newRec
overyTim
e and
lockoutR
ecovery
values

None

None

Crypto
officer
(CO)

TPM2_VendorCmdFiel
dUpgradeStart (I)

Initiates a field
upgrade
session

01b

Approve
d

None

SigV
er
KBK
DF
SHA
CKG

Crypto
officer
(CO)
-
fuSigEC
CKey: E
-
fuSigLMS
Key: E
-
fuSymKe
y: G

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 53 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

TPM2_VendorCmdFiel
dUpgradeData (I)

Conveys
firmware in a
field upgrade
session

01b

Field
upgrade
data blob

Completion
indicator

AES-
DEC
SHA

TPM2_ContextSave

Saves a
session
context, object
context, or
sequence
object context
outside the
TPM

01b

Saved
handle

Context

AES-
ENC
KTS
KBK
DF
MAC
CKG

TPM2_ContextLoad

Reloads a
context that

01b  Context

Loaded
handle

AES-
DEC

SSP
Access

-
fuSymSe
ed: E
Unauthen
ticated
-
fuSymKe
y: E,Z
Unauthen
ticated
-
contextE
ncKey:
G,E,Z
-
objSeed:
R
-
objSens:
R
- objPub:
R
- objAuth:
R
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E
-
contextK
ey: E
-
sesHmac
Key: R
-
seqAuth:
R
Unauthen
ticated

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 54 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

has been
saved by
TPM2_Context
Save()

Secu
rity
Func
tions
KTS
KBK
DF
MAC
CKG

TPM2_FlushContext

Causes all
context
associated with
a loaded
object,
sequence
object, or
session to be
removed from
TPM memory

01b

Flush
handle

None

None

SSP
Access

-
contextE
ncKey:
G,E,Z
-
objSeed:
W
-
objSens:
W
- objPub:
W
- objAuth:
W
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E
-
contextK
ey: E
-
sesHmac
Key: W
-
seqAuth:
W
Unauthen
ticated
-
objSeed:
Z
-
objSens:
Z
- objPub:
Z
- objAuth:
Z

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 55 of 96

Name

Description

TPM2_EvictControl (I)

TPM2_ReadClock (I)

TPM2_ClockSet (I)

TPM2_ClockRateAdjus
t (I)

TPM2_GetCapability
(I)

TPM2_SetCapability
(I/D)

TPM2_TestParms (I)

Allows certain
Transient
Objects to be
made
persistent or a
persistent
object to be
evicted

Reads the
current
TPMS_TIME_I
NFO structure
Advances the
value of the
TPM's clock

Adjusts the
rate of
advance of
Clock and
Time

Returns
various
information
regarding the
TPM and its
current state
Set specific
data in the
TPM, such as
TPM
configurations,
which may
change the
TPM's function
and behavior
Checks if
specific
combinations

Indi
cato
r

01b

Inputs

Outputs

Secu
rity
Func
tions

Authoriz
ation
handle
Loaded
object
handle
Persiste
nt handle

None

None

SSP
Access

Crypto
officer
(CO)
-
objSeed:
W,Z
-
objSens:
W,Z
- objPub:
W,Z
- objAuth:
W,Z

00b

None

Current
time

None

Unauthen
ticated

00b

New
time

None

None

Crypto
officer
(CO)

Crypto
officer
(CO)

None

None

More data
availability
indicator
Capability
data

None

Unauthen
ticated

Authoriz
ation
handle
Clock
update
rate
adjustme
nt

Capabilit
y,
property,
property
count

00b

00b

00b

Capabilit
y data

None

None

Crypto
officer
(CO)

00b

Algorith
m

None

None

Unauthen
ticated

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 56 of 96

Name

Description

of algorithm
parameters are
supported

Defines the
attributes of an
NV Index and
causes the
TPM to reserve
space to hold
the data
associated with
the NV Index

TPM2_NV_DefineSpac
e (I/D)

Indi
cato
r

01b

TPM2_NV_UndefineSp
ace (I)

Removes an
Index from the
TPM

01b

TPM2_NV_UndefineSp
aceSpecial (I)

TPM2_NV_ReadPublic
(I/E)

TPM2_NV_Write (I/D)

Removal of a
platform-
created NV
Index that has
TPMA_NV_PO
LICY_DELETE
SET

Reads the
public area and
Name of an NV
Index

Writes a value
to an area in
NV memory
that was
previously
defined by
TPM2_NV_Def
ineSpace()

01b

00b

TPM2_NV_Increment
(I)

Increments the
value in an NV
Index that has
the

00b

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

paramet
ers

Authoriz
ation
handle
NV
authoriza
tion
value NV
public
paramet
ers
Authoriz
ation
handle
NV index
to delete

Platform
authoriza
tion
handle
NV index
to delete

None

None

None

None

None

None

Crypto
officer
(CO)
- nvAuth:
W

Crypto
officer
(CO)
- nvAuth:
Z

Crypto
officer
(CO)
- nvAuth:
Z

01b  NV index

NV index
public area
Name of
the NV
index

SHA

Unauthen
ticated

Authoriz
ation
handle
NV index
to write
Data to
write
Offset in
the NV
index
area
Authoriz
ation
handle
NV index
to

None

None  User (U)

None

None  User (U)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 57 of 96

Name

Description

TPM2_NV_Extend
(I/D)

TPM_NT_COU
NTER attribute
Extends a
value to an
area in NV
memory that
was previously
defined by
TPM2_NV_Def
ineSpace()

Indi
cato
r

01b

TPM2_NV_SetBits (I)

Sets bits in an
NV Index that
was created as
a bit field

00b

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

incremen
t

Authoriz
ation
handle
NV index
to extend
Data to
extend

Authoriz
ation
handle
NV index
to extend
Data to
OR with
NV
content

None

SHA  User (U)

None

None  User (U)

TPM2_NV_WriteLock
(I)

TPM2_NV_GlobalWrite
Lock (I)

TPM2_NV_Read (I/E)

Inhibits further
writes of the
NV Index if the
TPMA_NV_W
RITEDEFINE
or
TPMA_NV_W
RITE_STCLEA
R attributes of
an NV location
are SET
Sets
TPMA_NV_W
RITELOCKED
for all indexes
that have their
TPMA_NV_GL
OBALLOCK
attribute SET
Reads a value
from an area in
NV memory
previously
defined by
TPM2_NV_Def
ineSpace()

00b

Authoriz
ation
handle
NV index

None

None  User (U)

00b

Authoriz
ation
handle

None

None

Crypto
officer
(CO)

00b

Authoriz
ation
handle
NV index
to be
read
Size and

Data read  None  User (U)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 58 of 96

Name

Description

TPM2_NV_ReadLock
(I)

TPM2_NV_ChangeAut
h (I/D)

Prevents
further reads of
the NV Index
until the next
TPM2_Startup
(TPM_SU_CL
EAR) if
TPMA_NV_RE
AD_STCLEAR
is SET

Allows the
authValue of
an NV Index to
be changed

Indi
cato
r

00b

01b

TPM2_NV_Certify
(I/E/D)

Certifies the
contents of an
NV Index or
portion of an
NV Index

01b

TPM2_VendorCmdSet
Mode (I)

Sets the low
power mode

00b

TPM2_VendorCmdSet
CommandSet (I)

Activates and
locks
commands

00b

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

offset in
NV area

Authoriz
ation
handle
NV index
to be
locked

NV index
New
authoriza
tion
value
Handle
of
signing
key
Authoriz
ation
handle
NV index
Qualifyin
g data
Scheme
Size and
offset in
NV area
Authoriz
ation
handle
Low
power
configura
tion
structure
Authoriz
ation
handle
Comman
d code
Activatio
n and

None

None  User (U)

None

None

User (U)
- nvAuth:
W

Structure
that was
signed
Signature

SigG
en
KBK
DF
MAC
SHA

User (U)
-
objSens:
E
- shProof:
E

None

None

None

None

Crypto
officer
(CO)

Crypto
officer
(CO)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 59 of 96

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

Name

Description

TPM2_VendorCmdSet
CommandSetLock (I)

TPM2_VendorCmdGet
Random2 (I/E)

Prevents
locking
commands

Get random
value from
DRBG

Indi
cato
r

00b

01b

TPM2_VendorCmdGPI
OConfig (I)

Configures
GPIO

00b

TPM2_VendorCmdGet
Random800_90B (I/E)

Get random
value from
ENT (P)

01b

TPM2_VendorCmdCha
ngeObjectDeletionAuth
(I)

Modifies
deletion
authorization
for an object

00b

lock
indicator
s
Authoriz
ation
handle

Number
of bytes
to
generate

Authoriz
ation
handle
GPIO
configura
tion
Number
of bytes
to
generate
Authoriz
ation
handle
Platform
authoriza
tion use
indicator

None

None

Random
value

None

Crypto
officer
(CO)
Unauthen
ticated
-
drbgState
: W,E

None

None

Unauthen
ticated

Random
value

ENT-
ESV

Unauthen
ticated

None

None

TPM2_VendorCmdRes
toreEK (I)

Restore EK
RSA or EK
ECC in case of
deletion by
TPM2_Change
EPS

01b

Authoriz
ation
handle

None

None

TPM2_VendorCmdZer
oizeEK (I)

Zeroize EK
RSA and EK
ECC

01b

Authoriz
ation
handle

None

None

TPM2_VendorCmdSig
n

Causes the
TPM to sign a
message with
the specified

01b

Handle
of a
signing
key

Signature
over the
message

SigG
en
DRB

Crypto
officer
(CO)

Crypto
officer
(CO)
- ekRsa:
W
- ekEcc:
W
Crypto
officer
(CO)
- ekRsa:
Z
- ekEcc:
Z
User (U)
-
objSens:
E

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 60 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

asymmetric
signing key

Message
to be
signed
Context
Scheme

Secu
rity
Func
tions
G
SHA

SSP
Access

- objPub:
E
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E
Unauthen
ticated
- objPub:
E
-
nullProof:
E
-
phProof:
E
-
ehProof:
E
- shProof:
E

Crypto
officer
(CO)

None

SigV
er

None

None

None

None

Crypto
officer
(CO)

TPM2_VendorCmdVeri
fySignature

Uses loaded
keys to
validate a
signature on a
message with
the message
digest passed
to the TPM

01b

TPM2_VendorCmdSet
BackgroundSlotsConfi
g

Configure the
RSA
background
key slots

00b

TPM2_PP_Commands

Determines
which
commands
require
assertion of
Physical
Presence

00b

Handle
of a
public
key
Signed
message
Context
Signatur
e to be
tested

Authoriz
ation
handle
Slots
configura
tion
Authoriz
ation
handle
List of
comman
ds to add
and list
of
comman
d to
remove

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 61 of 96

Name

Description

Indi
cato
r

Inputs

Outputs

Secu
rity
Func
tions

SSP
Access

This service is
not callable
from TPM
interface but is
only used
internally by
any command
and response
with an
authorization
area. It
consists in
computing the
integrity of the
received
command or
transmitted
response.
This service is
not callable
from TPM
interface but is
only used
internally by
any command
and response
with an
encryption or
decryption
session. It
consists in
decrypting the
first parameter
of a received
command or
encrypting the
first parameter
of a
transmitted
response.

Integrity mechanism
provided by sessions

Encryption mechanism
provided by sessions

Table 19: Approved Services

01b

Comman
d or
response

Integrity
value

DRB
G
KBK
DF
MAC
SHA
CKG

Unauthen
ticated
-
sesHmac
Key: E,Z

01b

Comman
d or
response

Encrypted
parameter

AES-
ENC
AES-
DEC
DRB
G
KBK
DF
SHA
CKG

Unauthen
ticated
-
sesSymK
ey: G,E,Z

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 62 of 96

The integrity mechanism provided by sessions is not directly callable from the security module external interfaces. Function is used (or might be used) by the services listed in this table. When a service is usable with a session, (I) is
added next to the service name. When a service can additionally use the encryption mechanism of a session, (I/E) is added next to the service name.
The encryption mechanism provided by sessions is not directly callable from the security module external interfaces. Function is used (or might be used) by the services listed in this table. When a service is usable with a session, (I) is
added next to the service name. When a service can additionally use the encryption mechanism of a session, (I/E) is added next to the service name.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 63 of 96

4.4 Non-Approved Services

All Approved services implemented by the Module are listed in the table below:

Name

TPM2_Create; TPM2_CreateLoaded;
TPM2_Load; TPM2_LoadExternal

Description
Creation or loading of an ECC key with a non-approved elliptic
curve; Creation or loading of an ECC key for a non-approved key
agreement usage;  Creation or loading of an ECC signing key with
an undetermined scheme (field
inPublic.buffer.parameters.scheme.scheme =
TPM_ALG_NULL);Creation or loading of an RSA decryption key
with an undetermined scheme (field
inPublic.buffer.parameters.scheme.scheme = TPM_ALG_NULL);
Creation or loading of a 1024-bit RSA key

TPM2_CreateLoaded

Derivation of an ECC key from a derivation parent key

TPM2_Load; TPM2_LoadExternal

Loading of an ECC or RSA key (sensitive and public parts) in the
NULL hierarchy

TPM2_Duplicate; TPM2_Rewrap;
TPM2_Import

Key transport with a 1024-bit RSA key Key agreement scheme
with a non-approved ECC curve Key agreement scheme with an
ECC key used in a non-approved key agreement usage

TPM2_RSA_Encrypt; TPM2_RSA_Decrypt

Key transport with a non-approved scheme: * RSAES-PKCS1-
v1_5 * RSA with no padding mode (null scheme) Key transport
with an RSA decryption key:  * Generated with an undetermined

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 64 of 96

Algorithms

Role

ECC BN P-256
(non-compliant)
RSA (non-
compliant)
X448 (non-
compliant)

ECC derived
keys (non-
compliant)
KBKDF (non-
compliant)
ECC BN P-256
(non-compliant)
RSA (non-
compliant)
ECC BN P-256
(non-compliant)
KAS (non-
compliant)
RSA (non-
compliant)
X448 (non-
compliant)
KTS-IFC (non-
compliant)
RSA with no

User

User

User

User

User

Name

Description
scheme (field inPublic.buffer.parameters.scheme.scheme =
TPM_ALG_NULL) * Loaded in the NULL hierarchy

TPM2_ECDH_KeyGen

Use of a non-approved elliptic curve:  * ECC key with curve BN P-
256 Use of an ECC key for a non-approved key agreement usage:
* ECC key with curve Curve448

TPM2_ECDH_ZGen

Use of an ECC key:  * Generated on curve BN P-256 * For a non-
approved key agreement usage * Derived from a derivation parent
key * Loaded in the NULL hierarchy

TPM2_ZGen_2Phase

This command is only usable jointly with TPM2_EC_Ephemeral
service that is non approved as using key derivation to generate
ECC keys

TPM2_HMAC

HMAC generation with a key length < 112 bits

Algorithms
padding mode
(null scheme)
(non-compliant)
RSAES-
PKCS1-v1_5
(non-compliant)
ECC BN P-256
(non-compliant)
X448 (non-
compliant)
ECC BN P-256
(non-compliant)
X448 (non-
compliant)
KBKDF (non-
compliant)
ECC derived
keys (non-
compliant)
KBKDF (non-
compliant)
HMAC (non-
compliant)

HMAC (non-
compliant)

Role

N/A

User

User

User

User

TPM2_HMAC_Start;
TPM2_SequenceUpdate;
TPM2_SequenceComplete

TPM2_Certify; TPM2_CertifyCreation;
TPM2_Quote;
TPM2_GetSessionAuditDigest;
TPM2_GetCommandAuditDigest;
TPM2_GetTime; TPM2_CertifyX509

HMAC generation with a key length < 112 bits

Digital signature with a non-approved signature scheme: * ECC
signature with ECDAA signature scheme * ECC signature with
ECSchnorr signature scheme * RSA signature with key length of
1024 bits * ECC or RSA signature key using SHA-1 as digest
method * ECC signature with curve BN P-256; Digital signature
with an ECC signing key generated with an undetermined scheme
(field inPublic.buffer.parameters.scheme.scheme =
TPM_ALG_NULL); Digital signature with an ECC signing key

ECC BN P-256
(non-compliant)
ECDAA (non-
compliant)
ECDSA (non-
compliant)
ECSchnorr
(non-compliant)

User/CO

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 65 of 96

Name

Description
derived from a derivation parent key; Digital signature with an
ECC or RSA key loaded in the NULL hierarchy

TPM2_Commit

Generation of an ECC key through key derivation method

TPM2_EC_Ephemeral

Generation of an ECC key through key derivation method

TPM2_VerifySignature

TPM2_Sign

TPM2_PolicySigned

Digital signature verification with a non-approved signature
scheme or a non-approved curve: * ECDAA signature scheme *
ECSchnorr signature scheme * ECC signature with curve BN P-
256

Digital signature generation with a non-approved signature
scheme: * ECC signature with ECDAA signature scheme * ECC
signature with ECSchnorr signature scheme * RSA signature with
key length of 1024 bits * ECC or RSA signature key using SHA-1
as digest method * ECC signature with curve BN P-256; Digital
signature with an ECC signing key generated with an
undetermined scheme (field
inPublic.buffer.parameters.scheme.scheme = TPM_ALG_NULL);
Digital signature with an ECC signing key derived from a
derivation parent key; Digital signature with an ECC or RSA key
loaded in the NULL hierarchy

Digital signature verification with a non-approved signature
scheme or a non-approved curve: * ECDAA signature scheme *
ECSchnorr signature scheme * ECC signature with curve BN P-
256

TPM2_CreatePrimary

Creation and loading of an ECC key with a non-approved elliptic
curve:  * ECC key with curve BN P-256 Use of an ECC key for a

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 66 of 96

Algorithms
RSA (non-
compliant)
SHA-1 (non-
compliant)
KBKDF (non-
compliant)
KBKDF (non-
compliant)
ECC BN P-256
(non-compliant)
ECDAA (non-
compliant)
ECSchnorr
(non-compliant)
ECC BN P-256
(non-compliant)
ECDAA (non-
compliant)
ECDSA (non-
compliant)
ECSchnorr
(non-compliant)
RSA (non-
compliant)
SHA-1 (non-
compliant)
ECC BN P-256
(non-compliant)
ECDAA (non-
compliant)
ECSchnorr
(non-compliant)
ECC BN P-256
(non-compliant)

Role

User

User

NA

User

N/A

CO

Name

TPM2_NV_Certify

Table 20: Non-Approved Services

Description
non-approved key agreement usage: * ECC key with curve
Curve448 Creation and loading of an ECC signing key with an
undetermined scheme (field
inPublic.buffer.parameters.scheme.scheme = TPM_ALG_NULL)
Creation and loading of an RSA decryption key with an
undetermined scheme (field
inPublic.buffer.parameters.scheme.scheme = TPM_ALG_NULL)

Digital signature with a non-approved signature scheme: * ECC
signature with ECDAA signature scheme * ECC signature with
ECSchnorr signature scheme * RSA signature with key length of
1024 bits * ECC or RSA signature key using SHA-1 as digest
method * ECC signature with curve BN P-256; Digital signature
with an ECC signing key generated with an undetermined scheme
(field inPublic.buffer.parameters.scheme.scheme =
TPM_ALG_NULL); Digital signature with an ECC key derived from
a derivation parent key; Digital signature with an ECC or RSA key
loaded in the NULL hierarchy

Algorithms
X448 (non-
compliant)

Role

ECC BN P-256
(non-compliant)
ECDAA (non-
compliant)
ECDSA (non-
compliant)
ECSchnorr
(non-compliant)
RSA (non-
compliant)
SHA-1 (non-
compliant)

User

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 67 of 96

4.5 External Software/Firmware Loaded

Loading of firmware onto the Module can be achieved by using two services:

•  TPM2_VendorCmdFieldUpgradeStart that performs the software/firmware load test detailed in the self-test section of this document to determine

if the authorizations to start a loading session are granted

•  TPM2_VendorCmdFieldUpgradeData  that  transports  the  protected  (confidentiality  and  integrity)  parts  of  the  firmware.  Several  commands  are

necessary to transport the full firmware.

Data outputs are inhibited until the loading session has completed successfully. Execution of the successfully loaded firmware is only effective after the next
reset of the security module.

New firmware versions must be validated through the FIPS 140-3 validation process. Any other firmware loaded into this module is out of the scope of this
validation and requires a separate FIPS 140-3 validation.

The core memory loader (CML) represented in Figure 8 is non-modifiable, only the TPM instances are modifiable by using an authenticated firmware upgrade
mechanism. The Module contains two instances of the firmware but only one instance is executed after a boot sequence.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 68 of 96

5 Software/Firmware Security

5.1 Integrity Techniques

The Module is composed of the following firmware component(s):

•  Core Memory Loader executable (aka CML)
•  TPM application instance 1 executable
•  TPM application instance 2 executable

The  firmware  integrity  is  verified  by  computing  a  CRC-16  [ISO  13239]  over  the  active  firmware  and
comparing  it  to  a  reference  value.  Firmware  integrity  is  verified  during  the  boot  sequence  before  the
execution of the code blocks (CML and TPM). If a failure is detected during the boot sequence, the TPM
enters  an infinite  reset loop that can be exited  only by a power-off/power-on sequence. If  a  failure is
detected during the self-tests execution, the security module enters failure mode.

Core Memory Loader

Sequencer

Sequencer

HWINTF
library

TPM2.0 commands

HWINTF
library

TPM2.0 commands

TPM2.0 core

TPM2.0 core

Memory
management and
low-level services

Cryptographic
library

Memory
management and
low-level services

Cryptographic
library

TPM instance #1

TPM instance #2

Figure 8 – Firmware block diagram

5.2 Initiate on Demand

The operator can initiate the integrity test on demand by using the TPM2_SelfTest command with the
full parameter set to YES or by using the TPM2_IncrementalSelfTest command.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 69 of 96

6 Operational Environment

6.1 Operational Environment Type and Requirements

Type of Operational Environment: Limited

The operational environment of the Module is “limited” because it allows loading authenticated firmware
that meets all applicable requirements of [140-3] standard.

Data  outputs  are  inhibited  until  the  loading  session  has  completed  successfully.  Execution  of  the
successfully loaded FW is only effective after the next reset of the security module.

New firmware versions must be validated through the FIPS 140-3 validation process. Any other firmware
loaded into this module is out of the scope of this validation and requires a separate FIPS 140-3 validation.

The core memory loader (CML) represented in  Figure  8  is non-modifiable, only the TPM instances are
modifiable by using an authenticated firmware upgrade mechanism.

The security module contains two instances of the FW but only one FW instance is executed after a boot
sequence.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 70 of 96

7 Physical Security

The  security module  is  production  grade  and  meets  the  Physical  Security  protection  requirements  for
single-chip module at FIPS 140-3 Level 3.

7.1 Mechanisms and Actions Required

Zeroization

Zeroization of CSPs can be triggered by specific services as detailed in Section 9.3. It occurs in a sufficiently
small  time-period  to  prevent  the  recovery  of  the  sensitive  data  between  start  of  zeroization  and  the
zeroization completion.

Physical security mechanisms

The security module is encapsulated in a hard opaque package to prevent direct observation of internal
security components. It implements additional security mechanisms:

•  An  active  metal  shield,  located  inside  the  package  and  covering  the  internal  circuitry  and  the
memory  components.  Cutting,  removing,  or  modifying  the  shield  layer  will  cause  the  security
module to reset and enter a shutdown mode.

•  An  internal  circuitry  detecting  environmental  conditions  outside  the  nominal  operating  range.
Power supply voltage and temperature are continuously monitored. If conditions exist outside
the range determined by the tamper detection circuitry, the security module resets and enters a
failure mode. The Module remains in failure mode as long as the environmental condition causing
the tamper event persists.

Physical security inspection

Mechanism

Hard opaque
package

Inspection Frequency
Dependent on the security module
integration environment varies from
once per month to once per year

Inspection Guidance
Visual inspection of the package to
confirm that it has not been
damaged by an external action

Table 21: Mechanisms and Actions Required

7.2 EFP/EFT Information

EFT has been performed for all security module configurations. Low and high temperatures have been
measured  at  a  nominal  voltage  of  3.3V.  Low  and  high  voltage  have  been  measured  at  ambient
temperature (25°C).

The nominal operating ranges are:

•  Between 1.62V and 3.8V for voltage

•  Between -40°C and +125°C for temperature

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 71 of 96

Temp/Voltage
Type

LowTemperature

HighTemperature

LowVoltage
HighVoltage

Temperature or Voltage

-77°C (ST33KTPM2A in UFQFPN32 WF); -70
(ST33KTPM2I in UFQFPN32 WF); -70 (ST33KTPM2A
in TSSOP20); -75 (ST33KTPM2I in WLCSP24)
165°C (ST33KTPM2A in UFQFPN32 WF); 160
(ST33KTPM2I in UFQFPN32 WF); 145 (ST33KTPM2A
in TSSOP20); 160 (ST33KTPM2I in WLCSP24)
1.4V
4.3V

EFP
or
EFT

Result

EFT  Shutdown

EFT  Shutdown

EFT  Shutdown
EFT  Shutdown

Table 22: EFP/EFT Information

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 72 of 96

7.3 Hardness Testing Temperature Ranges

Hardness testing was conducted at the temperature indicated in the table below:

Temperature
Type
LowTemperature
HighTemperature

Temperature

-40°C
105°C

Table 23: Hardness Testing Temperatures

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 73 of 96

8 Non-Invasive Security

8.1 Mitigation Techniques

The Module does not claim support of non-invasive attack mitigation techniques referenced in [140F].

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 74 of 96

9 Sensitive Security Parameters Management

9.1 Storage Areas

Storage
Area
Name

Dynamic
RAM

Static
RAM

NVRAM

Description

Volatile memory used to store SSPs between two consecutive
resets or power-on/power-off sequence of the security module.
SSPs don't persist after command execution. This area is marked
as RAM on the HW block diagram.
Volatile memory used to store SSPs between two consecutive
resets or power-on/power-off sequence of the security module.
SSPs persist after command execution. This area is marked as
RAM on the HW block diagram.
Non-volatile memory (flash-based) used to store SSPs and make
them persistent to a reset or a power-off/power-on sequence of
the security module. This area is marked as flash memory on the
HW block diagram.

Persistence
Type

Dynamic

Static

Static

Table 24: Storage Areas

9.2 SSP Input-Output Methods

Name

From

To

Format
Type

Distribution
Type

Entry
Type

SFI or
Algorithm

Input
plaintext
to
NVRAM
Input
protected
to
NVRAM
Input
plaintext
to RAM
Input
protected
to RAM
Output
plaintext
from
NVRAM
Output
protected
from
NVRAM

Outside of
cryptographi
c boundary

Outside of
cryptographi
c boundary

Outside of
cryptographi
c boundary
Outside of
cryptographi
c boundary

NVRAM

NVRAM

NVRAM

Plaintext

Manual

Electronic

NVRAM

Encrypted

Manual

Electronic

KTS

Static RAM

Plaintext

Manual

Electronic

Static RAM  Encrypted

Manual

Electronic

KTS

Outside of
cryptographic
boundary

Outside of
cryptographic
boundary

Plaintext

Manual

Electronic

Encrypted

Manual

Electronic

KTS

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 75 of 96

Name

From

To

Format
Type

Distribution
Type

Entry
Type

SFI or
Algorithm

Output
plaintext
from
RAM
Output
protected
from
RAM
Input
asym.
encrypte
d to RAM
Output
asym.
encrypte
d to RAM

Static RAM

Static RAM

Outside of
cryptographi
c boundary

Static RAM

Outside of
cryptographic
boundary

Outside of
cryptographic
boundary

Plaintext

Manual

Electronic

Encrypted

Manual

Electronic

KTS

Static RAM  Encrypted

Manual

Electronic  KTS-IFC

Outside of
cryptographic
boundary

Encrypted

Manual

Electronic  KTS-IFC

Table 25: SSP Input-Output Methods

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 76 of 96

9.3 SSP Zeroization Methods

Zeroization Method

TPM2_Init

Description
Zeroization of all volatile SSPs. Explicit zeroization indicator provided by
service completion status.

Rationale

N/A

TPM2_Clear

TPM2_Startup

TPM2_ChangePPS

TPM2_ChangeEPS

TPM2_EvictControl

TPM2_FlushContext

Automatic

TPM2_NV_UndefineSpace
TPM2_NV_UndefineSpaceSpecial

TPM2_VendorCmdZeroizeEK

TPM2_SequenceComplete
TPM2_EventSequenceComplete

Table 26: SSP Zeroization Methods

9.4 SSPs

Zeroization of all contexts associated with an Owner.  Explicit zeroization
indicator provided by service completion status.

Zeroization of platformAuth.  Explicit zeroization indicator provided by
service completion status.
Zeroize the platform primary seed and flush all transient and persistent
objects in the Platform hierarchy.  Explicit zeroization indicator provided
by service completion status.
Zeroize the endorsement primary seed and flush all transient and
persistent objects in the Endorsement hierarchy.  Explicit zeroization
indicator provided by service completion status.
Zeroize an object from NVRAM. Explicit zeroization indicator provided by
service completion status.
Zeroize an object from RAM. Explicit zeroization indicator provided by
service completion status.
Zeroize SSPs at the end of a command processing. Implicit zeroization
indication.
Zeroize a NV index. Explicit zeroization indicator provided by service
completion status.
Zeroize the endorsement key provisioned. Explicit zeroization indicator
provided by service completion status.
Zeroize a hash or HMAC sequence. Explicit zeroization indicator provided
by service completion status.

SSPs linked to an Owner must
not persist if the Owner
changes
Zeroize platformAuth before its
first use after a reset

Operator Initiation

Activation of reset signal

Send TPM2_Clear command

Send TPM2_Startup command

Platform hierarchy renewal

Send TPM2_ChangePPS command

Endorsement hierarchy
renewal

Method required to zeroize a
dedicated object in NVRAM
Method required to zeroize a
dedicated object in RAM
Method for limited life cycle
SSPs
Method required to flush NV
indices from NVRAM
Mandatory zeroization method
for EK SSPs
Method required to flush
sequences from RAM

Send TPM2_ChangeEPS command

Send TPM2_EvictControl command

Send TPM2_FlushContext command

No, zeroization is automatic.

Send TPM2_NV_UndefineSpace command. Send
TPM2_NV_UndefineSpaceSpecial command

Send TPM2_VendorCmdZeroizeEK  command

Send TPM2_SequenceComplete command. Send
TPM2_EventSequenceComplete command

All usage of these SSPs by the Module are described in the services detailed in section 4. The next table lists the SSPs used as keys.
Temporary storage duration column was removed for readability purposes because when temporary storage is indicated, duration corresponds to the duration of a command execution. The algorithms indicated in “Generate by” and
“Used by” columns correspond to items in the SFI table.

Description

Size - Strength

Type - Category

Generated By

Established
By

Name

nullProof

phProof
ehProof

shProof

Proof (secret value) of the null hierarchy

Proof (secret value) of the platform hierarchy
Proof (secret value) of the endorsement hierarchy

Proof (secret value) of the storage hierarchy

512 - 256

512 - 256
512 - 256

512 - 256

shProofForReseed

Random value

platformAuth

Authentication value for the platform hierarchy

endorsementAuth

Authentication value for the endorsement hierarchy

512 - 256
512 - 128 to 256 (depending on the underlying hash
algorithm used)
512 - 128 to 256 (depending on the underlying hash
algorithm used)

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 77 of 96

DRBG

DRBG
DRBG

DRBG

ENT-ESV

Symmetric key - CSP

Symmetric key - CSP
Symmetric key - CSP

Symmetric key - CSP

Entropy source - CSP
Authentication value /
Symmetric key - CSP
Authentication value /
Symmetric key - CSP

Used
By
KBKDF
MAC
MAC
MAC
KBKDF
MAC
DRBG
KBKDF
MAC
KBKDF
MAC

Name

Description

Size - Strength

Type - Category

Generated By

ownerAuth

Authentication value for the storage hierarchy

lockoutAuth

Authentication value for the lockout hierarchy

512 - 128 to 256 (depending on the underlying hash
algorithm used)
512 - 128 to 256 (depending on the underlying hash
algorithm used)

objSeed

objAuth

Seed value for  object generation

512 - 128 to 256

Object's authorization value

112 to 512 - 112 to 256

Authentication value /
Symmetric key - CSP
Authentication value /
Symmetric key - CSP
Data, Symmetric key -
CSP
Authentication value /
Symmetric key - CSP

DRBG
KBKDF

Established
By

objSymKey

Encryption key of object private part

256 - 256

Symmetric key - CSP

KBKDF

objHmacKey

Integrity key of object private part

160, 256, 384, 512 - 128 to 256

Symmetric key - CSP

KBKDF

objSens

Object private part

2048, 3072, 4096 (RSA); 128, 192, 256 (AES); 256,
384, 521 (ECC); 448 (EdDSA); 112 to 1024 (HMAC)
- 112 to 256

Symmetric or asymmetric
private key - CSP

KeyGen
KBKDF
CKG
KAS-KeyGen

objPub

nvAuth

sesSalt

Object public part

2048, 3072, 4096 (RSA); 512, 768, 1056 (ECC);
448 (EdDSA) - 112 to 256

Asymmetric public key -
PSP

KeyGen
KAS-KeyGen

Authorization of NV index

Salt for keys diversification

112 to 512 - 112 to 256

160, 256, 384, 512 - 128 to 256

Authentication value /
Symmetric key - CSP
Symmetric key - CSP

N/A

KAS

sesHmacKey

HMAC session key

160, 256, 384, 512 - 128 to 256

Symmetric key - CSP

KBKDF

sesSymKey

Encrypted session key

128, 192, 256 - 128 to 256

Symmetric key - CSP

KBKDF

contextKey

Derivation key for context protection

contextEncKey

Wrapping key for context protection

128 - 128

256 - 256

Symmetric key - CSP

DRBG

Symmetric key - CSP

KBKDF

dupInSymKey

Wrapping key for duplicated object

128, 192, 256 - 128 to 256

Symmetric key - CSP

DRBG

Used
By
KBKDF
MAC
KBKDF
MAC
KBKDF
SHA
KBKDF
MAC
AES-
ENC
AES-
DEC
MAC
AES-
ENC
AES-
DEC
SigGen
KAS
KBKDF
MAC
SigVer
KAS
KTS-
IFC
KBKDF
MAC
KBKDF
KBKDF
MAC
AES-
ENC
AES-
DEC
KBKDF
AES-
ENC
AES-
DEC
AES-
ENC
AES-
DEC

dupSeed

Seed for protection keys derivation

160 to 512 - 128 to 256

Symmetric key - CSP

DRBG
KAS

KAS

KBKDF

dupOutSymKey

Encryption key for duplicated objects

128, 192, 256 - 128 to 256

Symmetric key - CSP

KBKDF

dupOutHmacKey
creSeed

HMAC key for duplicated objects
Seed for credential keys derivation

160, 256, 384, 512 - 128 to 256
160 to 512 - 128 to 256

Symmetric key - CSP
Symmetric key - CSP

KBKDF

KAS

AES-
ENC
AES-
DEC
MAC
KBKDF

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 78 of 96

Name

Description

Size - Strength

Type - Category

Generated By

Established
By

creSymKey

Encryption key for credentials

128, 192, 256 - 128 to 256

Symmetric key - CSP

KBKDF

creHmacKey
ephSensEccKey
ephPubEccKey

ekRsa

ekEcc

HMAC key for credentials
ECC ephemeral private key
ECC ephemeral public key

160, 256, 384, 512 - 128 to 256
256, 384, 521 - 128 to 256
512, 768, 1056 - 128 to 256

Provisioned RSA endorsement key

2048 - 112

Symmetric key - CSP
ECC private key - CSP
ECC public key - PSP

RSA private key - CSP

Provisioned ECC endorsement key

256, 384 - 128 to 192

ECC private key - CSP

fuSigECCKey

Field upgrade ECC signature verification key

fuSigLMSKey

Field upgrade LMS signature verification key

384 - 192

32 - 128

Authorization value for hash or HMAC sequence

112 to 512 - 112 to 256

512 - 256
512 - 256
512 - 256
512 - 256

256 - 256

512 - 256

256 - 256

256 - 256

256 - 256

256 - 256

256 - 256

seqAuth

nullSeed
phSeed
ehSeed
shSeed

drbgState

drbgSeed

tdrbgState

Seed of the null hierarchy
Seed of the platform hierarchy
Seed of the endorsement hierarchy
Seed of the storage hierarchy
Internal state (V and C secret values) of the DRBG (based on
SHA256)
Seed value for the DRBG
Internal state (V and C secret values) of the transient DRBG
(based on SHA256) used to generate prime numbers for
primary RSA keys

fuSymSeed

Seed used for field upgrade symmetric key derivation

fuSymKey

field upgrade symmetric key

diagSymSeed

Seed used for diagnostic symmetric key derivation

diagSymKey

diagnostic symmetric key

Table 27: SSP Table 1

Name

nullProof

phProof

ehProof

shProof

shProofForReseed

Input - Output

Storage

Storage Duration

Static RAM:Plaintext

Until next reset

NVRAM:Plaintext

NVRAM:Plaintext

NVRAM:Plaintext

NVRAM:Plaintext

After Use

After Use

After Use

After Use

platformAuth

Input plaintext to RAM
Input protected to RAM

Static RAM:Plaintext

Until next reset

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 79 of 96

KBKDF
KAS-KeyGen
KAS-KeyGen
Input during
manufacturing
Input during
manufacturing
Input during
manufacturing
Input during
manufacturing

N/A

ENT-ESV
ENT-ESV
ENT-ESV
ENT-ESV

DRBG

ENT-ESV

ECC public key - PSP

LMS public key - PSP

Authentication value /
Symmetric key - CSP
Seed - CSP
Seed - CSP
Seed - CSP
Seed - CSP

State - CSP

Seed - CSP

State - CSP

DRBG

Symmetric key - Neither

Input during
manufacturing

Symmetric key - Neither

KBKDF

Symmetric key - Neither

Input during
manufacturing

Symmetric key - Neither

KBKDF

Used
By
AES-
ENC
AES-
DEC
MAC
KAS
KAS
KTS-
IFC

KAS

SigVer

SigVer

KBKDF
MAC
DRBG
DRBG
DRBG
DRBG

DRBG

DRBG

DRBG

KBKDF

AES-
DEC

KBKDF

AES-
ENC

Zeroization

TPM2_Init

TPM2_ChangePPS

TPM2_ChangeEPS
TPM2_Clear

TPM2_Clear

TPM2_Clear

TPM2_Init

Related SSPs
drbgState:Generates
contextEncKey:Derived From
drbgState:Generates
contextEncKey:Derived From
drbgState:Generates
contextEncKey:Derived From
drbgState:Generates
contextEncKey:Derived From
tdrbgState:Reseeded From
sesSymKey:Derived from, Protects
(Encrypts)
sesHmacKey:Derived from, Protects
(Integrity)

Name

endorsementAuth

ownerAuth

lockoutAuth

objSeed

objAuth

objSymKey

objHmacKey

objSens

objPub

nvAuth

sesSalt

sesHmacKey

Input - Output
Input plaintext to
NVRAM
Input protected to
NVRAM
Input plaintext to
NVRAM
Input protected to
NVRAM
Input plaintext to
NVRAM
Input protected to
NVRAM
Input protected to RAM
Input plaintext to RAM
Output protected from
RAM
Output protected from
NVRAM
Input plaintext to RAM
Input protected to RAM
Output protected from
RAM
Output protected from
NVRAM

Input plaintext to RAM
Input protected to RAM
Output protected from
RAM
Output protected from
NVRAM

Input plaintext to RAM
Output plaintext from
NVRAM
Output plaintext from
RAM

Input plaintext to
NVRAM
Input protected to
NVRAM
Input asym. encrypted to
RAM

Input protected to RAM
Output protected from
RAM

Storage

Storage Duration

Zeroization

NVRAM:Plaintext

After Use

TPM2_Clear
TPM2_ChangeEPS

NVRAM:Plaintext

After Use

TPM2_Clear

NVRAM:Plaintext

After Use

TPM2_Clear

Static RAM:Plaintext
NVRAM:Plaintext

Until object zeroization, shift to NVRAM
or next reset

Static RAM:Plaintext
NVRAM:Plaintext

Until object zeroization, shift to NVRAM
or next reset

Dynamic
RAM:Plaintext
NVRAM:Plaintext
Dynamic
RAM:Encrypted
NVRAM:Plaintext

After Use

After Use

Static RAM:Plaintext
NVRAM:Plaintext

Until object zeroization, shift to NVRAM
or next reset

Static RAM:Plaintext
NVRAM:Plaintext

Until object zeroization, shift to NVRAM
or next reset

TPM2_Init
TPM2_Clear
TPM2_ChangePPS
TPM2_ChangeEPS
TPM2_EvictControl
TPM2_FlushContext
TPM2_Init
TPM2_Clear
TPM2_ChangePPS
TPM2_ChangeEPS
TPM2_EvictControl
TPM2_FlushContext

Automatic

Automatic

TPM2_Init
TPM2_Clear
TPM2_ChangePPS
TPM2_ChangeEPS
TPM2_EvictControl
TPM2_FlushContext
TPM2_Init
TPM2_Clear
TPM2_ChangePPS
TPM2_ChangeEPS
TPM2_EvictControl
TPM2_FlushContext

NVRAM:Plaintext

After Use

TPM2_NV_UndefineSpace
TPM2_NV_UndefineSpaceSpecial

Dynamic
RAM:Plaintext

Dynamic
RAM:Plaintext

After Use

After Use

Automatic

Automatic

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 80 of 96

Related SSPs
sesHmacKey:Derived from, Protects
(Integrity)
sesSymKey:Derived from, Protects
(Encrypts)
sesHmacKey:Derived from, Protects
(Integrity)
sesSymKey:Derived from, Protects
(Encrypts)
sesHmacKey:Derived from, Protects
(Integrity)
sesSymKey:Derived from, Protects
(Encrypts)
tdrbgState:Derived From
drbgState:Derived From
objSymKey:Derived From
objHmacKey:Derived From
sesHmacKey:Protects (Integrity)
sesSymKey:Protects (Encrypts)

sesHmacKey:Derived from, Protects
(Integrity)
sesSymKey:Derived from, Encrypts

objAuth:Encrypted by
objSens:Encrypted by
objSeed:Encrypted by
objAuth:Protected by (Integrity)
objSens:Protected by (Integrity)
objSeed:Protected by (Integrity)
tdrbgState:Generates
drbgState:Generates
objSens:Derives
objSymKey:Encrypts
objHmacKey:Protects (Integrity)
objPub:Paired With

objSens:Paired With

sesHmacKey:Derived from, Protects
(Integrity)
sesSymKey:Encrypts

sesHmacKey:Derived From
objPub:Encrypts
nvAuth:Derives; Protected by (Integrity)
contextKey:Encrypts
contextEncKey:Encrypts
platformAuth:Protected by (Integrity)
endorsementAuth:Protected by

Name

Input - Output

Storage

Storage Duration

Zeroization

sesSymKey

Dynamic
RAM:Plaintext

After Use

Automatic

contextKey

Static RAM:Plaintext

Until next reset

Dynamic
RAM:Plaintext

After Use

TPM2_Init

Automatic

contextEncKey

dupInSymKey

dupSeed

dupOutSymKey

dupOutHmacKey

creSeed

creSymKey

creHmacKey

ephSensEccKey

Input plaintext to RAM
Input protected to RAM
Output plaintext from
RAM
Output protected from
RAM
Input asym. encrypted to
RAM
Output asym. encrypted
to RAM

Input asym. encrypted to
RAM
Output asym. encrypted
to RAM

Dynamic
RAM:Plaintext

Dynamic
RAM:Plaintext

Dynamic
RAM:Plaintext

Dynamic
RAM:Plaintext

Dynamic
RAM:Plaintext

Dynamic
RAM:Plaintext
Dynamic
RAM:Plaintext
Dynamic
RAM:Plaintext

After Use

Automatic

After Use

After Use

After Use

After Use

After Use

After Use

After Use

Automatic

Automatic

Automatic

Automatic

Automatic

Automatic

Automatic

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 81 of 96

Related SSPs
(Integrity)
ownerAuth:Protected by (Integrity)
lockoutAuth:Protected by (Integrity)
objAuth:Protected by (Integrity)
seqAuth:Protected by (Integrity)
dupInSymKey:Protected by (Integrity)
dupSeed:Protected by (Integrity)
creSeed:Protected by (Integrity)
sesHmacKey:Derives
platformAuth:Derives; Encrypts
endorsementAuth:Derives; Encrypts
ownerAuth:Derives; Encrypts
lockoutAuth:Derives; Encrypts
objAuth:Derives; Encrypts
seqAuth:Derives; Encrypts
nvAuth:Derives; Encrypts
dupInSymKey:Encrypted by
drbgState:Generates
contextEncKey:Derived From
contextKey:Derives
nullProof:Derives
phProof:Derives
ehProof:Derives
shProof:Derives

sesSymKey:Encrypts
sesHmacKey:Protects (Integrity)
objSens:Encrypted by

objPub:Encrypts
dupOutSymKey:Derived from
dupOutHmacKey:Derived from

dupSeed:Derives
objSens:Encrypted by
objAuth:Encrypted by
objSeed:Encrypted by
dupSeed:Derives
objSens:Protects (Integrity)
objAuth:Protects (Integrity)
objSeed:Protects (Integrity)

creSymKey:Derives
creHmacKey:Derives
objPub:Encrypts

creSeed:Derived From

creSeed:Derived From

drbgState:Generates

Input - Output
Input plaintext to RAM
Output plaintext from
RAM

Input plaintext to RAM
Input protected to RAM
Output protected from
RAM

Storage

Dynamic
RAM:Plaintext

NVRAM:Plaintext
NVRAM:Plaintext
NVRAM:Plaintext
NVRAM:Plaintext

Storage Duration

After Use

After Use
After Use
After Use
After Use

Zeroization

Automatic

TPM2_VendorCmdZeroizeEK
TPM2_VendorCmdZeroizeEK
N/A
N/A

NVRAM:Plaintext

Until use of zeroization command or
next reset

TPM2_SequenceComplete
TPM2_EventSequenceComplete

Static RAM:Plaintext
NVRAM:Plaintext
NVRAM:Plaintext
NVRAM:Plaintext

Until next reset
After Use
After Use
After Use

Static RAM:Plaintext

Until next reset or use of TPM2_Clear

Dynamic
RAM:Plaintext

Dynamic
RAM:Plaintext

NVRAM:Plaintext
Dynamic
RAM:Plaintext
NVRAM:Plaintext
Dynamic
RAM:Plaintext

After Use

After Use

After Use

After Use

After Use

After Use

TPM2_Init
TPM2_ChangePPS
TPM2_ChangeEPS
TPM2_Clear
TPM2_Init
TPM2_Clear

Automatic

Automatic

N/A

Automatic

N/A

Automatic

Related SSPs

ephSensEccKey:Derives

objSens:Derived From
objSens:Derived From

sesSymKey:Derived From
sesHmacKey:Derived From

tdrbgState:Instantiated with
tdrbgState:Instantiated with
tdrbgState:Instantiated with
tdrbgState:Instantiated with

drbgSeed:Instantiates

drbgState:Instantiated with

nullSeed:Instantiates
phSeed:Instantiates
ehSeed:Instantiates
shSeed:Instantiates
fuSymKey:Derived From

fuSymSeed:Derives

diagSymKey:Derived From

diagSymSeed:Derives

Name

ephPubEccKey

ekRsa
ekEcc
fuSigECCKey
fuSigLMSKey

seqAuth

nullSeed
phSeed
ehSeed
shSeed

drbgState

drbgSeed

tdrbgState

fuSymSeed

fuSymKey

diagSymSeed

diagSymKey

Table 28: SSP Table 2

9.5 Transitions

The use of SHA-1 for digital signature generation is non-Approved and only available through non-Approved services. All other applications of SHA-1 are acceptable, where collision resistance is not required.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 82 of 96

The next table gives the security strength of a key depending on the underlying algorithm used and its
size:

Algorithm

Underlying algorithm

Key size (bits)

Security strength (bits)

SHA-1

KBKDF

SHA2-256

SHA2-384

SHA2-512

SHA-1

HMAC

SHA2-256

SHA2-384

SHA2-512

SHA2-256

-

-

-

DRBG

AES

RSA

ECC

size ≥ 128

size < 128

size ≥ 192

size < 192

size ≥ 256

size < 256

size ≥ 128

size < 128

size ≥ 192

size < 192

size ≥ 256

size < 256

-

128

Key size

192

Key size

256

Key size

128

Key size

192

Key size

256

Key size

256

128 / 192 / 256

128 / 192 / 256

2048 / 3072 / 4096

112 / 128 / 142

256 / 384 / 448 / 521

128 / 192 / 224 / 256

Table 29 – Security Strength of a Key Depending on the Underlying Algorithm Used and its Size

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 83 of 96

10 Self-Tests

10.1 Pre-Operational Self-Tests

The Module performs self-tests to ensure the proper operation of the Module. Per FIPS 140-3 these are categorized as either pre-operational self-tests or conditional self-tests. Pre-operational self–tests are available on demand by
power cycling the Module. The Module performs the following pre-operational self-tests in the table below:

Algorithm or
Test
Firmware
integrity test

HW integrity

Test Properties

CRC 16

HW registers
verification

Test
Method

EDC

KAT

Test Type

SW/FW
Integrity
Critical
Function

Table 30: Pre-Operational Self-Tests

Indicator

Details

Successful execution of TPM2_Startup command
indicates tests have been run
Successful execution of TPM2_Startup command
indicates tests have been run

FW integrity is verified by computing an EDC (CRC-16 [ISO13239]) and comparing it to
reference values.
HW integrity is guaranteed via check of HW sensors. If failure is detected during boot
sequence, status is set to FAIL, and error is returned.

10.2 Conditional Self-Tests

The Module performs the following conditional self-tests as shown in the table below. The bit index indicated in the “Indicator” column corresponds to the index in the algo_status field in the TPM2_GetTestResult response.

Algorithm or
Test
AES-CBC
(A5356) Encrypt
AES-CBC
(A5356) Decrypt
ECDSA KeyGen
(FIPS186-4)
(A5358)
ECDSA SigGen
(FIPS186-4)
(A5358)
ECDSA SigVer
(FIPS186-4)
(A5358)

Test Properties

Test Method

Test
Type

Indicator

Details

Conditions

CAST

Bit #7 clear

AES CBC 128 encryption of known data compared to a reference value.

Power On

AES-128-CBC

AES-128-CBC

KAT

KAT

CAST

Bit #7 clear

P-256, P-384, P-521

PCT

PCT

Key creation
failure

NIST P-256

KAT

CAST

Bit #10 clear

AES CBC 128 decryption of known encrypted data and comparison to the expected
plaintext data
Depending on the key purpose (signing or key establishment) an ECDSA signature is
generated (k fixed and the message varies) and verified with pairwise consistency test as
defined by [56Ar3] or a scalar multiplication is done and compared to the public key.

Power On

Upon ECC Key
Generation

ECDSA signature generation on known data with known key and k. Output of signature is
compared to a reference signature.

Power On

NIST P-256

KAT

CAST

Bit #10 clear

ECDSA signature verification on known signature with known key and k.

Power On

Entropy

RCT and APT

[90B] Health-
Test

CAST

Bit #1 clear

AIS31 and [90B] (RCT and APT)  start-up health tests on ENT(P) output sequence. If test
fails, test status is set to FAIL, and error is returned

At each random
bits generation

Firmware loading

ECDSA P-384 and LMS

Signature
Verification

SW/FW
Load

Error returned on
FW loading
command

Hash DRBG
(A5351)

HMAC-SHA-1
(A5355)

KAS-ECC
Sp800-56Ar3
(A5358)

KDF SP800-108
(A5354)

SHA2-256

KAT

CAST

Bit #1 clear

HMAC-SHA1

KAT

CAST

Bit #5 clear

NIST P-256

KAT

CAST

Bit #9 clear

N/A

KAT

CAST

Bit #6 clear

Verification of chained digest and signature to ensure authentication of the FW

Instantiate then Reseed are seeded with a known seed value (64 bytes). Random is then
generated with Generate API to output a 32-bytes value compared to a reference value
(single test sequence done in accordance with §11.3 of [90A])
HMAC on known data and known key. Comparison of output to an expected MAC value
(20 bytes)
Primitive "Z" Computation and key derivation are implemented: a known private key d is
used with a known point P of NIST P-256 curve to compute Q = dP.  Key derivation of Q
performed with SHA-1 underlying algorithm to output a key of 20 bytes that is compared
to a refence value
KDF on known data and known label. Comparison of output to an expected derivation
value (32 bytes)

Upon firmware
load

Power On

Power On

Power On

Power On

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 84 of 96

Algorithm or
Test
LMS SigVer
(A5360)
RSA SigGen
(FIPS186-5)
(A5357)
RSA SigVer
(FIPS186-5)
(A5357)
RSA KeyGen
(FIPS186-5)
(A5357)

SHS

EDDSA SigGen
(A5359)
EDDSA SigVer
(A5359)
EDDSA KeyGen
(A5359)

Test Properties

Test Method

Test
Type

Indicator

Details

Conditions

LMOTS_SHA256_N32_W4
LMS_SHA256_M32_H10

KAT

CAST

Bit #8 clear

LMS signature verification of known signature with known data and known key.

Power On

RSASSA-PKCS1-v1_5

KAT

CAST

Bit #12 clear

RSA signature generation on known data with a known key. Output of signature is
compared to a reference signature (covers also KTS-IFC functionality)

Power On

RSASSA-PKCS1-v1_5

KAT

CAST

Bit #12 clear

RSA signature verification on a known signature with a known key (covers also KTS-IFC
functionality)

Power On

2048, 3072 or 4096-bit

PCT

PCT

Key creation
failure

Depending on the key purpose (signing or encrypting) indicated in sign attribute of the
key, encryption/decryption or signing/verification is done on known data

Upon RSA Key
Generation

SHA1, SHA2-256, SHA2-512,
SHA3-256

KAT

CAST

Bit #2 clear Bit
#3 clear Bit #4
clear

CAST

Bit #11 clear

Hash of known data and comparison of output to an expected digest. SHA-1, SHA2-256,
SHA2-512 are tested twice to cover each of the two implementations covered by CAVP
Cert. #A5352 and #A5353.
EdDSA signature generation on known data with known key. Output of signature is
compared to a reference signature.

Ed448

Ed448

Ed448

KAT

KAT

PCT

CAST

Bit #11 clear

Signature verification performed on the generated signature

PCT

Key creation
failure

An EdDSA signature is generated and verified with pairwise consistency test.

Power On

Power-On

Power-On

Upon EdDSA
Key Generation

Table 31: Conditional Self-Tests

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 85 of 96

10.3 Periodic Self-Test Information

Algorithm or
Test
Firmware
integrity test
HW integrity

Test Method

Test Type

Period

EDC

KAT

SW/FW Integrity

On demand

Critical Function

On demand

Table 32: Pre-Operational Periodic Information

Test Method

Test Type

Period

Periodic
Method

Manually

Manually

Periodic
Method

Manually

Algorithm or
Test
AES-CBC
(A5356) Encrypt
AES-CBC
(A5356) Decrypt
ECDSA KeyGen
(FIPS186-4)
(A5358)
ECDSA SigGen
(FIPS186-4)
(A5358)
ECDSA SigVer
(FIPS186-4)
(A5358)

Entropy

Firmware
loading
Hash DRBG
(A5351)
HMAC-SHA-1
(A5355)
KAS-ECC
Sp800-56Ar3
(A5358)
KDF SP800-108
(A5354)
LMS SigVer
(A5360)
RSA SigGen
(FIPS186-5)
(A5357)
RSA SigVer
(FIPS186-5)
(A5357)
RSA KeyGen
(FIPS186-5)
(A5357)
SHS

KAT

KAT

PCT

KAT

KAT

[90B] Health-
Test
Signature
Verification

KAT

KAT

KAT

KAT

KAT

KAT

KAT

PCT

KAT

CAST

CAST

PCT

On Demand

On Demand

Manually

N/A

Manually

CAST

On Demand

Manually

CAST

On Demand

Manually

CAST

On Demand

Manually

SW/FW Load

On Demand

Manually

CAST

CAST

On Demand

Manually

On Demand

Manually

CAST

On Demand

Manually

CAST

CAST

On Demand

Manually

On Demand

Manually

CAST

On Demand

Manually

CAST

On Demand

Manually

PCT

N/A

Manually

CAST

On Demand

Manually

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 86 of 96

Algorithm or
Test
EDDSA SigGen
(A5359)
EDDSA SigVer
(A5359)
EDDSA KeyGen
(A5359)

Test Method

Test Type

Period

KAT

KAT

PCT

CAST

CAST

PCT

Periodic
Method

Manually

On Demand

On Demand

Manually

N/A

Manually

Table 33: Conditional Periodic Information

10.4 Error States

Name

Description

Conditions

Recovery
Method

ES1

The Module fails a
KAT, PCT, FW or
HW integrity
verification, [90B]
health test

The Module
enters the
failure state

Reboot/Power
cycle the
module

ES2

The Module fails a
firmware loading
test

The Module
returns to
normal state

None

Table 34: Error States

Indicator

Outputs return code of
TPM_RC_FAILURE,
otherwise it indicates
successful completion by
TPM_RC_SUCCESS
Return code different from
TPM_RC_SUCCESS sent on
firmware upgrade start
command

All cryptographic functions are inhibited while the Module is in an error state. Successful completion of
self-tests  can be verified through use  of TPM2_GetTestResult  command. The first 4 bytes of response
indicate self-tests status. If they are equal to 0, self-tests completed successfully. If not, the subsequent 4
bytes indicate the list of algorithms not fully self-tested.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 87 of 96

11 Life-Cycle Assurance

11.1 Installation, Initialization, and Startup Procedures

Installation and Initialization:

The following steps must be performed in order to securely install, initialize, and start up the Module in
the FIPS 140-3 Approved mode of operation:

•  Connection of the Module with its environment must be done according to the pinout description

detailed in section 3.2.

•  Command  TPM2_SetCapability  with  the  following  parameters  must  be  sent  to  the  Module  to

configure it in FIPS 140-3 Level 2 mode:

o  setCapability = TPM_CAP_N_CONFIGS (0x80100000)
o  configuration = TPM_PT_CONFIG_FIPS_SL2_MODE (0x00000000)
o  enable = YES (0x01)
o
lock = YES (0x01)

Module operation:

Once configured in FIPS 140-3 Level 2, the following restrictions are enforced by the Module:

•  The default authValue of hierarchies (owner, endorsement, lockout, platform) must be changed
prior to being used in an authorization session. If not done, the authorization will be reported as
failed.

•  Use of other authorization sessions than the ones described in section 4.1 is prohibited except for

the following use cases:

o  First use or use after TPM2_Clear (for the owner, endorsement, or lockout authValue) or
use  after  reset  (for  the  platform  authValue)  of  the  TPM2_HierarchyChangeAuth
command to change the default authValue of the hierarchies.

•

If the minimum length of an object’s authValue is less than 112 bits (14 bytes), the creation of the
object will fail with the error TPM_RC_AUTHSIZE. This concerns keys, NV indices and Hash/HMAC
sessions.

•  Use  of  a  policy  authorization  session  will  fail  and  report  TPM_RC_AUTH_FAIL  if  one  of  the

following policy commands is not part of the policy:

Policy command

Authentication mechanism

Description

TPM2_PolicyAuthValue

Message Authentication Code

TPM2_ PolicySigned

TPM2_ PolicyAuthorize

Public Key Digital Signature
Algorithm or
Message Authentication Code

Message Authentication Code

TPM2_PolicySecret

Message Authentication Code

authValue of authorized entity is used as
HMAC key in authorization HMAC (as for
HMAC session)

Signature with asymmetric or HMAC key

Signature with HMAC key being one of the
hierarchy proofs
authValue of reference entity is provided in
HMAC session, or policy session containing
TPM2_PolicyAuthValue

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 88 of 96

TPM2_PolicyTicket

Message Authentication Code

Bound session

Message Authentication Code

Signature with HMAC key (one of the proofs)
generated by TPM2_PolicySigned or
TPM2_PolicySecret
authValue of bound entity is used as KDK
generated from KBKDF in session key
derivation

Table 35 – List of policy commands to use in a policy session

TPM  is  operated  in  an  Approved mode of operation  as  long  as  no  non-Approved  service  using  a  non-
Approved algorithm is used. No specific rules of operation are required to operate this module at FIPS
140-3 Level 2.

TPM is in normal operation mode when all pre-operational and conditional self-tests (apart from firmware
load  and  PCT  tests)  are  complete.  All  Approved  and  non-Approved  services  with  the  corresponding
indicator reporting if the service uses an Approved cryptographic algorithm or a security function.

Products list:

The Module configurations indicated in  Table  8  are defined into several manufactured products listed
hereafter.

The default firmware version of ZA9 and AC5 modules configuration is 10.257. To operate with firmware
version 10.512, the Module must first be field upgraded to 10.512.

Module name /
HW P/N

Package

Interface

Marking

FW version

TPM2.0 revision

Module name /
HW P/N

Package

Interface

Module Configuration

ST33KTPM2I

UFQFPN32 WF, WLCSP24

SPI / I2C

KTPMI ZA9

00.0A.02.00 (10.512)

1.59

Table 36 – ZA9 Module Configuration

Module Configuration

ST33KTPM2A

UFQFPN32 WF, TSSOP20

SPI / I2C

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 89 of 96

Marking

FW version

TPM2.0 revision

KTPMA AC5

00.0A.02.00 (10.512)

1.59

Table 37 – AC5 Module Configuration

Module name /
HW P/N

Package

Interface

Marking

FW version

TPM2.0 revision

Module name /
HW P/N

Package

Interface

Marking

FW version

TPM2.0 revision

Module Configuration

ST33KTPM2I

UFQFPN32 WF, WLCSP24

SPI / I2C

KTPMI ZB1

00.0A.02.00 (10.512)

1.59

Table 38 – ZB1 Module Configuration

Module Configuration

ST33KTPM2A

UFQFPN32 WF, TSSOP20

SPI / I2C

STV10TPM AD6

00.0A.02.00 (10.512)

1.59

Table 39 – AD6 Module Configuration

The current FIPS 140-3 Level 2 Security Policy applies to the Module configurations listed above when the
Module  is  configured  in  FIPS  140-3  Level  2  mode  with  the  command  TPM2_SetCapability.  For  the
configurations supporting both SPI and I2C interfaces, the selection of the mode is done during the boot
of the Module.

11.2 Administrator Guidance

No specific initialization procedure is required.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 90 of 96

11.3 Non-Administrator Guidance

No initialization procedures are required.

11.4 Design and Rules

Rules of Operation

1.  The Module provides two operator roles: the Cryptographic Officer and the User role. Each role

is associated with a set of services as detailed in the services table.

2.  The Module, evaluated at FIPS 140-3 Level 2, requires authentication to access some of the

services as detailed in the services table.

3.  The Module allows the operator to initiate power-up self-tests by power cycling or resetting the

Module.

4.  Power up self-tests do not require any operator action.

5.  Data output is inhibited during key generation, self-tests, zeroization, firmware loading, and

error states.

6.  Status information does not contain CSPs or sensitive data that, if misused, could lead to a

compromise of the Module.

7.  The Module does not support concurrent operators.

8.  The Module does not support a maintenance interface or role.

9.  The Module does not support manual key entry method.

10. The Module does not have any proprietary external input/output devices used for entry/output

of data.

11. The Module does not output intermediate key values.

12. The Module does not provide bypass services or ports/interfaces.

13. The Module does not support a self-initiated cryptographic output capability.

14. For all zeroization methods, the Module must be in direct control of the operator.

11.5 End of Life

End-of-life of the product requires the following zeroization commands to be executed to remove all
CSPs from the memory of the Module:

•  TPM2_Init

•  TPM2_Clear

•  TPM2_ChangeEPS

•  TPM2_ChangePPS

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 91 of 96

•  TPM2_VendorCmdZeroizeEK

•  TPM2_NV_UndefineSpace or TPM2_NV_UndefineSpaceSpecial

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 92 of 96

12 Mitigation of Other Attacks

The Module does not implement any mitigation method against other attacks.

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 93 of 96

References and Definitions

The following standards are referred to in this Security Policy:

Abbreviation

Full Specification Name

[TPM2.0 Part1]

TPM2.0 Main, Part 1, Architecture, rev 1.59, TCG

[TPM2.0 Part2]

TPM2.0 Main, Part 2, Structures, rev 1.59, TCG

[TPM2.0 Part3]

TPM2.0 Main, Part 3, Commands, rev 1.59, TCG

[TPM2.0 Part4]

TPM2.0 Main, Part 4, Supporting routines, rev 1.59, TCG

[PTP 1.06]

TCG PC Client Platform TPM Profile (PTP) Specification, rev. 1.06

[ISO19790]

[ISO24759]

[ISO13239]

[140-3]

[140]

[140A]

[140Br1]

[140C]

[140D]

[140E]

[140F]

[IG]

[108]

[131A]

[133]

International Standard, ISO/IEC 19790, Information technology — Security techniques — Test
requirements for cryptographic modules, Third edition, March 2017

International Standard, ISO/IEC 24759, Information technology — Security techniques — Test
requirements for cryptographic modules, Second and Corrected version, 15 December 2015

International Standard, ISO/IEC 13239, Information technology — Telecommunications and
information exchange between systems — High-level data link control (HDLC) procedures, July
2002

Security Requirements for Cryptographic Modules, March 22, 2019

NIST Special Publication 800-140, FIPS 140-3 Derived Test Requirements (DTR), CMVP Validation
Authority Updates to ISO/IEC 24759, March 2020

NIST Special Publication 800-140A, CMVP Documentation Requirements, CMVP Validation
Authority Updates to ISO/IEC 24759, March 2020

NIST Special Publication 800-140B revision 1, CMVP Security Policy Requirements, CMVP
Validation Authority Updates to ISO/IEC 24759 and ISO/IEC 19790 Annex B, November 2023

NIST Special Publication 800-140Cr2, CMVP Approved Security Functions, CMVP Validation
Authority Updates to ISO/IEC 24759, July 2023

NIST Special Publication 800-140Dr2, CMVP Approved Sensitive Security Parameter Generation
and Establishment Methods, CMVP Validation Authority Updates to ISO/IEC 24759, July 2023

NIST Special Publication 800-140E, CMVP Approved Authentication Mechanisms, CMVP
Validation Authority Requirements for ISO/IEC 19790:2012 Annex E and ISO/IEC 24759 Section
6.17, March 2020

NIST Special Publication 800-140Fr1, CMVP Approved Non-Invasive Attack Mitigation Test
Metrics, CMVP Validation Authority Updates to ISO/IEC 24759, August 2021

Implementation Guidance for FIPS PUB 140-3 and the Cryptographic Module Validation Program,
March 2024

NIST Special Publication 800-108r1-upd1, Recommendation for Key Derivation Using
Pseudorandom Functions (Revised), August 2022

Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key
Lengths, Revision 2, March 2019

NIST Special Publication 800-133, Recommendation for Cryptographic Key Generation, Revision
2, June 2020

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 94 of 96

Abbreviation

Full Specification Name

[135]

[186]

[197]

[198]

[180]

[202]

[208]

[38A]

[56Ar3]

[56Br2]

[90A]

[90B]

[5639]

National Institute of Standards and Technology, Recommendation for Existing Application-
Specific Key Derivation Functions, Special Publication 800-135rev1, December 2011

National Institute of Standards and Technology, Digital Signature Standard (DSS), Federal
Information Processing Standards Publication 186-5, Feb 2023

National Institute of Standards and Technology, Advanced Encryption Standard (AES), Federal
Information Processing Standards Publication 197-upd1, May, 2023

National Institute of Standards and Technology, The Keyed-Hash Message Authentication Code
(HMAC), Federal Information Processing Standards Publication 198-1, July, 2008

National Institute of Standards and Technology, Secure Hash Standard, Federal Information
Processing Standards Publication 180-4, August 2015

FEDERAL INFORMATION PROCESSING STANDARDS PUBLICATION, SHA-3 Standard: Permutation-
Based Hash and Extendable-Output Functions, FIPS PUB 202, August 2015

National Institute of Standards and Technology, Recommendation for Stateful Hash-Based
Signature Schemes, October 2020

National Institute of Standards and Technology, Recommendation for Block Cipher Modes of
Operation, Methods and Techniques, Special Publication 800-38A, December 2001

NIST Special Publication 800-56A Revision 3, Recommendation for Pair-Wise Key Establishment
Schemes Using Discrete Logarithm Cryptography, April 2018

NIST Special Publication 800-56B Revision 2, Recommendation for Pair-Wise Key Establishment
Schemes Using Finite Field Cryptography, March 2019

National Institute of Standards and Technology, Recommendation for Random Number
Generation Using Deterministic Random Bit Generators, Special Publication 800-90A, Revision 1,
June 2015

National Institute of Standards and Technology, Recommendation for the Entropy Sources Used
for Random Bit Generation, Special Publication 800-90B, January 2018

Request for Comments, Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve
Generation, March 2010

Table 40 – References

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 95 of 96

Acronym

Definition

APT

BN P-256

BP P-256

BP P-384

BP P-512

FW

HW

KAT
I2C

MPU

RCT

SPI

SSP

TCG

TPM

Adaptive Proportion Test

Barreto-Naehrig 256-bit elliptic curve

Brainpool 256-bit elliptic curve

Brainpool 384-bit elliptic curve

Brainpool 512-bit elliptic curve

Firmware

Hardware

Know Answer Test

Inter-Integrated Circuit

Memory Protection Unit

Repetition Count Test

Serial Peripheral Interface

Sensitive Security Parameter

Trusted Computing Group

Trusted Platform Module

Table 41 – Acronyms and Definitions

Copyright STMicroelectronics, 2024
Public Material – May be reproduced only in its original entirety (without revision).

Version 04-02

Page 96 of 96

