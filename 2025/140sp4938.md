Ampex Data Systems Corporation

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Non-Proprietary Security Policy

Document Version 1.11

May 29, 2024

Prepared for:

Prepared by:

Ampex Data Systems Corporation
26460 Corporate Avenue, Suite 200
Hayward, CA 94545
ampex.com
+1 650.367.2011

KeyPair Consulting Inc.
987 Osos Street
San Luis Obispo, CA 93401
keypair.us
+1 805.316.5024

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 1 of 24

TuffServ® Encryption Module (TSEM)

Table of Contents

FIPS 140-3 Security Policy

3

2

1  General ................................................................................................................................................................................................................................ 5
1.1  Overview .................................................................................................................................................................................................................................. 5
Security Levels ......................................................................................................................................................................................................................... 5
1.2
Cryptographic Module Specification ................................................................................................................................................................................... 5
2.1  Description ............................................................................................................................................................................................................................... 5
Tested and Vendor Affirmed Module Version and Identification ........................................................................................................................................... 8
2.2
2.3
Excluded Components ............................................................................................................................................................................................................. 8
2.4  Modes of Operation ................................................................................................................................................................................................................ 8
Algorithms ............................................................................................................................................................................................................................... 8
2.5
Security Function Implementations....................................................................................................................................................................................... 10
2.6
Algorithm Specific Information .............................................................................................................................................................................................. 10
2.7
RBG and Entropy .................................................................................................................................................................................................................... 11
2.8
2.9
Key Generation ...................................................................................................................................................................................................................... 11
2.10  Key Establishment ................................................................................................................................................................................................................. 11
Industry Protocols .................................................................................................................................................................................................................. 11
2.11
Cryptographic Module Interfaces ...................................................................................................................................................................................... 12
Ports and Interfaces ............................................................................................................................................................................................................... 12
Roles, Services, and Authentication .................................................................................................................................................................................. 12
Authentication Methods ....................................................................................................................................................................................................... 12
4.1
Roles ...................................................................................................................................................................................................................................... 13
4.2
4.3
Approved Services ................................................................................................................................................................................................................. 13
4.4  Non-Approved Services ......................................................................................................................................................................................................... 17
External Software/Firmware Loaded ..................................................................................................................................................................................... 17
4.5
Software/Firmware Security .............................................................................................................................................................................................. 17
Integrity Techniques .............................................................................................................................................................................................................. 17
Initiate on Demand ................................................................................................................................................................................................................ 17
6  Operational Environment .................................................................................................................................................................................................. 17
6.1  Operational Environment Type and Requirements ............................................................................................................................................................... 17
Physical Security ................................................................................................................................................................................................................ 17
7.1  Mechanisms and Actions Required ....................................................................................................................................................................................... 17
8  Non-Invasive Security ........................................................................................................................................................................................................ 18
Sensitive Security Parameters Management .................................................................................................................................................................... 19
9

5.1
5.2

3.1

4

5

7

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 2 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

9.1
9.2
9.3
9.4

Storage Areas ......................................................................................................................................................................................................................... 19
SSP Input-Output Methods .................................................................................................................................................................................................... 19
SSP Zeroization Methods ....................................................................................................................................................................................................... 19
SSPs ........................................................................................................................................................................................................................................ 19
10  Self-Tests ............................................................................................................................................................................................................................ 21
10.1  Pre-Operational Self-Tests ..................................................................................................................................................................................................... 21
10.2  Conditional Self-Tests ............................................................................................................................................................................................................ 21
10.3  Periodic Self-Test Information ............................................................................................................................................................................................... 22
10.4  Error States ............................................................................................................................................................................................................................ 22
10.5  Operator Initiation of Self-Tests ............................................................................................................................................................................................ 23
11  Life-Cycle Assurance .......................................................................................................................................................................................................... 23
11.1
Installation, Initialization, and Startup Procedures ............................................................................................................................................................... 23
11.2  Administrator Guidance ........................................................................................................................................................................................................ 23
11.3  Non-Administrator Guidance ................................................................................................................................................................................................ 23
11.4  Design and Rules .................................................................................................................................................................................................................... 23
11.5  End of Life .............................................................................................................................................................................................................................. 24
12  Mitigation of Other Attacks ............................................................................................................................................................................................... 24

List of Tables

Table 1: Security Levels ............................................................................................................................................................................................................... 5
Table 2: Tested Module Identification – Hardware ..................................................................................................................................................................... 8
Table 3: Modes List and Description ........................................................................................................................................................................................... 8
Table 4: Approved Algorithms - Cipher ....................................................................................................................................................................................... 8
Table 5: Approved Algorithms - Signature .................................................................................................................................................................................. 9
Table 6: Approved Algorithms - Random .................................................................................................................................................................................... 9
Table 7: Approved Algorithms - Message authentication ........................................................................................................................................................... 9
Table 8: Approved Algorithms - Key derivation .......................................................................................................................................................................... 9
Table 9: Approved Algorithms - Message digest ......................................................................................................................................................................... 9
Table 10: Vendor-Affirmed Algorithms ....................................................................................................................................................................................... 9
Table 11: Security Function Implementations........................................................................................................................................................................... 10
Table 12: Entropy Sources ......................................................................................................................................................................................................... 11
Table 13: Ports and Interfaces ................................................................................................................................................................................................... 12
Table 14: Authentication Methods............................................................................................................................................................................................ 13
Table 15: Roles .......................................................................................................................................................................................................................... 13
Table 16: Approved Services ..................................................................................................................................................................................................... 15

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 3 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

Table 17: Mechanisms and Actions Required ........................................................................................................................................................................... 18
Table 18: Storage Areas ............................................................................................................................................................................................................. 19
Table 19: SSP Input-Output Methods ........................................................................................................................................................................................ 19
Table 20: SSP Zeroization Methods ........................................................................................................................................................................................... 19
Table 21: SSP Table 1 ................................................................................................................................................................................................................. 20
Table 22: SSP Table 2 ................................................................................................................................................................................................................. 21
Table 23: Pre-Operational Self-Tests ......................................................................................................................................................................................... 21
Table 24: Conditional Self-Tests ................................................................................................................................................................................................ 22
Table 25: Pre-Operational Periodic Information ....................................................................................................................................................................... 22
Table 26: Conditional Periodic Information .............................................................................................................................................................................. 22
Table 27: Error States ................................................................................................................................................................................................................ 23

List of Figures

Figure 1: TSEM Physical Perimeter .............................................................................................................................................................................................. 6
Figure 2: Block Diagram ............................................................................................................................................................................................................... 7
Figure 3:  Location of Tamper Seals (Front) .............................................................................................................................................................................. 18
Figure 4: Location of Tamper Seal #1 (Top Edge) ...................................................................................................................................................................... 18
Figure 5: Location of Tamper Seal #2 (Bottom Edge) ................................................................................................................................................................ 18

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 4 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

1  General

1.1  Overview

This document defines the Security Policy for the TuffServ® Encryption Module by Ampex, hereafter denoted the “TSEM”. The TSEM:

is a non-modifiable environment.

•
•  does not implement mitigations of attacks outside the scope of the FIPS 140-3 specification.

The TSEM is validated to FIPS 140-3 overall Level 2 requirements with security levels as specified in Section 1.2.

1.2  Security Levels

Section
1
2
3
4
5
6
7
8
9
10
11
12

Title
General
Cryptographic module specification
Cryptographic module interfaces
Roles, services, and authentication
Software/Firmware security
Operational environment
Physical security
Non-invasive security
Sensitive security parameter management
Self-tests
Life-cycle assurance
Mitigation of other attacks
Overall Level

Security Level
2
2
2
2
2
N/A
2
N/A
2
2
3
N/A
2

Table 1: Security Levels

2  Cryptographic Module Specification

2.1  Description

Purpose and Use:

The hardware TSEM is a multichip embedded embodiment in FIPS 140-3 terminology. The TSEM provides cryptographic key management services for the
TuffServ® secure storage device.

Module Type: Hardware

Module Embodiment: MultiChipEmbed

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 5 of 24

TuffServ® Encryption Module (TSEM)

Cryptographic Boundary:

FIPS 140-3 Security Policy

The Tested Operational Environment’s Physical Perimeter (TOEPP) is depicted in Figure 1. The cryptographic boundary is the metal enclosure and the P1
connector  on  the  back  of  the  enclosure.  The  enclosure  opening  for  the  P1  connector  does  not  expose  any  circuitry  except  for  the  P1  connector  and
associated traces or decoupling capacitors.

Front of Module

Back of Module with P1 Connector

Top of Module (Location of Tamper Seal #1)

Bottom of Module (Location of Tamper Seal #2)

Figure 1: TSEM Physical Perimeter

The TSEM logical functionality (outlined in red) in the context of the larger TuffServ® product is shown in Figure 2. The two SATA controllers (SATA CTL)
implement all data plane functionality, including AES XTS data encryption and decryption to and from the storage media. The SoC implements control
plane functionality, such as module initialization, configuration, and provisioning. All TSEM firmware is contained within the boundary.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 6 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

Figure 2: Block Diagram

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 7 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

2.2  Tested and Vendor Affirmed Module Version and Identification

Tested Module Identification – Hardware:

Model
and/or
Part
Number
TSEM

Hardware Version

Firmware
Version

Processors

Features

1320249-010 Rev A  1.1.16

NXP K81 (ARM Cortex M4)  N/A - only one TSEM model exists.

Table 2: Tested Module Identification – Hardware

2.3  Excluded Components

N/A for this Module.

2.4  Modes of Operation

Modes List and Description:

Mode Name

Description

Type

Status
Indicator

Approved Mode  Approved mode of operation  Approved

Table 3: Modes List and Description

The TSEM supports only an Approved mode of operation, with no configuration necessary to operate and remain in the Approved mode. The TSEM design
corresponds to the TSEM security rules specified in Section 11.4.

2.5  Algorithms

Approved Algorithms:

Cipher
Algorithm
AES-XTS Testing Revision 2.0  A2914

CAVP Cert

AES-ECB

AES-KW

AES-ECB

A2921

A2921

A3009

Table 4: Approved Algorithms - Cipher

Properties
Direction - Decrypt, Encrypt
Key Length - 256
Direction - Decrypt, Encrypt
Key Length - 256
Direction - Decrypt, Encrypt
Key Length - 256
Direction - Decrypt, Encrypt
Key Length - 128, 256

Reference
SP 800-38E

SP 800-38A

SP 800-38F

SP 800-38A

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 8 of 24

FIPS 140-3 Security Policy

TuffServ® Encryption Module (TSEM)

Signature
Algorithm
ECDSA SigVer (FIPS186-4)  A2921

CAVP Cert

Table 5: Approved Algorithms - Signature

Properties
Curve - P-384
Hash Algorithm - SHA2-384

Reference
FIPS 186-4

Random
Algorithm  CAVP Cert
Hash DRBG  A2921

Properties
Prediction Resistance - No
Mode - SHA2-256

Reference
SP 800-90A Rev. 1

Table 6: Approved Algorithms - Random

Message authentication
Algorithm
HMAC-SHA2-384  A2921

CAVP Cert

Properties
Reference
Key Length - Key Length: 256  FIPS 198-1

Table 7: Approved Algorithms - Message authentication

Key derivation
Algorithm
KDF SP800-108  A2921

CAVP Cert

Properties
KDF Mode - Counter
Supported Lengths - Supported Lengths: 256

Reference
SP 800-108 Rev. 1

Table 8: Approved Algorithms - Key derivation

Message digest
Algorithm  CAVP Cert
SHA2-256  A2921
SHA2-384  A2921

Properties
Reference
Message Length - Message Length: 256-2048 Increment 128  FIPS 180-4
Message Length - Message Length: 256-2048 Increment 128  FIPS 180-4

Table 9: Approved Algorithms - Message digest

Vendor-Affirmed Algorithms:

Properties
Name
CKG Section 4
Key Type:Symmetric  TSEM Cryptographic Library  NIST, SP 800-133 Rev. 2
CKG Section 6.1  Key Type:Symmetric  TSEM Cryptographic Library  NIST, SP 800-133 Rev. 2
CKG Section 6.2  Key Type:Symmetric  TSEM Cryptographic Library  NIST, SP 800-133 Rev. 2

Implementation

Reference

Table 10: Vendor-Affirmed Algorithms

Non-Approved, Allowed Algorithms:

N/A for this Module.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 9 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

Non-Approved, Allowed Algorithms with No Security Claimed:

N/A for this Module.

Non-Approved, Not Allowed Algorithms:

N/A for this Module.

2.6  Security Function Implementations

Name
Cipher

CKG Section 4

CKG Section 6.1

Type
BC-UnAuth

CKG

CKG

KTS

KTS-Wrap

Signature ECDSA

DigSig-SigVer

Key derivation

Random

CKG
KBKDF
MAC

CKG
ENT-P

Table 11: Security Function Implementations

2.7  Algorithm Specific Information

Properties

KTS:256 bit keys providing 256
bits of encryption strength

Description
AES-XTS encryption and
decryption for data storage
Using the Output of a Random
Bit Generator
Direct Generation of Symmetric
Keys
SP 800-38F. KTS (key wrapping
and unwrapping) per IG D.G
Signature verification

Key-based key derivation
(KBKDF) for key establishment.

Generate random value

Algorithms
AES-XTS Testing Revision 2.0
AES-ECB
CKG Section 4

CKG Section 6.1

AES-KW
AES-ECB
ECDSA SigVer (FIPS186-4)
SHA2-384
HMAC-SHA2-384
SHA2-384
KDF SP800-108
CKG Section 4
CKG Section 6.2
Hash DRBG
SHA2-256

XTS-AES:
In accordance with SP 800-38E, the XTS-AES algorithm is to be used for confidentiality on storage devices. The TSEM complies with FIPS 140-3 IG C.I by:

•  Generating Key_1 and Key_2 independently according to the rules for component symmetric keys from SP 800-133 Rev. 2 Section 6.3.
•  Explicitly checking that Key_1 ≠ Key_2 before using the keys in the XTS-AES algorithm to process data with them.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 10 of 24

TuffServ® Encryption Module (TSEM)

2.8  RBG and Entropy

Name

Type

Operational
Environment

Sample
Size

Entropy
per
Sample

Conditioning
Component

ENT K81  Physical  K81

1024 bytes  811 bits  N/A

Table 12: Entropy Sources

FIPS 140-3 Security Policy

The entropy source does not have an ESV certificate. In accordance with FIPS 140-3 IG 9.3.A option 1(a), the TSEM generates ENT within the module
boundary using a SP 800-90B compliant ENT (P) present on the SoC component.

Per SP 800-90A Rev. 1 Table 2, the SHA2-256 Hash_DRBG requires 256 bits of entropy (equivalent to security strength) within the 440-bit DRBG_Seed
value. As input to the SP 800-90A Rev. 1 Hash_df, the TSEM collects 1024 bytes of data from the ENT (P) to use as entropy and nonce input. The SP 800-
90B compliant assessment supports at least 0.099 bits of entropy per bit of ENT (P) output; as such the DRBG seeding material contains at least 811 bits
of entropy, well in excess of the requirement for generating the largest key size of 256 bits.

2.9  Key Generation

The TSEM performs symmetric key generation per FIPS 140-3 IG D.H (direct output of the DRBG):

•  Random values are produced in accordance with SP 800-133 Rev. 2 Section 4, in that the DRBG output is provided directly as the random output.
•  All usage of DRBG output is of the form B = U
•  Symmetric keys are generated directly by the DRBG in accordance with SP 800-133 Rev. 2 Section 6.1.

V, where V = 0.

The TSEM also performs derivation of symmetric keys in accordance with SP 800-133 Rev. 2 Section 6.2.

⊕

2.10  Key Establishment

Key agreement: N/A for this Module.

Key transport: The Module uses AES-KW with AES-256, which provides 256 bits of strength. This is an Approved key transport method compliant with SP
800-38F and FIPS 140-3 IG D.G.

2.11  Industry Protocols

N/A for this Module.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 11 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

3  Cryptographic Module Interfaces

3.1  Ports and Interfaces

Physical Port

P1: USB1.1 – full speed, 12 MB/s
Dedicated Virtual Serial Port over USB.

Logical
Interface(s)
Data Input
Data Output
Control
Input
Status
Output
Data Input
Data Output
Control
Input
Control
Output
Status
Output
P1: RESETN TSEM reset input, active low  Control

P1: SATA III I/O

Data That Passes

Proprietary control plane commands and responses to and from host (TSEM configuration and control). Does
not respond as a general-purpose USB port.

Data plane: interaction between host and drive media via controller. SATA commands/responses/status
to/from host. Plaintext Data In/Out (from/to host). Ciphertext Data Out/In (to/from media).

Low pulse results in TSEM reset.

P1: Power and ground connections

Table 13: Ports and Interfaces

Input
Power

N/A

The P1 connector, shown in Figure 1, is the only physical port of the TSEM. It incorporates all of the specified interfaces.

4  Roles, Services, and Authentication

4.1  Authentication Methods

Method
Name

Description

PIK Provided  Receipt of PIK by a provisioned TSEM provides role-based authentication of an operator in

the User role. The 256-bit PIK is used to derive the 256-bit TIK, which in turn is used to
unwrap the TMK. Success of the TMK key unwrap authenticates the caller and unlocks the
TSEM, moving it to the Operational state.

Security
Mechanism

KDF SP800-
108

Strength
Each
Attempt
1/(2^256) =
8.6E-78

Strength per Minute

(60*100,000,000)/(2^256) =
5.2E-70

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 12 of 24

TuffServ® Encryption Module (TSEM)

Method
Name

Description

Signature
Verification

Verification of signed command (ECDSA P-384 / SHA-384). All commands that require CO
authentication include a corresponding authentication block (signature value) in the
command. The value must be verified for the command to be executed.

Table 14: Authentication Methods

4.2  Roles

Name
CO
User

Table 15: Roles

Type
Role
Role

Operator Type  Authentication Methods
CO
User

Signature Verification
PIK Provided

Security
Mechanism

Signature
ECDSA

Strength
Each
Attempt
1/(2^192) =
1.6E-58

FIPS 140-3 Security Policy

Strength per Minute

(60*100,000,000)/(2^192) =
9.6E-51

The CO and the User roles are implicitly identified by the service requested.

4.3  Approved Services

Name

Description

Indicator

Inputs

Outputs

Initialize

Power-on initialization, including DRBG
instantiate and Built-In Test (BIT) with CASTs
and FW integrity.

None

None (automatic
invocation at power-on /
reset).

CPSW (on first
command)

create_keys

Derive TIK from PIK. Use TIK to obtain KEK.
Generate DEKs (compliant with SP800-133r2
CKG) and wrap using KEK. Return wrapped
DEKs.

TSEM_STATUS_OK or
error code

create_keys command
packet, PIK, command
signature.

CPSW; eDEK

create_random  Obtain a random value.

TSEM_STATUS_OK or
error code

create_random command
packet .

CPSW; random
value

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Security
Functions
Random

Cipher
CKG
Section 4
CKG
Section 6.1
KTS
Signature
ECDSA
Key
derivation
Random
CKG
Section 4

SSP Access

Unauthenticated
- DRBG_EI: G,E,Z
- DRBG_C: G,W
- DRBG_V: G,W
- DRBG_Seed:
G,E,Z
CO
- COA Public: E
- PIK: W,E,Z
- TIK: G,E,Z
- TMK: G,E
- KEK: G,E,Z
- DRBG_C: W,E
- DRBG_V: W,E
- DEK: G,R,Z

Unauthenticated
- DRBG_EI: G,E,Z
- DRBG_C: G,W

Page 13 of 24

TuffServ® Encryption Module (TSEM)

Name

Description

Indicator

Inputs

Outputs

FIPS 140-3 Security Policy

Security
Functions

SSP Access

destroy

Halt and reset SATA controllers. Destroy CSPs
in local memory and NVM.

TSEM_STATUS_OK or
error code

destroy command packet,
command signature.

CPSW

Signature
ECDSA

- DRBG_Seed:
G,E,Z
CO
- COA Public: E,Z
- DEK: Z
- TMK: Z
- DRBG_C: Z
- DRBG_EI: Z
- DRBG_Seed: Z
- DRBG_V: Z
- KEK: Z
- PIK: Z
- TIK: Z
Unauthenticated

do_bit

Perform built-in test (including FIPS 140 self-
tests).

TSEM_STATUS_OK or
error code

get_bit_results  Obtain status of the most recent built-in tests.  TSEM_STATUS_OK

nop

provision

Check TSEM responsiveness without
performing an operation.
Derive TIK from PIK. Wrap TMK using TIK.
eTMK refers to the wrapped TMK.

TSEM_STATUS_OK

TSEM_STATUS_OK or
error code

do_bit command packet,
self-test selection.
get_bit_results command
packet, self-test selection.
nop command; no
additional input.
provision command
packet, PIK, TMK,
command signature.

CPSW; self-test
results
CPSW; self-test
results
CPSW

CPSW

put_keys

Derive TIK from PIK. Use TIK to obtain KEK.
Use KEK to unwrap DEK. Update SATA
controller.

TSEM_STATUS_OK or
error code

put_keys command
packet, PIK, command
signature.

CPSW

SATA reset
status

Reset the SATA controllers.
Return status, name, version.

SATA_OK
TSEM_STATUS_OK

SATA reset command.
This service is not
authenticated per
FIPS140-3_IG 4.1.A.

CPSW.
CPSW; TSEM
name, status,
version info

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

None

None

Unauthenticated

None

Unauthenticated

Signature
ECDSA
Key
derivation

Cipher
CKG
Section 4
CKG
Section 6.1
KTS
Signature
ECDSA
Key
derivation
None
None

CO
- COA Public: E
- PIK: W,E,Z
- TIK: G,E,Z
- TMK: W,Z
CO
- COA Public: E
- PIK: W,E,Z
- TIK: G,E,Z
- TMK: G,E
- KEK: G,E,Z
- DEK: G,R,Z

Unauthenticated
Unauthenticated

Page 14 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

Name

Description

Indicator

Inputs

Outputs

read

write

Read decrypted data from media.

Write encrypted data to media.

Media control  Non-cryptographic SATA commands.

Table 16: Approved Services

SATA_OK or error
code
SATA_OK or error
code
SATA_OK or error
code

SATA read command
input.
SATA write command
input, data to storage.
SATA media control
command input.

SATA response,
data from storage
SATA response

SATA response

None

Security
Functions
Cipher

Cipher

SSP Access

User
- DEK: E
User
- DEK: E
Unauthenticated

The TSEM supports two status mechanisms: nop returns minimal status information, status returns additional information. A return code of 0 represents
a state without errors. Any other return code is the specific function error of the TSEM.

The  phrase “self-test selection” in do_bit and  get_bit_results commands  refers to an  enumerated target of  self-tests, which can specify the firmware
integrity test, subsets of CASTs or SATA controller self-tests. “BIT” refers to built-in tests.

eDEK and eTMK refer to the wrapped set of AES XTS (DEK) keys or wrapped TMK, respectively.

CPSW (control plane status word): the Approved mode indicator and success or failure (enumerated) status.

The Indicator column above shows all possible (success or failure) indicator values. The TSEM is a slave device and as such can return status only when it
receives a command. If the TSEM fails any CAST or firmware integrity test, it will respond as described in Section 10.4. The return code TSEM_STATUS_OK
confirms normal successful completion of the command in the Approved mode, similar to FIPS 140-3 IG 2.4.C example scenario 2, a global indicator for
modules having Approved services only.

The relationship of SSPs and security functions is detailed next, using the following notation based on the cited specifications:
SP 800-38F Authenticated encryption: Ciphertext (wrapped) Key = KW-AE (Wrapping Key, Plaintext Key).
SP 800-38F Authenticated decryption: Plaintext key = KW-AD (Wrapping Key, Ciphertext (wrapped) Key).
SP 800-90A Rev. 1 DRBG Generate (Length): generate Length random bits.
SP 800-108 Rev. 1 Key Based Key Derivation Function (KBKDF) used to derive symmetric Key Material from a Key Derivation Key. The TSEM uses the Counter
mode with HMAC as PRF.

Key Material = KBKDF (Key Derivation Key, Label, Context, Length)
•
Label: binary string that identifies the purpose for the derived keying material.
•  Context: a binary string used to bind the derived value to an entity or process.
•

Length of material to be derived in bits.

The notation eKeyname refers to Keyname in encrypted (ciphertext) form. It is not a different CSP.

create_keys
[1] Verify command (with COA Public).

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 15 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

[2] TIK = KBKDF (PIK): Derive TIK from PIK.
[3] TMK = KW-AD (TIK, eTMK): Use TIK to obtain KEK.
[4] KEK = KBKDF (TMK). Generate DEKs and wrap using KEK. Return wrapped DEKs. (eDEK refers to the wrapped DEK.)
[5] DEK = DRBG Generate.
[6] Verify AES XTS non-equal.
[7] eDEK = KW-AE(KEK, DEK).

create_random
Performs a DRBG generate. DRBG_EI is used to seed as required. Random generation updates the DRBG_State.

destroy
[1] Verify command (with COA Public).
[2] Halt / reset SATA controllers.
[3] Overwrite RAM CSPs.
[4] Erase NVM CSPs.

do_bit, get_bit_results, nop, status and Media control do not utilize approved security functions or access SSPs. The term “bit” refers to built-in self-test
functionality.

The nop command provides a mechanism to check simple status; the status command provides extended status information, including name and version
correlatable to the CMVP listing (as required by ISO/IEC 19790:2012 AS04.13). The status command response (intended for use by the host device driver)
is  a  binary  structure  encoded  in  Base64  for  transfer.  When  translated  to  ASCII,  the  response  includes  the  module  name  (“TSEM”)  as  well  as  version
information for the SoC and the SATA controllers.

provision
[1] Verify command (COA Public).
[2] TIK = KBKDF (PIK): Derive TIK from PIK.
[3] eTMK = KW-AE (TIK, TMK): Wrap TMK using TIK. (eTMK refers to the wrapped TMK.)

put_keys
Update SATA controller.
[1] Verify command (COA Public).
[2] TIK = KBKDF (PIK): Derive TIK from PIK.
[3] TMK = KW-AD (TIK, eTMK): Use TIK to obtain KEK.
[4] KEK = KBKDF (TMK): Derive KEK from TMK.
[5] DEK = KW-AD (KEK, eDEK): Use KEK to unwrap DEK.
[6] Verify AES XTS key constituents are non-equal.
[7] Update SATA controller DEK.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 16 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

SATA reset
Resets the SATA engine hardware, zeroizing the DEK SSPs in both channels. The DEK keys are erased from SATA controller registers but remain intact in
the TSEM RAM.

read
Decrypts the data using AES-XTS; supports 2 channels of decryption with separate keys.

Write
Encrypts the data using AES-XTS; supports 2 channels of encryption with separate keys.

4.4  Non-Approved Services

N/A for this Module.

4.5  External Software/Firmware Loaded

N/A for this Module.

5  Software/Firmware Security

5.1

Integrity Techniques

The TSEM uses ECDSA P-384 SHA2-384 signature verification performed over all module firmware as the integrity technique.

5.2

Initiate on Demand

The operator can initiate the integrity test on demand by power cycling the module or by issuing the do_bit command.

6  Operational Environment

6.1  Operational Environment Type and Requirements

Type of Operational Environment: Non-Modifiable

7  Physical Security

7.1  Mechanisms and Actions Required

Mechanism
Enclosure tamper
seals (qty. 2)

Inspection Frequency
Seals should be inspected during maintenance operations and when
circumstances dictate (e.g., if tampering is suspected).

Inspection Guidance
The tamper seals are within recessed seal guides. Inspect tamper
seals for evidence of lifted edges or excessive wear.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 17 of 24

TuffServ® Encryption Module (TSEM)

Table 17: Mechanisms and Actions Required

FIPS 140-3 Security Policy

The hardware TSEM is a multichip embedded embodiment packaged in a metal enclosure. The metal enclosure is protected by two (2) tamper seals placed
within the seal guides (milled sections on the enclosure), as shown in Error! Reference source not found.. The metal enclosure is opaque in the visible
spectrum.

Ampex maintains control over the tamper seals, which may only be applied or replaced in the factory setting.

Figure 4: Location of Tamper Seal #1 (Top Edge)

Figure 3:  Location of Tamper Seals (Front)

Figure 5: Location of Tamper Seal #2 (Bottom Edge)

8  Non-Invasive Security
N/A for this Module.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 18 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

9  Sensitive Security Parameters Management

9.1  Storage Areas

Description

Persistence
Type
Firmware image stored in SoC Non-volatile memory (flash)  Static
SoC RAM

Storage Area
Name
SoC FW NVM
SoC RAM
SATA CTL register  SATA CTL register
SoC NVM

SoC CFG Non-volatile memory (flash)

Dynamic
Dynamic
Static

Table 18: Storage Areas

9.2  SSP Input-Output Methods

Name

From

To

Ampex facility
Encrypted input parameter
Encrypted output parameter  SATA CTL register
Plaintext input parameter

External source

Entered in Ampex maintenance facility.  SoC FW NVM
External source

SATA CTL register  Encrypted  Automated  Electronic  KTS
Encrypted  Automated  Electronic  KTS
External source
Plaintext  Automated  Electronic
SoC RAM

Distribution
Format
Type
Type
Plaintext  N/A

Entry
Type
N/A

SFI or
Algorithm

Table 19: SSP Input-Output Methods

9.3  SSP Zeroization Methods

Description

Zeroization
Method
After use
Power Cycle  Overwritten by zeros upon loss of power  Overwritten with zeros  Operator can remove power from the module
Overwritten by zeros by Destroy service  Overwritten with zeros  Operator calls the destroy service
Destroy

Overwritten with zeros  Module code enforces zeroization after use

Overwritten by zeros after use

Operator Initiation

Rationale

Table 20: SSP Zeroization Methods

TSEM code destroys all plaintext CSPs prior to return from any control plane command.

9.4  SSPs

Name

Description

Size - Strength

Type - Category

Generated By  Established

Used By

By

COA Public  Verification of CO operator commands.

Size: 384 -
Strength: 192

ECDSA P-384 -
PSP

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Signature
ECDSA

Page 19 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

Name

Description

Size - Strength

Type - Category

Generated By  Established

Used By

DEK

AES XTS data encryption keys (DEKC1, DEKC2, DEKD1, DEKD2).

DRBG_C

DRBG state value C.

DRBG_EI

DRBG Entropy Input (inclusive of nonce).

DRBG_Seed  DRBG Seed (required per CMVP SSP conventions).

DRBG_V

DRBG state value V.

KEK

AES-256 key used to wrap DEK keys.

PIK

TIK

Platform Identity Key, used to derive TIK which unwraps TMK;
success authenticates host to TSEM.
TSEM Identity Key: used to wrap the TMK.

TMK

TSEM Master Key: AES-256 key used to derive KEK.

Size: 256 -
Strength: 256

Size: 440 -
Strength: 256
Size: 1024 -
Strength: 256
Size: 440 -
Strength: 256
Size: 440 -
Strength: 256
Size: 256 -
Strength: 256
Size: 256 -
Strength: 256
Size: 256 -
Strength: 256
Size: 256 -
Strength: 256

Symmetric - CSP

CKG Section 4
CKG Section
6.1
Hash DRBG

Hash_DRBG_C -
CSP
Entropy input -
CSP
DRBG_Seed - CSP  Hash DRBG

Hash_DRBG_V -
CSP
Symmetric - CSP

Symmetric - CSP

Key
derivation

Symmetric - CSP

Key
derivation

Symmetric - CSP

By

Cipher

Hash DRBG

Hash DRBG

Hash DRBG

Hash DRBG

Hash DRBG

KTS

Key derivation

KTS

Key derivation

Table 21: SSP Table 1

Name

Input - Output

Storage

COA Public  Ampex facility
DEK

Encrypted input parameter
Encrypted output parameter

SoC NVM:Plaintext
SoC RAM:Plaintext
SATA CTL register:Plaintext

Storage
Duration
Call lifetime
Call lifetime

Zeroization  Related SSPs

Destroy
After use
Power Cycle
Destroy

KEK:Wrapped By

DRBG_C

DRBG_EI

SoC RAM:Plaintext

Module uptime  After use

Power Cycle
Destroy

DRBG_V:Used With
DRBG_Seed:Derived From

SoC RAM:Plaintext

Module uptime  After use

DRBG_Seed:Incorporated Into

DRBG_Seed

SoC RAM:Plaintext

Module uptime  After use

Power Cycle
Destroy

DRBG_EI:Constituent
DRBG_C:Derives
DRBG_V:Derives

Power Cycle
Destroy

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 20 of 24

TuffServ® Encryption Module (TSEM)

Name

Input - Output

Storage

DRBG_V

KEK

SoC RAM:Plaintext

Zeroization  Related SSPs

Storage
Duration
Module uptime  After use

SoC RAM:Plaintext

Call lifetime

FIPS 140-3 Security Policy

Power Cycle
Destroy
After use
Power Cycle
Destroy
After use
Power Cycle
Destroy
After use
Power Cycle
Destroy
Destroy

DRBG_C:Used With
DRBG_Seed:Generated From

TMK:Derived From
DEK:Wraps

TIK:Derives

PIK:Derived From
TMK:Wrapped By

TIK:Wraps

PIK

Plaintext input parameter

SoC RAM:Plaintext

Call lifetime

TIK

SoC RAM:Plaintext

Call lifetime

TMK

Plaintext input parameter

SoC NVM:Encrypted

Call lifetime

Table 22: SSP Table 2

10 Self-Tests

10.1  Pre-Operational Self-Tests

Test Properties

Algorithm
or Test
FW Integrity  ECDSA P-384 #A2921  Signature verification performed over all TSEM firmware at power-up.  SW/FW Integrity  TSEM_STATUS_OK  Verify

Test Method

Test Type

Indicator

Details

Table 23: Pre-Operational Self-Tests

The corresponding ECDSA signature verification CAST is performed prior to the integrity test.

10.2  Conditional Self-Tests

Algorithm or Test

AES-XTS Testing
Revision 2.0
AES-XTS Testing
Revision 2.0
AES-KW
AES-KW

Test
Properties
256-bit

Test
Method
KAT

Indicator

Test
Type
CAST  TSEM_STATUS_OK  Encrypt

Details

Conditions

Performed on module load.

256-bit

KAT

CAST  TSEM_STATUS_OK  Decrypt

Performed on module load.

256-bit
256-bit

KAT
KAT

CAST  TSEM_STATUS_OK  Forward cipher
CAST  TSEM_STATUS_OK  Inverse cipher

Performed on module load.
Performed on module load.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 21 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

Algorithm or Test

ECDSA SigVer
(FIPS186-4)
Hash DRBG
KDF SP800-108

SHA2-384 (A2921)
ENT (P) Self-tests

Test
Method
KAT

Test
Properties
P-384 SHA2-
384
SHA2-256
HMAC-SHA2-
384
KAT
SHA2-384
90B Self-tests  CAST

KAT
KAT

Indicator

Test
Type
CAST  TSEM_STATUS_OK  Signature verification

Details

CAST  TSEM_STATUS_OK  Instantiate, generate, reseed
CAST  TSEM_STATUS_OK  SP800-108r1 Section 4.1 KAT for a

Counter Mode KDF

CAST  TSEM_STATUS_OK  Hash
CAST  TSEM_STATUS_OK  90B Health Tests

Conditions

Performed on module load prior to firmware
integrity test.
Performed on module load.
Performed on module load.

Performed on module load.
Performed on module load, power cycle or
do_bit service invocation.

Table 24: Conditional Self-Tests

All cryptographic algorithm self-tests (CASTs) must complete successfully prior to any other use of cryptography by the TSEM.

10.3  Periodic Self-Test Information

Algorithm or Test
FW Integrity

Test Method
Signature verification
performed over all TSEM
firmware at power-up.

Table 25: Pre-Operational Periodic Information

Test Method

Algorithm or Test
AES-XTS Testing Revision 2.0  KAT
AES-XTS Testing Revision 2.0  KAT
KAT
AES-KW
KAT
AES-KW
KAT
ECDSA SigVer (FIPS186-4)
KAT
Hash DRBG
KAT
KDF SP800-108
KAT
SHA2-384 (A2921)
CAST
ENT (P) Self-tests

Table 26: Conditional Periodic Information

10.4  Error States

Name

Description

Conditions

Test Type
SW/FW Integrity

Period
On demand

Periodic Method
Power cycle or do_bit

Test Type
CAST
CAST
CAST
CAST
CAST
CAST
CAST
CAST
CAST

Period
On demand
On demand
On demand
On demand
On demand
On demand
On demand
On demand
Each use

Periodic Method
Power cycle or do_bit
Power cycle or do_bit
Power cycle or do_bit
Power cycle or do_bit
Power cycle or do_bit
Power cycle or do_bit
Power cycle or do_bit
Power cycle or do_bit
Continuously running

Recovery
Method

Indicator

ERROR state  Self-test failure error state  If one of the KATs fails or integrity test fails  Power-cycle  Non-zero return status

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 22 of 24

TuffServ® Encryption Module (TSEM)

Table 27: Error States

FIPS 140-3 Security Policy

If one of the CASTs fails, the TSEM enters the ERROR state. The error state is persistent, and only Status services are available. All attempts to use the
TSEM’s services result in the return of a non-zero error code in the range -40 (TSEM_ERROR_CYBER) to -47 (TSEM_ERROR_CYBER_LYCAN2).

10.5  Operator Initiation of Self-Tests

The TSEM automatically invokes all self-tests on each power-on or reset. The conditional self-tests may also be invoked on demand by the Self-Test service
do_bit command; detailed results are available using the Self-Test service get_BITResults command.

11 Life-Cycle Assurance

11.1  Installation, Initialization, and Startup Procedures

The TSEM is a subsystem of the TuffServ® product and is not intended for use in other settings. The TSEM User and CO Guide documents all procedures
for the following:

•  Secure installation, initialization, configuration, and provisioning of the TSEM.
•  Secure distribution and delivery of the TSEM.

The module only operates in the Approved mode of operation. There are no maintenance requirements for the TSEM.

11.2  Administrator Guidance

The TSEM User and CO Guide is inclusive of all information required per ISO/IEC 19790:2012 Section 7.11.9.

11.3  Non-Administrator Guidance

The TSEM User and CO Guide is inclusive of all information required per ISO/IEC 19790:2012 Section 7.11.9.

11.4  Design and Rules

The TSEM enforces the following security rules:
1.  All services implemented by the module are described in the tables below. The module has no other mechanism which permits access to CSPs.
2.  Data output is inhibited during key generation, self-tests, zeroization, and the error state.
3.  Control output is inhibited whenever the module is in the error state and during self-tests.
4.  There are no restrictions on which keys or CSPs are zeroized by the zeroization service.
5.  The module does not support manual key entry.
6.  The module does not support firmware loading.
7.  The module does not output plaintext CSPs or intermediate key values.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 23 of 24

TuffServ® Encryption Module (TSEM)

FIPS 140-3 Security Policy

8.  The module does not allow CSPs entered in the module in encrypted form to be displayed in plaintext.
9.  Status information does not contain CSPs or sensitive data that if misused could lead to a compromise of the module.
10. The module can use only algorithms that have passed self-tests.
11. The module prohibits changing to the Crypto Officer state from any other role other than the Crypto Officer.
12. The module does not support multiple concurrent operators, a maintenance role or a bypass capability.

11.5  End of Life

The TSEM User and CO Guide documents all procedures for decommissioning and sanitization of the TSEM.

12 Mitigation of Other Attacks
N/A for this Module.

Copyright © 2024 Ampex Data Systems Corporation
This non-proprietary Security Policy document may be freely reproduced and distributed in its entirety without modification.

Page 24 of 24

